diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/autoconf_inc.m4 wxPdfDoc-copy/build/autoconf_inc.m4
--- wxpdfdoc-0.9.2.1/build/autoconf_inc.m4	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/autoconf_inc.m4	2012-05-22 01:03:23.074200000 +0100
@@ -1,10 +1,10 @@
 dnl ### begin block 00_header[wxpdfdoc.bkl] ###
 dnl
 dnl This macro was generated by
-dnl Bakefile 0.2.8 (http://www.bakefile.org)
+dnl Bakefile 0.2.9 (http://www.bakefile.org)
 dnl Do not modify, all changes will be overwritten!
 
-BAKEFILE_AUTOCONF_INC_M4_VERSION="0.2.8"
+BAKEFILE_AUTOCONF_INC_M4_VERSION="0.2.9"
 
 dnl ### begin block 20_COND_DEPS_TRACKING_0[wxpdfdoc.bkl] ###
     COND_DEPS_TRACKING_0="#"
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/configure.ac wxPdfDoc-copy/build/configure.ac
--- wxpdfdoc-0.9.2.1/build/configure.ac	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/configure.ac	2012-05-26 17:57:54.206900000 +0100
@@ -10,7 +10,7 @@
 
 # Init this configure script with basic info about the component
 # (DON'T PUT ANYTHING BEFORE AC_INIT, JUST COMMENTS)
-AC_INIT([wxpdfdoc], [0.9.1], [utelle@users.sourceforge.net])
+AC_INIT([wxpdfdoc], [0.9.3], [utelle@users.sourceforge.net])
 AC_CONFIG_AUX_DIR(build)
 
 # ENABLES/DISABLES THE DEBUG MODE FOR THIS CONFIGURE SCRIPT
@@ -44,7 +44,7 @@
 # argument 1: here put the minimum required version of wx
 # argument 2: here you must put a comma-separed list of all wx required libraries 
 #             except for base,core (e.g. "xml,net,adv"); leave empty if you use only core & base
-WXCODE_CHECKS([2.8.0], [core,base,xml])      # we need at least wxWidgets 2.8 to work
+WXCODE_CHECKS([2.8.0], [core,base,xml,adv,html,richtext])      # we need at least wxWidgets 2.8 to work
 
 # end in a nice way the configure script
 WXCODE_END
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/GNUmakefile wxPdfDoc-copy/build/GNUmakefile
--- wxpdfdoc-0.9.2.1/build/GNUmakefile	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/GNUmakefile	2012-05-22 01:03:37.596400000 +0100
@@ -1,6 +1,6 @@
 # =========================================================================
 #     This makefile was generated by
-#     Bakefile 0.2.8 (http://www.bakefile.org)
+#     Bakefile 0.2.9 (http://www.bakefile.org)
 #     Do not modify, all changes will be overwritten!
 # =========================================================================
 
@@ -115,6 +115,7 @@
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfocg.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfparser.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfpattern.o \
+	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfprint.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfrijndael.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdftemplate.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfutility.o \
@@ -168,6 +169,7 @@
 	include/wx/pdfobjects.h \
 	include/wx/pdfparser.h \
 	include/wx/pdfpattern.h \
+	include/wx/pdfprint.h \
 	include/wx/pdfproperties.h \
 	include/wx/pdfrijndael.h \
 	include/wx/pdfshape.h \
@@ -225,6 +227,7 @@
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfocg.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfparser.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfpattern.o \
+	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfprint.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfrijndael.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdftemplate.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfutility.o \
@@ -278,6 +281,7 @@
 	include/wx/pdfobjects.h \
 	include/wx/pdfparser.h \
 	include/wx/pdfpattern.h \
+	include/wx/pdfprint.h \
 	include/wx/pdfproperties.h \
 	include/wx/pdfrijndael.h \
 	include/wx/pdfshape.h \
@@ -297,6 +301,7 @@
 MINIMAL_CXXFLAGS = $(VAR) $(VAR_7) -W -Wall -I../include -I../samples/minimal \
 	`$(WX_CONFIG) --cxxflags $(WX_CONFIG_FLAGS)` $(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  \
+	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/minimal_attachment.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/minimal_barcodes.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/minimal_bookmark.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/minimal_charting.o \
@@ -657,6 +662,9 @@
 gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfpattern.o: ../src/pdfpattern.cpp
 	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
 
+gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfprint.o: ../src/pdfprint.cpp
+	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
+
 gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfrijndael.o: ../src/pdfrijndael.cpp
 	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
 
@@ -780,6 +788,9 @@
 gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfpattern.o: ../src/pdfpattern.cpp
 	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
 
+gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfprint.o: ../src/pdfprint.cpp
+	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
+
 gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfrijndael.o: ../src/pdfrijndael.cpp
 	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
 
@@ -792,6 +803,9 @@
 gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfxml.o: ../src/pdfxml.cpp
 	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
 
+gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/minimal_attachment.o: ../samples/minimal/attachment.cpp
+	$(CXX) -c -o $@ $(MINIMAL_CXXFLAGS) $(CPPDEPS) $<
+
 gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/minimal_barcodes.o: ../samples/minimal/barcodes.cpp
 	$(CXX) -c -o $@ $(MINIMAL_CXXFLAGS) $(CPPDEPS) $<
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/makefile.bcc wxPdfDoc-copy/build/makefile.bcc
--- wxpdfdoc-0.9.2.1/build/makefile.bcc	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/makefile.bcc	2012-05-26 17:57:54.222500000 +0100
@@ -1,6 +1,6 @@
 # =========================================================================
 #     This makefile was generated by
-#     Bakefile 0.2.8 (http://www.bakefile.org)
+#     Bakefile 0.2.9 (http://www.bakefile.org)
 #     Do not modify, all changes will be overwritten!
 # =========================================================================
 
@@ -125,6 +125,7 @@
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfocg.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfparser.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.obj \
+	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdftemplate.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfutility.obj \
@@ -171,6 +172,7 @@
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfocg.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfparser.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.obj \
+	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdftemplate.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfutility.obj \
@@ -180,6 +182,7 @@
 	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -I..\include -I..\samples\minimal $(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  \
+	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_bookmark.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_charting.obj \
@@ -246,6 +249,15 @@
 __pdfdoc_dll___depname = \
 	..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.dll
 !endif
+!if "$(WX_MONOLITHIC)" == "0"
+__WXLIB_ADV_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_adv.lib
+!endif
+!if "$(WX_MONOLITHIC)" == "0"
+__WXLIB_HTML_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_html.lib
+!endif
+!if "$(WX_MONOLITHIC)" == "0"
+__WXLIB_RICHTEXT_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_richtext.lib
+!endif
 !if "$(SHARED)" == "0"
 ____pdfdoc_lib__DIRNAME_SHARED_SUFFIX_FILENAMES = lib
 !endif
@@ -423,7 +435,7 @@
 
 ..\samples\pdfdc\printing.exe: $(DCSAMPLE_OBJECTS) $(__COMPONENT_LIB_DEP)  bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res
 	ilink32 -Tpe -q  -L$(BCCDIR)\lib -L$(BCCDIR)\lib\psdk -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH) -aa $(LDFLAGS) @&&|
-	c0w32.obj $(DCSAMPLE_OBJECTS),$@,, $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib ole2w32.lib oleacc.lib import32.lib cw32.lib,, bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res
+	c0w32.obj $(DCSAMPLE_OBJECTS),$@,, $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) $(__WXLIB_ADV_NAME_p) $(__WXLIB_HTML_NAME_p) $(__WXLIB_RICHTEXT_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib ole2w32.lib oleacc.lib import32.lib cw32.lib,, bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res
 |
 
 ..\makefont\makefont.exe: $(MAKEFONT_OBJECTS) $(__COMPONENT_LIB_DEP)  bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.res
@@ -547,6 +559,9 @@
 bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.obj: ..\src\pdfpattern.cpp
 	$(CXX) -q -c -P -o$@ $(PDFDOC_LIB_CXXFLAGS) ..\src\pdfpattern.cpp
 
+bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.obj: ..\src\pdfprint.cpp
+	$(CXX) -q -c -P -o$@ $(PDFDOC_LIB_CXXFLAGS) ..\src\pdfprint.cpp
+
 bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.obj: ..\src\pdfrijndael.cpp
 	$(CXX) -q -c -P -o$@ $(PDFDOC_LIB_CXXFLAGS) ..\src\pdfrijndael.cpp
 
@@ -670,6 +685,9 @@
 bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.obj: ..\src\pdfpattern.cpp
 	$(CXX) -q -c -P -o$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfpattern.cpp
 
+bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.obj: ..\src\pdfprint.cpp
+	$(CXX) -q -c -P -o$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfprint.cpp
+
 bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.obj: ..\src\pdfrijndael.cpp
 	$(CXX) -q -c -P -o$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfrijndael.cpp
 
@@ -682,6 +700,9 @@
 bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfxml.obj: ..\src\pdfxml.cpp
 	$(CXX) -q -c -P -o$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfxml.cpp
 
+bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.obj: ..\samples\minimal\attachment.cpp
+	$(CXX) -q -c -P -o$@ $(MINIMAL_CXXFLAGS) ..\samples\minimal\attachment.cpp
+
 bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.obj: ..\samples\minimal\barcodes.cpp
 	$(CXX) -q -c -P -o$@ $(MINIMAL_CXXFLAGS) ..\samples\minimal\barcodes.cpp
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/makefile.gcc wxPdfDoc-copy/build/makefile.gcc
--- wxpdfdoc-0.9.2.1/build/makefile.gcc	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/makefile.gcc	2012-05-26 01:10:03.876700000 +0100
@@ -46,6 +46,14 @@
 # Build this wxCode component as DLL or as static library? [0,1]
 SHARED ?= 0
 
+# Build printing sample with html printout example
+WX_USE_HTML ?= 1
+
+# Build printing sample with richtext printout example
+WX_USE_RICHTEXT ?= 1
+
+# use the static libs included
+WXPERL_STATIC_DIR ?=none
 
 
 # -------------------------------------------------------------------------
@@ -58,7 +66,7 @@
 COMPILER_PREFIX = gcc
 PDFDOC_LIB_CXXFLAGS = -DHAVE_W32API_H $(____WX_SHARED) $(__WXUNICODE_DEFINE_p) \
 	$(__WXDEBUG_DEFINE_p) -D__WXMSW__ \
-	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
+	-I$(WX_DIR)$(WXLIBPATH) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -W -Wall -I..\include $(CPPFLAGS) $(CXXFLAGS)
 PDFDOC_LIB_OBJECTS =  \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfannotation.o \
@@ -98,13 +106,14 @@
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfocg.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfparser.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.o \
+	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdftemplate.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfutility.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfxml.o
 PDFDOC_DLL_CXXFLAGS = -DHAVE_W32API_H $(____WX_SHARED) $(__WXUNICODE_DEFINE_p) \
 	$(__WXDEBUG_DEFINE_p) -D__WXMSW__ \
-	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
+	-I$(WX_DIR)$(WXLIBPATH) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -W -Wall -I..\include -DWXMAKINGDLL_PDFDOC $(CPPFLAGS) $(CXXFLAGS)
 PDFDOC_DLL_OBJECTS =  \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfannotation.o \
@@ -144,15 +153,17 @@
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfocg.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfparser.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.o \
+	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdftemplate.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfutility.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfxml.o
 MINIMAL_CXXFLAGS = -DHAVE_W32API_H $(____WX_SHARED) $(__WXUNICODE_DEFINE_p) \
 	$(__WXDEBUG_DEFINE_p) -D__WXMSW__ \
-	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
+	-I$(WX_DIR)$(WXLIBPATH) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -W -Wall -I..\include -I..\samples\minimal $(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  \
+    gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_bookmark.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_charting.o \
@@ -184,21 +195,21 @@
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_minimal_rc.o
 DCSAMPLE_CXXFLAGS = -DHAVE_W32API_H $(____WX_SHARED) $(__WXUNICODE_DEFINE_p) \
 	$(__WXDEBUG_DEFINE_p) -D__WXMSW__ \
-	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
+	-I$(WX_DIR)$(WXLIBPATH) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -W -Wall -I..\include -I..\samples\pdfdc $(CPPFLAGS) $(CXXFLAGS)
 DCSAMPLE_OBJECTS =  \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing_rc.o
 MAKEFONT_CXXFLAGS = -DHAVE_W32API_H $(____WX_SHARED) $(__WXUNICODE_DEFINE_p) \
 	$(__WXDEBUG_DEFINE_p) -D__WXMSW__ \
-	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
+	-I$(WX_DIR)$(WXLIBPATH) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -W -Wall -I..\include -I..\makefont $(CPPFLAGS) $(CXXFLAGS)
 MAKEFONT_OBJECTS =  \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont_rc.o
 SHOWFONT_CXXFLAGS = -DHAVE_W32API_H $(____WX_SHARED) $(__WXUNICODE_DEFINE_p) \
 	$(__WXDEBUG_DEFINE_p) -D__WXMSW__ \
-	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
+	-I$(WX_DIR)$(WXLIBPATH) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -W -Wall -I..\include -I..\showfont $(CPPFLAGS) $(CXXFLAGS)
 SHOWFONT_OBJECTS =  \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont.o \
@@ -298,6 +309,16 @@
 __WXLIB_XML_NAME_p = -lwxbase$(WX_VERSION)$(WXLIBPOSTFIX)_xml
 endif
 ifeq ($(WX_MONOLITHIC),0)
+ifeq ($(WX_USE_RICHTEXT),1)
+__WXLIB_RICHTEXT_NAME_p = -lwxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_richtext
+endif
+endif
+ifeq ($(WX_MONOLITHIC),0)
+ifeq ($(WX_USE_HTML),1)
+__WXLIB_HTML_NAME_p = -lwxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_html
+endif
+endif
+ifeq ($(WX_MONOLITHIC),0)
 __WXLIB_CORE_NAME_p = -lwxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_core
 endif
 ifeq ($(WX_MONOLITHIC),0)
@@ -307,10 +328,10 @@
 __WXLIB_BASE_NAME_p = -lwxmsw$(WX_VERSION)$(WXLIBPOSTFIX)
 endif
 ifeq ($(WX_SHARED),0)
-WXLIBPATH = \lib\$(COMPILER_PREFIX)_lib
+WXLIBPATH = \lib
 endif
 ifeq ($(WX_SHARED),1)
-WXLIBPATH = \lib\$(COMPILER_PREFIX)_dll
+WXLIBPATH = \lib
 endif
 ifeq ($(WX_DEBUG),0)
 VAR_7 = 
@@ -340,15 +361,15 @@
 	-if exist ..\showfont\showfont.exe del ..\showfont\showfont.exe
 
 test_for_selected_wxbuild: 
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo ----------------------------------------------------------------------------
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo The selected wxWidgets build is not available!
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo Please use the options prefixed with WX_ to select another wxWidgets build.
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo ----------------------------------------------------------------------------
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	exit 1
 
 ifeq ($(WX_SHARED),0)
@@ -363,23 +384,23 @@
 
 ifeq ($(WX_SHARED),1)
 ..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.dll: make_dir_pdfdoc_dll  $(PDFDOC_DLL_OBJECTS)
-	$(CXX) $(LINK_DLL_FLAGS) -fPIC -o $@ $(PDFDOC_DLL_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH) -Wl,--out-implib=..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\libwxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.a $(LDFLAGS)  $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
+	$(CXX) $(LINK_DLL_FLAGS) -fPIC -o $@ $(PDFDOC_DLL_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH) -L../../msw/builtin/$(WXPERL_STATIC_DIR) -Wl,--out-implib=..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\libwxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.a $(LDFLAGS)  $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
 endif
 
 make_dir_pdfdoc_dll: 
 	if not exist ..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES) mkdir ..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)
 
 ..\samples\minimal\minimal.exe: $(MINIMAL_OBJECTS) $(__COMPONENT_LIB_DEP) gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_minimal_rc.o
-	$(CXX) -o $@ $(MINIMAL_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH)  $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
+	$(CXX) -o $@ $(MINIMAL_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH) -L../../msw/builtin/$(WXPERL_STATIC_DIR)  $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
 
 ..\samples\pdfdc\printing.exe: $(DCSAMPLE_OBJECTS) $(__COMPONENT_LIB_DEP) gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing_rc.o
-	$(CXX) -o $@ $(DCSAMPLE_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH) -Wl,--subsystem,windows -mwindows $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
+	$(CXX) -o $@ $(DCSAMPLE_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH) -L../../msw/builtin/$(WXPERL_STATIC_DIR) -Wl,--subsystem,windows -mwindows $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_RICHTEXT_NAME_p) $(__WXLIB_HTML_NAME_p) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
 
 ..\makefont\makefont.exe: $(MAKEFONT_OBJECTS) $(__COMPONENT_LIB_DEP) gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont_rc.o
-	$(CXX) -o $@ $(MAKEFONT_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH)  $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
+	$(CXX) -o $@ $(MAKEFONT_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH) -L../../msw/builtin/$(WXPERL_STATIC_DIR)  $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
 
 ..\showfont\showfont.exe: $(SHOWFONT_OBJECTS) $(__COMPONENT_LIB_DEP) gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont_rc.o
-	$(CXX) -o $@ $(SHOWFONT_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH)  $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
+	$(CXX) -o $@ $(SHOWFONT_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH) -L../../msw/builtin/$(WXPERL_STATIC_DIR)  $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfannotation.o: ../src/pdfannotation.cpp
 	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
@@ -492,6 +513,9 @@
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.o: ../src/pdfpattern.cpp
 	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
 
+gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.o: ../src/pdfprint.cpp
+	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
+
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.o: ../src/pdfrijndael.cpp
 	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
 
@@ -615,6 +639,9 @@
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.o: ../src/pdfpattern.cpp
 	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
 
+gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.o: ../src/pdfprint.cpp
+	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
+
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.o: ../src/pdfrijndael.cpp
 	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
 
@@ -627,6 +654,9 @@
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfxml.o: ../src/pdfxml.cpp
 	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
 
+gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.o: ../samples/minimal/attachment.cpp
+	$(CXX) -c -o $@ $(MINIMAL_CXXFLAGS) $(CPPDEPS) $<
+	
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.o: ../samples/minimal/barcodes.cpp
 	$(CXX) -c -o $@ $(MINIMAL_CXXFLAGS) $(CPPDEPS) $<
 
@@ -712,25 +742,25 @@
 	$(CXX) -c -o $@ $(MINIMAL_CXXFLAGS) $(CPPDEPS) $<
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_minimal_rc.o: ../samples/minimal/minimal.rc
-	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../samples/minimal
+	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../samples/minimal
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.o: ../samples/pdfdc/printing.cpp
 	$(CXX) -c -o $@ $(DCSAMPLE_CXXFLAGS) $(CPPDEPS) $<
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing_rc.o: ../samples/pdfdc/printing.rc
-	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../samples/pdfdc
+	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../samples/pdfdc
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.o: ../makefont/makefont.cpp
 	$(CXX) -c -o $@ $(MAKEFONT_CXXFLAGS) $(CPPDEPS) $<
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont_rc.o: ../makefont/makefont.rc
-	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../makefont
+	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../makefont
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont.o: ../showfont/showfont.cpp
 	$(CXX) -c -o $@ $(SHOWFONT_CXXFLAGS) $(CPPDEPS) $<
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont_rc.o: ../showfont/showfont.rc
-	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../showfont
+	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../showfont
 
 .PHONY: all clean
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/makefile.vc wxPdfDoc-copy/build/makefile.vc
--- wxpdfdoc-0.9.2.1/build/makefile.vc	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/makefile.vc	2012-05-26 01:10:03.876700000 +0100
@@ -53,7 +53,14 @@
 #   1 - DLL
 SHARED = 0
 
+# Build printing sample with html printout example
+WX_USE_HTML = 1
 
+# Build printing sample with richtext printout example
+WX_USE_RICHTEXT = 1
+
+# use the static libs included
+WXPERL_STATIC_DIR = none
 
 # -------------------------------------------------------------------------
 # Do not modify the rest of this file!
@@ -64,7 +71,7 @@
 COMPILER_PREFIX = vc
 PDFDOC_LIB_CXXFLAGS = /MD$(VAR_18) /DWIN32 $(____WX_SHARED) \
 	$(__WXUNICODE_DEFINE_p) $(__WXDEBUG_DEFINE_p) /D__WXMSW__ \
-	/I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /I$(WX_DIR)\include $(VAR) \
+	/I$(WX_DIR)$(WXLIBPATH) /I$(WX_DIR)\include $(VAR) \
 	$(VAR_15) $(VAR_17) \
 	/Fd..\lib\vc_$(____pdfdoc_lib__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.pdb \
 	/W4 /I..\include /GR /EHsc $(CPPFLAGS) $(CXXFLAGS)
@@ -106,13 +113,14 @@
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfocg.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfparser.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.obj \
+	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdftemplate.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfutility.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfxml.obj
 PDFDOC_DLL_CXXFLAGS = /MD$(VAR_18) /DWIN32 $(____WX_SHARED) \
 	$(__WXUNICODE_DEFINE_p) $(__WXDEBUG_DEFINE_p) /D__WXMSW__ \
-	/I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /I$(WX_DIR)\include $(VAR) \
+	/I$(WX_DIR)$(WXLIBPATH) /I$(WX_DIR)\include $(VAR) \
 	$(VAR_15) $(VAR_17) \
 	/Fd..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.pdb \
 	/W4 /I..\include /DWXMAKINGDLL_PDFDOC /GR /EHsc $(CPPFLAGS) $(CXXFLAGS)
@@ -154,16 +162,18 @@
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfocg.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfparser.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.obj \
+	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdftemplate.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfutility.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfxml.obj
 MINIMAL_CXXFLAGS = /MD$(VAR_18) /DWIN32 $(____WX_SHARED) \
 	$(__WXUNICODE_DEFINE_p) $(__WXDEBUG_DEFINE_p) /D__WXMSW__ \
-	/I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /I$(WX_DIR)\include $(VAR) \
+	/I$(WX_DIR)$(WXLIBPATH) /I$(WX_DIR)\include $(VAR) \
 	$(VAR_15) $(VAR_17) /Fd..\samples\minimal\minimal.pdb /W4 /I..\include \
 	/D_CONSOLE /I..\samples\minimal /GR /EHsc $(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  \
+	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_bookmark.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_charting.obj \
@@ -196,7 +206,7 @@
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_minimal.res
 DCSAMPLE_CXXFLAGS = /MD$(VAR_18) /DWIN32 $(____WX_SHARED) \
 	$(__WXUNICODE_DEFINE_p) $(__WXDEBUG_DEFINE_p) /D__WXMSW__ \
-	/I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /I$(WX_DIR)\include $(VAR) \
+	/I$(WX_DIR)$(WXLIBPATH) /I$(WX_DIR)\include $(VAR) \
 	$(VAR_15) $(VAR_17) /Fd..\samples\pdfdc\printing.pdb /W4 /I..\include \
 	/D_WINDOWS /I..\samples\pdfdc /GR /EHsc $(CPPFLAGS) $(CXXFLAGS)
 DCSAMPLE_OBJECTS =  \
@@ -205,7 +215,7 @@
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res
 MAKEFONT_CXXFLAGS = /MD$(VAR_18) /DWIN32 $(____WX_SHARED) \
 	$(__WXUNICODE_DEFINE_p) $(__WXDEBUG_DEFINE_p) /D__WXMSW__ \
-	/I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /I$(WX_DIR)\include $(VAR) \
+	/I$(WX_DIR)$(WXLIBPATH) /I$(WX_DIR)\include $(VAR) \
 	$(VAR_15) $(VAR_17) /Fd..\makefont\makefont.pdb /W4 /I..\include /D_CONSOLE \
 	/I..\makefont /GR /EHsc $(CPPFLAGS) $(CXXFLAGS)
 MAKEFONT_OBJECTS =  \
@@ -214,7 +224,7 @@
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.res
 SHOWFONT_CXXFLAGS = /MD$(VAR_18) /DWIN32 $(____WX_SHARED) \
 	$(__WXUNICODE_DEFINE_p) $(__WXDEBUG_DEFINE_p) /D__WXMSW__ \
-	/I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /I$(WX_DIR)\include $(VAR) \
+	/I$(WX_DIR)$(WXLIBPATH) /I$(WX_DIR)\include $(VAR) \
 	$(VAR_15) $(VAR_17) /Fd..\showfont\showfont.pdb /W4 /I..\include /D_CONSOLE \
 	/I..\showfont /GR /EHsc $(CPPFLAGS) $(CXXFLAGS)
 SHOWFONT_OBJECTS =  \
@@ -308,6 +318,9 @@
 __WXDEBUG_DEFINE_p_11 = /d __WXDEBUG__
 !endif
 !if "$(WX_DEBUG)" == "0"
+__WXDEBUG_DEFINE_p = /DNDEBUG
+!endif
+!if "$(WX_DEBUG)" == "0"
 VAR = /O2
 !endif
 !if "$(WX_DEBUG)" == "1"
@@ -367,6 +380,16 @@
 __WXLIB_XML_NAME_p = wxbase$(WX_VERSION)$(WXLIBPOSTFIX)_xml.lib
 !endif
 !if "$(WX_MONOLITHIC)" == "0"
+!if "$(WX_USE_RICHTEXT)" == "1"
+__WXLIB_RICHTEXT_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_richtext.lib
+!endif
+!endif
+!if "$(WX_MONOLITHIC)" == "0"
+!if "$(WX_USE_HTML)" == "1"
+__WXLIB_HTML_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_html.lib
+!endif
+!endif
+!if "$(WX_MONOLITHIC)" == "0"
 __WXLIB_CORE_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_core.lib
 !endif
 !if "$(WX_MONOLITHIC)" == "0"
@@ -385,10 +408,10 @@
 WXLIBPOSTFIX = ud
 !endif
 !if "$(WX_SHARED)" == "0"
-WXLIBPATH = \lib\$(COMPILER_PREFIX)_lib
+WXLIBPATH = \lib
 !endif
 !if "$(WX_SHARED)" == "1"
-WXLIBPATH = \lib\$(COMPILER_PREFIX)_dll
+WXLIBPATH = \lib
 !endif
 
 
@@ -423,15 +446,15 @@
 	-if exist ..\showfont\showfont.pdb del ..\showfont\showfont.pdb
 
 test_for_selected_wxbuild: 
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo ----------------------------------------------------------------------------
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo The selected wxWidgets build is not available!
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo Please use the options prefixed with WX_ to select another wxWidgets build.
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo ----------------------------------------------------------------------------
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	exit 1
 
 !if "$(WX_SHARED)" == "0"
@@ -447,7 +470,7 @@
 
 !if "$(WX_SHARED)" == "1"
 ..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.dll: make_dir_pdfdoc_dll  $(PDFDOC_DLL_OBJECTS)
-	link /DLL /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) $(VAR_16) /pdb:"..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.pdb" $(____pdfdoc_dll__DEBUGINFO_21) /LIBPATH:..$(WXLIBPATH) $(LDFLAGS) @<<
+	link /DLL /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) /LIBPATH:..\..\msw\builtin\$(WXPERL_STATIC_DIR) $(VAR_16) /pdb:"..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.pdb" $(____pdfdoc_dll__DEBUGINFO_21) /LIBPATH:..$(WXLIBPATH) $(LDFLAGS) @<<
 	$(PDFDOC_DLL_OBJECTS)   $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /IMPLIB:..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.lib
 <<
 !endif
@@ -456,22 +479,22 @@
 	if not exist ..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES) mkdir ..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)
 
 ..\samples\minimal\minimal.exe: $(MINIMAL_OBJECTS) $(__COMPONENT_LIB_DEP) vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_minimal.res
-	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) $(VAR_16) /pdb:"..\samples\minimal\minimal.pdb" $(____minimal__DEBUGINFO_32) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:CONSOLE $(LDFLAGS) @<<
+	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) /LIBPATH:..\..\msw\builtin\$(WXPERL_STATIC_DIR) $(VAR_16) /pdb:"..\samples\minimal\minimal.pdb" $(____minimal__DEBUGINFO_32) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:CONSOLE $(LDFLAGS) @<<
 	$(MINIMAL_OBJECTS) $(MINIMAL_RESOURCES)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib
 <<
 
 ..\samples\pdfdc\printing.exe: $(DCSAMPLE_OBJECTS) $(__COMPONENT_LIB_DEP) vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res
-	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) $(VAR_16) /pdb:"..\samples\pdfdc\printing.pdb" $(____dcsample__DEBUGINFO_45) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:WINDOWS $(LDFLAGS) @<<
-	$(DCSAMPLE_OBJECTS) $(DCSAMPLE_RESOURCES)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib
+	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) /LIBPATH:..\..\msw\builtin\$(WXPERL_STATIC_DIR) $(VAR_16) /pdb:"..\samples\pdfdc\printing.pdb" $(____dcsample__DEBUGINFO_45) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:WINDOWS $(LDFLAGS) @<<
+	$(DCSAMPLE_OBJECTS) $(DCSAMPLE_RESOURCES)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_RICHTEXT_NAME_p) $(__WXLIB_HTML_NAME_p) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib
 <<
 
 ..\makefont\makefont.exe: $(MAKEFONT_OBJECTS) $(__COMPONENT_LIB_DEP) vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.res
-	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) $(VAR_16) /pdb:"..\makefont\makefont.pdb" $(____makefont__DEBUGINFO_58) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:CONSOLE $(LDFLAGS) @<<
+	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) /LIBPATH:..\..\msw\builtin\$(WXPERL_STATIC_DIR) $(VAR_16) /pdb:"..\makefont\makefont.pdb" $(____makefont__DEBUGINFO_58) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:CONSOLE $(LDFLAGS) @<<
 	$(MAKEFONT_OBJECTS) $(MAKEFONT_RESOURCES)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib
 <<
 
 ..\showfont\showfont.exe: $(SHOWFONT_OBJECTS) $(__COMPONENT_LIB_DEP) vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont.res
-	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) $(VAR_16) /pdb:"..\showfont\showfont.pdb" $(____showfont__DEBUGINFO_71) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:CONSOLE $(LDFLAGS) @<<
+	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) /LIBPATH:..\..\msw\builtin\$(WXPERL_STATIC_DIR) $(VAR_16) /pdb:"..\showfont\showfont.pdb" $(____showfont__DEBUGINFO_71) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:CONSOLE $(LDFLAGS) @<<
 	$(SHOWFONT_OBJECTS) $(SHOWFONT_RESOURCES)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib
 <<
 
@@ -586,6 +609,9 @@
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.obj: ..\src\pdfpattern.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_LIB_CXXFLAGS) ..\src\pdfpattern.cpp
 
+vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.obj: ..\src\pdfprint.cpp
+	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_LIB_CXXFLAGS) ..\src\pdfprint.cpp
+
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.obj: ..\src\pdfrijndael.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_LIB_CXXFLAGS) ..\src\pdfrijndael.cpp
 
@@ -709,6 +735,9 @@
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.obj: ..\src\pdfpattern.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfpattern.cpp
 
+vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.obj: ..\src\pdfprint.cpp
+	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfprint.cpp
+
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.obj: ..\src\pdfrijndael.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfrijndael.cpp
 
@@ -721,6 +750,9 @@
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfxml.obj: ..\src\pdfxml.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfxml.cpp
 
+vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.obj: ..\samples\minimal\attachment.cpp
+	$(CXX) /c /nologo /TP /Fo$@ $(MINIMAL_CXXFLAGS) ..\samples\minimal\attachment.cpp
+
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.obj: ..\samples\minimal\barcodes.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(MINIMAL_CXXFLAGS) ..\samples\minimal\barcodes.cpp
 
@@ -806,23 +838,23 @@
 	$(CXX) /c /nologo /TP /Fo$@ $(MINIMAL_CXXFLAGS) ..\samples\minimal\xmlwrite.cpp
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_minimal.res: ..\samples\minimal\minimal.rc
-	rc /fo$@  /d WIN32 $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /i $(WX_DIR)\include $(p_1) /i ..\include /d _CONSOLE /i ..\samples\minimal ..\samples\minimal\minimal.rc
+	rc /fo$@  /d WIN32 $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH) /i $(WX_DIR)\include $(p_1) /i ..\include /d _CONSOLE /i ..\samples\minimal ..\samples\minimal\minimal.rc
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.obj: ..\samples\pdfdc\printing.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(DCSAMPLE_CXXFLAGS) ..\samples\pdfdc\printing.cpp
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res: ..\samples\pdfdc\printing.rc
-	rc /fo$@  /d WIN32 $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /i $(WX_DIR)\include $(p_1) /i ..\include /d _WINDOWS /i ..\samples\pdfdc ..\samples\pdfdc\printing.rc
+	rc /fo$@  /d WIN32 $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH) /i $(WX_DIR)\include $(p_1) /i ..\include /d _WINDOWS /i ..\samples\pdfdc ..\samples\pdfdc\printing.rc
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.obj: ..\makefont\makefont.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(MAKEFONT_CXXFLAGS) ..\makefont\makefont.cpp
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.res: ..\makefont\makefont.rc
-	rc /fo$@  /d WIN32 $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /i $(WX_DIR)\include $(p_1) /i ..\include /d _CONSOLE /i ..\makefont ..\makefont\makefont.rc
+	rc /fo$@  /d WIN32 $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH) /i $(WX_DIR)\include $(p_1) /i ..\include /d _CONSOLE /i ..\makefont ..\makefont\makefont.rc
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont.obj: ..\showfont\showfont.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(SHOWFONT_CXXFLAGS) ..\showfont\showfont.cpp
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont.res: ..\showfont\showfont.rc
-	rc /fo$@  /d WIN32 $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /i $(WX_DIR)\include $(p_1) /i ..\include /d _CONSOLE /i ..\showfont ..\showfont\showfont.rc
+	rc /fo$@  /d WIN32 $(____WX_SHARED_2) $(__WXUNICODE_DEFINE_p_11) $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH) /i $(WX_DIR)\include $(p_1) /i ..\include /d _CONSOLE /i ..\showfont ..\showfont\showfont.rc
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/makefile.wat wxPdfDoc-copy/build/makefile.wat
--- wxpdfdoc-0.9.2.1/build/makefile.wat	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/makefile.wat	2012-05-26 17:57:54.206900000 +0100
@@ -1,6 +1,6 @@
 # =========================================================================
 #     This makefile was generated by
-#     Bakefile 0.2.8 (http://www.bakefile.org)
+#     Bakefile 0.2.9 (http://www.bakefile.org)
 #     Do not modify, all changes will be overwritten!
 # =========================================================================
 
@@ -101,6 +101,18 @@
 __pdfdoc_dll___depname = &
 	..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.dll
 !endif
+__WXLIB_ADV_NAME_p =
+!ifeq WX_MONOLITHIC 0
+__WXLIB_ADV_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_adv.lib
+!endif
+__WXLIB_HTML_NAME_p =
+!ifeq WX_MONOLITHIC 0
+__WXLIB_HTML_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_html.lib
+!endif
+__WXLIB_RICHTEXT_NAME_p =
+!ifeq WX_MONOLITHIC 0
+__WXLIB_RICHTEXT_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_richtext.lib
+!endif
 ____pdfdoc_lib__DIRNAME_SHARED_SUFFIX_FILENAMES =
 !ifeq SHARED 0
 ____pdfdoc_lib__DIRNAME_SHARED_SUFFIX_FILENAMES = lib
@@ -251,6 +263,7 @@
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfocg.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfparser.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.obj &
+	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdftemplate.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfutility.obj &
@@ -297,6 +310,7 @@
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfocg.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfparser.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.obj &
+	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdftemplate.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfutility.obj &
@@ -306,6 +320,7 @@
 	-i=$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -i=$(WX_DIR)\include $(VAR) &
 	$(VAR_6) -wx -i=..\include -i=..\samples\minimal $(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  &
+	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_bookmark.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_charting.obj &
@@ -435,7 +450,7 @@
 	@%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc option caseexact
 	@%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc  libpath $(WX_DIR)$(WXLIBPATH) $(VAR_7) libpath ..$(WXLIBPATH) system nt_win ref '_WinMain@16' $(LDFLAGS)
 	@for %i in ($(DCSAMPLE_OBJECTS)) do @%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc file %i
-	@for %i in ( $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib) do @%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc library %i
+	@for %i in ( $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) $(__WXLIB_ADV_NAME_p) $(__WXLIB_HTML_NAME_p) $(__WXLIB_RICHTEXT_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib) do @%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc library %i
 	@%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc option resource=watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res
 	@for %i in () do @%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc option stack=%i
 	wlink @watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc
@@ -575,6 +590,9 @@
 watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.obj :  .AUTODEPEND ..\src\pdfpattern.cpp
 	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_LIB_CXXFLAGS) $<
 
+watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.obj :  .AUTODEPEND ..\src\pdfprint.cpp
+	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_LIB_CXXFLAGS) $<
+
 watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.obj :  .AUTODEPEND ..\src\pdfrijndael.cpp
 	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_LIB_CXXFLAGS) $<
 
@@ -698,6 +716,9 @@
 watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.obj :  .AUTODEPEND ..\src\pdfpattern.cpp
 	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_DLL_CXXFLAGS) $<
 
+watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.obj :  .AUTODEPEND ..\src\pdfprint.cpp
+	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_DLL_CXXFLAGS) $<
+
 watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.obj :  .AUTODEPEND ..\src\pdfrijndael.cpp
 	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_DLL_CXXFLAGS) $<
 
@@ -710,6 +731,9 @@
 watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfxml.obj :  .AUTODEPEND ..\src\pdfxml.cpp
 	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_DLL_CXXFLAGS) $<
 
+watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.obj :  .AUTODEPEND ..\samples\minimal\attachment.cpp
+	$(CXX) -bt=nt -zq -fo=$^@ $(MINIMAL_CXXFLAGS) $<
+
 watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.obj :  .AUTODEPEND ..\samples\minimal\barcodes.cpp
 	$(CXX) -bt=nt -zq -fo=$^@ $(MINIMAL_CXXFLAGS) $<
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc.bkl wxPdfDoc-copy/build/wxpdfdoc.bkl
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc.bkl	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc.bkl	2012-05-26 17:57:54.222500000 +0100
@@ -78,6 +78,9 @@
 
   <template id="gui_app" template="generic_app">
     <app-type>gui</app-type>
+    <wx-lib>adv</wx-lib>
+    <wx-lib>html</wx-lib>
+    <wx-lib>richtext</wx-lib>
   </template>
 
   <!-- The samples of the component: as for the LIB target, this exe derives from a 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc6_dcsample.dsp wxPdfDoc-copy/build/wxpdfdoc_vc6_dcsample.dsp
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc6_dcsample.dsp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc6_dcsample.dsp	2012-05-26 17:57:54.222500000 +0100
@@ -131,8 +131,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 DLL Unicode Debug Multilib Static"
 
@@ -156,8 +156,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 DLL Unicode Release Monolithic DLL"
 
@@ -231,8 +231,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 DLL Unicode Release Multilib Static"
 
@@ -256,8 +256,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 DLL ANSI Debug Monolithic DLL"
 
@@ -331,8 +331,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 DLL ANSI Debug Multilib Static"
 
@@ -356,8 +356,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 DLL ANSI Release Monolithic DLL"
 
@@ -431,8 +431,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 DLL ANSI Release Multilib Static"
 
@@ -456,8 +456,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 Static Unicode Debug Monolithic DLL"
 
@@ -531,8 +531,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 Static Unicode Debug Multilib Static"
 
@@ -556,8 +556,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 Static Unicode Release Monolithic DLL"
 
@@ -631,8 +631,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 Static Unicode Release Multilib Static"
 
@@ -656,8 +656,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 Static ANSI Debug Monolithic DLL"
 
@@ -731,8 +731,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 Static ANSI Debug Multilib Static"
 
@@ -756,8 +756,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 Static ANSI Release Monolithic DLL"
 
@@ -831,8 +831,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 Static ANSI Release Multilib Static"
 
@@ -856,8 +856,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ENDIF
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc6_minimal.dsp wxPdfDoc-copy/build/wxpdfdoc_vc6_minimal.dsp
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc6_minimal.dsp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc6_minimal.dsp	2012-05-22 01:03:37.628400000 +0100
@@ -835,6 +835,10 @@
 # PROP Default_Filter ""
 # Begin Source File
 
+SOURCE=..\samples\minimal\attachment.cpp
+# End Source File
+# Begin Source File
+
 SOURCE=..\samples\minimal\barcodes.cpp
 # End Source File
 # Begin Source File
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc6_pdfdoc.dsp wxPdfDoc-copy/build/wxpdfdoc_vc6_pdfdoc.dsp
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc6_pdfdoc.dsp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc6_pdfdoc.dsp	2012-05-22 01:03:26.434000000 +0100
@@ -1016,6 +1016,10 @@
 # End Source File
 # Begin Source File
 
+SOURCE=..\src\pdfprint.cpp
+# End Source File
+# Begin Source File
+
 SOURCE=..\src\pdfrijndael.cpp
 # End Source File
 # Begin Source File
@@ -1228,6 +1232,10 @@
 # End Source File
 # Begin Source File
 
+SOURCE=..\include\wx\pdfprint.h
+# End Source File
+# Begin Source File
+
 SOURCE=..\include\wx\pdfproperties.h
 # End Source File
 # Begin Source File
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc7_dcsample.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc7_dcsample.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc7_dcsample.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc7_dcsample.vcproj	2012-05-26 17:57:54.206900000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
@@ -42,7 +42,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="TRUE"
@@ -102,7 +102,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="TRUE"
@@ -285,7 +285,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="TRUE"
@@ -349,7 +349,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="TRUE"
@@ -539,7 +539,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="TRUE"
@@ -600,7 +600,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="TRUE"
@@ -786,7 +786,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="TRUE"
@@ -851,7 +851,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="TRUE"
@@ -1042,7 +1042,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="TRUE"
@@ -1102,7 +1102,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="TRUE"
@@ -1285,7 +1285,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="TRUE"
@@ -1349,7 +1349,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="TRUE"
@@ -1539,7 +1539,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="TRUE"
@@ -1600,7 +1600,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="TRUE"
@@ -1786,7 +1786,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="TRUE"
@@ -1851,7 +1851,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="TRUE"
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc7_makefont.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc7_makefont.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc7_makefont.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc7_makefont.vcproj	2012-05-22 01:03:25.139400000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc7_minimal.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc7_minimal.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc7_minimal.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc7_minimal.vcproj	2012-05-22 01:03:37.641400000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
@@ -2026,6 +2026,9 @@
 			Filter="cpp;c;cc;cxx;def;odl;idl;hpj;bat;asm;asmx"
 			UniqueIdentifier="{4FC737F1-C7A5-4376-A066-2A32D752A2FF}">
 			<File
+				RelativePath="..\samples\minimal\attachment.cpp">
+			</File>
+			<File
 				RelativePath="..\samples\minimal\barcodes.cpp">
 			</File>
 			<File
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc7_pdfdoc.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc7_pdfdoc.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc7_pdfdoc.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc7_pdfdoc.vcproj	2012-05-22 01:03:26.893000000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
@@ -2017,6 +2017,9 @@
 				RelativePath="..\src\pdfpattern.cpp">
 			</File>
 			<File
+				RelativePath="..\src\pdfprint.cpp">
+			</File>
+			<File
 				RelativePath="..\src\pdfrijndael.cpp">
 			</File>
 			<File
@@ -2205,6 +2208,9 @@
 				RelativePath="..\include\wx\pdfpattern.h">
 			</File>
 			<File
+				RelativePath="..\include\wx\pdfprint.h">
+			</File>
+			<File
 				RelativePath="..\include\wx\pdfproperties.h">
 			</File>
 			<File
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc7_showfont.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc7_showfont.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc7_showfont.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc7_showfont.vcproj	2012-05-22 01:03:25.798400000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc8_dcsample.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc8_dcsample.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc8_dcsample.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc8_dcsample.vcproj	2012-05-26 17:57:54.206900000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
@@ -76,7 +76,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -168,7 +168,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -447,7 +447,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -543,7 +543,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -829,7 +829,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -922,7 +922,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -1204,7 +1204,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -1301,7 +1301,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -1588,7 +1588,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -1680,7 +1680,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -1959,7 +1959,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -2055,7 +2055,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -2341,7 +2341,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -2434,7 +2434,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -2716,7 +2716,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -2813,7 +2813,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc8_makefont.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc8_makefont.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc8_makefont.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc8_makefont.vcproj	2012-05-22 01:03:25.367400000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc8_minimal.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc8_minimal.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc8_minimal.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc8_minimal.vcproj	2012-05-22 01:03:37.571400000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
@@ -3056,6 +3056,10 @@
 			UniqueIdentifier="{4FC737F1-C7A5-4376-A066-2A32D752A2FF}"
 			>
 			<File
+				RelativePath="..\samples\minimal\attachment.cpp"
+				>
+			</File>
+			<File
 				RelativePath="..\samples\minimal\barcodes.cpp"
 				>
 			</File>
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc8_pdfdoc.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc8_pdfdoc.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc8_pdfdoc.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc8_pdfdoc.vcproj	2012-05-22 01:03:22.725200000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
@@ -2876,6 +2876,10 @@
 				>
 			</File>
 			<File
+				RelativePath="..\src\pdfprint.cpp"
+				>
+			</File>
+			<File
 				RelativePath="..\src\pdfrijndael.cpp"
 				>
 			</File>
@@ -3126,6 +3130,10 @@
 				>
 			</File>
 			<File
+				RelativePath="..\include\wx\pdfprint.h"
+				>
+			</File>
+			<File
 				RelativePath="..\include\wx\pdfproperties.h"
 				>
 			</File>
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc8_showfont.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc8_showfont.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc8_showfont.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc8_showfont.vcproj	2012-05-22 01:03:26.079200000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc9_dcsample.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc9_dcsample.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc9_dcsample.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc9_dcsample.vcproj	2012-05-26 17:57:54.206900000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
@@ -76,7 +76,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -165,7 +165,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -434,7 +434,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -526,7 +526,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -801,7 +801,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -891,7 +891,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -1163,7 +1163,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -1256,7 +1256,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -1532,7 +1532,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -1621,7 +1621,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28_pdfdoc.lib wxbase28_xml.lib wxmsw28_core.lib wxbase28.lib wxmsw28_adv.lib wxmsw28_html.lib wxmsw28_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregex.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -1890,7 +1890,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -1982,7 +1982,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28d_pdfdoc.lib wxbase28d_xml.lib wxmsw28d_core.lib wxbase28d.lib wxmsw28d_adv.lib wxmsw28d_html.lib wxmsw28d_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexd.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -2257,7 +2257,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -2347,7 +2347,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28u_pdfdoc.lib wxbase28u_xml.lib wxmsw28u_core.lib wxbase28u.lib wxmsw28u_adv.lib wxmsw28u_html.lib wxmsw28u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -2619,7 +2619,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -2712,7 +2712,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw28ud_pdfdoc.lib wxbase28ud_xml.lib wxmsw28ud_core.lib wxbase28ud.lib wxmsw28ud_adv.lib wxmsw28ud_html.lib wxmsw28ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc9_makefont.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc9_makefont.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc9_makefont.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc9_makefont.vcproj	2012-05-22 01:03:25.484400000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc9_minimal.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc9_minimal.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc9_minimal.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc9_minimal.vcproj	2012-05-22 01:03:37.644400000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
@@ -2944,6 +2944,10 @@
 			UniqueIdentifier="{4FC737F1-C7A5-4376-A066-2A32D752A2FF}"
 			>
 			<File
+				RelativePath="..\samples\minimal\attachment.cpp"
+				>
+			</File>
+			<File
 				RelativePath="..\samples\minimal\barcodes.cpp"
 				>
 			</File>
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc9_pdfdoc.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc9_pdfdoc.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc9_pdfdoc.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc9_pdfdoc.vcproj	2012-05-22 01:03:22.916200000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
@@ -2860,6 +2860,10 @@
 				>
 			</File>
 			<File
+				RelativePath="..\src\pdfprint.cpp"
+				>
+			</File>
+			<File
 				RelativePath="..\src\pdfrijndael.cpp"
 				>
 			</File>
@@ -3110,6 +3114,10 @@
 				>
 			</File>
 			<File
+				RelativePath="..\include\wx\pdfprint.h"
+				>
+			</File>
+			<File
 				RelativePath="..\include\wx\pdfproperties.h"
 				>
 			</File>
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc9_showfont.vcproj wxPdfDoc-copy/build/wxpdfdoc_vc9_showfont.vcproj
--- wxpdfdoc-0.9.2.1/build/wxpdfdoc_vc9_showfont.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build/wxpdfdoc_vc9_showfont.vcproj	2012-05-22 01:03:26.293000000 +0100
@@ -2,7 +2,7 @@
 <!--
 
   This project was generated by
-  Bakefile 0.2.8 (http://www.bakefile.org)
+  Bakefile 0.2.9 (http://www.bakefile.org)
   Do not modify, all changes will be overwritten!
 
 -->
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/configure.ac wxPdfDoc-copy/build29/configure.ac
--- wxpdfdoc-0.9.2.1/build29/configure.ac	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/configure.ac	2012-05-26 17:57:54.877700000 +0100
@@ -10,7 +10,7 @@
 
 # Init this configure script with basic info about the component
 # (DON'T PUT ANYTHING BEFORE AC_INIT, JUST COMMENTS)
-AC_INIT([wxpdfdoc], [0.9.1], [utelle@users.sourceforge.net])
+AC_INIT([wxpdfdoc], [0.9.3], [utelle@users.sourceforge.net])
 AC_CONFIG_AUX_DIR(build)
 
 # ENABLES/DISABLES THE DEBUG MODE FOR THIS CONFIGURE SCRIPT
@@ -44,7 +44,7 @@
 # argument 1: here put the minimum required version of wx
 # argument 2: here you must put a comma-separed list of all wx required libraries 
 #             except for base,core (e.g. "xml,net,adv"); leave empty if you use only core & base
-WXCODE_CHECKS([2.8.0], [core,base,xml])      # we need at least wxWidgets 2.8 to work
+WXCODE_CHECKS([2.8.0], [core,base,xml,adv,html,richtext])      # we need at least wxWidgets 2.8 to work
 
 # end in a nice way the configure script
 WXCODE_END
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/GNUmakefile wxPdfDoc-copy/build29/GNUmakefile
--- wxpdfdoc-0.9.2.1/build29/GNUmakefile	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/GNUmakefile	2012-05-22 01:03:37.862400000 +0100
@@ -115,6 +115,7 @@
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfocg.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfparser.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfpattern.o \
+	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfprint.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfrijndael.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdftemplate.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfutility.o \
@@ -168,6 +169,7 @@
 	include/wx/pdfobjects.h \
 	include/wx/pdfparser.h \
 	include/wx/pdfpattern.h \
+	include/wx/pdfprint.h \
 	include/wx/pdfproperties.h \
 	include/wx/pdfrijndael.h \
 	include/wx/pdfshape.h \
@@ -225,6 +227,7 @@
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfocg.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfparser.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfpattern.o \
+	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfprint.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfrijndael.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdftemplate.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfutility.o \
@@ -278,6 +281,7 @@
 	include/wx/pdfobjects.h \
 	include/wx/pdfparser.h \
 	include/wx/pdfpattern.h \
+	include/wx/pdfprint.h \
 	include/wx/pdfproperties.h \
 	include/wx/pdfrijndael.h \
 	include/wx/pdfshape.h \
@@ -297,6 +301,7 @@
 MINIMAL_CXXFLAGS = $(VAR) $(VAR_7) -W -Wall -I../include -I../samples/minimal \
 	`$(WX_CONFIG) --cxxflags $(WX_CONFIG_FLAGS)` $(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  \
+	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/minimal_attachment.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/minimal_barcodes.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/minimal_bookmark.o \
 	gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/minimal_charting.o \
@@ -657,6 +662,9 @@
 gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfpattern.o: ../src/pdfpattern.cpp
 	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
 
+gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfprint.o: ../src/pdfprint.cpp
+	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
+
 gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_lib_pdfrijndael.o: ../src/pdfrijndael.cpp
 	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
 
@@ -780,6 +788,9 @@
 gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfpattern.o: ../src/pdfpattern.cpp
 	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
 
+gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfprint.o: ../src/pdfprint.cpp
+	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
+
 gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfrijndael.o: ../src/pdfrijndael.cpp
 	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
 
@@ -792,6 +803,9 @@
 gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/pdfdoc_dll_pdfxml.o: ../src/pdfxml.cpp
 	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
 
+gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/minimal_attachment.o: ../samples/minimal/attachment.cpp
+	$(CXX) -c -o $@ $(MINIMAL_CXXFLAGS) $(CPPDEPS) $<
+
 gcc$(WX_PORT)$(_BUILDDIR_SHARED_SUFFIX)/minimal_barcodes.o: ../samples/minimal/barcodes.cpp
 	$(CXX) -c -o $@ $(MINIMAL_CXXFLAGS) $(CPPDEPS) $<
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/makefile.bcc wxPdfDoc-copy/build29/makefile.bcc
--- wxpdfdoc-0.9.2.1/build29/makefile.bcc	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/makefile.bcc	2012-05-26 17:57:54.908900000 +0100
@@ -120,6 +120,7 @@
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfocg.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfparser.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.obj \
+	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdftemplate.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfutility.obj \
@@ -166,6 +167,7 @@
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfocg.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfparser.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.obj \
+	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdftemplate.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfutility.obj \
@@ -175,6 +177,7 @@
 	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -I..\include -I..\samples\minimal $(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  \
+	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_bookmark.obj \
 	bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_charting.obj \
@@ -241,6 +244,15 @@
 __pdfdoc_dll___depname = \
 	..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.dll
 !endif
+!if "$(WX_MONOLITHIC)" == "0"
+__WXLIB_ADV_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_adv.lib
+!endif
+!if "$(WX_MONOLITHIC)" == "0"
+__WXLIB_HTML_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_html.lib
+!endif
+!if "$(WX_MONOLITHIC)" == "0"
+__WXLIB_RICHTEXT_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_richtext.lib
+!endif
 !if "$(SHARED)" == "0"
 ____pdfdoc_lib__DIRNAME_SHARED_SUFFIX_FILENAMES = lib
 !endif
@@ -409,7 +421,7 @@
 
 ..\samples\pdfdc\printing.exe: $(DCSAMPLE_OBJECTS) $(__COMPONENT_LIB_DEP)  bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res
 	ilink32 -Tpe -q  -L$(BCCDIR)\lib -L$(BCCDIR)\lib\psdk -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH) -aa $(LDFLAGS) @&&|
-	c0w32.obj $(DCSAMPLE_OBJECTS),$@,, $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib ole2w32.lib oleacc.lib import32.lib cw32.lib,, bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res
+	c0w32.obj $(DCSAMPLE_OBJECTS),$@,, $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) $(__WXLIB_ADV_NAME_p) $(__WXLIB_HTML_NAME_p) $(__WXLIB_RICHTEXT_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib ole2w32.lib oleacc.lib import32.lib cw32.lib,, bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res
 |
 
 ..\makefont\makefont.exe: $(MAKEFONT_OBJECTS) $(__COMPONENT_LIB_DEP)  bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.res
@@ -533,6 +545,9 @@
 bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.obj: ..\src\pdfpattern.cpp
 	$(CXX) -q -c -P -o$@ $(PDFDOC_LIB_CXXFLAGS) ..\src\pdfpattern.cpp
 
+bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.obj: ..\src\pdfprint.cpp
+	$(CXX) -q -c -P -o$@ $(PDFDOC_LIB_CXXFLAGS) ..\src\pdfprint.cpp
+
 bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.obj: ..\src\pdfrijndael.cpp
 	$(CXX) -q -c -P -o$@ $(PDFDOC_LIB_CXXFLAGS) ..\src\pdfrijndael.cpp
 
@@ -656,6 +671,9 @@
 bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.obj: ..\src\pdfpattern.cpp
 	$(CXX) -q -c -P -o$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfpattern.cpp
 
+bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.obj: ..\src\pdfprint.cpp
+	$(CXX) -q -c -P -o$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfprint.cpp
+
 bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.obj: ..\src\pdfrijndael.cpp
 	$(CXX) -q -c -P -o$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfrijndael.cpp
 
@@ -668,6 +686,9 @@
 bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfxml.obj: ..\src\pdfxml.cpp
 	$(CXX) -q -c -P -o$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfxml.cpp
 
+bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.obj: ..\samples\minimal\attachment.cpp
+	$(CXX) -q -c -P -o$@ $(MINIMAL_CXXFLAGS) ..\samples\minimal\attachment.cpp
+
 bccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.obj: ..\samples\minimal\barcodes.cpp
 	$(CXX) -q -c -P -o$@ $(MINIMAL_CXXFLAGS) ..\samples\minimal\barcodes.cpp
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/makefile.gcc wxPdfDoc-copy/build29/makefile.gcc
--- wxpdfdoc-0.9.2.1/build29/makefile.gcc	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/makefile.gcc	2012-05-26 01:10:04.157500000 +0100
@@ -40,10 +40,17 @@
 # The directory where wxWidgets library is installed 
 WX_DIR ?= $(WXWIN)
 
+# Build printing sample with html printout example
+WX_USE_HTML ?= 1
+
+# Build printing sample with richtext printout example
+WX_USE_RICHTEXT ?= 1
+
 # Build this wxCode component as DLL or as static library? [0,1]
 SHARED ?= 0
 
-
+# use the static libs included
+WXPERL_STATIC_DIR ?=none
 
 # -------------------------------------------------------------------------
 # Do not modify the rest of this file!
@@ -55,7 +62,7 @@
 COMPILER_PREFIX = gcc
 PDFDOC_LIB_CXXFLAGS = -DHAVE_W32API_H $(____WX_SHARED) -D_UNICODE \
 	$(__WXDEBUG_DEFINE_p) -D__WXMSW__ \
-	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
+	-I$(WX_DIR)$(WXLIBPATH) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -W -Wall -I..\include $(CPPFLAGS) $(CXXFLAGS)
 PDFDOC_LIB_OBJECTS =  \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfannotation.o \
@@ -95,13 +102,14 @@
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfocg.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfparser.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.o \
+	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdftemplate.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfutility.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfxml.o
 PDFDOC_DLL_CXXFLAGS = -DHAVE_W32API_H $(____WX_SHARED) -D_UNICODE \
 	$(__WXDEBUG_DEFINE_p) -D__WXMSW__ \
-	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
+	-I$(WX_DIR)$(WXLIBPATH) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -W -Wall -I..\include -DWXMAKINGDLL_PDFDOC $(CPPFLAGS) $(CXXFLAGS)
 PDFDOC_DLL_OBJECTS =  \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfannotation.o \
@@ -141,15 +149,17 @@
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfocg.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfparser.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.o \
+	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdftemplate.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfutility.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfxml.o
 MINIMAL_CXXFLAGS = -DHAVE_W32API_H $(____WX_SHARED) -D_UNICODE \
 	$(__WXDEBUG_DEFINE_p) -D__WXMSW__ \
-	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
+	-I$(WX_DIR)$(WXLIBPATH) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -W -Wall -I..\include -I..\samples\minimal $(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  \
+	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_bookmark.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_charting.o \
@@ -181,21 +191,21 @@
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_minimal_rc.o
 DCSAMPLE_CXXFLAGS = -DHAVE_W32API_H $(____WX_SHARED) -D_UNICODE \
 	$(__WXDEBUG_DEFINE_p) -D__WXMSW__ \
-	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
+	-I$(WX_DIR)$(WXLIBPATH) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -W -Wall -I..\include -I..\samples\pdfdc $(CPPFLAGS) $(CXXFLAGS)
 DCSAMPLE_OBJECTS =  \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing_rc.o
 MAKEFONT_CXXFLAGS = -DHAVE_W32API_H $(____WX_SHARED) -D_UNICODE \
 	$(__WXDEBUG_DEFINE_p) -D__WXMSW__ \
-	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
+	-I$(WX_DIR)$(WXLIBPATH) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -W -Wall -I..\include -I..\makefont $(CPPFLAGS) $(CXXFLAGS)
 MAKEFONT_OBJECTS =  \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.o \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont_rc.o
 SHOWFONT_CXXFLAGS = -DHAVE_W32API_H $(____WX_SHARED) -D_UNICODE \
 	$(__WXDEBUG_DEFINE_p) -D__WXMSW__ \
-	-I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) -I$(WX_DIR)\include $(VAR) \
+	-I$(WX_DIR)$(WXLIBPATH) -I$(WX_DIR)\include $(VAR) \
 	$(VAR_7) -W -Wall -I..\include -I..\showfont $(CPPFLAGS) $(CXXFLAGS)
 SHOWFONT_OBJECTS =  \
 	gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont.o \
@@ -251,6 +261,9 @@
 __WXDEBUG_DEFINE_p_11 = --define __WXDEBUG__
 endif
 ifeq ($(WX_DEBUG),0)
+__WXDEBUG_DEFINE_p = -DwxDEBUG_LEVEL=0 -DNDEBUG
+endif
+ifeq ($(WX_DEBUG),0)
 WXLIBPOSTFIX = u
 endif
 ifeq ($(WX_DEBUG),1)
@@ -280,6 +293,16 @@
 __WXLIB_XML_NAME_p = -lwxbase$(WX_VERSION)$(WXLIBPOSTFIX)_xml
 endif
 ifeq ($(WX_MONOLITHIC),0)
+ifeq ($(WX_USE_RICHTEXT),1)
+__WXLIB_RICHTEXT_NAME_p = -lwxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_richtext
+endif
+endif
+ifeq ($(WX_MONOLITHIC),0)
+ifeq ($(WX_USE_HTML),1)
+__WXLIB_HTML_NAME_p = -lwxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_html
+endif
+endif
+ifeq ($(WX_MONOLITHIC),0)
 __WXLIB_CORE_NAME_p = -lwxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_core
 endif
 ifeq ($(WX_MONOLITHIC),0)
@@ -289,10 +312,10 @@
 __WXLIB_BASE_NAME_p = -lwxmsw$(WX_VERSION)$(WXLIBPOSTFIX)
 endif
 ifeq ($(WX_SHARED),0)
-WXLIBPATH = \lib\$(COMPILER_PREFIX)_lib
+WXLIBPATH = \lib
 endif
 ifeq ($(WX_SHARED),1)
-WXLIBPATH = \lib\$(COMPILER_PREFIX)_dll
+WXLIBPATH = \lib
 endif
 ifeq ($(WX_DEBUG),0)
 VAR_7 = 
@@ -322,15 +345,15 @@
 	-if exist ..\showfont\showfont.exe del ..\showfont\showfont.exe
 
 test_for_selected_wxbuild: 
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo ----------------------------------------------------------------------------
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo The selected wxWidgets build is not available!
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo Please use the options prefixed with WX_ to select another wxWidgets build.
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo ----------------------------------------------------------------------------
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	exit 1
 
 ifeq ($(WX_SHARED),0)
@@ -345,23 +368,23 @@
 
 ifeq ($(WX_SHARED),1)
 ..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.dll: make_dir_pdfdoc_dll  $(PDFDOC_DLL_OBJECTS)
-	$(CXX) $(LINK_DLL_FLAGS) -fPIC -o $@ $(PDFDOC_DLL_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH) -Wl,--out-implib=..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\libwxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.a $(LDFLAGS)  $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
+	$(CXX) $(LINK_DLL_FLAGS) -fPIC -o $@ $(PDFDOC_DLL_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) -L../../msw/builtin/$(WXPERL_STATIC_DIR) $(VAR_7) -L..$(WXLIBPATH) -Wl,--out-implib=..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\libwxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.a $(LDFLAGS)  $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
 endif
 
 make_dir_pdfdoc_dll: 
 	if not exist ..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES) mkdir ..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)
 
 ..\samples\minimal\minimal.exe: $(MINIMAL_OBJECTS) $(__COMPONENT_LIB_DEP) gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_minimal_rc.o
-	$(CXX) -o $@ $(MINIMAL_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH)  $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
+	$(CXX) -o $@ $(MINIMAL_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) -L../../msw/builtin/$(WXPERL_STATIC_DIR) $(VAR_7) -L..$(WXLIBPATH)  $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
 
 ..\samples\pdfdc\printing.exe: $(DCSAMPLE_OBJECTS) $(__COMPONENT_LIB_DEP) gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing_rc.o
-	$(CXX) -o $@ $(DCSAMPLE_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH) -Wl,--subsystem,windows -mwindows $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
+	$(CXX) -o $@ $(DCSAMPLE_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) -L../../msw/builtin/$(WXPERL_STATIC_DIR) $(VAR_7) -L..$(WXLIBPATH) -Wl,--subsystem,windows -mwindows $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_RICHTEXT_NAME_p) $(__WXLIB_HTML_NAME_p) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
 
 ..\makefont\makefont.exe: $(MAKEFONT_OBJECTS) $(__COMPONENT_LIB_DEP) gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont_rc.o
-	$(CXX) -o $@ $(MAKEFONT_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH)  $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
+	$(CXX) -o $@ $(MAKEFONT_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) -L../../msw/builtin/$(WXPERL_STATIC_DIR) $(VAR_7) -L..$(WXLIBPATH)  $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
 
 ..\showfont\showfont.exe: $(SHOWFONT_OBJECTS) $(__COMPONENT_LIB_DEP) gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont_rc.o
-	$(CXX) -o $@ $(SHOWFONT_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) $(VAR_7) -L..$(WXLIBPATH)  $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
+	$(CXX) -o $@ $(SHOWFONT_OBJECTS)  -mthreads -L$(WX_DIR)$(WXLIBPATH) -L../../msw/builtin/$(WXPERL_STATIC_DIR) $(VAR_7) -L..$(WXLIBPATH)  $(LDFLAGS)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) -lwxtiff$(WX3RDPARTYLIBPOSTFIX) -lwxjpeg$(WX3RDPARTYLIBPOSTFIX) -lwxpng$(WX3RDPARTYLIBPOSTFIX) -lwxzlib$(WX3RDPARTYLIBPOSTFIX) -lwxregex$(WXLIBPOSTFIX) -lwxexpat$(WX3RDPARTYLIBPOSTFIX) -lkernel32 -luser32 -lgdi32 -lcomdlg32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lole32 -loleaut32 -luuid -lrpcrt4 -ladvapi32 -lwsock32
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfannotation.o: ../src/pdfannotation.cpp
 	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
@@ -474,6 +497,9 @@
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.o: ../src/pdfpattern.cpp
 	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
 
+gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.o: ../src/pdfprint.cpp
+	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
+
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.o: ../src/pdfrijndael.cpp
 	$(CXX) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(CPPDEPS) $<
 
@@ -597,6 +623,9 @@
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.o: ../src/pdfpattern.cpp
 	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
 
+gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.o: ../src/pdfprint.cpp
+	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
+
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.o: ../src/pdfrijndael.cpp
 	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
 
@@ -609,6 +638,9 @@
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfxml.o: ../src/pdfxml.cpp
 	$(CXX) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(CPPDEPS) $<
 
+gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.o: ../samples/minimal/attachment.cpp
+	$(CXX) -c -o $@ $(MINIMAL_CXXFLAGS) $(CPPDEPS) $<
+
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.o: ../samples/minimal/barcodes.cpp
 	$(CXX) -c -o $@ $(MINIMAL_CXXFLAGS) $(CPPDEPS) $<
 
@@ -694,25 +726,25 @@
 	$(CXX) -c -o $@ $(MINIMAL_CXXFLAGS) $(CPPDEPS) $<
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_minimal_rc.o: ../samples/minimal/minimal.rc
-	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) --define _UNICODE $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../samples/minimal
+	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) --define _UNICODE $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../samples/minimal
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.o: ../samples/pdfdc/printing.cpp
 	$(CXX) -c -o $@ $(DCSAMPLE_CXXFLAGS) $(CPPDEPS) $<
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing_rc.o: ../samples/pdfdc/printing.rc
-	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) --define _UNICODE $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../samples/pdfdc
+	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) --define _UNICODE $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../samples/pdfdc
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.o: ../makefont/makefont.cpp
 	$(CXX) -c -o $@ $(MAKEFONT_CXXFLAGS) $(CPPDEPS) $<
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont_rc.o: ../makefont/makefont.rc
-	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) --define _UNICODE $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../makefont
+	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) --define _UNICODE $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../makefont
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont.o: ../showfont/showfont.cpp
 	$(CXX) -c -o $@ $(SHOWFONT_CXXFLAGS) $(CPPDEPS) $<
 
 gccmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont_rc.o: ../showfont/showfont.rc
-	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) --define _UNICODE $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../showfont
+	windres --use-temp-file -i$< -o$@  --define HAVE_W32API_H $(____WX_SHARED_2) --define _UNICODE $(__WXDEBUG_DEFINE_p_11) --define __WXMSW__ --include-dir $(WX_DIR)$(WXLIBPATH) --include-dir $(WX_DIR)/include --include-dir ../include --include-dir ../showfont
 
 .PHONY: all clean
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/makefile.vc wxPdfDoc-copy/build29/makefile.vc
--- wxpdfdoc-0.9.2.1/build29/makefile.vc	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/makefile.vc	2012-05-26 01:10:04.188700000 +0100
@@ -43,11 +43,19 @@
 # The directory where wxWidgets library is installed 
 WX_DIR = $(WXWIN)
 
+# Build printing sample with html printout example
+WX_USE_HTML = 1
+
+# Build printing sample with richtext printout example
+WX_USE_RICHTEXT = 1
+
 # Build this wxCode component as DLL or as static library? [0,1]
 #   0 - Static
 #   1 - DLL
 SHARED = 0
 
+# use the static libs included
+WXPERL_STATIC_DIR = none
 
 
 # -------------------------------------------------------------------------
@@ -59,7 +67,7 @@
 COMPILER_PREFIX = vc
 PDFDOC_LIB_CXXFLAGS = /MD$(VAR_18) /DWIN32 $(____WX_SHARED) /D_UNICODE \
 	$(__WXDEBUG_DEFINE_p) /D__WXMSW__ \
-	/I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /I$(WX_DIR)\include $(VAR) \
+	/I$(WX_DIR)$(WXLIBPATH) /I$(WX_DIR)\include $(VAR) \
 	$(VAR_15) $(VAR_17) \
 	/Fd..\lib\vc_$(____pdfdoc_lib__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.pdb \
 	/W4 /I..\include /GR /EHsc $(CPPFLAGS) $(CXXFLAGS)
@@ -101,13 +109,14 @@
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfocg.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfparser.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.obj \
+	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdftemplate.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfutility.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfxml.obj
 PDFDOC_DLL_CXXFLAGS = /MD$(VAR_18) /DWIN32 $(____WX_SHARED) /D_UNICODE \
 	$(__WXDEBUG_DEFINE_p) /D__WXMSW__ \
-	/I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /I$(WX_DIR)\include $(VAR) \
+	/I$(WX_DIR)$(WXLIBPATH) /I$(WX_DIR)\include $(VAR) \
 	$(VAR_15) $(VAR_17) \
 	/Fd..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.pdb \
 	/W4 /I..\include /DWXMAKINGDLL_PDFDOC /GR /EHsc $(CPPFLAGS) $(CXXFLAGS)
@@ -149,16 +158,18 @@
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfocg.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfparser.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.obj \
+	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdftemplate.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfutility.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfxml.obj
 MINIMAL_CXXFLAGS = /MD$(VAR_18) /DWIN32 $(____WX_SHARED) /D_UNICODE \
 	$(__WXDEBUG_DEFINE_p) /D__WXMSW__ \
-	/I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /I$(WX_DIR)\include $(VAR) \
+	/I$(WX_DIR)$(WXLIBPATH) /I$(WX_DIR)\include $(VAR) \
 	$(VAR_15) $(VAR_17) /Fd..\samples\minimal\minimal.pdb /W4 /I..\include \
 	/D_CONSOLE /I..\samples\minimal /GR /EHsc $(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  \
+	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_bookmark.obj \
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_charting.obj \
@@ -191,7 +202,7 @@
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_minimal.res
 DCSAMPLE_CXXFLAGS = /MD$(VAR_18) /DWIN32 $(____WX_SHARED) /D_UNICODE \
 	$(__WXDEBUG_DEFINE_p) /D__WXMSW__ \
-	/I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /I$(WX_DIR)\include $(VAR) \
+	/I$(WX_DIR)$(WXLIBPATH) /I$(WX_DIR)\include $(VAR) \
 	$(VAR_15) $(VAR_17) /Fd..\samples\pdfdc\printing.pdb /W4 /I..\include \
 	/D_WINDOWS /I..\samples\pdfdc /GR /EHsc $(CPPFLAGS) $(CXXFLAGS)
 DCSAMPLE_OBJECTS =  \
@@ -200,7 +211,7 @@
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res
 MAKEFONT_CXXFLAGS = /MD$(VAR_18) /DWIN32 $(____WX_SHARED) /D_UNICODE \
 	$(__WXDEBUG_DEFINE_p) /D__WXMSW__ \
-	/I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /I$(WX_DIR)\include $(VAR) \
+	/I$(WX_DIR)$(WXLIBPATH) /I$(WX_DIR)\include $(VAR) \
 	$(VAR_15) $(VAR_17) /Fd..\makefont\makefont.pdb /W4 /I..\include /D_CONSOLE \
 	/I..\makefont /GR /EHsc $(CPPFLAGS) $(CXXFLAGS)
 MAKEFONT_OBJECTS =  \
@@ -209,7 +220,7 @@
 	vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.res
 SHOWFONT_CXXFLAGS = /MD$(VAR_18) /DWIN32 $(____WX_SHARED) /D_UNICODE \
 	$(__WXDEBUG_DEFINE_p) /D__WXMSW__ \
-	/I$(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /I$(WX_DIR)\include $(VAR) \
+	/I$(WX_DIR)$(WXLIBPATH) /I$(WX_DIR)\include $(VAR) \
 	$(VAR_15) $(VAR_17) /Fd..\showfont\showfont.pdb /W4 /I..\include /D_CONSOLE \
 	/I..\showfont /GR /EHsc $(CPPFLAGS) $(CXXFLAGS)
 SHOWFONT_OBJECTS =  \
@@ -297,6 +308,9 @@
 __WXDEBUG_DEFINE_p_11 = /d __WXDEBUG__
 !endif
 !if "$(WX_DEBUG)" == "0"
+__WXDEBUG_DEFINE_p = /DwxDEBUG_LEVEL=0 /DNDEBUG
+!endif
+!if "$(WX_DEBUG)" == "0"
 VAR = /O2
 !endif
 !if "$(WX_DEBUG)" == "1"
@@ -356,6 +370,16 @@
 __WXLIB_XML_NAME_p = wxbase$(WX_VERSION)$(WXLIBPOSTFIX)_xml.lib
 !endif
 !if "$(WX_MONOLITHIC)" == "0"
+!if "$(WX_USE_RICHTEXT)" == "1"
+__WXLIB_RICHTEXT_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_richtext.lib
+!endif
+!endif
+!if "$(WX_MONOLITHIC)" == "0"
+!if "$(WX_USE_HTML)" == "1"
+__WXLIB_HTML_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_html.lib
+!endif
+!endif
+!if "$(WX_MONOLITHIC)" == "0"
 __WXLIB_CORE_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_core.lib
 !endif
 !if "$(WX_MONOLITHIC)" == "0"
@@ -371,10 +395,10 @@
 WXLIBPOSTFIX = ud
 !endif
 !if "$(WX_SHARED)" == "0"
-WXLIBPATH = \lib\$(COMPILER_PREFIX)_lib
+WXLIBPATH = \lib
 !endif
 !if "$(WX_SHARED)" == "1"
-WXLIBPATH = \lib\$(COMPILER_PREFIX)_dll
+WXLIBPATH = \lib
 !endif
 
 
@@ -409,15 +433,15 @@
 	-if exist ..\showfont\showfont.pdb del ..\showfont\showfont.pdb
 
 test_for_selected_wxbuild: 
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo ----------------------------------------------------------------------------
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo The selected wxWidgets build is not available!
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo Please use the options prefixed with WX_ to select another wxWidgets build.
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	echo ----------------------------------------------------------------------------
-	@if not exist $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX)\wx\setup.h \
+	@if not exist $(WX_DIR)$(WXLIBPATH)\wx\setup.h \
 	exit 1
 
 !if "$(WX_SHARED)" == "0"
@@ -433,7 +457,7 @@
 
 !if "$(WX_SHARED)" == "1"
 ..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.dll: make_dir_pdfdoc_dll  $(PDFDOC_DLL_OBJECTS)
-	link /DLL /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) $(VAR_16) /pdb:"..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.pdb" $(____pdfdoc_dll__DEBUGINFO_21) /LIBPATH:..$(WXLIBPATH) $(LDFLAGS) @<<
+	link /DLL /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) /LIBPATH:..\..\msw\builtin\$(WXPERL_STATIC_DIR) $(VAR_16) /pdb:"..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.pdb" $(____pdfdoc_dll__DEBUGINFO_21) /LIBPATH:..$(WXLIBPATH) $(LDFLAGS) @<<
 	$(PDFDOC_DLL_OBJECTS)   $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /IMPLIB:..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.lib
 <<
 !endif
@@ -442,22 +466,22 @@
 	if not exist ..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES) mkdir ..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)
 
 ..\samples\minimal\minimal.exe: $(MINIMAL_OBJECTS) $(__COMPONENT_LIB_DEP) vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_minimal.res
-	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) $(VAR_16) /pdb:"..\samples\minimal\minimal.pdb" $(____minimal__DEBUGINFO_32) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:CONSOLE $(LDFLAGS) @<<
+	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) /LIBPATH:..\..\msw\builtin\$(WXPERL_STATIC_DIR) $(VAR_16) /pdb:"..\samples\minimal\minimal.pdb" $(____minimal__DEBUGINFO_32) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:CONSOLE $(LDFLAGS) @<<
 	$(MINIMAL_OBJECTS) $(MINIMAL_RESOURCES)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib
 <<
 
 ..\samples\pdfdc\printing.exe: $(DCSAMPLE_OBJECTS) $(__COMPONENT_LIB_DEP) vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res
-	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) $(VAR_16) /pdb:"..\samples\pdfdc\printing.pdb" $(____dcsample__DEBUGINFO_45) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:WINDOWS $(LDFLAGS) @<<
-	$(DCSAMPLE_OBJECTS) $(DCSAMPLE_RESOURCES)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib
+	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) /LIBPATH:..\..\msw\builtin\$(WXPERL_STATIC_DIR) $(VAR_16) /pdb:"..\samples\pdfdc\printing.pdb" $(____dcsample__DEBUGINFO_45) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:WINDOWS $(LDFLAGS) @<<
+	$(DCSAMPLE_OBJECTS) $(DCSAMPLE_RESOURCES)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_RICHTEXT_NAME_p) $(__WXLIB_HTML_NAME_p) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib
 <<
 
 ..\makefont\makefont.exe: $(MAKEFONT_OBJECTS) $(__COMPONENT_LIB_DEP) vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.res
-	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) $(VAR_16) /pdb:"..\makefont\makefont.pdb" $(____makefont__DEBUGINFO_58) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:CONSOLE $(LDFLAGS) @<<
+	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) /LIBPATH:..\..\msw\builtin\$(WXPERL_STATIC_DIR) $(VAR_16) /pdb:"..\makefont\makefont.pdb" $(____makefont__DEBUGINFO_58) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:CONSOLE $(LDFLAGS) @<<
 	$(MAKEFONT_OBJECTS) $(MAKEFONT_RESOURCES)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib
 <<
 
 ..\showfont\showfont.exe: $(SHOWFONT_OBJECTS) $(__COMPONENT_LIB_DEP) vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont.res
-	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) $(VAR_16) /pdb:"..\showfont\showfont.pdb" $(____showfont__DEBUGINFO_71) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:CONSOLE $(LDFLAGS) @<<
+	link /NOLOGO /OUT:$@  /LIBPATH:$(WX_DIR)$(WXLIBPATH) /LIBPATH:..\..\msw\builtin\$(WXPERL_STATIC_DIR) $(VAR_16) /pdb:"..\showfont\showfont.pdb" $(____showfont__DEBUGINFO_71) /LIBPATH:..$(WXLIBPATH) /SUBSYSTEM:CONSOLE $(LDFLAGS) @<<
 	$(SHOWFONT_OBJECTS) $(SHOWFONT_RESOURCES)  $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib
 <<
 
@@ -572,6 +596,9 @@
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.obj: ..\src\pdfpattern.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_LIB_CXXFLAGS) ..\src\pdfpattern.cpp
 
+vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.obj: ..\src\pdfprint.cpp
+	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_LIB_CXXFLAGS) ..\src\pdfprint.cpp
+
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.obj: ..\src\pdfrijndael.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_LIB_CXXFLAGS) ..\src\pdfrijndael.cpp
 
@@ -695,6 +722,9 @@
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.obj: ..\src\pdfpattern.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfpattern.cpp
 
+vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.obj: ..\src\pdfprint.cpp
+	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfprint.cpp
+
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.obj: ..\src\pdfrijndael.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfrijndael.cpp
 
@@ -707,6 +737,9 @@
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfxml.obj: ..\src\pdfxml.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(PDFDOC_DLL_CXXFLAGS) ..\src\pdfxml.cpp
 
+vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.obj: ..\samples\minimal\attachment.cpp
+	$(CXX) /c /nologo /TP /Fo$@ $(MINIMAL_CXXFLAGS) ..\samples\minimal\attachment.cpp
+
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.obj: ..\samples\minimal\barcodes.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(MINIMAL_CXXFLAGS) ..\samples\minimal\barcodes.cpp
 
@@ -792,23 +825,23 @@
 	$(CXX) /c /nologo /TP /Fo$@ $(MINIMAL_CXXFLAGS) ..\samples\minimal\xmlwrite.cpp
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_minimal.res: ..\samples\minimal\minimal.rc
-	rc /fo$@  /d WIN32 $(____WX_SHARED_2) /d _UNICODE $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /i $(WX_DIR)\include $(p_1) /i ..\include /d _CONSOLE /i ..\samples\minimal ..\samples\minimal\minimal.rc
+	rc /fo$@  /d WIN32 $(____WX_SHARED_2) /d _UNICODE $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH) /i $(WX_DIR)\include $(p_1) /i ..\include /d _CONSOLE /i ..\samples\minimal ..\samples\minimal\minimal.rc
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.obj: ..\samples\pdfdc\printing.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(DCSAMPLE_CXXFLAGS) ..\samples\pdfdc\printing.cpp
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res: ..\samples\pdfdc\printing.rc
-	rc /fo$@  /d WIN32 $(____WX_SHARED_2) /d _UNICODE $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /i $(WX_DIR)\include $(p_1) /i ..\include /d _WINDOWS /i ..\samples\pdfdc ..\samples\pdfdc\printing.rc
+	rc /fo$@  /d WIN32 $(____WX_SHARED_2) /d _UNICODE $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH) /i $(WX_DIR)\include $(p_1) /i ..\include /d _WINDOWS /i ..\samples\pdfdc ..\samples\pdfdc\printing.rc
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.obj: ..\makefont\makefont.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(MAKEFONT_CXXFLAGS) ..\makefont\makefont.cpp
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\makefont_makefont.res: ..\makefont\makefont.rc
-	rc /fo$@  /d WIN32 $(____WX_SHARED_2) /d _UNICODE $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /i $(WX_DIR)\include $(p_1) /i ..\include /d _CONSOLE /i ..\makefont ..\makefont\makefont.rc
+	rc /fo$@  /d WIN32 $(____WX_SHARED_2) /d _UNICODE $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH) /i $(WX_DIR)\include $(p_1) /i ..\include /d _CONSOLE /i ..\makefont ..\makefont\makefont.rc
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont.obj: ..\showfont\showfont.cpp
 	$(CXX) /c /nologo /TP /Fo$@ $(SHOWFONT_CXXFLAGS) ..\showfont\showfont.cpp
 
 vcmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\showfont_showfont.res: ..\showfont\showfont.rc
-	rc /fo$@  /d WIN32 $(____WX_SHARED_2) /d _UNICODE $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH)\msw$(WXLIBPOSTFIX) /i $(WX_DIR)\include $(p_1) /i ..\include /d _CONSOLE /i ..\showfont ..\showfont\showfont.rc
+	rc /fo$@  /d WIN32 $(____WX_SHARED_2) /d _UNICODE $(__WXDEBUG_DEFINE_p_11) /d __WXMSW__ /i $(WX_DIR)$(WXLIBPATH) /i $(WX_DIR)\include $(p_1) /i ..\include /d _CONSOLE /i ..\showfont ..\showfont\showfont.rc
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/makefile.wat wxPdfDoc-copy/build29/makefile.wat
--- wxpdfdoc-0.9.2.1/build29/makefile.wat	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/makefile.wat	2012-05-26 17:57:54.893300000 +0100
@@ -96,6 +96,18 @@
 __pdfdoc_dll___depname = &
 	..\lib\$(COMPILER_PREFIX)_$(____pdfdoc_dll__DIRNAME_SHARED_SUFFIX_FILENAMES)\wxcode_msw$(WX_VERSION)$(WXLIBPOSTFIX)_pdfdoc.dll
 !endif
+__WXLIB_ADV_NAME_p =
+!ifeq WX_MONOLITHIC 0
+__WXLIB_ADV_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_adv.lib
+!endif
+__WXLIB_HTML_NAME_p =
+!ifeq WX_MONOLITHIC 0
+__WXLIB_HTML_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_html.lib
+!endif
+__WXLIB_RICHTEXT_NAME_p =
+!ifeq WX_MONOLITHIC 0
+__WXLIB_RICHTEXT_NAME_p = wxmsw$(WX_VERSION)$(WXLIBPOSTFIX)_richtext.lib
+!endif
 ____pdfdoc_lib__DIRNAME_SHARED_SUFFIX_FILENAMES =
 !ifeq SHARED 0
 ____pdfdoc_lib__DIRNAME_SHARED_SUFFIX_FILENAMES = lib
@@ -232,6 +244,7 @@
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfocg.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfparser.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.obj &
+	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdftemplate.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfutility.obj &
@@ -278,6 +291,7 @@
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfocg.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfparser.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.obj &
+	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdftemplate.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfutility.obj &
@@ -287,6 +301,7 @@
 	-i=$(WX_DIR)\include $(VAR) $(VAR_6) -wx -i=..\include -i=..\samples\minimal &
 	$(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  &
+	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_bookmark.obj &
 	watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_charting.obj &
@@ -416,7 +431,7 @@
 	@%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc option caseexact
 	@%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc  libpath $(WX_DIR)$(WXLIBPATH) $(VAR_7) libpath ..$(WXLIBPATH) system nt_win ref '_WinMain@16' $(LDFLAGS)
 	@for %i in ($(DCSAMPLE_OBJECTS)) do @%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc file %i
-	@for %i in ( $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib) do @%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc library %i
+	@for %i in ( $(__COMPONENT_LIB_LIBR) $(__WXLIB_XML_NAME_p) $(__WXLIB_CORE_NAME_p) $(__WXLIB_BASE_NAME_p) $(__WXLIB_ADV_NAME_p) $(__WXLIB_HTML_NAME_p) $(__WXLIB_RICHTEXT_NAME_p) wxtiff$(WX3RDPARTYLIBPOSTFIX).lib wxjpeg$(WX3RDPARTYLIBPOSTFIX).lib wxpng$(WX3RDPARTYLIBPOSTFIX).lib wxzlib$(WX3RDPARTYLIBPOSTFIX).lib wxregex$(WXLIBPOSTFIX).lib wxexpat$(WX3RDPARTYLIBPOSTFIX).lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib) do @%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc library %i
 	@%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc option resource=watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample_printing.res
 	@for %i in () do @%append watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc option stack=%i
 	wlink @watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\dcsample.lbc
@@ -556,6 +571,9 @@
 watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfpattern.obj :  .AUTODEPEND ..\src\pdfpattern.cpp
 	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_LIB_CXXFLAGS) $<
 
+watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfprint.obj :  .AUTODEPEND ..\src\pdfprint.cpp
+	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_LIB_CXXFLAGS) $<
+
 watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_lib_pdfrijndael.obj :  .AUTODEPEND ..\src\pdfrijndael.cpp
 	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_LIB_CXXFLAGS) $<
 
@@ -679,6 +697,9 @@
 watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfpattern.obj :  .AUTODEPEND ..\src\pdfpattern.cpp
 	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_DLL_CXXFLAGS) $<
 
+watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfprint.obj :  .AUTODEPEND ..\src\pdfprint.cpp
+	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_DLL_CXXFLAGS) $<
+
 watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfrijndael.obj :  .AUTODEPEND ..\src\pdfrijndael.cpp
 	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_DLL_CXXFLAGS) $<
 
@@ -691,6 +712,9 @@
 watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\pdfdoc_dll_pdfxml.obj :  .AUTODEPEND ..\src\pdfxml.cpp
 	$(CXX) -bt=nt -zq -fo=$^@ $(PDFDOC_DLL_CXXFLAGS) $<
 
+watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_attachment.obj :  .AUTODEPEND ..\samples\minimal\attachment.cpp
+	$(CXX) -bt=nt -zq -fo=$^@ $(MINIMAL_CXXFLAGS) $<
+
 watmsw$(WXLIBPOSTFIX)$(_BUILDDIR_SHARED_SUFFIX)\minimal_barcodes.obj :  .AUTODEPEND ..\samples\minimal\barcodes.cpp
 	$(CXX) -bt=nt -zq -fo=$^@ $(MINIMAL_CXXFLAGS) $<
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc.bkl wxPdfDoc-copy/build29/wxpdfdoc.bkl
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc.bkl	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc.bkl	2012-05-26 17:57:54.893300000 +0100
@@ -82,6 +82,9 @@
 
   <template id="gui_app" template="generic_app">
     <app-type>gui</app-type>
+    <wx-lib>adv</wx-lib>
+    <wx-lib>html</wx-lib>
+    <wx-lib>richtext</wx-lib>
   </template>
 
   <!-- The samples of the component: as for the LIB target, this exe derives from a 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc6_dcsample.dsp wxPdfDoc-copy/build29/wxpdfdoc_vc6_dcsample.dsp
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc6_dcsample.dsp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc_vc6_dcsample.dsp	2012-05-26 17:57:54.908900000 +0100
@@ -115,8 +115,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 DLL Debug Multilib Static"
 
@@ -140,8 +140,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 DLL Release Monolithic DLL"
 
@@ -215,8 +215,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 DLL Release Multilib Static"
 
@@ -240,8 +240,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_dll" /libpath:"..\lib\vc_dll" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 Static Debug Monolithic DLL"
 
@@ -315,8 +315,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 Static Debug Multilib Static"
 
@@ -340,8 +340,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /debug /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 Static Release Monolithic DLL"
 
@@ -415,8 +415,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ELSEIF  "$(CFG)" == "dcsample - Win32 Static Release Multilib Static"
 
@@ -440,8 +440,8 @@
 # ADD BASE BSC32 /nologo
 # ADD BSC32 /nologo
 LINK32=link.exe
-# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
-# ADD LINK32 ..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD BASE LINK32 ..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
+# ADD LINK32 ..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib oleacc.lib /nologo /machine:i386 /out:"..\samples\pdfdc\printing.exe" /libpath:"$(WXWIN)\lib\vc_lib" /libpath:"..\lib\vc_lib" /subsystem:windows /pdb:"..\samples\pdfdc\printing.pdb"
 
 !ENDIF
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc6_minimal.dsp wxPdfDoc-copy/build29/wxpdfdoc_vc6_minimal.dsp
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc6_minimal.dsp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc_vc6_minimal.dsp	2012-05-22 01:03:37.865400000 +0100
@@ -435,6 +435,10 @@
 # PROP Default_Filter ""
 # Begin Source File
 
+SOURCE=..\samples\minimal\attachment.cpp
+# End Source File
+# Begin Source File
+
 SOURCE=..\samples\minimal\barcodes.cpp
 # End Source File
 # Begin Source File
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc6_pdfdoc.dsp wxPdfDoc-copy/build29/wxpdfdoc_vc6_pdfdoc.dsp
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc6_pdfdoc.dsp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc_vc6_pdfdoc.dsp	2012-05-22 01:03:33.747200000 +0100
@@ -600,6 +600,10 @@
 # End Source File
 # Begin Source File
 
+SOURCE=..\src\pdfprint.cpp
+# End Source File
+# Begin Source File
+
 SOURCE=..\src\pdfrijndael.cpp
 # End Source File
 # Begin Source File
@@ -812,6 +816,10 @@
 # End Source File
 # Begin Source File
 
+SOURCE=..\include\wx\pdfprint.h
+# End Source File
+# Begin Source File
+
 SOURCE=..\include\wx\pdfproperties.h
 # End Source File
 # Begin Source File
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc7_dcsample.vcproj wxPdfDoc-copy/build29/wxpdfdoc_vc7_dcsample.vcproj
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc7_dcsample.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc_vc7_dcsample.vcproj	2012-05-26 17:57:54.893300000 +0100
@@ -43,7 +43,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="TRUE"
@@ -104,7 +104,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="TRUE"
@@ -290,7 +290,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="TRUE"
@@ -355,7 +355,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="TRUE"
@@ -547,7 +547,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="TRUE"
@@ -608,7 +608,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="TRUE"
@@ -794,7 +794,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="TRUE"
@@ -859,7 +859,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="TRUE"
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc7_minimal.vcproj wxPdfDoc-copy/build29/wxpdfdoc_vc7_minimal.vcproj
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc7_minimal.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc_vc7_minimal.vcproj	2012-05-22 01:03:37.876400000 +0100
@@ -1034,6 +1034,9 @@
 			Filter="cpp;c;cc;cxx;def;odl;idl;hpj;bat;asm;asmx"
 			UniqueIdentifier="{4FC737F1-C7A5-4376-A066-2A32D752A2FF}">
 			<File
+				RelativePath="..\samples\minimal\attachment.cpp">
+			</File>
+			<File
 				RelativePath="..\samples\minimal\barcodes.cpp">
 			</File>
 			<File
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc7_pdfdoc.vcproj wxPdfDoc-copy/build29/wxpdfdoc_vc7_pdfdoc.vcproj
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc7_pdfdoc.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc_vc7_pdfdoc.vcproj	2012-05-22 01:03:34.232600000 +0100
@@ -1085,6 +1085,9 @@
 				RelativePath="..\src\pdfpattern.cpp">
 			</File>
 			<File
+				RelativePath="..\src\pdfprint.cpp">
+			</File>
+			<File
 				RelativePath="..\src\pdfrijndael.cpp">
 			</File>
 			<File
@@ -1273,6 +1276,9 @@
 				RelativePath="..\include\wx\pdfpattern.h">
 			</File>
 			<File
+				RelativePath="..\include\wx\pdfprint.h">
+			</File>
+			<File
 				RelativePath="..\include\wx\pdfproperties.h">
 			</File>
 			<File
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc8_dcsample.vcproj wxPdfDoc-copy/build29/wxpdfdoc_vc8_dcsample.vcproj
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc8_dcsample.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc_vc8_dcsample.vcproj	2012-05-26 17:57:54.893300000 +0100
@@ -77,7 +77,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -170,7 +170,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -452,7 +452,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -549,7 +549,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -837,7 +837,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -930,7 +930,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -1212,7 +1212,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -1309,7 +1309,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc8_minimal.vcproj wxPdfDoc-copy/build29/wxpdfdoc_vc8_minimal.vcproj
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc8_minimal.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc_vc8_minimal.vcproj	2012-05-22 01:03:37.840400000 +0100
@@ -1552,6 +1552,10 @@
 			UniqueIdentifier="{4FC737F1-C7A5-4376-A066-2A32D752A2FF}"
 			>
 			<File
+				RelativePath="..\samples\minimal\attachment.cpp"
+				>
+			</File>
+			<File
 				RelativePath="..\samples\minimal\barcodes.cpp"
 				>
 			</File>
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc8_pdfdoc.vcproj wxPdfDoc-copy/build29/wxpdfdoc_vc8_pdfdoc.vcproj
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc8_pdfdoc.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc_vc8_pdfdoc.vcproj	2012-05-22 01:03:32.728000000 +0100
@@ -1536,6 +1536,10 @@
 				>
 			</File>
 			<File
+				RelativePath="..\src\pdfprint.cpp"
+				>
+			</File>
+			<File
 				RelativePath="..\src\pdfrijndael.cpp"
 				>
 			</File>
@@ -1786,6 +1790,10 @@
 				>
 			</File>
 			<File
+				RelativePath="..\include\wx\pdfprint.h"
+				>
+			</File>
+			<File
 				RelativePath="..\include\wx\pdfproperties.h"
 				>
 			</File>
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc9_dcsample.vcproj wxPdfDoc-copy/build29/wxpdfdoc_vc9_dcsample.vcproj
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc9_dcsample.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc_vc9_dcsample.vcproj	2012-05-26 17:57:54.893300000 +0100
@@ -77,7 +77,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -167,7 +167,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -439,7 +439,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -532,7 +532,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -809,7 +809,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -899,7 +899,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29u_pdfdoc.lib wxbase29u_xml.lib wxmsw29u_core.lib wxbase29u.lib wxmsw29u_adv.lib wxmsw29u_html.lib wxmsw29u_richtext.lib wxtiff.lib wxjpeg.lib wxpng.lib wxzlib.lib wxregexu.lib wxexpat.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="1"
 				SuppressStartupBanner="true"
@@ -1171,7 +1171,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_lib\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
@@ -1264,7 +1264,7 @@
 			<Tool
 				Name="VCLinkerTool"
 				AdditionalOptions=""
-				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
+				AdditionalDependencies="..\lib\vc_dll\wxcode_msw29ud_pdfdoc.lib wxbase29ud_xml.lib wxmsw29ud_core.lib wxbase29ud.lib wxmsw29ud_adv.lib wxmsw29ud_html.lib wxmsw29ud_richtext.lib wxtiffd.lib wxjpegd.lib wxpngd.lib wxzlibd.lib wxregexud.lib wxexpatd.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib winspool.lib winmm.lib shell32.lib comctl32.lib ole32.lib oleaut32.lib uuid.lib rpcrt4.lib advapi32.lib wsock32.lib"
 				OutputFile="..\samples\pdfdc\printing.exe"
 				LinkIncremental="2"
 				SuppressStartupBanner="true"
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc9_minimal.vcproj wxPdfDoc-copy/build29/wxpdfdoc_vc9_minimal.vcproj
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc9_minimal.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc_vc9_minimal.vcproj	2012-05-22 01:03:37.880400000 +0100
@@ -1496,6 +1496,10 @@
 			UniqueIdentifier="{4FC737F1-C7A5-4376-A066-2A32D752A2FF}"
 			>
 			<File
+				RelativePath="..\samples\minimal\attachment.cpp"
+				>
+			</File>
+			<File
 				RelativePath="..\samples\minimal\barcodes.cpp"
 				>
 			</File>
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc9_pdfdoc.vcproj wxPdfDoc-copy/build29/wxpdfdoc_vc9_pdfdoc.vcproj
--- wxpdfdoc-0.9.2.1/build29/wxpdfdoc_vc9_pdfdoc.vcproj	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/build29/wxpdfdoc_vc9_pdfdoc.vcproj	2012-05-22 01:03:32.805000000 +0100
@@ -1528,6 +1528,10 @@
 				>
 			</File>
 			<File
+				RelativePath="..\src\pdfprint.cpp"
+				>
+			</File>
+			<File
 				RelativePath="..\src\pdfrijndael.cpp"
 				>
 			</File>
@@ -1778,6 +1782,10 @@
 				>
 			</File>
 			<File
+				RelativePath="..\include\wx\pdfprint.h"
+				>
+			</File>
+			<File
 				RelativePath="..\include\wx\pdfproperties.h"
 				>
 			</File>
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/configure wxPdfDoc-copy/configure
--- wxpdfdoc-0.9.2.1/configure	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/configure	2012-05-26 17:57:53.317700000 +0100
@@ -1,6 +1,6 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.63 for wxpdfdoc 0.9.1.
+# Generated by GNU Autoconf 2.63 for wxpdfdoc 0.9.3.
 #
 # Report bugs to <utelle@users.sourceforge.net>.
 #
@@ -596,8 +596,8 @@
 # Identity of this package.
 PACKAGE_NAME='wxpdfdoc'
 PACKAGE_TARNAME='wxpdfdoc'
-PACKAGE_VERSION='0.9.1'
-PACKAGE_STRING='wxpdfdoc 0.9.1'
+PACKAGE_VERSION='0.9.3'
+PACKAGE_STRING='wxpdfdoc 0.9.3'
 PACKAGE_BUGREPORT='utelle@users.sourceforge.net'
 
 ac_subst_vars='LTLIBOBJS
@@ -1331,7 +1331,7 @@
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures wxpdfdoc 0.9.1 to adapt to many kinds of systems.
+\`configure' configures wxpdfdoc 0.9.3 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
@@ -1397,7 +1397,7 @@
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of wxpdfdoc 0.9.1:";;
+     short | recursive ) echo "Configuration of wxpdfdoc 0.9.3:";;
    esac
   cat <<\_ACEOF
 
@@ -1505,7 +1505,7 @@
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-wxpdfdoc configure 0.9.1
+wxpdfdoc configure 0.9.3
 generated by GNU Autoconf 2.63
 
 Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
@@ -1519,7 +1519,7 @@
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by wxpdfdoc $as_me 0.9.1, which was
+It was created by wxpdfdoc $as_me 0.9.3, which was
 generated by GNU Autoconf 2.63.  Invocation command line was
 
   $ $0 $@
@@ -2612,11 +2612,11 @@
     if test -n "$wx_ver_ok"; then
       { $as_echo "$as_me:$LINENO: result: yes (version $WX_VERSION)" >&5
 $as_echo "yes (version $WX_VERSION)" >&6; }
-      WX_LIBS=`$WX_CONFIG_WITH_ARGS --libs core,base,xml`
+      WX_LIBS=`$WX_CONFIG_WITH_ARGS --libs core,base,xml,adv,html,richtext`
 
                               { $as_echo "$as_me:$LINENO: checking for wxWidgets static library" >&5
 $as_echo_n "checking for wxWidgets static library... " >&6; }
-      WX_LIBS_STATIC=`$WX_CONFIG_WITH_ARGS --static --libs core,base,xml 2>/dev/null`
+      WX_LIBS_STATIC=`$WX_CONFIG_WITH_ARGS --static --libs core,base,xml,adv,html,richtext 2>/dev/null`
       if test "x$WX_LIBS_STATIC" = "x"; then
         { $as_echo "$as_me:$LINENO: result: no" >&5
 $as_echo "no" >&6; }
@@ -2659,16 +2659,16 @@
       fi
 
       if test "x$wx_has_cppflags" = x ; then
-                  WX_CFLAGS=`$WX_CONFIG_WITH_ARGS --cflags core,base,xml`
+                  WX_CFLAGS=`$WX_CONFIG_WITH_ARGS --cflags core,base,xml,adv,html,richtext`
          WX_CPPFLAGS=$WX_CFLAGS
          WX_CXXFLAGS=$WX_CFLAGS
 
          WX_CFLAGS_ONLY=$WX_CFLAGS
          WX_CXXFLAGS_ONLY=$WX_CFLAGS
       else
-                  WX_CPPFLAGS=`$WX_CONFIG_WITH_ARGS --cppflags core,base,xml`
-         WX_CXXFLAGS=`$WX_CONFIG_WITH_ARGS --cxxflags core,base,xml`
-         WX_CFLAGS=`$WX_CONFIG_WITH_ARGS --cflags core,base,xml`
+                  WX_CPPFLAGS=`$WX_CONFIG_WITH_ARGS --cppflags core,base,xml,adv,html,richtext`
+         WX_CXXFLAGS=`$WX_CONFIG_WITH_ARGS --cxxflags core,base,xml,adv,html,richtext`
+         WX_CFLAGS=`$WX_CONFIG_WITH_ARGS --cflags core,base,xml,adv,html,richtext`
 
          WX_CFLAGS_ONLY=`echo $WX_CFLAGS | sed "s@^$WX_CPPFLAGS *@@"`
          WX_CXXFLAGS_ONLY=`echo $WX_CXXFLAGS | sed "s@^$WX_CFLAGS *@@"`
@@ -4298,1165 +4298,19 @@
 
 
 
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}gcc; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="${ac_tool_prefix}gcc"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:$LINENO: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-fi
-if test -z "$ac_cv_prog_CC"; then
-  ac_ct_CC=$CC
-  # Extract the first word of "gcc", so it can be a program name with args.
-set dummy gcc; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CC="gcc"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  { $as_echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-$as_echo "$ac_ct_CC" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:$LINENO: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
-else
-  CC="$ac_cv_prog_CC"
-fi
-
-if test -z "$CC"; then
-          if test -n "$ac_tool_prefix"; then
-    # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}cc; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="${ac_tool_prefix}cc"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:$LINENO: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-  fi
-fi
-if test -z "$CC"; then
-  # Extract the first word of "cc", so it can be a program name with args.
-set dummy cc; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-  ac_prog_rejected=no
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
-       ac_prog_rejected=yes
-       continue
-     fi
-    ac_cv_prog_CC="cc"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-if test $ac_prog_rejected = yes; then
-  # We found a bogon in the path, so make sure we never use it.
-  set dummy $ac_cv_prog_CC
-  shift
-  if test $# != 0; then
-    # We chose a different compiler from the bogus one.
-    # However, it has the same basename, so the bogon will be chosen
-    # first if we set CC to just the basename; use the full file name.
-    shift
-    ac_cv_prog_CC="$as_dir/$ac_word${1+' '}$@"
-  fi
-fi
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:$LINENO: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-fi
-if test -z "$CC"; then
-  if test -n "$ac_tool_prefix"; then
-  for ac_prog in cl.exe
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:$LINENO: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-    test -n "$CC" && break
-  done
-fi
-if test -z "$CC"; then
-  ac_ct_CC=$CC
-  for ac_prog in cl.exe
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CC="$ac_prog"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  { $as_echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-$as_echo "$ac_ct_CC" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-  test -n "$ac_ct_CC" && break
-done
-
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:$LINENO: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
-fi
-
-fi
-
-
-test -z "$CC" && { { $as_echo "$as_me:$LINENO: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-{ { $as_echo "$as_me:$LINENO: error: no acceptable C compiler found in \$PATH
-See \`config.log' for more details." >&5
-$as_echo "$as_me: error: no acceptable C compiler found in \$PATH
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }; }
-
-# Provide some information about the compiler.
-$as_echo "$as_me:$LINENO: checking for C compiler version" >&5
-set X $ac_compile
-ac_compiler=$2
-{ (ac_try="$ac_compiler --version >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compiler --version >&5") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -v >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compiler -v >&5") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -V >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compiler -V >&5") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-
-{ $as_echo "$as_me:$LINENO: checking whether we are using the GNU C compiler" >&5
-$as_echo_n "checking whether we are using the GNU C compiler... " >&6; }
-if test "${ac_cv_c_compiler_gnu+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_compiler_gnu=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_compiler_gnu=no
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_c_compiler_gnu=$ac_compiler_gnu
-
-fi
-{ $as_echo "$as_me:$LINENO: result: $ac_cv_c_compiler_gnu" >&5
-$as_echo "$ac_cv_c_compiler_gnu" >&6; }
-if test $ac_compiler_gnu = yes; then
-  GCC=yes
-else
-  GCC=
-fi
-ac_test_CFLAGS=${CFLAGS+set}
-ac_save_CFLAGS=$CFLAGS
-{ $as_echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
-$as_echo_n "checking whether $CC accepts -g... " >&6; }
-if test "${ac_cv_prog_cc_g+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  ac_save_c_werror_flag=$ac_c_werror_flag
-   ac_c_werror_flag=yes
-   ac_cv_prog_cc_g=no
-   CFLAGS="-g"
-   cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	CFLAGS=""
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  :
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_c_werror_flag=$ac_save_c_werror_flag
-	 CFLAGS="-g"
-	 cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_c_werror_flag=$ac_save_c_werror_flag
-fi
-{ $as_echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
-$as_echo "$ac_cv_prog_cc_g" >&6; }
-if test "$ac_test_CFLAGS" = set; then
-  CFLAGS=$ac_save_CFLAGS
-elif test $ac_cv_prog_cc_g = yes; then
-  if test "$GCC" = yes; then
-    CFLAGS="-g -O2"
-  else
-    CFLAGS="-g"
-  fi
-else
-  if test "$GCC" = yes; then
-    CFLAGS="-O2"
-  else
-    CFLAGS=
-  fi
-fi
-{ $as_echo "$as_me:$LINENO: checking for $CC option to accept ISO C89" >&5
-$as_echo_n "checking for $CC option to accept ISO C89... " >&6; }
-if test "${ac_cv_prog_cc_c89+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  ac_cv_prog_cc_c89=no
-ac_save_CC=$CC
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <stdarg.h>
-#include <stdio.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-/* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
-struct buf { int x; };
-FILE * (*rcsopen) (struct buf *, struct stat *, int);
-static char *e (p, i)
-     char **p;
-     int i;
-{
-  return p[i];
-}
-static char *f (char * (*g) (char **, int), char **p, ...)
-{
-  char *s;
-  va_list v;
-  va_start (v,p);
-  s = g (p, va_arg (v,int));
-  va_end (v);
-  return s;
-}
-
-/* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
-   function prototypes and stuff, but not '\xHH' hex character constants.
-   These don't provoke an error unfortunately, instead are silently treated
-   as 'x'.  The following induces an error, until -std is added to get
-   proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
-   array size at least.  It's necessary to write '\x00'==0 to get something
-   that's true only with -std.  */
-int osf4_cc_array ['\x00' == 0 ? 1 : -1];
-
-/* IBM C 6 for AIX is almost-ANSI by default, but it replaces macro parameters
-   inside strings and character constants.  */
-#define FOO(x) 'x'
-int xlc6_cc_array[FOO(a) == 'x' ? 1 : -1];
-
-int test (int i, double x);
-struct s1 {int (*f) (int a);};
-struct s2 {int (*f) (double a);};
-int pairnames (int, char **, FILE *(*)(struct buf *, struct stat *, int), int, int);
-int argc;
-char **argv;
-int
-main ()
-{
-return f (e, argv, 0) != argv[0]  ||  f (e, argv, 1) != argv[1];
-  ;
-  return 0;
-}
-_ACEOF
-for ac_arg in '' -qlanglvl=extc89 -qlanglvl=ansi -std \
-	-Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
-do
-  CC="$ac_save_CC $ac_arg"
-  rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_c89=$ac_arg
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext
-  test "x$ac_cv_prog_cc_c89" != "xno" && break
-done
-rm -f conftest.$ac_ext
-CC=$ac_save_CC
-
-fi
-# AC_CACHE_VAL
-case "x$ac_cv_prog_cc_c89" in
-  x)
-    { $as_echo "$as_me:$LINENO: result: none needed" >&5
-$as_echo "none needed" >&6; } ;;
-  xno)
-    { $as_echo "$as_me:$LINENO: result: unsupported" >&5
-$as_echo "unsupported" >&6; } ;;
-  *)
-    CC="$CC $ac_cv_prog_cc_c89"
-    { $as_echo "$as_me:$LINENO: result: $ac_cv_prog_cc_c89" >&5
-$as_echo "$ac_cv_prog_cc_c89" >&6; } ;;
-esac
-
-
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
-
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-    { $as_echo "$as_me:$LINENO: checking whether we are using the Intel C compiler" >&5
-$as_echo_n "checking whether we are using the Intel C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___INTEL_COMPILER+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-             #ifndef __INTEL_COMPILER
-                choke me
-             #endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___INTEL_COMPILER=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	bakefile_cv_c_compiler___INTEL_COMPILER=no
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-
-
-fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___INTEL_COMPILER" >&5
-$as_echo "$bakefile_cv_c_compiler___INTEL_COMPILER" >&6; }
-    if test "x$bakefile_cv_c_compiler___INTEL_COMPILER" = "xyes"; then
-        :; INTELCC=yes
-    else
-        :;
-    fi
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
-
-        if test "$INTELCC" = "yes"; then
-
-
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-    { $as_echo "$as_me:$LINENO: checking whether we are using Intel C compiler v8 or later" >&5
-$as_echo_n "checking whether we are using Intel C compiler v8 or later... " >&6; }
-if test "${bakefile_cv_c_compiler___INTEL_COMPILER_lt_800+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-             #ifndef __INTEL_COMPILER || __INTEL_COMPILER < 800
-                choke me
-             #endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___INTEL_COMPILER_lt_800=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	bakefile_cv_c_compiler___INTEL_COMPILER_lt_800=no
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-
-
-fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___INTEL_COMPILER_lt_800" >&5
-$as_echo "$bakefile_cv_c_compiler___INTEL_COMPILER_lt_800" >&6; }
-    if test "x$bakefile_cv_c_compiler___INTEL_COMPILER_lt_800" = "xyes"; then
-        :; INTELCC8=yes
-    else
-        :;
-    fi
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
-
-
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-    { $as_echo "$as_me:$LINENO: checking whether we are using Intel C compiler v10 or later" >&5
-$as_echo_n "checking whether we are using Intel C compiler v10 or later... " >&6; }
-if test "${bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-             #ifndef __INTEL_COMPILER || __INTEL_COMPILER < 1000
-                choke me
-             #endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000=no
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-
-
-fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000" >&5
-$as_echo "$bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000" >&6; }
-    if test "x$bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000" = "xyes"; then
-        :; INTELCC10=yes
-    else
-        :;
-    fi
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
-    fi
-
-        if test "x$GCC" != "xyes"; then
-        if test "xCC" = "xC"; then
-            { $as_echo "$as_me:$LINENO: checking if the C++ compiler requires -ext o" >&5
-$as_echo_n "checking if the C++ compiler requires -ext o... " >&6; }
-if test "${bakefile_cv_cxx_exto+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest.$ac_ext.o
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  for ac_file in `(ls conftest.* 2>/dev/null)`; do
-    case $ac_file in
-        conftest.$ac_ext.o)
-            bakefile_cv_cxx_exto="-ext o"
-            ;;
-        *)
-            ;;
-    esac
-done
-else
-  { { $as_echo "$as_me:$LINENO: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-{ { $as_echo "$as_me:$LINENO: error: cannot figure out if compiler needs -ext o: cannot compile
-See \`config.log' for more details." >&5
-$as_echo "$as_me: error: cannot figure out if compiler needs -ext o: cannot compile
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }; }
-
-fi
-
-rm -f conftest.$ac_ext.o conftest.$ac_objext conftest.$ac_ext
-
-fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_cxx_exto" >&5
-$as_echo "$bakefile_cv_cxx_exto" >&6; }
-if test "x$bakefile_cv_cxx_exto" '!=' "x"; then
-    if test "cxx" = "c"; then
-        CFLAGS="$bakefile_cv_cxx_exto $CFLAGS"
-    fi
-    if test "cxx" = "cxx"; then
-        CXXFLAGS="$bakefile_cv_cxx_exto $CXXFLAGS"
-    fi
-fi
-
-            if test "x$bakefile_cv_c_exto" '!=' "x"; then
-                unset ac_cv_prog_cc_g
-                ac_test_CFLAGS=${CFLAGS+set}
-ac_save_CFLAGS=$CFLAGS
-{ $as_echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
-$as_echo_n "checking whether $CC accepts -g... " >&6; }
-if test "${ac_cv_prog_cc_g+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  ac_save_c_werror_flag=$ac_c_werror_flag
-   ac_c_werror_flag=yes
-   ac_cv_prog_cc_g=no
-   CFLAGS="-g"
-   cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	CFLAGS=""
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  :
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_c_werror_flag=$ac_save_c_werror_flag
-	 CFLAGS="-g"
-	 cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
 
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_c_werror_flag=$ac_save_c_werror_flag
-fi
-{ $as_echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
-$as_echo "$ac_cv_prog_cc_g" >&6; }
-if test "$ac_test_CFLAGS" = set; then
-  CFLAGS=$ac_save_CFLAGS
-elif test $ac_cv_prog_cc_g = yes; then
-  if test "$GCC" = yes; then
-    CFLAGS="-g -O2"
-  else
-    CFLAGS="-g"
-  fi
-else
-  if test "$GCC" = yes; then
-    CFLAGS="-O2"
-  else
-    CFLAGS=
-  fi
-fi
-            fi
-        fi
 
-                        case `uname -s` in
-            AIX*)
 
 
     ac_ext=c
 ac_cpp='$CPP $CPPFLAGS'
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-    { $as_echo "$as_me:$LINENO: checking whether we are using the IBM xlC C compiler" >&5
-$as_echo_n "checking whether we are using the IBM xlC C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___xlC__+set}" = set; then
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+    { $as_echo "$as_me:$LINENO: checking whether we are using the Intel C compiler" >&5
+$as_echo_n "checking whether we are using the Intel C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___INTEL_COMPILER+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -5470,7 +4324,7 @@
 main ()
 {
 
-             #ifndef __xlC__
+             #ifndef __INTEL_COMPILER
                 choke me
              #endif
 
@@ -5496,12 +4350,12 @@
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___xlC__=yes
+  bakefile_cv_c_compiler___INTEL_COMPILER=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler___xlC__=no
+	bakefile_cv_c_compiler___INTEL_COMPILER=no
 
 fi
 
@@ -5509,10 +4363,10 @@
 
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___xlC__" >&5
-$as_echo "$bakefile_cv_c_compiler___xlC__" >&6; }
-    if test "x$bakefile_cv_c_compiler___xlC__" = "xyes"; then
-        :; XLCC=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___INTEL_COMPILER" >&5
+$as_echo "$bakefile_cv_c_compiler___INTEL_COMPILER" >&6; }
+    if test "x$bakefile_cv_c_compiler___INTEL_COMPILER" = "xyes"; then
+        :; INTELCC=yes
     else
         :;
     fi
@@ -5524,9 +4378,8 @@
 
 
 
-                ;;
 
-            Darwin)
+        if test "$INTELCC" = "yes"; then
 
 
     ac_ext=c
@@ -5535,9 +4388,9 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the Metrowerks C compiler" >&5
-$as_echo_n "checking whether we are using the Metrowerks C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___MWERKS__+set}" = set; then
+    { $as_echo "$as_me:$LINENO: checking whether we are using Intel C compiler v8 or later" >&5
+$as_echo_n "checking whether we are using Intel C compiler v8 or later... " >&6; }
+if test "${bakefile_cv_c_compiler___INTEL_COMPILER_lt_800+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -5551,7 +4404,7 @@
 main ()
 {
 
-             #ifndef __MWERKS__
+             #ifndef __INTEL_COMPILER || __INTEL_COMPILER < 800
                 choke me
              #endif
 
@@ -5577,12 +4430,12 @@
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___MWERKS__=yes
+  bakefile_cv_c_compiler___INTEL_COMPILER_lt_800=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler___MWERKS__=no
+	bakefile_cv_c_compiler___INTEL_COMPILER_lt_800=no
 
 fi
 
@@ -5590,10 +4443,10 @@
 
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___MWERKS__" >&5
-$as_echo "$bakefile_cv_c_compiler___MWERKS__" >&6; }
-    if test "x$bakefile_cv_c_compiler___MWERKS__" = "xyes"; then
-        :; MWCC=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___INTEL_COMPILER_lt_800" >&5
+$as_echo "$bakefile_cv_c_compiler___INTEL_COMPILER_lt_800" >&6; }
+    if test "x$bakefile_cv_c_compiler___INTEL_COMPILER_lt_800" = "xyes"; then
+        :; INTELCC8=yes
     else
         :;
     fi
@@ -5605,7 +4458,6 @@
 
 
 
-                if test "$MWCC" != "yes"; then
 
 
     ac_ext=c
@@ -5614,9 +4466,9 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the IBM xlC C compiler" >&5
-$as_echo_n "checking whether we are using the IBM xlC C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___xlC__+set}" = set; then
+    { $as_echo "$as_me:$LINENO: checking whether we are using Intel C compiler v10 or later" >&5
+$as_echo_n "checking whether we are using Intel C compiler v10 or later... " >&6; }
+if test "${bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -5630,7 +4482,7 @@
 main ()
 {
 
-             #ifndef __xlC__
+             #ifndef __INTEL_COMPILER || __INTEL_COMPILER < 1000
                 choke me
              #endif
 
@@ -5656,12 +4508,12 @@
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___xlC__=yes
+  bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler___xlC__=no
+	bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000=no
 
 fi
 
@@ -5669,10 +4521,10 @@
 
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___xlC__" >&5
-$as_echo "$bakefile_cv_c_compiler___xlC__" >&6; }
-    if test "x$bakefile_cv_c_compiler___xlC__" = "xyes"; then
-        :; XLCC=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000" >&5
+$as_echo "$bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000" >&6; }
+    if test "x$bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000" = "xyes"; then
+        :; INTELCC10=yes
     else
         :;
     fi
@@ -5685,22 +4537,82 @@
 
 
                 fi
+
+        if test "x$GCC" != "xyes"; then
+        if test "xCC" = "xC"; then
+            { $as_echo "$as_me:$LINENO: checking if the C++ compiler requires -ext o" >&5
+$as_echo_n "checking if the C++ compiler requires -ext o... " >&6; }
+if test "${bakefile_cv_cxx_exto+set}" = set; then
+  $as_echo_n "(cached) " >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest.$ac_ext.o
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>&5
+  ac_status=$?
+  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; then
+  for ac_file in `(ls conftest.* 2>/dev/null)`; do
+    case $ac_file in
+        conftest.$ac_ext.o)
+            bakefile_cv_cxx_exto="-ext o"
                 ;;
+        *)
+            ;;
+    esac
+done
+else
+  { { $as_echo "$as_me:$LINENO: error: in \`$ac_pwd':" >&5
+$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+{ { $as_echo "$as_me:$LINENO: error: cannot figure out if compiler needs -ext o: cannot compile
+See \`config.log' for more details." >&5
+$as_echo "$as_me: error: cannot figure out if compiler needs -ext o: cannot compile
+See \`config.log' for more details." >&2;}
+   { (exit 1); exit 1; }; }; }
 
-            IRIX*)
+fi
 
+rm -f conftest.$ac_ext.o conftest.$ac_objext conftest.$ac_ext
 
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
+fi
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_cxx_exto" >&5
+$as_echo "$bakefile_cv_cxx_exto" >&6; }
+if test "x$bakefile_cv_cxx_exto" '!=' "x"; then
+    if test "cxx" = "c"; then
+        CFLAGS="$bakefile_cv_cxx_exto $CFLAGS"
+    fi
+    if test "cxx" = "cxx"; then
+        CXXFLAGS="$bakefile_cv_cxx_exto $CXXFLAGS"
+    fi
+fi
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the SGI C compiler" >&5
-$as_echo_n "checking whether we are using the SGI C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler__SGI_COMPILER_VERSION+set}" = set; then
+            if test "x$bakefile_cv_c_exto" '!=' "x"; then
+                unset ac_cv_prog_cc_g
+                ac_test_CFLAGS=${CFLAGS+set}
+ac_save_CFLAGS=$CFLAGS
+{ $as_echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
+$as_echo_n "checking whether $CC accepts -g... " >&6; }
+if test "${ac_cv_prog_cc_g+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
+  ac_save_c_werror_flag=$ac_c_werror_flag
+   ac_c_werror_flag=yes
+   ac_cv_prog_cc_g=no
+   CFLAGS="-g"
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5712,10 +4624,6 @@
 main ()
 {
 
-             #ifndef _SGI_COMPILER_VERSION
-                choke me
-             #endif
-
   ;
   return 0;
 }
@@ -5735,54 +4643,55 @@
   cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
+	 test -z "$ac_cxx_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler__SGI_COMPILER_VERSION=yes
+  ac_cv_prog_cc_g=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler__SGI_COMPILER_VERSION=no
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+	CFLAGS=""
+      cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
 
+int
+main ()
+{
 
-fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler__SGI_COMPILER_VERSION" >&5
-$as_echo "$bakefile_cv_c_compiler__SGI_COMPILER_VERSION" >&6; }
-    if test "x$bakefile_cv_c_compiler__SGI_COMPILER_VERSION" = "xyes"; then
-        :; SGICC=yes
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
+$as_echo "$ac_try_echo") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_cxx_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  :
     else
-        :;
-    fi
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
-                ;;
-
-            Linux*)
-                                                if test "$INTELCC" != "yes"; then
-
-
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
+  $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the Sun C compiler" >&5
-$as_echo_n "checking whether we are using the Sun C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___SUNPRO_C+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
+	ac_c_werror_flag=$ac_save_c_werror_flag
+	 CFLAGS="-g"
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5794,10 +4703,6 @@
 main ()
 {
 
-             #ifndef __SUNPRO_C
-                choke me
-             #endif
-
   ;
   return 0;
 }
@@ -5817,41 +4722,48 @@
   cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
+	 test -z "$ac_cxx_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___SUNPRO_C=yes
+  ac_cv_prog_cc_g=yes
+else
+  $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+   ac_c_werror_flag=$ac_save_c_werror_flag
+fi
+{ $as_echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
+$as_echo "$ac_cv_prog_cc_g" >&6; }
+if test "$ac_test_CFLAGS" = set; then
+  CFLAGS=$ac_save_CFLAGS
+elif test $ac_cv_prog_cc_g = yes; then
+  if test "$GCC" = yes; then
+    CFLAGS="-g -O2"
+  else
+    CFLAGS="-g"
+  fi
 else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	bakefile_cv_c_compiler___SUNPRO_C=no
-
+  if test "$GCC" = yes; then
+    CFLAGS="-O2"
+  else
+    CFLAGS=
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-
-
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___SUNPRO_C" >&5
-$as_echo "$bakefile_cv_c_compiler___SUNPRO_C" >&6; }
-    if test "x$bakefile_cv_c_compiler___SUNPRO_C" = "xyes"; then
-        :; SUNCC=yes
-    else
-        :;
     fi
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
                 fi
-                ;;
 
-            HP-UX*)
+                        case `uname -s` in
+            AIX*)
 
 
     ac_ext=c
@@ -5860,9 +4772,9 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the HP C compiler" >&5
-$as_echo_n "checking whether we are using the HP C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___HP_cc+set}" = set; then
+    { $as_echo "$as_me:$LINENO: checking whether we are using the IBM xlC C compiler" >&5
+$as_echo_n "checking whether we are using the IBM xlC C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___xlC__+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -5876,7 +4788,7 @@
 main ()
 {
 
-             #ifndef __HP_cc
+             #ifndef __xlC__
                 choke me
              #endif
 
@@ -5902,12 +4814,12 @@
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___HP_cc=yes
+  bakefile_cv_c_compiler___xlC__=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler___HP_cc=no
+	bakefile_cv_c_compiler___xlC__=no
 
 fi
 
@@ -5915,10 +4827,10 @@
 
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___HP_cc" >&5
-$as_echo "$bakefile_cv_c_compiler___HP_cc" >&6; }
-    if test "x$bakefile_cv_c_compiler___HP_cc" = "xyes"; then
-        :; HPCC=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___xlC__" >&5
+$as_echo "$bakefile_cv_c_compiler___xlC__" >&6; }
+    if test "x$bakefile_cv_c_compiler___xlC__" = "xyes"; then
+        :; XLCC=yes
     else
         :;
     fi
@@ -5932,7 +4844,7 @@
 
                 ;;
 
-            OSF1)
+            Darwin)
 
 
     ac_ext=c
@@ -5941,9 +4853,9 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the Compaq C compiler" >&5
-$as_echo_n "checking whether we are using the Compaq C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___DECC+set}" = set; then
+    { $as_echo "$as_me:$LINENO: checking whether we are using the Metrowerks C compiler" >&5
+$as_echo_n "checking whether we are using the Metrowerks C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___MWERKS__+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -5957,7 +4869,7 @@
 main ()
 {
 
-             #ifndef __DECC
+             #ifndef __MWERKS__
                 choke me
              #endif
 
@@ -5983,12 +4895,12 @@
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___DECC=yes
+  bakefile_cv_c_compiler___MWERKS__=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler___DECC=no
+	bakefile_cv_c_compiler___MWERKS__=no
 
 fi
 
@@ -5996,10 +4908,10 @@
 
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___DECC" >&5
-$as_echo "$bakefile_cv_c_compiler___DECC" >&6; }
-    if test "x$bakefile_cv_c_compiler___DECC" = "xyes"; then
-        :; COMPAQCC=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___MWERKS__" >&5
+$as_echo "$bakefile_cv_c_compiler___MWERKS__" >&6; }
+    if test "x$bakefile_cv_c_compiler___MWERKS__" = "xyes"; then
+        :; MWCC=yes
     else
         :;
     fi
@@ -6011,9 +4923,7 @@
 
 
 
-                ;;
-
-            SunOS)
+                if test "$MWCC" != "yes"; then
 
 
     ac_ext=c
@@ -6022,9 +4932,9 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the Sun C compiler" >&5
-$as_echo_n "checking whether we are using the Sun C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___SUNPRO_C+set}" = set; then
+    { $as_echo "$as_me:$LINENO: checking whether we are using the IBM xlC C compiler" >&5
+$as_echo_n "checking whether we are using the IBM xlC C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___xlC__+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -6038,7 +4948,7 @@
 main ()
 {
 
-             #ifndef __SUNPRO_C
+             #ifndef __xlC__
                 choke me
              #endif
 
@@ -6064,12 +4974,12 @@
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___SUNPRO_C=yes
+  bakefile_cv_c_compiler___xlC__=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler___SUNPRO_C=no
+	bakefile_cv_c_compiler___xlC__=no
 
 fi
 
@@ -6077,10 +4987,10 @@
 
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___SUNPRO_C" >&5
-$as_echo "$bakefile_cv_c_compiler___SUNPRO_C" >&6; }
-    if test "x$bakefile_cv_c_compiler___SUNPRO_C" = "xyes"; then
-        :; SUNCC=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___xlC__" >&5
+$as_echo "$bakefile_cv_c_compiler___xlC__" >&6; }
+    if test "x$bakefile_cv_c_compiler___xlC__" = "xyes"; then
+        :; XLCC=yes
     else
         :;
     fi
@@ -6092,166 +5002,103 @@
 
 
 
-                ;;
-        esac
     fi
+                ;;
 
+            IRIX*)
 
 
+    ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
-
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-if test -z "$CXX"; then
-  if test -n "$CCC"; then
-    CXX=$CCC
-  else
-    if test -n "$ac_tool_prefix"; then
-  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CXX+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CXX"; then
-  ac_cv_prog_CXX="$CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CXX="$ac_tool_prefix$ac_prog"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CXX=$ac_cv_prog_CXX
-if test -n "$CXX"; then
-  { $as_echo "$as_me:$LINENO: result: $CXX" >&5
-$as_echo "$CXX" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-    test -n "$CXX" && break
-  done
-fi
-if test -z "$CXX"; then
-  ac_ct_CXX=$CXX
-  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_ac_ct_CXX+set}" = set; then
+    { $as_echo "$as_me:$LINENO: checking whether we are using the SGI C compiler" >&5
+$as_echo_n "checking whether we are using the SGI C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler__SGI_COMPILER_VERSION+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
-  if test -n "$ac_ct_CXX"; then
-  ac_cv_prog_ac_ct_CXX="$ac_ct_CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CXX="$ac_prog"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CXX=$ac_cv_prog_ac_ct_CXX
-if test -n "$ac_ct_CXX"; then
-  { $as_echo "$as_me:$LINENO: result: $ac_ct_CXX" >&5
-$as_echo "$ac_ct_CXX" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
 
-  test -n "$ac_ct_CXX" && break
-done
+int
+main ()
+{
 
-  if test "x$ac_ct_CXX" = x; then
-    CXX="g++"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:$LINENO: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    CXX=$ac_ct_CXX
-  fi
-fi
+             #ifndef _SGI_COMPILER_VERSION
+                choke me
+             #endif
 
-  fi
-fi
-# Provide some information about the compiler.
-$as_echo "$as_me:$LINENO: checking for C++ compiler version" >&5
-set X $ac_compile
-ac_compiler=$2
-{ (ac_try="$ac_compiler --version >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compiler --version >&5") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -v >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compiler -v >&5") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -V >&5"
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
 case "(($ac_try" in
   *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
   *) ac_try_echo=$ac_try;;
 esac
 eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
 $as_echo "$ac_try_echo") >&5
-  (eval "$ac_compiler -V >&5") 2>&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  bakefile_cv_c_compiler__SGI_COMPILER_VERSION=yes
+else
+  $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
-{ $as_echo "$as_me:$LINENO: checking whether we are using the GNU C++ compiler" >&5
-$as_echo_n "checking whether we are using the GNU C++ compiler... " >&6; }
-if test "${ac_cv_cxx_compiler_gnu+set}" = set; then
+	bakefile_cv_c_compiler__SGI_COMPILER_VERSION=no
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+
+fi
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler__SGI_COMPILER_VERSION" >&5
+$as_echo "$bakefile_cv_c_compiler__SGI_COMPILER_VERSION" >&6; }
+    if test "x$bakefile_cv_c_compiler__SGI_COMPILER_VERSION" = "xyes"; then
+        :; SGICC=yes
+    else
+        :;
+    fi
+    ac_ext=cpp
+ac_cpp='$CXXCPP $CPPFLAGS'
+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
+
+
+
+                ;;
+
+            Linux*)
+                                                if test "$INTELCC" != "yes"; then
+
+
+    ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+    { $as_echo "$as_me:$LINENO: checking whether we are using the Sun C compiler" >&5
+$as_echo_n "checking whether we are using the Sun C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___SUNPRO_C+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -6264,7 +5111,8 @@
 int
 main ()
 {
-#ifndef __GNUC__
+
+             #ifndef __SUNPRO_C
        choke me
 #endif
 
@@ -6287,39 +5135,54 @@
   cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
+	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  ac_compiler_gnu=yes
+  bakefile_cv_c_compiler___SUNPRO_C=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_compiler_gnu=no
+	bakefile_cv_c_compiler___SUNPRO_C=no
+
 fi
 
 rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_cxx_compiler_gnu=$ac_compiler_gnu
+
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $ac_cv_cxx_compiler_gnu" >&5
-$as_echo "$ac_cv_cxx_compiler_gnu" >&6; }
-if test $ac_compiler_gnu = yes; then
-  GXX=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___SUNPRO_C" >&5
+$as_echo "$bakefile_cv_c_compiler___SUNPRO_C" >&6; }
+    if test "x$bakefile_cv_c_compiler___SUNPRO_C" = "xyes"; then
+        :; SUNCC=yes
 else
-  GXX=
+        :;
 fi
-ac_test_CXXFLAGS=${CXXFLAGS+set}
-ac_save_CXXFLAGS=$CXXFLAGS
-{ $as_echo "$as_me:$LINENO: checking whether $CXX accepts -g" >&5
-$as_echo_n "checking whether $CXX accepts -g... " >&6; }
-if test "${ac_cv_prog_cxx_g+set}" = set; then
+    ac_ext=cpp
+ac_cpp='$CXXCPP $CPPFLAGS'
+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
+
+
+
+                fi
+                ;;
+
+            HP-UX*)
+
+
+    ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+    { $as_echo "$as_me:$LINENO: checking whether we are using the HP C compiler" >&5
+$as_echo_n "checking whether we are using the HP C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___HP_cc+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
-  ac_save_cxx_werror_flag=$ac_cxx_werror_flag
-   ac_cxx_werror_flag=yes
-   ac_cv_prog_cxx_g=no
-   CXXFLAGS="-g"
    cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -6331,6 +5194,10 @@
 main ()
 {
 
+             #ifndef __HP_cc
+                choke me
+             #endif
+
   ;
   return 0;
 }
@@ -6350,15 +5217,53 @@
   cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
+	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cxx_g=yes
+  bakefile_cv_c_compiler___HP_cc=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	CXXFLAGS=""
+	bakefile_cv_c_compiler___HP_cc=no
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+
+fi
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___HP_cc" >&5
+$as_echo "$bakefile_cv_c_compiler___HP_cc" >&6; }
+    if test "x$bakefile_cv_c_compiler___HP_cc" = "xyes"; then
+        :; HPCC=yes
+    else
+        :;
+    fi
+    ac_ext=cpp
+ac_cpp='$CXXCPP $CPPFLAGS'
+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
+
+
+
+                ;;
+
+            OSF1)
+
+
+    ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+    { $as_echo "$as_me:$LINENO: checking whether we are using the Compaq C compiler" >&5
+$as_echo_n "checking whether we are using the Compaq C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___DECC+set}" = set; then
+  $as_echo_n "(cached) " >&6
+else
       cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -6370,6 +5275,10 @@
 main ()
 {
 
+             #ifndef __DECC
+                choke me
+             #endif
+
   ;
   return 0;
 }
@@ -6389,16 +5298,53 @@
   cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
+	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  :
+  bakefile_cv_c_compiler___DECC=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-	 CXXFLAGS="-g"
+	bakefile_cv_c_compiler___DECC=no
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+
+fi
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___DECC" >&5
+$as_echo "$bakefile_cv_c_compiler___DECC" >&6; }
+    if test "x$bakefile_cv_c_compiler___DECC" = "xyes"; then
+        :; COMPAQCC=yes
+    else
+        :;
+    fi
+    ac_ext=cpp
+ac_cpp='$CXXCPP $CPPFLAGS'
+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
+
+
+
+                ;;
+
+            SunOS)
+
+
+    ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+    { $as_echo "$as_me:$LINENO: checking whether we are using the Sun C compiler" >&5
+$as_echo_n "checking whether we are using the Sun C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___SUNPRO_C+set}" = set; then
+  $as_echo_n "(cached) " >&6
+else
 	 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -6410,6 +5356,10 @@
 main ()
 {
 
+             #ifndef __SUNPRO_C
+                choke me
+             #endif
+
   ;
   return 0;
 }
@@ -6429,42 +5379,28 @@
   cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
+	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cxx_g=yes
+  bakefile_cv_c_compiler___SUNPRO_C=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
+	bakefile_cv_c_compiler___SUNPRO_C=no
 
 fi
 
 rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
 
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
 
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-fi
-{ $as_echo "$as_me:$LINENO: result: $ac_cv_prog_cxx_g" >&5
-$as_echo "$ac_cv_prog_cxx_g" >&6; }
-if test "$ac_test_CXXFLAGS" = set; then
-  CXXFLAGS=$ac_save_CXXFLAGS
-elif test $ac_cv_prog_cxx_g = yes; then
-  if test "$GXX" = yes; then
-    CXXFLAGS="-g -O2"
-  else
-    CXXFLAGS="-g"
   fi
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___SUNPRO_C" >&5
+$as_echo "$bakefile_cv_c_compiler___SUNPRO_C" >&6; }
+    if test "x$bakefile_cv_c_compiler___SUNPRO_C" = "xyes"; then
+        :; SUNCC=yes
 else
-  if test "$GXX" = yes; then
-    CXXFLAGS="-O2"
-  else
-    CXXFLAGS=
-  fi
+        :;
 fi
 ac_ext=cpp
 ac_cpp='$CXXCPP $CPPFLAGS'
@@ -6474,6 +5410,17 @@
 
 
 
+                ;;
+        esac
+    fi
+
+
+
+
+
+
+
+
 
     ac_ext=cpp
 ac_cpp='$CXXCPP $CPPFLAGS'
@@ -9613,10 +8560,10 @@
 
 
 
-    BAKEFILE_BAKEFILE_M4_VERSION="0.2.8"
+    BAKEFILE_BAKEFILE_M4_VERSION="0.2.9"
 
 
-BAKEFILE_AUTOCONF_INC_M4_VERSION="0.2.8"
+BAKEFILE_AUTOCONF_INC_M4_VERSION="0.2.9"
 
     COND_DEPS_TRACKING_0="#"
     if test "x$DEPS_TRACKING" = "x0" ; then
@@ -10209,7 +9156,7 @@
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by wxpdfdoc $as_me 0.9.1, which was
+This file was extended by wxpdfdoc $as_me 0.9.3, which was
 generated by GNU Autoconf 2.63.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
@@ -10259,7 +9206,7 @@
 _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 ac_cs_version="\\
-wxpdfdoc config.status 0.9.1
+wxpdfdoc config.status 0.9.3
 configured by $0, generated by GNU Autoconf 2.63,
   with options \\"`$as_echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`\\"
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/configure28 wxPdfDoc-copy/configure28
--- wxpdfdoc-0.9.2.1/configure28	2011-01-14 19:27:10.000000000 +0000
+++ wxPdfDoc-copy/configure28	2012-05-26 17:57:54.160100000 +0100
@@ -1,6 +1,6 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.63 for wxpdfdoc 0.9.1.
+# Generated by GNU Autoconf 2.63 for wxpdfdoc 0.9.3.
 #
 # Report bugs to <utelle@users.sourceforge.net>.
 #
@@ -596,8 +596,8 @@
 # Identity of this package.
 PACKAGE_NAME='wxpdfdoc'
 PACKAGE_TARNAME='wxpdfdoc'
-PACKAGE_VERSION='0.9.1'
-PACKAGE_STRING='wxpdfdoc 0.9.1'
+PACKAGE_VERSION='0.9.3'
+PACKAGE_STRING='wxpdfdoc 0.9.3'
 PACKAGE_BUGREPORT='utelle@users.sourceforge.net'
 
 ac_subst_vars='LTLIBOBJS
@@ -1331,7 +1331,7 @@
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures wxpdfdoc 0.9.1 to adapt to many kinds of systems.
+\`configure' configures wxpdfdoc 0.9.3 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
@@ -1397,7 +1397,7 @@
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of wxpdfdoc 0.9.1:";;
+     short | recursive ) echo "Configuration of wxpdfdoc 0.9.3:";;
    esac
   cat <<\_ACEOF
 
@@ -1505,7 +1505,7 @@
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-wxpdfdoc configure 0.9.1
+wxpdfdoc configure 0.9.3
 generated by GNU Autoconf 2.63
 
 Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
@@ -1519,7 +1519,7 @@
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by wxpdfdoc $as_me 0.9.1, which was
+It was created by wxpdfdoc $as_me 0.9.3, which was
 generated by GNU Autoconf 2.63.  Invocation command line was
 
   $ $0 $@
@@ -2612,11 +2612,11 @@
     if test -n "$wx_ver_ok"; then
       { $as_echo "$as_me:$LINENO: result: yes (version $WX_VERSION)" >&5
 $as_echo "yes (version $WX_VERSION)" >&6; }
-      WX_LIBS=`$WX_CONFIG_WITH_ARGS --libs core,base,xml`
+      WX_LIBS=`$WX_CONFIG_WITH_ARGS --libs core,base,xml,adv,html,richtext`
 
                               { $as_echo "$as_me:$LINENO: checking for wxWidgets static library" >&5
 $as_echo_n "checking for wxWidgets static library... " >&6; }
-      WX_LIBS_STATIC=`$WX_CONFIG_WITH_ARGS --static --libs core,base,xml 2>/dev/null`
+      WX_LIBS_STATIC=`$WX_CONFIG_WITH_ARGS --static --libs core,base,xml,adv,html,richtext 2>/dev/null`
       if test "x$WX_LIBS_STATIC" = "x"; then
         { $as_echo "$as_me:$LINENO: result: no" >&5
 $as_echo "no" >&6; }
@@ -2659,16 +2659,16 @@
       fi
 
       if test "x$wx_has_cppflags" = x ; then
-                  WX_CFLAGS=`$WX_CONFIG_WITH_ARGS --cflags core,base,xml`
+                  WX_CFLAGS=`$WX_CONFIG_WITH_ARGS --cflags core,base,xml,adv,html,richtext`
          WX_CPPFLAGS=$WX_CFLAGS
          WX_CXXFLAGS=$WX_CFLAGS
 
          WX_CFLAGS_ONLY=$WX_CFLAGS
          WX_CXXFLAGS_ONLY=$WX_CFLAGS
       else
-                  WX_CPPFLAGS=`$WX_CONFIG_WITH_ARGS --cppflags core,base,xml`
-         WX_CXXFLAGS=`$WX_CONFIG_WITH_ARGS --cxxflags core,base,xml`
-         WX_CFLAGS=`$WX_CONFIG_WITH_ARGS --cflags core,base,xml`
+                  WX_CPPFLAGS=`$WX_CONFIG_WITH_ARGS --cppflags core,base,xml,adv,html,richtext`
+         WX_CXXFLAGS=`$WX_CONFIG_WITH_ARGS --cxxflags core,base,xml,adv,html,richtext`
+         WX_CFLAGS=`$WX_CONFIG_WITH_ARGS --cflags core,base,xml,adv,html,richtext`
 
          WX_CFLAGS_ONLY=`echo $WX_CFLAGS | sed "s@^$WX_CPPFLAGS *@@"`
          WX_CXXFLAGS_ONLY=`echo $WX_CXXFLAGS | sed "s@^$WX_CFLAGS *@@"`
@@ -4298,1165 +4298,19 @@
 
 
 
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}gcc; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="${ac_tool_prefix}gcc"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:$LINENO: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-fi
-if test -z "$ac_cv_prog_CC"; then
-  ac_ct_CC=$CC
-  # Extract the first word of "gcc", so it can be a program name with args.
-set dummy gcc; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CC="gcc"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  { $as_echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-$as_echo "$ac_ct_CC" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:$LINENO: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
-else
-  CC="$ac_cv_prog_CC"
-fi
-
-if test -z "$CC"; then
-          if test -n "$ac_tool_prefix"; then
-    # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}cc; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="${ac_tool_prefix}cc"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:$LINENO: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-  fi
-fi
-if test -z "$CC"; then
-  # Extract the first word of "cc", so it can be a program name with args.
-set dummy cc; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-  ac_prog_rejected=no
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
-       ac_prog_rejected=yes
-       continue
-     fi
-    ac_cv_prog_CC="cc"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-if test $ac_prog_rejected = yes; then
-  # We found a bogon in the path, so make sure we never use it.
-  set dummy $ac_cv_prog_CC
-  shift
-  if test $# != 0; then
-    # We chose a different compiler from the bogus one.
-    # However, it has the same basename, so the bogon will be chosen
-    # first if we set CC to just the basename; use the full file name.
-    shift
-    ac_cv_prog_CC="$as_dir/$ac_word${1+' '}$@"
-  fi
-fi
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:$LINENO: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-fi
-if test -z "$CC"; then
-  if test -n "$ac_tool_prefix"; then
-  for ac_prog in cl.exe
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:$LINENO: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-    test -n "$CC" && break
-  done
-fi
-if test -z "$CC"; then
-  ac_ct_CC=$CC
-  for ac_prog in cl.exe
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CC="$ac_prog"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  { $as_echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-$as_echo "$ac_ct_CC" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-  test -n "$ac_ct_CC" && break
-done
-
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:$LINENO: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
-fi
-
-fi
-
-
-test -z "$CC" && { { $as_echo "$as_me:$LINENO: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-{ { $as_echo "$as_me:$LINENO: error: no acceptable C compiler found in \$PATH
-See \`config.log' for more details." >&5
-$as_echo "$as_me: error: no acceptable C compiler found in \$PATH
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }; }
-
-# Provide some information about the compiler.
-$as_echo "$as_me:$LINENO: checking for C compiler version" >&5
-set X $ac_compile
-ac_compiler=$2
-{ (ac_try="$ac_compiler --version >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compiler --version >&5") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -v >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compiler -v >&5") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -V >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compiler -V >&5") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-
-{ $as_echo "$as_me:$LINENO: checking whether we are using the GNU C compiler" >&5
-$as_echo_n "checking whether we are using the GNU C compiler... " >&6; }
-if test "${ac_cv_c_compiler_gnu+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_compiler_gnu=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_compiler_gnu=no
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_c_compiler_gnu=$ac_compiler_gnu
-
-fi
-{ $as_echo "$as_me:$LINENO: result: $ac_cv_c_compiler_gnu" >&5
-$as_echo "$ac_cv_c_compiler_gnu" >&6; }
-if test $ac_compiler_gnu = yes; then
-  GCC=yes
-else
-  GCC=
-fi
-ac_test_CFLAGS=${CFLAGS+set}
-ac_save_CFLAGS=$CFLAGS
-{ $as_echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
-$as_echo_n "checking whether $CC accepts -g... " >&6; }
-if test "${ac_cv_prog_cc_g+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  ac_save_c_werror_flag=$ac_c_werror_flag
-   ac_c_werror_flag=yes
-   ac_cv_prog_cc_g=no
-   CFLAGS="-g"
-   cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	CFLAGS=""
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  :
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_c_werror_flag=$ac_save_c_werror_flag
-	 CFLAGS="-g"
-	 cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_c_werror_flag=$ac_save_c_werror_flag
-fi
-{ $as_echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
-$as_echo "$ac_cv_prog_cc_g" >&6; }
-if test "$ac_test_CFLAGS" = set; then
-  CFLAGS=$ac_save_CFLAGS
-elif test $ac_cv_prog_cc_g = yes; then
-  if test "$GCC" = yes; then
-    CFLAGS="-g -O2"
-  else
-    CFLAGS="-g"
-  fi
-else
-  if test "$GCC" = yes; then
-    CFLAGS="-O2"
-  else
-    CFLAGS=
-  fi
-fi
-{ $as_echo "$as_me:$LINENO: checking for $CC option to accept ISO C89" >&5
-$as_echo_n "checking for $CC option to accept ISO C89... " >&6; }
-if test "${ac_cv_prog_cc_c89+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  ac_cv_prog_cc_c89=no
-ac_save_CC=$CC
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <stdarg.h>
-#include <stdio.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-/* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
-struct buf { int x; };
-FILE * (*rcsopen) (struct buf *, struct stat *, int);
-static char *e (p, i)
-     char **p;
-     int i;
-{
-  return p[i];
-}
-static char *f (char * (*g) (char **, int), char **p, ...)
-{
-  char *s;
-  va_list v;
-  va_start (v,p);
-  s = g (p, va_arg (v,int));
-  va_end (v);
-  return s;
-}
-
-/* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
-   function prototypes and stuff, but not '\xHH' hex character constants.
-   These don't provoke an error unfortunately, instead are silently treated
-   as 'x'.  The following induces an error, until -std is added to get
-   proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
-   array size at least.  It's necessary to write '\x00'==0 to get something
-   that's true only with -std.  */
-int osf4_cc_array ['\x00' == 0 ? 1 : -1];
-
-/* IBM C 6 for AIX is almost-ANSI by default, but it replaces macro parameters
-   inside strings and character constants.  */
-#define FOO(x) 'x'
-int xlc6_cc_array[FOO(a) == 'x' ? 1 : -1];
-
-int test (int i, double x);
-struct s1 {int (*f) (int a);};
-struct s2 {int (*f) (double a);};
-int pairnames (int, char **, FILE *(*)(struct buf *, struct stat *, int), int, int);
-int argc;
-char **argv;
-int
-main ()
-{
-return f (e, argv, 0) != argv[0]  ||  f (e, argv, 1) != argv[1];
-  ;
-  return 0;
-}
-_ACEOF
-for ac_arg in '' -qlanglvl=extc89 -qlanglvl=ansi -std \
-	-Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
-do
-  CC="$ac_save_CC $ac_arg"
-  rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_c89=$ac_arg
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext
-  test "x$ac_cv_prog_cc_c89" != "xno" && break
-done
-rm -f conftest.$ac_ext
-CC=$ac_save_CC
-
-fi
-# AC_CACHE_VAL
-case "x$ac_cv_prog_cc_c89" in
-  x)
-    { $as_echo "$as_me:$LINENO: result: none needed" >&5
-$as_echo "none needed" >&6; } ;;
-  xno)
-    { $as_echo "$as_me:$LINENO: result: unsupported" >&5
-$as_echo "unsupported" >&6; } ;;
-  *)
-    CC="$CC $ac_cv_prog_cc_c89"
-    { $as_echo "$as_me:$LINENO: result: $ac_cv_prog_cc_c89" >&5
-$as_echo "$ac_cv_prog_cc_c89" >&6; } ;;
-esac
-
-
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
-
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-    { $as_echo "$as_me:$LINENO: checking whether we are using the Intel C compiler" >&5
-$as_echo_n "checking whether we are using the Intel C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___INTEL_COMPILER+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-             #ifndef __INTEL_COMPILER
-                choke me
-             #endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___INTEL_COMPILER=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	bakefile_cv_c_compiler___INTEL_COMPILER=no
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-
-
-fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___INTEL_COMPILER" >&5
-$as_echo "$bakefile_cv_c_compiler___INTEL_COMPILER" >&6; }
-    if test "x$bakefile_cv_c_compiler___INTEL_COMPILER" = "xyes"; then
-        :; INTELCC=yes
-    else
-        :;
-    fi
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
-
-        if test "$INTELCC" = "yes"; then
-
-
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-    { $as_echo "$as_me:$LINENO: checking whether we are using Intel C compiler v8 or later" >&5
-$as_echo_n "checking whether we are using Intel C compiler v8 or later... " >&6; }
-if test "${bakefile_cv_c_compiler___INTEL_COMPILER_lt_800+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-             #ifndef __INTEL_COMPILER || __INTEL_COMPILER < 800
-                choke me
-             #endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___INTEL_COMPILER_lt_800=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	bakefile_cv_c_compiler___INTEL_COMPILER_lt_800=no
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-
-
-fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___INTEL_COMPILER_lt_800" >&5
-$as_echo "$bakefile_cv_c_compiler___INTEL_COMPILER_lt_800" >&6; }
-    if test "x$bakefile_cv_c_compiler___INTEL_COMPILER_lt_800" = "xyes"; then
-        :; INTELCC8=yes
-    else
-        :;
-    fi
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
-
-
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-    { $as_echo "$as_me:$LINENO: checking whether we are using Intel C compiler v10 or later" >&5
-$as_echo_n "checking whether we are using Intel C compiler v10 or later... " >&6; }
-if test "${bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-             #ifndef __INTEL_COMPILER || __INTEL_COMPILER < 1000
-                choke me
-             #endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000=no
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-
-
-fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000" >&5
-$as_echo "$bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000" >&6; }
-    if test "x$bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000" = "xyes"; then
-        :; INTELCC10=yes
-    else
-        :;
-    fi
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
-    fi
-
-        if test "x$GCC" != "xyes"; then
-        if test "xCC" = "xC"; then
-            { $as_echo "$as_me:$LINENO: checking if the C++ compiler requires -ext o" >&5
-$as_echo_n "checking if the C++ compiler requires -ext o... " >&6; }
-if test "${bakefile_cv_cxx_exto+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest.$ac_ext.o
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  for ac_file in `(ls conftest.* 2>/dev/null)`; do
-    case $ac_file in
-        conftest.$ac_ext.o)
-            bakefile_cv_cxx_exto="-ext o"
-            ;;
-        *)
-            ;;
-    esac
-done
-else
-  { { $as_echo "$as_me:$LINENO: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-{ { $as_echo "$as_me:$LINENO: error: cannot figure out if compiler needs -ext o: cannot compile
-See \`config.log' for more details." >&5
-$as_echo "$as_me: error: cannot figure out if compiler needs -ext o: cannot compile
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }; }
-
-fi
-
-rm -f conftest.$ac_ext.o conftest.$ac_objext conftest.$ac_ext
-
-fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_cxx_exto" >&5
-$as_echo "$bakefile_cv_cxx_exto" >&6; }
-if test "x$bakefile_cv_cxx_exto" '!=' "x"; then
-    if test "cxx" = "c"; then
-        CFLAGS="$bakefile_cv_cxx_exto $CFLAGS"
-    fi
-    if test "cxx" = "cxx"; then
-        CXXFLAGS="$bakefile_cv_cxx_exto $CXXFLAGS"
-    fi
-fi
-
-            if test "x$bakefile_cv_c_exto" '!=' "x"; then
-                unset ac_cv_prog_cc_g
-                ac_test_CFLAGS=${CFLAGS+set}
-ac_save_CFLAGS=$CFLAGS
-{ $as_echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
-$as_echo_n "checking whether $CC accepts -g... " >&6; }
-if test "${ac_cv_prog_cc_g+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  ac_save_c_werror_flag=$ac_c_werror_flag
-   ac_c_werror_flag=yes
-   ac_cv_prog_cc_g=no
-   CFLAGS="-g"
-   cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	CFLAGS=""
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  :
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_c_werror_flag=$ac_save_c_werror_flag
-	 CFLAGS="-g"
-	 cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
 
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_c_werror_flag=$ac_save_c_werror_flag
-fi
-{ $as_echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
-$as_echo "$ac_cv_prog_cc_g" >&6; }
-if test "$ac_test_CFLAGS" = set; then
-  CFLAGS=$ac_save_CFLAGS
-elif test $ac_cv_prog_cc_g = yes; then
-  if test "$GCC" = yes; then
-    CFLAGS="-g -O2"
-  else
-    CFLAGS="-g"
-  fi
-else
-  if test "$GCC" = yes; then
-    CFLAGS="-O2"
-  else
-    CFLAGS=
-  fi
-fi
-            fi
-        fi
 
-                        case `uname -s` in
-            AIX*)
 
 
     ac_ext=c
 ac_cpp='$CPP $CPPFLAGS'
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-    { $as_echo "$as_me:$LINENO: checking whether we are using the IBM xlC C compiler" >&5
-$as_echo_n "checking whether we are using the IBM xlC C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___xlC__+set}" = set; then
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+    { $as_echo "$as_me:$LINENO: checking whether we are using the Intel C compiler" >&5
+$as_echo_n "checking whether we are using the Intel C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___INTEL_COMPILER+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -5470,7 +4324,7 @@
 main ()
 {
 
-             #ifndef __xlC__
+             #ifndef __INTEL_COMPILER
                 choke me
              #endif
 
@@ -5496,12 +4350,12 @@
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___xlC__=yes
+  bakefile_cv_c_compiler___INTEL_COMPILER=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler___xlC__=no
+	bakefile_cv_c_compiler___INTEL_COMPILER=no
 
 fi
 
@@ -5509,10 +4363,10 @@
 
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___xlC__" >&5
-$as_echo "$bakefile_cv_c_compiler___xlC__" >&6; }
-    if test "x$bakefile_cv_c_compiler___xlC__" = "xyes"; then
-        :; XLCC=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___INTEL_COMPILER" >&5
+$as_echo "$bakefile_cv_c_compiler___INTEL_COMPILER" >&6; }
+    if test "x$bakefile_cv_c_compiler___INTEL_COMPILER" = "xyes"; then
+        :; INTELCC=yes
     else
         :;
     fi
@@ -5524,9 +4378,8 @@
 
 
 
-                ;;
 
-            Darwin)
+        if test "$INTELCC" = "yes"; then
 
 
     ac_ext=c
@@ -5535,9 +4388,9 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the Metrowerks C compiler" >&5
-$as_echo_n "checking whether we are using the Metrowerks C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___MWERKS__+set}" = set; then
+    { $as_echo "$as_me:$LINENO: checking whether we are using Intel C compiler v8 or later" >&5
+$as_echo_n "checking whether we are using Intel C compiler v8 or later... " >&6; }
+if test "${bakefile_cv_c_compiler___INTEL_COMPILER_lt_800+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -5551,7 +4404,7 @@
 main ()
 {
 
-             #ifndef __MWERKS__
+             #ifndef __INTEL_COMPILER || __INTEL_COMPILER < 800
                 choke me
              #endif
 
@@ -5577,12 +4430,12 @@
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___MWERKS__=yes
+  bakefile_cv_c_compiler___INTEL_COMPILER_lt_800=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler___MWERKS__=no
+	bakefile_cv_c_compiler___INTEL_COMPILER_lt_800=no
 
 fi
 
@@ -5590,10 +4443,10 @@
 
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___MWERKS__" >&5
-$as_echo "$bakefile_cv_c_compiler___MWERKS__" >&6; }
-    if test "x$bakefile_cv_c_compiler___MWERKS__" = "xyes"; then
-        :; MWCC=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___INTEL_COMPILER_lt_800" >&5
+$as_echo "$bakefile_cv_c_compiler___INTEL_COMPILER_lt_800" >&6; }
+    if test "x$bakefile_cv_c_compiler___INTEL_COMPILER_lt_800" = "xyes"; then
+        :; INTELCC8=yes
     else
         :;
     fi
@@ -5605,7 +4458,6 @@
 
 
 
-                if test "$MWCC" != "yes"; then
 
 
     ac_ext=c
@@ -5614,9 +4466,9 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the IBM xlC C compiler" >&5
-$as_echo_n "checking whether we are using the IBM xlC C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___xlC__+set}" = set; then
+    { $as_echo "$as_me:$LINENO: checking whether we are using Intel C compiler v10 or later" >&5
+$as_echo_n "checking whether we are using Intel C compiler v10 or later... " >&6; }
+if test "${bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -5630,7 +4482,7 @@
 main ()
 {
 
-             #ifndef __xlC__
+             #ifndef __INTEL_COMPILER || __INTEL_COMPILER < 1000
                 choke me
              #endif
 
@@ -5656,12 +4508,12 @@
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___xlC__=yes
+  bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler___xlC__=no
+	bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000=no
 
 fi
 
@@ -5669,10 +4521,10 @@
 
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___xlC__" >&5
-$as_echo "$bakefile_cv_c_compiler___xlC__" >&6; }
-    if test "x$bakefile_cv_c_compiler___xlC__" = "xyes"; then
-        :; XLCC=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000" >&5
+$as_echo "$bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000" >&6; }
+    if test "x$bakefile_cv_c_compiler___INTEL_COMPILER_lt_1000" = "xyes"; then
+        :; INTELCC10=yes
     else
         :;
     fi
@@ -5685,22 +4537,82 @@
 
 
                 fi
+
+        if test "x$GCC" != "xyes"; then
+        if test "xCC" = "xC"; then
+            { $as_echo "$as_me:$LINENO: checking if the C++ compiler requires -ext o" >&5
+$as_echo_n "checking if the C++ compiler requires -ext o... " >&6; }
+if test "${bakefile_cv_cxx_exto+set}" = set; then
+  $as_echo_n "(cached) " >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest.$ac_ext.o
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>&5
+  ac_status=$?
+  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; then
+  for ac_file in `(ls conftest.* 2>/dev/null)`; do
+    case $ac_file in
+        conftest.$ac_ext.o)
+            bakefile_cv_cxx_exto="-ext o"
                 ;;
+        *)
+            ;;
+    esac
+done
+else
+  { { $as_echo "$as_me:$LINENO: error: in \`$ac_pwd':" >&5
+$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+{ { $as_echo "$as_me:$LINENO: error: cannot figure out if compiler needs -ext o: cannot compile
+See \`config.log' for more details." >&5
+$as_echo "$as_me: error: cannot figure out if compiler needs -ext o: cannot compile
+See \`config.log' for more details." >&2;}
+   { (exit 1); exit 1; }; }; }
 
-            IRIX*)
+fi
 
+rm -f conftest.$ac_ext.o conftest.$ac_objext conftest.$ac_ext
 
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
+fi
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_cxx_exto" >&5
+$as_echo "$bakefile_cv_cxx_exto" >&6; }
+if test "x$bakefile_cv_cxx_exto" '!=' "x"; then
+    if test "cxx" = "c"; then
+        CFLAGS="$bakefile_cv_cxx_exto $CFLAGS"
+    fi
+    if test "cxx" = "cxx"; then
+        CXXFLAGS="$bakefile_cv_cxx_exto $CXXFLAGS"
+    fi
+fi
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the SGI C compiler" >&5
-$as_echo_n "checking whether we are using the SGI C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler__SGI_COMPILER_VERSION+set}" = set; then
+            if test "x$bakefile_cv_c_exto" '!=' "x"; then
+                unset ac_cv_prog_cc_g
+                ac_test_CFLAGS=${CFLAGS+set}
+ac_save_CFLAGS=$CFLAGS
+{ $as_echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
+$as_echo_n "checking whether $CC accepts -g... " >&6; }
+if test "${ac_cv_prog_cc_g+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
+  ac_save_c_werror_flag=$ac_c_werror_flag
+   ac_c_werror_flag=yes
+   ac_cv_prog_cc_g=no
+   CFLAGS="-g"
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5712,10 +4624,6 @@
 main ()
 {
 
-             #ifndef _SGI_COMPILER_VERSION
-                choke me
-             #endif
-
   ;
   return 0;
 }
@@ -5735,54 +4643,55 @@
   cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
+	 test -z "$ac_cxx_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler__SGI_COMPILER_VERSION=yes
+  ac_cv_prog_cc_g=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler__SGI_COMPILER_VERSION=no
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+	CFLAGS=""
+      cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
 
+int
+main ()
+{
 
-fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler__SGI_COMPILER_VERSION" >&5
-$as_echo "$bakefile_cv_c_compiler__SGI_COMPILER_VERSION" >&6; }
-    if test "x$bakefile_cv_c_compiler__SGI_COMPILER_VERSION" = "xyes"; then
-        :; SGICC=yes
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
+$as_echo "$ac_try_echo") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_cxx_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  :
     else
-        :;
-    fi
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
-                ;;
-
-            Linux*)
-                                                if test "$INTELCC" != "yes"; then
-
-
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
+  $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the Sun C compiler" >&5
-$as_echo_n "checking whether we are using the Sun C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___SUNPRO_C+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
+	ac_c_werror_flag=$ac_save_c_werror_flag
+	 CFLAGS="-g"
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5794,10 +4703,6 @@
 main ()
 {
 
-             #ifndef __SUNPRO_C
-                choke me
-             #endif
-
   ;
   return 0;
 }
@@ -5817,41 +4722,48 @@
   cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
+	 test -z "$ac_cxx_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___SUNPRO_C=yes
+  ac_cv_prog_cc_g=yes
+else
+  $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+   ac_c_werror_flag=$ac_save_c_werror_flag
+fi
+{ $as_echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
+$as_echo "$ac_cv_prog_cc_g" >&6; }
+if test "$ac_test_CFLAGS" = set; then
+  CFLAGS=$ac_save_CFLAGS
+elif test $ac_cv_prog_cc_g = yes; then
+  if test "$GCC" = yes; then
+    CFLAGS="-g -O2"
+  else
+    CFLAGS="-g"
+  fi
 else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	bakefile_cv_c_compiler___SUNPRO_C=no
-
+  if test "$GCC" = yes; then
+    CFLAGS="-O2"
+  else
+    CFLAGS=
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-
-
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___SUNPRO_C" >&5
-$as_echo "$bakefile_cv_c_compiler___SUNPRO_C" >&6; }
-    if test "x$bakefile_cv_c_compiler___SUNPRO_C" = "xyes"; then
-        :; SUNCC=yes
-    else
-        :;
     fi
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
                 fi
-                ;;
 
-            HP-UX*)
+                        case `uname -s` in
+            AIX*)
 
 
     ac_ext=c
@@ -5860,9 +4772,9 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the HP C compiler" >&5
-$as_echo_n "checking whether we are using the HP C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___HP_cc+set}" = set; then
+    { $as_echo "$as_me:$LINENO: checking whether we are using the IBM xlC C compiler" >&5
+$as_echo_n "checking whether we are using the IBM xlC C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___xlC__+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -5876,7 +4788,7 @@
 main ()
 {
 
-             #ifndef __HP_cc
+             #ifndef __xlC__
                 choke me
              #endif
 
@@ -5902,12 +4814,12 @@
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___HP_cc=yes
+  bakefile_cv_c_compiler___xlC__=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler___HP_cc=no
+	bakefile_cv_c_compiler___xlC__=no
 
 fi
 
@@ -5915,10 +4827,10 @@
 
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___HP_cc" >&5
-$as_echo "$bakefile_cv_c_compiler___HP_cc" >&6; }
-    if test "x$bakefile_cv_c_compiler___HP_cc" = "xyes"; then
-        :; HPCC=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___xlC__" >&5
+$as_echo "$bakefile_cv_c_compiler___xlC__" >&6; }
+    if test "x$bakefile_cv_c_compiler___xlC__" = "xyes"; then
+        :; XLCC=yes
     else
         :;
     fi
@@ -5932,7 +4844,7 @@
 
                 ;;
 
-            OSF1)
+            Darwin)
 
 
     ac_ext=c
@@ -5941,9 +4853,9 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the Compaq C compiler" >&5
-$as_echo_n "checking whether we are using the Compaq C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___DECC+set}" = set; then
+    { $as_echo "$as_me:$LINENO: checking whether we are using the Metrowerks C compiler" >&5
+$as_echo_n "checking whether we are using the Metrowerks C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___MWERKS__+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -5957,7 +4869,7 @@
 main ()
 {
 
-             #ifndef __DECC
+             #ifndef __MWERKS__
                 choke me
              #endif
 
@@ -5983,12 +4895,12 @@
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___DECC=yes
+  bakefile_cv_c_compiler___MWERKS__=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler___DECC=no
+	bakefile_cv_c_compiler___MWERKS__=no
 
 fi
 
@@ -5996,10 +4908,10 @@
 
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___DECC" >&5
-$as_echo "$bakefile_cv_c_compiler___DECC" >&6; }
-    if test "x$bakefile_cv_c_compiler___DECC" = "xyes"; then
-        :; COMPAQCC=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___MWERKS__" >&5
+$as_echo "$bakefile_cv_c_compiler___MWERKS__" >&6; }
+    if test "x$bakefile_cv_c_compiler___MWERKS__" = "xyes"; then
+        :; MWCC=yes
     else
         :;
     fi
@@ -6011,9 +4923,7 @@
 
 
 
-                ;;
-
-            SunOS)
+                if test "$MWCC" != "yes"; then
 
 
     ac_ext=c
@@ -6022,9 +4932,9 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
-    { $as_echo "$as_me:$LINENO: checking whether we are using the Sun C compiler" >&5
-$as_echo_n "checking whether we are using the Sun C compiler... " >&6; }
-if test "${bakefile_cv_c_compiler___SUNPRO_C+set}" = set; then
+    { $as_echo "$as_me:$LINENO: checking whether we are using the IBM xlC C compiler" >&5
+$as_echo_n "checking whether we are using the IBM xlC C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___xlC__+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -6038,7 +4948,7 @@
 main ()
 {
 
-             #ifndef __SUNPRO_C
+             #ifndef __xlC__
                 choke me
              #endif
 
@@ -6064,12 +4974,12 @@
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  bakefile_cv_c_compiler___SUNPRO_C=yes
+  bakefile_cv_c_compiler___xlC__=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	bakefile_cv_c_compiler___SUNPRO_C=no
+	bakefile_cv_c_compiler___xlC__=no
 
 fi
 
@@ -6077,10 +4987,10 @@
 
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___SUNPRO_C" >&5
-$as_echo "$bakefile_cv_c_compiler___SUNPRO_C" >&6; }
-    if test "x$bakefile_cv_c_compiler___SUNPRO_C" = "xyes"; then
-        :; SUNCC=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___xlC__" >&5
+$as_echo "$bakefile_cv_c_compiler___xlC__" >&6; }
+    if test "x$bakefile_cv_c_compiler___xlC__" = "xyes"; then
+        :; XLCC=yes
     else
         :;
     fi
@@ -6092,166 +5002,103 @@
 
 
 
-                ;;
-        esac
     fi
+                ;;
 
+            IRIX*)
 
 
+    ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
-
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-if test -z "$CXX"; then
-  if test -n "$CCC"; then
-    CXX=$CCC
-  else
-    if test -n "$ac_tool_prefix"; then
-  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CXX+set}" = set; then
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CXX"; then
-  ac_cv_prog_CXX="$CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CXX="$ac_tool_prefix$ac_prog"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CXX=$ac_cv_prog_CXX
-if test -n "$CXX"; then
-  { $as_echo "$as_me:$LINENO: result: $CXX" >&5
-$as_echo "$CXX" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-    test -n "$CXX" && break
-  done
-fi
-if test -z "$CXX"; then
-  ac_ct_CXX=$CXX
-  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ $as_echo "$as_me:$LINENO: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_ac_ct_CXX+set}" = set; then
+    { $as_echo "$as_me:$LINENO: checking whether we are using the SGI C compiler" >&5
+$as_echo_n "checking whether we are using the SGI C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler__SGI_COMPILER_VERSION+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
-  if test -n "$ac_ct_CXX"; then
-  ac_cv_prog_ac_ct_CXX="$ac_ct_CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CXX="$ac_prog"
-    $as_echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CXX=$ac_cv_prog_ac_ct_CXX
-if test -n "$ac_ct_CXX"; then
-  { $as_echo "$as_me:$LINENO: result: $ac_ct_CXX" >&5
-$as_echo "$ac_ct_CXX" >&6; }
-else
-  { $as_echo "$as_me:$LINENO: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
 
-  test -n "$ac_ct_CXX" && break
-done
+int
+main ()
+{
 
-  if test "x$ac_ct_CXX" = x; then
-    CXX="g++"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:$LINENO: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    CXX=$ac_ct_CXX
-  fi
-fi
+             #ifndef _SGI_COMPILER_VERSION
+                choke me
+             #endif
 
-  fi
-fi
-# Provide some information about the compiler.
-$as_echo "$as_me:$LINENO: checking for C++ compiler version" >&5
-set X $ac_compile
-ac_compiler=$2
-{ (ac_try="$ac_compiler --version >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compiler --version >&5") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -v >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
-$as_echo "$ac_try_echo") >&5
-  (eval "$ac_compiler -v >&5") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -V >&5"
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
 case "(($ac_try" in
   *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
   *) ac_try_echo=$ac_try;;
 esac
 eval ac_try_echo="\"\$as_me:$LINENO: $ac_try_echo\""
 $as_echo "$ac_try_echo") >&5
-  (eval "$ac_compiler -V >&5") 2>&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  bakefile_cv_c_compiler__SGI_COMPILER_VERSION=yes
+else
+  $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
-{ $as_echo "$as_me:$LINENO: checking whether we are using the GNU C++ compiler" >&5
-$as_echo_n "checking whether we are using the GNU C++ compiler... " >&6; }
-if test "${ac_cv_cxx_compiler_gnu+set}" = set; then
+	bakefile_cv_c_compiler__SGI_COMPILER_VERSION=no
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+
+fi
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler__SGI_COMPILER_VERSION" >&5
+$as_echo "$bakefile_cv_c_compiler__SGI_COMPILER_VERSION" >&6; }
+    if test "x$bakefile_cv_c_compiler__SGI_COMPILER_VERSION" = "xyes"; then
+        :; SGICC=yes
+    else
+        :;
+    fi
+    ac_ext=cpp
+ac_cpp='$CXXCPP $CPPFLAGS'
+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
+
+
+
+                ;;
+
+            Linux*)
+                                                if test "$INTELCC" != "yes"; then
+
+
+    ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+    { $as_echo "$as_me:$LINENO: checking whether we are using the Sun C compiler" >&5
+$as_echo_n "checking whether we are using the Sun C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___SUNPRO_C+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -6264,7 +5111,8 @@
 int
 main ()
 {
-#ifndef __GNUC__
+
+             #ifndef __SUNPRO_C
        choke me
 #endif
 
@@ -6287,39 +5135,54 @@
   cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
+	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  ac_compiler_gnu=yes
+  bakefile_cv_c_compiler___SUNPRO_C=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_compiler_gnu=no
+	bakefile_cv_c_compiler___SUNPRO_C=no
+
 fi
 
 rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_cxx_compiler_gnu=$ac_compiler_gnu
+
 
 fi
-{ $as_echo "$as_me:$LINENO: result: $ac_cv_cxx_compiler_gnu" >&5
-$as_echo "$ac_cv_cxx_compiler_gnu" >&6; }
-if test $ac_compiler_gnu = yes; then
-  GXX=yes
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___SUNPRO_C" >&5
+$as_echo "$bakefile_cv_c_compiler___SUNPRO_C" >&6; }
+    if test "x$bakefile_cv_c_compiler___SUNPRO_C" = "xyes"; then
+        :; SUNCC=yes
 else
-  GXX=
+        :;
 fi
-ac_test_CXXFLAGS=${CXXFLAGS+set}
-ac_save_CXXFLAGS=$CXXFLAGS
-{ $as_echo "$as_me:$LINENO: checking whether $CXX accepts -g" >&5
-$as_echo_n "checking whether $CXX accepts -g... " >&6; }
-if test "${ac_cv_prog_cxx_g+set}" = set; then
+    ac_ext=cpp
+ac_cpp='$CXXCPP $CPPFLAGS'
+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
+
+
+
+                fi
+                ;;
+
+            HP-UX*)
+
+
+    ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+    { $as_echo "$as_me:$LINENO: checking whether we are using the HP C compiler" >&5
+$as_echo_n "checking whether we are using the HP C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___HP_cc+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
-  ac_save_cxx_werror_flag=$ac_cxx_werror_flag
-   ac_cxx_werror_flag=yes
-   ac_cv_prog_cxx_g=no
-   CXXFLAGS="-g"
    cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -6331,6 +5194,10 @@
 main ()
 {
 
+             #ifndef __HP_cc
+                choke me
+             #endif
+
   ;
   return 0;
 }
@@ -6350,15 +5217,53 @@
   cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
+	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cxx_g=yes
+  bakefile_cv_c_compiler___HP_cc=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	CXXFLAGS=""
+	bakefile_cv_c_compiler___HP_cc=no
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+
+fi
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___HP_cc" >&5
+$as_echo "$bakefile_cv_c_compiler___HP_cc" >&6; }
+    if test "x$bakefile_cv_c_compiler___HP_cc" = "xyes"; then
+        :; HPCC=yes
+    else
+        :;
+    fi
+    ac_ext=cpp
+ac_cpp='$CXXCPP $CPPFLAGS'
+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
+
+
+
+                ;;
+
+            OSF1)
+
+
+    ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+    { $as_echo "$as_me:$LINENO: checking whether we are using the Compaq C compiler" >&5
+$as_echo_n "checking whether we are using the Compaq C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___DECC+set}" = set; then
+  $as_echo_n "(cached) " >&6
+else
       cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -6370,6 +5275,10 @@
 main ()
 {
 
+             #ifndef __DECC
+                choke me
+             #endif
+
   ;
   return 0;
 }
@@ -6389,16 +5298,53 @@
   cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
+	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  :
+  bakefile_cv_c_compiler___DECC=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-	 CXXFLAGS="-g"
+	bakefile_cv_c_compiler___DECC=no
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+
+fi
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___DECC" >&5
+$as_echo "$bakefile_cv_c_compiler___DECC" >&6; }
+    if test "x$bakefile_cv_c_compiler___DECC" = "xyes"; then
+        :; COMPAQCC=yes
+    else
+        :;
+    fi
+    ac_ext=cpp
+ac_cpp='$CXXCPP $CPPFLAGS'
+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
+
+
+
+                ;;
+
+            SunOS)
+
+
+    ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+    { $as_echo "$as_me:$LINENO: checking whether we are using the Sun C compiler" >&5
+$as_echo_n "checking whether we are using the Sun C compiler... " >&6; }
+if test "${bakefile_cv_c_compiler___SUNPRO_C+set}" = set; then
+  $as_echo_n "(cached) " >&6
+else
 	 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -6410,6 +5356,10 @@
 main ()
 {
 
+             #ifndef __SUNPRO_C
+                choke me
+             #endif
+
   ;
   return 0;
 }
@@ -6429,42 +5379,28 @@
   cat conftest.err >&5
   $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
+	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cxx_g=yes
+  bakefile_cv_c_compiler___SUNPRO_C=yes
 else
   $as_echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
+	bakefile_cv_c_compiler___SUNPRO_C=no
 
 fi
 
 rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
 
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
 
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-fi
-{ $as_echo "$as_me:$LINENO: result: $ac_cv_prog_cxx_g" >&5
-$as_echo "$ac_cv_prog_cxx_g" >&6; }
-if test "$ac_test_CXXFLAGS" = set; then
-  CXXFLAGS=$ac_save_CXXFLAGS
-elif test $ac_cv_prog_cxx_g = yes; then
-  if test "$GXX" = yes; then
-    CXXFLAGS="-g -O2"
-  else
-    CXXFLAGS="-g"
   fi
+{ $as_echo "$as_me:$LINENO: result: $bakefile_cv_c_compiler___SUNPRO_C" >&5
+$as_echo "$bakefile_cv_c_compiler___SUNPRO_C" >&6; }
+    if test "x$bakefile_cv_c_compiler___SUNPRO_C" = "xyes"; then
+        :; SUNCC=yes
 else
-  if test "$GXX" = yes; then
-    CXXFLAGS="-O2"
-  else
-    CXXFLAGS=
-  fi
+        :;
 fi
 ac_ext=cpp
 ac_cpp='$CXXCPP $CPPFLAGS'
@@ -6474,6 +5410,17 @@
 
 
 
+                ;;
+        esac
+    fi
+
+
+
+
+
+
+
+
 
     ac_ext=cpp
 ac_cpp='$CXXCPP $CPPFLAGS'
@@ -9613,10 +8560,10 @@
 
 
 
-    BAKEFILE_BAKEFILE_M4_VERSION="0.2.8"
+    BAKEFILE_BAKEFILE_M4_VERSION="0.2.9"
 
 
-BAKEFILE_AUTOCONF_INC_M4_VERSION="0.2.8"
+BAKEFILE_AUTOCONF_INC_M4_VERSION="0.2.9"
 
     COND_DEPS_TRACKING_0="#"
     if test "x$DEPS_TRACKING" = "x0" ; then
@@ -10209,7 +9156,7 @@
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by wxpdfdoc $as_me 0.9.1, which was
+This file was extended by wxpdfdoc $as_me 0.9.3, which was
 generated by GNU Autoconf 2.63.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
@@ -10259,7 +9206,7 @@
 _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 ac_cs_version="\\
-wxpdfdoc config.status 0.9.1
+wxpdfdoc config.status 0.9.3
 configured by $0, generated by GNU Autoconf 2.63,
   with options \\"`$as_echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`\\"
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/configure29 wxPdfDoc-copy/configure29
--- wxpdfdoc-0.9.2.1/configure29	2011-01-14 18:06:28.000000000 +0000
+++ wxPdfDoc-copy/configure29	2012-05-26 17:57:54.191300000 +0100
@@ -1,6 +1,6 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.65 for wxpdfdoc 0.9.1.
+# Generated by GNU Autoconf 2.65 for wxpdfdoc 0.9.3.
 #
 # Report bugs to <utelle@users.sourceforge.net>.
 #
@@ -551,8 +551,8 @@
 # Identity of this package.
 PACKAGE_NAME='wxpdfdoc'
 PACKAGE_TARNAME='wxpdfdoc'
-PACKAGE_VERSION='0.9.1'
-PACKAGE_STRING='wxpdfdoc 0.9.1'
+PACKAGE_VERSION='0.9.3'
+PACKAGE_STRING='wxpdfdoc 0.9.3'
 PACKAGE_BUGREPORT='utelle@users.sourceforge.net'
 PACKAGE_URL=''
 
@@ -1274,7 +1274,7 @@
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures wxpdfdoc 0.9.1 to adapt to many kinds of systems.
+\`configure' configures wxpdfdoc 0.9.3 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
@@ -1340,7 +1340,7 @@
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of wxpdfdoc 0.9.1:";;
+     short | recursive ) echo "Configuration of wxpdfdoc 0.9.3:";;
    esac
   cat <<\_ACEOF
 
@@ -1448,7 +1448,7 @@
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-wxpdfdoc configure 0.9.1
+wxpdfdoc configure 0.9.3
 generated by GNU Autoconf 2.65
 
 Copyright (C) 2009 Free Software Foundation, Inc.
@@ -1541,7 +1541,7 @@
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by wxpdfdoc $as_me 0.9.1, which was
+It was created by wxpdfdoc $as_me 0.9.3, which was
 generated by GNU Autoconf 2.65.  Invocation command line was
 
   $ $0 $@
@@ -2566,11 +2566,11 @@
     if test -n "$wx_ver_ok"; then
       { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes (version $WX_VERSION)" >&5
 $as_echo "yes (version $WX_VERSION)" >&6; }
-      WX_LIBS=`$WX_CONFIG_WITH_ARGS --libs core,base,xml`
+      WX_LIBS=`$WX_CONFIG_WITH_ARGS --libs core,base,xml,adv,html,richtext`
 
                               { $as_echo "$as_me:${as_lineno-$LINENO}: checking for wxWidgets static library" >&5
 $as_echo_n "checking for wxWidgets static library... " >&6; }
-      WX_LIBS_STATIC=`$WX_CONFIG_WITH_ARGS --static --libs core,base,xml 2>/dev/null`
+      WX_LIBS_STATIC=`$WX_CONFIG_WITH_ARGS --static --libs core,base,xml,adv,html,richtext 2>/dev/null`
       if test "x$WX_LIBS_STATIC" = "x"; then
         { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
 $as_echo "no" >&6; }
@@ -2613,16 +2613,16 @@
       fi
 
       if test "x$wx_has_cppflags" = x ; then
-                  WX_CFLAGS=`$WX_CONFIG_WITH_ARGS --cflags core,base,xml`
+                  WX_CFLAGS=`$WX_CONFIG_WITH_ARGS --cflags core,base,xml,adv,html,richtext`
          WX_CPPFLAGS=$WX_CFLAGS
          WX_CXXFLAGS=$WX_CFLAGS
 
          WX_CFLAGS_ONLY=$WX_CFLAGS
          WX_CXXFLAGS_ONLY=$WX_CFLAGS
       else
-                  WX_CPPFLAGS=`$WX_CONFIG_WITH_ARGS --cppflags core,base,xml`
-         WX_CXXFLAGS=`$WX_CONFIG_WITH_ARGS --cxxflags core,base,xml`
-         WX_CFLAGS=`$WX_CONFIG_WITH_ARGS --cflags core,base,xml`
+                  WX_CPPFLAGS=`$WX_CONFIG_WITH_ARGS --cppflags core,base,xml,adv,html,richtext`
+         WX_CXXFLAGS=`$WX_CONFIG_WITH_ARGS --cxxflags core,base,xml,adv,html,richtext`
+         WX_CFLAGS=`$WX_CONFIG_WITH_ARGS --cflags core,base,xml,adv,html,richtext`
 
          WX_CFLAGS_ONLY=`echo $WX_CFLAGS | sed "s@^$WX_CPPFLAGS *@@"`
          WX_CXXFLAGS_ONLY=`echo $WX_CXXFLAGS | sed "s@^$WX_CFLAGS *@@"`
@@ -3973,545 +3973,6 @@
 
 
 
-    ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}gcc; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="${ac_tool_prefix}gcc"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-fi
-if test -z "$ac_cv_prog_CC"; then
-  ac_ct_CC=$CC
-  # Extract the first word of "gcc", so it can be a program name with args.
-set dummy gcc; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CC="gcc"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CC" >&5
-$as_echo "$ac_ct_CC" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
-else
-  CC="$ac_cv_prog_CC"
-fi
-
-if test -z "$CC"; then
-          if test -n "$ac_tool_prefix"; then
-    # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}cc; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="${ac_tool_prefix}cc"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-  fi
-fi
-if test -z "$CC"; then
-  # Extract the first word of "cc", so it can be a program name with args.
-set dummy cc; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-  ac_prog_rejected=no
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
-       ac_prog_rejected=yes
-       continue
-     fi
-    ac_cv_prog_CC="cc"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-if test $ac_prog_rejected = yes; then
-  # We found a bogon in the path, so make sure we never use it.
-  set dummy $ac_cv_prog_CC
-  shift
-  if test $# != 0; then
-    # We chose a different compiler from the bogus one.
-    # However, it has the same basename, so the bogon will be chosen
-    # first if we set CC to just the basename; use the full file name.
-    shift
-    ac_cv_prog_CC="$as_dir/$ac_word${1+' '}$@"
-  fi
-fi
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-fi
-if test -z "$CC"; then
-  if test -n "$ac_tool_prefix"; then
-  for ac_prog in cl.exe
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-    test -n "$CC" && break
-  done
-fi
-if test -z "$CC"; then
-  ac_ct_CC=$CC
-  for ac_prog in cl.exe
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CC="$ac_prog"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CC" >&5
-$as_echo "$ac_ct_CC" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-  test -n "$ac_ct_CC" && break
-done
-
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
-fi
-
-fi
-
-
-test -z "$CC" && { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error "no acceptable C compiler found in \$PATH
-See \`config.log' for more details." "$LINENO" 5; }
-
-# Provide some information about the compiler.
-$as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler version" >&5
-set X $ac_compile
-ac_compiler=$2
-for ac_option in --version -v -V -qversion; do
-  { { ac_try="$ac_compiler $ac_option >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
-  ac_status=$?
-  if test -s conftest.err; then
-    sed '10a\
-... rest of stderr output deleted ...
-         10q' conftest.err >conftest.er1
-    cat conftest.er1 >&5
-  fi
-  rm -f conftest.er1 conftest.err
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }
-done
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether we are using the GNU C compiler" >&5
-$as_echo_n "checking whether we are using the GNU C compiler... " >&6; }
-if test "${ac_cv_c_compiler_gnu+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_compiler_gnu=yes
-else
-  ac_compiler_gnu=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_c_compiler_gnu=$ac_compiler_gnu
-
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_compiler_gnu" >&5
-$as_echo "$ac_cv_c_compiler_gnu" >&6; }
-if test $ac_compiler_gnu = yes; then
-  GCC=yes
-else
-  GCC=
-fi
-ac_test_CFLAGS=${CFLAGS+set}
-ac_save_CFLAGS=$CFLAGS
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether $CC accepts -g" >&5
-$as_echo_n "checking whether $CC accepts -g... " >&6; }
-if test "${ac_cv_prog_cc_g+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_save_c_werror_flag=$ac_c_werror_flag
-   ac_c_werror_flag=yes
-   ac_cv_prog_cc_g=no
-   CFLAGS="-g"
-   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_cv_prog_cc_g=yes
-else
-  CFLAGS=""
-      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-
-else
-  ac_c_werror_flag=$ac_save_c_werror_flag
-	 CFLAGS="-g"
-	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_cv_prog_cc_g=yes
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_c_werror_flag=$ac_save_c_werror_flag
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_g" >&5
-$as_echo "$ac_cv_prog_cc_g" >&6; }
-if test "$ac_test_CFLAGS" = set; then
-  CFLAGS=$ac_save_CFLAGS
-elif test $ac_cv_prog_cc_g = yes; then
-  if test "$GCC" = yes; then
-    CFLAGS="-g -O2"
-  else
-    CFLAGS="-g"
-  fi
-else
-  if test "$GCC" = yes; then
-    CFLAGS="-O2"
-  else
-    CFLAGS=
-  fi
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $CC option to accept ISO C89" >&5
-$as_echo_n "checking for $CC option to accept ISO C89... " >&6; }
-if test "${ac_cv_prog_cc_c89+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_cv_prog_cc_c89=no
-ac_save_CC=$CC
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <stdarg.h>
-#include <stdio.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-/* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
-struct buf { int x; };
-FILE * (*rcsopen) (struct buf *, struct stat *, int);
-static char *e (p, i)
-     char **p;
-     int i;
-{
-  return p[i];
-}
-static char *f (char * (*g) (char **, int), char **p, ...)
-{
-  char *s;
-  va_list v;
-  va_start (v,p);
-  s = g (p, va_arg (v,int));
-  va_end (v);
-  return s;
-}
-
-/* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
-   function prototypes and stuff, but not '\xHH' hex character constants.
-   These don't provoke an error unfortunately, instead are silently treated
-   as 'x'.  The following induces an error, until -std is added to get
-   proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
-   array size at least.  It's necessary to write '\x00'==0 to get something
-   that's true only with -std.  */
-int osf4_cc_array ['\x00' == 0 ? 1 : -1];
-
-/* IBM C 6 for AIX is almost-ANSI by default, but it replaces macro parameters
-   inside strings and character constants.  */
-#define FOO(x) 'x'
-int xlc6_cc_array[FOO(a) == 'x' ? 1 : -1];
-
-int test (int i, double x);
-struct s1 {int (*f) (int a);};
-struct s2 {int (*f) (double a);};
-int pairnames (int, char **, FILE *(*)(struct buf *, struct stat *, int), int, int);
-int argc;
-char **argv;
-int
-main ()
-{
-return f (e, argv, 0) != argv[0]  ||  f (e, argv, 1) != argv[1];
-  ;
-  return 0;
-}
-_ACEOF
-for ac_arg in '' -qlanglvl=extc89 -qlanglvl=ansi -std \
-	-Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
-do
-  CC="$ac_save_CC $ac_arg"
-  if ac_fn_c_try_compile "$LINENO"; then :
-  ac_cv_prog_cc_c89=$ac_arg
-fi
-rm -f core conftest.err conftest.$ac_objext
-  test "x$ac_cv_prog_cc_c89" != "xno" && break
-done
-rm -f conftest.$ac_ext
-CC=$ac_save_CC
-
-fi
-# AC_CACHE_VAL
-case "x$ac_cv_prog_cc_c89" in
-  x)
-    { $as_echo "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
-$as_echo "none needed" >&6; } ;;
-  xno)
-    { $as_echo "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
-$as_echo "unsupported" >&6; } ;;
-  *)
-    CC="$CC $ac_cv_prog_cc_c89"
-    { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c89" >&5
-$as_echo "$ac_cv_prog_cc_c89" >&6; } ;;
-esac
-if test "x$ac_cv_prog_cc_c89" != xno; then :
-
-fi
-
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
 
 
 
@@ -5272,262 +4733,6 @@
 
 
 
-    ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-if test -z "$CXX"; then
-  if test -n "$CCC"; then
-    CXX=$CCC
-  else
-    if test -n "$ac_tool_prefix"; then
-  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_CXX+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CXX"; then
-  ac_cv_prog_CXX="$CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CXX="$ac_tool_prefix$ac_prog"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-CXX=$ac_cv_prog_CXX
-if test -n "$CXX"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CXX" >&5
-$as_echo "$CXX" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-    test -n "$CXX" && break
-  done
-fi
-if test -z "$CXX"; then
-  ac_ct_CXX=$CXX
-  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if test "${ac_cv_prog_ac_ct_CXX+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$ac_ct_CXX"; then
-  ac_cv_prog_ac_ct_CXX="$ac_ct_CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CXX="$ac_prog"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CXX=$ac_cv_prog_ac_ct_CXX
-if test -n "$ac_ct_CXX"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CXX" >&5
-$as_echo "$ac_ct_CXX" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-  test -n "$ac_ct_CXX" && break
-done
-
-  if test "x$ac_ct_CXX" = x; then
-    CXX="g++"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    CXX=$ac_ct_CXX
-  fi
-fi
-
-  fi
-fi
-# Provide some information about the compiler.
-$as_echo "$as_me:${as_lineno-$LINENO}: checking for C++ compiler version" >&5
-set X $ac_compile
-ac_compiler=$2
-for ac_option in --version -v -V -qversion; do
-  { { ac_try="$ac_compiler $ac_option >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
-  ac_status=$?
-  if test -s conftest.err; then
-    sed '10a\
-... rest of stderr output deleted ...
-         10q' conftest.err >conftest.er1
-    cat conftest.er1 >&5
-  fi
-  rm -f conftest.er1 conftest.err
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }
-done
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether we are using the GNU C++ compiler" >&5
-$as_echo_n "checking whether we are using the GNU C++ compiler... " >&6; }
-if test "${ac_cv_cxx_compiler_gnu+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-  ac_compiler_gnu=yes
-else
-  ac_compiler_gnu=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_cxx_compiler_gnu=$ac_compiler_gnu
-
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cxx_compiler_gnu" >&5
-$as_echo "$ac_cv_cxx_compiler_gnu" >&6; }
-if test $ac_compiler_gnu = yes; then
-  GXX=yes
-else
-  GXX=
-fi
-ac_test_CXXFLAGS=${CXXFLAGS+set}
-ac_save_CXXFLAGS=$CXXFLAGS
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether $CXX accepts -g" >&5
-$as_echo_n "checking whether $CXX accepts -g... " >&6; }
-if test "${ac_cv_prog_cxx_g+set}" = set; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_save_cxx_werror_flag=$ac_cxx_werror_flag
-   ac_cxx_werror_flag=yes
-   ac_cv_prog_cxx_g=no
-   CXXFLAGS="-g"
-   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-  ac_cv_prog_cxx_g=yes
-else
-  CXXFLAGS=""
-      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-
-else
-  ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-	 CXXFLAGS="-g"
-	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-  ac_cv_prog_cxx_g=yes
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cxx_g" >&5
-$as_echo "$ac_cv_prog_cxx_g" >&6; }
-if test "$ac_test_CXXFLAGS" = set; then
-  CXXFLAGS=$ac_save_CXXFLAGS
-elif test $ac_cv_prog_cxx_g = yes; then
-  if test "$GXX" = yes; then
-    CXXFLAGS="-g -O2"
-  else
-    CXXFLAGS="-g"
-  fi
-else
-  if test "$GXX" = yes; then
-    CXXFLAGS="-O2"
-  else
-    CXXFLAGS=
-  fi
-fi
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
 
 
 
@@ -8280,10 +7485,10 @@
 
 
 
-    BAKEFILE_BAKEFILE_M4_VERSION="0.2.8"
+    BAKEFILE_BAKEFILE_M4_VERSION="0.2.9"
 
 
-BAKEFILE_AUTOCONF_INC_M4_VERSION="0.2.8"
+BAKEFILE_AUTOCONF_INC_M4_VERSION="0.2.9"
 
     COND_DEPS_TRACKING_0="#"
     if test "x$DEPS_TRACKING" = "x0" ; then
@@ -8943,7 +8148,7 @@
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by wxpdfdoc $as_me 0.9.1, which was
+This file was extended by wxpdfdoc $as_me 0.9.3, which was
 generated by GNU Autoconf 2.65.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
@@ -8996,7 +8201,7 @@
 cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 ac_cs_config="`$as_echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`"
 ac_cs_version="\\
-wxpdfdoc config.status 0.9.1
+wxpdfdoc config.status 0.9.3
 configured by $0, generated by GNU Autoconf 2.65,
   with options \\"\$ac_cs_config\\"
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/include/wx/pdfdc.h wxPdfDoc-copy/include/wx/pdfdc.h
--- wxpdfdoc-0.9.2.1/include/wx/pdfdc.h	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/include/wx/pdfdc.h	2012-05-29 23:51:27.474500000 +0100
@@ -21,6 +21,16 @@
 #include "wx/pdfdocument.h"
 #include "wx/pdffont.h"
 
+/// Enumeration of map mode styles
+enum wxPdfMapModeStyle
+{
+  wxPDF_MAPMODESTYLE_STANDARD = 1,
+  wxPDF_MAPMODESTYLE_MSW,
+  wxPDF_MAPMODESTYLE_GTK,
+  wxPDF_MAPMODESTYLE_MAC,
+  wxPDF_MAPMODESTYLE_PDF
+};
+
 #if wxCHECK_VERSION(2,9,0)
 // Interface of wxPdfDC for wxWidgets 2.9.x (and above)
 #include "wx/pdfdc29.h"
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/include/wx/pdfdc28.h wxPdfDoc-copy/include/wx/pdfdc28.h
--- wxpdfdoc-0.9.2.1/include/wx/pdfdc28.h	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/include/wx/pdfdc28.h	2012-05-30 00:33:16.464100000 +0100
@@ -61,10 +61,10 @@
   virtual void SetDeviceOrigin(wxCoord x, wxCoord y);
   virtual void SetAxisOrientation(bool xLeftRight, bool yBottomUp);
   virtual void SetLogicalFunction(int function);
-#if 0
   virtual void SetTextForeground(const wxColour& colour);
-  virtual void SetTextBackground(const wxColour& colour);
   virtual void ComputeScaleAndOrigin();
+#if 0
+  virtual void SetTextBackground(const wxColour& colour);
 #endif
 
 #if 0
@@ -171,22 +171,34 @@
                   wxBitmap* bitmap);
   int IncreaseImageCounter() { return ++m_imageCount; }
 
+  void SetMapModeStyle(wxPdfMapModeStyle style) { m_mappingModeStyle = style; }
+  wxPdfMapModeStyle GetMapModeStyle() const { return m_mappingModeStyle; }
+
 private:
   void Init();
   int FindPdfFont(wxFont* font) const;
   void SetupPen();
   void SetupBrush();
-  double ScaleToPdf(wxCoord x) const;
+  double ScaleLogicalToPdfX(wxCoord x) const;
+  double ScaleLogicalToPdfXRel(wxCoord x) const;
+  double ScaleLogicalToPdfY(wxCoord y) const;
+  double ScaleLogicalToPdfYRel(wxCoord y) const;
+  double ScaleFontSizeToPdf(int pointSize) const;
+  int ScalePdfToFontMetric(double metric) const;
+  void CalculateFontMetrics(wxPdfFontDescription* desc, int pointSize,
+                            int* height, int* ascent, int* descent, int* extLeading) const;
 
   bool           m_templateMode;
   double         m_templateWidth;
   double         m_templateHeight;
   double         m_ppi;
+  double         m_ppiPdfFont;
   wxPdfDocument* m_pdfDocument;
   int            m_imageCount;
   int            m_bkgMode;
   wxString       m_strFileName;
   wxPrintData    m_printData;
+  wxPdfMapModeStyle m_mappingModeStyle;
 
   DECLARE_DYNAMIC_CLASS(wxPdfDC);
 };
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/include/wx/pdfdc29.h wxPdfDoc-copy/include/wx/pdfdc29.h
--- wxpdfdoc-0.9.2.1/include/wx/pdfdc29.h	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/include/wx/pdfdc29.h	2012-05-30 00:32:40.585300000 +0100
@@ -27,6 +27,10 @@
   wxPdfDocument* GetPdfDocument();
 
   void SetResolution(int ppi);
+  int GetResolution() const;
+
+  void SetMapModeStyle(wxPdfMapModeStyle style);
+  wxPdfMapModeStyle GetMapModeStyle() const;
 
 private:
     DECLARE_DYNAMIC_CLASS(wxPdfDC)
@@ -83,9 +87,9 @@
   virtual void SetDeviceOrigin(wxCoord x, wxCoord y);
   virtual void SetAxisOrientation(bool xLeftRight, bool yBottomUp);
   virtual void SetLogicalFunction(wxRasterOperationMode function);
-#if 0
+
+  virtual void SetTextForeground(const wxColour& colour);
   virtual void ComputeScaleAndOrigin();
-#endif
 
 #if 0
   // RTL related functions
@@ -178,25 +182,39 @@
                                wxCoord* externalLeading = NULL,
                                const wxFont* theFont = NULL) const;
 
+  virtual bool DoGetPartialTextExtents(const wxString& text, wxArrayInt& widths) const;
+
 public:
   int GetDrawingStyle();
   bool StretchBlt(wxCoord xdest, wxCoord ydest, wxCoord width, wxCoord height,
                   wxBitmap* bitmap);
   int IncreaseImageCounter() { return ++m_imageCount; }
 
+  void SetMapModeStyle(wxPdfMapModeStyle style) { m_mappingModeStyle = style; }
+  wxPdfMapModeStyle GetMapModeStyle() const { return m_mappingModeStyle; }
+
 private:
   int FindPdfFont(wxFont* font) const;
   void SetupPen();
   void SetupBrush();
-  double ScaleToPdf(wxCoord x) const;
+  double ScaleLogicalToPdfX(wxCoord x) const;
+  double ScaleLogicalToPdfXRel(wxCoord x) const;
+  double ScaleLogicalToPdfY(wxCoord y) const;
+  double ScaleLogicalToPdfYRel(wxCoord y) const;
+  double ScaleFontSizeToPdf(int pointSize) const;
+  int ScalePdfToFontMetric(double metric) const;
+  void CalculateFontMetrics(wxPdfFontDescription* desc, int pointSize,
+                            int* height, int* ascent, int* descent, int* extLeading) const;
 
   bool           m_templateMode;
   double         m_templateWidth;
   double         m_templateHeight;
   double         m_ppi;
+  double         m_ppiPdfFont;
   wxPdfDocument* m_pdfDocument;
   int            m_imageCount;
   wxPrintData    m_printData;
+  wxPdfMapModeStyle m_mappingModeStyle;
 
   DECLARE_DYNAMIC_CLASS(wxPdfDCImpl);
 };
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/include/wx/pdfdocdef.h wxPdfDoc-copy/include/wx/pdfdocdef.h
--- wxpdfdoc-0.9.2.1/include/wx/pdfdocdef.h	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/include/wx/pdfdocdef.h	2012-05-26 17:57:53.317700000 +0100
@@ -71,6 +71,29 @@
 \section version Version history
 
 <dl>
+<dt><b>0.9.3</b> - <i>June 2012</i></dt>
+<dd>
+wxPdfDocument is compatible with wxWidgets version 2.8.12 and version 2.9.3. 
+Compatibility with older wxWidgets versions is not guaranteed, but it should
+work with all 2.8.x versions.
+
+General changes:<br>
+- added methods to access the bottom right coordinates of the last inserted image
+- added span tag to XML markup
+- added method wxPdfDocument::AttachFile to attach files to PDF documents
+- added compile time option to derive wxPdfDocument from wxObject (makes interfacing to wxPerl easier)
+- integrated enhancements to wxPdfDC and MakeFont contributed by Mark Dootson
+- added support for the wxWidgets printing framework (contributed by Mark Dootson)
+- enhanced wxPdfDC sample application to demonstrate the integration with the printing framework (contributed by Mark Dootson)
+
+Fixed bugs:<br>
+- fixed a bug in pdffontdatacore.cpp (non-ASCII characters didn't show on OSX)
+- fixed a bug in pdfencrypt.cpp (setting a non-empty document id)
+- fixed a bug in pdfxml.cpp (force line break for words too long to fit on a line)
+- fixed in bug in handling external templates in conjunction with protection (crypting used the wrong object id for strings and streams)
+
+</dd>
+
 <dt><b>0.9.2</b> - <i>September 2011</i></dt>
 <dd>
 wxPdfDocument is compatible with wxWidgets version 2.8.12 and version 2.9.2. 
@@ -337,6 +360,9 @@
 (http://mpdf.bpm1.com); special thanks to <b>K Vinod Kumar</b> of the Centre for Development of Advanced
 Computing, Mumbai (http://www.cdacmumbai.in), for clearing license issues of the Raghu font series.
 
+Kudos to <b>Mark Dootson</b> for contributing major enhancements of wxPdfDC and it's integration
+into the wxWidgets printing framework.
+
 Since wxPdfDocument is based on the great \b FPDF PHP class and several of the contributions to it
 found on the <a href="http://www.fpdf.org"><b>FPDF website</b></a> I would like to thank 
 
@@ -384,6 +410,7 @@
 \li wxPdfDocument::Annotate - add a text annotation
 \li wxPdfDocument::AppendJavascript - add document level JavaScript
 \li wxPdfDocument::Arrow - draw an arrow
+\li wxPdfDocument::AttachFile - add a file attachment
 \li wxPdfDocument::AxialGradient - define axial gradient shading
 
 \li wxPdfDocument::BeginTemplate - start template creation
@@ -424,6 +451,8 @@
 \li wxPdfDocument::GetFontStyles - get current font styles
 \li wxPdfDocument::GetFontSubsetting - get font embedding mode
 \li wxPdfDocument::GetImageScale - get image scale
+\li wxPdfDocument::GetLastImageBottomRightX - get the X coordinate of the bottom right corner of the last inserted image
+\li wxPdfDocument::GetLastImageBottomRightY - get the Y coordinate of the bottom right corner of the last inserted image
 \li wxPdfDocument::GetLeftMargin - get the left margin
 \li wxPdfDocument::GetLineHeight - get line height
 \li wxPdfDocument::GetLineStyle - get current line style
@@ -645,7 +674,7 @@
 all the information needed by wxPdfDocument; in addition, the font file is compressed.
 To do this, a utility program, \b makefont, is provided.
 
-<tt>makefont {-a font.afm | -u font.ufm | -i } [-f font.{ttf|pfb}] [-e encoding] [-p patch] [-t {ttf|otf|t1}]</tt>
+<tt>makefont {-a font.afm | -u font.ufm | -i } [-f font.{ttf|pfb}] [-e encoding] [-p patch] [-t {ttf|otf|t1}] [-o outdir]</tt>
 
 <table border=0>
 <tr><td><tt>-a font.afm</tt></td><td>AFM font metric file for \b TrueType or \b Type1 fonts</td></tr>
@@ -701,6 +730,7 @@
 For TrueType Unicode and OpenType Unicode fonts this parameter is ignored.
 </td></tr>
 <tr><td><tt>-t {ttf|otf|t1}</tt></td><td>font type (ttf = TrueType, otf = OpenType, t1 = Type1). Only needed if omitting the font file.</td></tr>
+<tr><td><tt>-o outdir</tt></td><td>the output directory for all generated files (default: current working directory)</td></tr>
 </table>
 
 \b Note: in the case of a font with the same name as a standard one, for instance arial.ttf,
@@ -1178,6 +1208,13 @@
   #define WXDLLIMPEXP_DATA_PDFDOC(type) type
 #endif
 
+// Setting inheritance of wxPdfDocument
+// 0 = do not derive wxPdfDocument from wxObject (default)
+// 1 = derive wxPdfDocumentinherit from wxObject
+#ifndef WXPDFDOC_INHERIT_WXOBJECT
+#define WXPDFDOC_INHERIT_WXOBJECT 0
+#endif
+
 /*
   GCC warns about using __declspec on forward declarations
   while MSVC complains about forward declarations without
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/include/wx/pdfdocument.h wxPdfDoc-copy/include/wx/pdfdocument.h
--- wxpdfdoc-0.9.2.1/include/wx/pdfdocument.h	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/include/wx/pdfdocument.h	2012-05-28 00:19:13.864100000 +0100
@@ -113,6 +113,9 @@
 /// Hashmap class for optional content groups
 WX_DECLARE_HASH_MAP_WITH_DECL(long, wxPdfLayerGroup*, wxIntegerHash, wxIntegerEqual, wxPdfLayerRGMap, class WXDLLIMPEXP_PDFDOC);
 
+/// Hashmap class for file attachments
+WX_DECLARE_HASH_MAP_WITH_DECL(long, wxArrayString*, wxIntegerHash, wxIntegerEqual, wxPdfAttachmentMap, class WXDLLIMPEXP_PDFDOC);
+
 /// Hashmap class for core fonts
 WX_DECLARE_STRING_HASH_MAP_WITH_DECL(int, wxPdfCoreFontMap, class WXDLLIMPEXP_PDFDOC);
 
@@ -138,7 +141,11 @@
 WX_DECLARE_STRING_HASH_MAP_WITH_DECL(wxPdfParser*, wxPdfParserMap, class WXDLLIMPEXP_PDFDOC);
 
 /// Class representing a PDF document.
+#if WXPDFDOC_INHERIT_WXOBJECT
+class WXDLLIMPEXP_PDFDOC wxPdfDocument : public wxObject
+#else
 class WXDLLIMPEXP_PDFDOC wxPdfDocument
+#endif
 {
 public:
   /// Constructor
@@ -163,6 +170,9 @@
 
   virtual ~wxPdfDocument();
 
+  // this is a dummy placeholder that helps building the wxPerl wrapper
+  virtual void wxPerlHelperProc() {};
+
   /// Set permissions as well as user and owner passwords.
   /**
   * \param permissions flag indicating permissions.
@@ -1616,6 +1626,16 @@
                             const wxPdfLink& link = wxPdfLink(-1),
                             int maskImage = 0);
 
+  /// Get x coordinate of bottom right corner of last inserted image
+  /**
+  */
+  virtual double GetLastImageBottomRightX() { return m_img_rb_x; }
+
+  /// Get y coordinate of bottom right corner of last inserted image
+  /**
+  */
+  virtual double GetLastImageBottomRightY() { return m_img_rb_y; }
+
   /// Performs a line break.
   /**
   * The current abscissa goes back to the left margin and the ordinate increases by the amount passed in parameter.
@@ -2450,6 +2470,17 @@
   */
   virtual void LeaveLayer();
 
+  /// Attach file
+  /**
+  * Attaches a file to the PDF document.
+  * \param fileName path to the file to attach
+  * \param attachName the name under which the file will be attached (dfeault: filename)
+  * \param description an optional description
+  */
+  virtual bool AttachFile(const wxString& fileName, 
+                          const wxString& attachName = wxEmptyString,
+                          const wxString& description = wxEmptyString);
+
   /// Set message translation mode
   /**
   * Sets the message translation mode which controls the handling of msg tags in XML output
@@ -2581,6 +2612,9 @@
   /// Add Javascript (document level)
   virtual void PutJavaScript();
 
+  /// Add attached files
+  virtual void PutFiles();
+
   /// Add resource dictionary
   virtual void PutResourceDict();
   
@@ -2854,8 +2888,18 @@
   wxPdfLayerGroup*     m_lockedLayers;        ///< array of locked layers
   wxArrayInt           m_layerDepth;          ///< stack for nested layers
 
+  // File attachments
+  int                  m_nAttachments;        ///< attachments object number
+  wxPdfAttachmentMap*  m_attachments;         ///< array of file attachments
+
   bool                 m_translate;           ///< flag whether messages in msg tags should be translated
 
+private:
+#if WXPDFDOC_INHERIT_WXOBJECT
+  DECLARE_DYNAMIC_CLASS(wxPdfDocument)
+#endif
+  DECLARE_NO_COPY_CLASS(wxPdfDocument)
+
   friend class wxPdfImage;
   friend class wxPdfTable;
 };
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/include/wx/pdffontdescription.h wxPdfDoc-copy/include/wx/pdffontdescription.h
--- wxpdfdoc-0.9.2.1/include/wx/pdffontdescription.h	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/include/wx/pdffontdescription.h	2012-05-22 01:23:11.874400000 +0100
@@ -39,11 +39,22 @@
   * \param xHeight height of character X
   * \param underlinePosition position of underline decoration
   * \param underlineThickness thickness of underline decoration
+  * \param hheaAscender ascender in OpenType table hhea
+  * \param hheaDescender descender in OpenType table hhea
+  * \param hheaLineGap line gap in OpenType table hhea
+  * \param os2sTypoAscender typographic ascender in OpenType table OS/2
+  * \param os2sTypoDescender typographic descender in OpenType table OS/2
+  * \param os2sTypoLineGap typographic line gap in OpenType table OS/2
+  * \param os2usWinAscent Windows ascender in OpenType table OS/2
+  * \param os2usWinDescent Windows descender in OpenType table OS/2
   */
   wxPdfFontDescription(int ascent, int descent, int capHeight, int flags,
                        const wxString& fontBBox, int italicAngle, int stemV,
                        int missingWidth, int xHeight,
-                       int underlinePosition, int underlineThickness);
+                       int underlinePosition, int underlineThickness,
+                       int hheaAscender = 0, int hheaDescender = 0, int hheaLineGap = 0,
+                       int os2sTypoAscender = 0, int os2sTypoDescender = 0, int os2sTypoLineGap = 0,
+                       int os2usWinAscent = 0, int os2usWinDescent = 0);
 
   /// Copy constructor
   wxPdfFontDescription(const wxPdfFontDescription& desc);
@@ -183,6 +194,22 @@
   */
   int  GetUnderlineThickness() const { return m_underlineThickness; };
 
+  /// Set OpenType Font Metrics
+  /**
+  * Set font metrics from the OpenType tables hhea and OS/2
+  */
+  void SetOpenTypeMetrics(int hheaAscender, int hheaDescender, int hheaLineGap,
+                          int os2sTypoAscender, int os2sTypoDescender, int os2sTypoLineGap,
+                          int os2usWinAscent, int os2usWinDescent);
+
+  /// Get OpenType Font Metrics
+  /**
+  * Get stored font metrics from the OpneType tables hhea and OS/2
+  */
+  void GetOpenTypeMetrics(int* hheaAscender, int* hheaDescender, int* hheaLineGap,
+                          int* os2sTypoAscender, int* os2sTypoDescender, int* os2sTypoLineGap,
+                          int* os2usWinAscent, int* os2usWinDescent);
+
 private:
   int      m_ascent;                  ///< Ascender
   int      m_descent;                 ///< Descender
@@ -195,6 +222,15 @@
   int      m_xHeight;                 ///< xHeight
   int      m_underlinePosition;       ///< Underline position
   int      m_underlineThickness;      ///< Underline thickness
+
+  int      m_hheaAscender;            ///< hhea table Ascender
+  int      m_hheaDescender;           ///< hhea table Descender
+  int      m_hheaLineGap;             ///< hhea table LineGap
+  int      m_os2sTypoAscender;        ///< OS/2 table sTypoAscender
+  int      m_os2sTypoDescender;       ///< OS/2 table sTypoDescender
+  int      m_os2sTypoLineGap;         ///< OS/2 table sTypoLineGap
+  int      m_os2usWinAscent;          ///< OS/2 table usWinAscent
+  int      m_os2usWinDescent;         ///< OS/2 table usWinDescent
 };
 
 #endif
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/include/wx/pdffontparsertruetype.h wxPdfDoc-copy/include/wx/pdffontparsertruetype.h
--- wxpdfdoc-0.9.2.1/include/wx/pdffontparsertruetype.h	2012-05-04 02:20:32.358000000 +0100
+++ wxPdfDoc-copy/include/wx/pdffontparsertruetype.h	2012-05-22 01:23:11.956400000 +0100
@@ -210,6 +210,12 @@
   wxPdfTableDirectory*  m_tableDirectory;    ///< table directory of the font
 
   bool                  m_isMacCoreText;     ///< Flag whether a Mac Core Text font is to be parsed
+#if defined(__WXMAC__)
+#if wxPDFMACOSX_HAS_CORE_TEXT
+  CTFontRef             m_fontRef;           ///< Mac Core Text font reference
+  wxCFRef<CFDataRef>    m_tableRef;          ///< Font table reference
+#endif
+#endif
 
 private:
   bool                  m_cff;               ///< Flag whether the font is in CFF format
@@ -230,12 +236,6 @@
   wxPdfKernPairMap*     m_kp;                ///< list of kerning pairs
 
   wxInputStream*        m_savedStream;       ///< Saved input stream
-#if defined(__WXMAC__)
-#if wxPDFMACOSX_HAS_CORE_TEXT
-  CTFontRef             m_fontRef;           ///< Mac Core Text font reference
-  wxCFRef<CFDataRef>    m_tableRef;          ///< Font table reference
-#endif
-#endif
 };
 
 #endif
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/include/wx/pdffontsubsettruetype.h wxPdfDoc-copy/include/wx/pdffontsubsettruetype.h
--- wxpdfdoc-0.9.2.1/include/wx/pdffontsubsettruetype.h	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/include/wx/pdffontsubsettruetype.h	2012-05-22 01:23:12.314400000 +0100
@@ -1,5 +1,5 @@
 ///////////////////////////////////////////////////////////////////////////////
-// Name:        pdffont_ttf.h
+// Name:        pdffontsubsettruetype.h
 // Purpose:     
 // Author:      Ulrich Telle
 // Modified by:
@@ -43,6 +43,12 @@
   wxMemoryOutputStream* CreateSubset(wxInputStream* inFont,
                                      wxPdfSortedArrayInt* glyphsUsed,
                                      bool includeCmap = false);
+#if defined(__WXMAC__)
+#if wxPDFMACOSX_HAS_CORE_TEXT
+  /// Set Mac Core Text font reference
+  void SetCTFontRef(const wxFont& font);                                 
+#endif
+#endif
 
 protected:
   /// Read 'loca' table
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/include/wx/pdfobjects.h wxPdfDoc-copy/include/wx/pdfobjects.h
--- wxpdfdoc-0.9.2.1/include/wx/pdfobjects.h	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/include/wx/pdfobjects.h	2012-05-22 01:23:12.015400000 +0100
@@ -53,6 +53,12 @@
   /// Get generation number
   int GetGeneration() { return m_objGen; }
 
+  /// Set actual object id
+  void SetActualId(int actualId) { m_actualId = actualId; }
+
+  // Get actual object id
+  int GetActualId() { return m_actualId; }
+
   /// Flag this object as created through a indirect reference
   void SetCreatedIndirect(bool indirect) { m_indirect = indirect; }
 
@@ -93,6 +99,7 @@
   int  m_type;     ///< Object type
   int  m_objNum;   ///< Object number
   int  m_objGen;   ///< Object generation
+  int  m_actualId; ///< Actual object id
   bool m_indirect; ///< Flag whether created through indirect reference
 };
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/include/wx/pdfprint.h wxPdfDoc-copy/include/wx/pdfprint.h
--- wxpdfdoc-0.9.2.1/include/wx/pdfprint.h	1970-01-01 00:00:00.000000000 +0000
+++ wxPdfDoc-copy/include/wx/pdfprint.h	2012-05-22 01:23:12.303400000 +0100
@@ -0,0 +1,1265 @@
+/////////////////////////////////////////////////////////////////////////////
+// Name:        wx/pdfprint.h
+// Purpose:     wxPdfPrinter, wxPdfPrintNativeData
+// Author:      Mark Dootson
+// Modified by:
+// Created:     11 May 2012
+// SVN-ID:      $Id$
+// Copyright:   (c) 2012 Ulrich Telle
+// Licence:     wxWindows licence
+/////////////////////////////////////////////////////////////////////////////
+
+#ifndef _PDF_PRINTING_H_
+#define _PDF_PRINTING_H_
+
+// wxPdfDocument headers
+#include "wx/pdfdocdef.h"
+
+#include <wx/defs.h>
+
+#include <wx/dialog.h>
+#include <wx/cmndata.h>
+#include <wx/prntbase.h>
+#include <wx/printdlg.h>
+#include <wx/listctrl.h>
+#include <wx/filepicker.h>
+#include <wx/checkbox.h>
+
+#include "wx/pdfdc.h"
+
+#define wxPDF_PRINTER_DEFAULT_RESOLUTION 600
+
+//----------------------------------------------------------------------------
+// wxPdfPrintData
+//----------------------------------------------------------------------------
+
+#define wxPDF_PRINTDIALOG_ALLOWNONE  0
+#define wxPDF_PRINTDIALOG_FILEPATH   0x01
+#define wxPDF_PRINTDIALOG_PROPERTIES 0x02
+#define wxPDF_PRINTDIALOG_PROTECTION 0x04
+#define wxPDF_PRINTDIALOG_OPENDOC    0x08
+#define wxPDF_PRINTDIALOG_ALLOWALL   wxPDF_PRINTDIALOG_FILEPATH   \
+                                    |wxPDF_PRINTDIALOG_PROPERTIES \
+                                    |wxPDF_PRINTDIALOG_PROTECTION \
+                                    |wxPDF_PRINTDIALOG_OPENDOC
+
+class WXDLLIMPEXP_PDFDOC wxPdfPrintData : public wxObject
+{
+public:
+  wxPdfPrintData();
+  wxPdfPrintData(wxPdfPrintData* pdfPrintData);
+  wxPdfPrintData(wxPrintData* printData);
+  wxPdfPrintData(wxPrintDialogData* printDialogData);
+  wxPdfPrintData(wxPageSetupDialogData* pageSetupDialogData);
+
+  bool Ok() const { return IsOk(); }
+  bool IsOk() const { return true; }
+
+  // wxPrintData compatibility
+
+#if wxCHECK_VERSION(2,9,0)
+  wxPrintOrientation GetOrientation() const { return m_printOrientation; }
+  void SetOrientation(wxPrintOrientation orient) { m_printOrientation = orient; }
+#else
+  int GetOrientation() const { return m_printOrientation; }
+  void SetOrientation(int orient) { m_printOrientation = orient; }
+#endif
+
+  wxPaperSize GetPaperId() const { return m_paperId; }
+  void SetPaperId(wxPaperSize sizeId) { m_paperId = sizeId; }
+
+  wxPrintQuality GetQuality() const { return m_printQuality; }    
+  void SetQuality(wxPrintQuality quality) { m_printQuality = quality; }
+
+  wxString GetFilename() const { return m_filename; }
+  void SetFilename( const wxString &filename ) { m_filename = filename; }
+
+  // wxPrintDialogData compatibility
+
+  int GetFromPage() const { return m_printFromPage; }
+  int GetToPage() const { return m_printToPage; }
+  int GetMinPage() const { return m_printMinPage; }
+  int GetMaxPage() const { return m_printMaxPage; }
+  void SetFromPage(int v) { m_printFromPage = v; }
+  void SetToPage(int v) { m_printToPage = v; }
+  void SetMinPage(int v) { m_printMinPage = v; }
+  void SetMaxPage(int v) { m_printMaxPage = v; }
+
+  // wxPdfPrintDialog flags
+
+  int GetPrintDialogFlags() const { return m_printDialogFlags; }
+  void SetPrintDialogFlags(int flags) { m_printDialogFlags = flags; }
+
+  // wxPdfDocument specific
+
+  void SetTemplate(wxPdfDocument* pdfDocument, double templateWidth, double templateHeight);
+  wxPdfDocument* GetTemplateDocument() const { return m_templateDocument; }
+  double GetTemplateWidth() const { return m_templateWidth; }
+  double GetTemplateHeight() const { return m_templateHeight; }
+  bool GetTemplateMode() const { return m_templateMode; }
+
+  int GetPrintResolution() const;
+  void SetPrintResolution( int resolution ) { m_printQuality = resolution; }
+
+  bool GetLaunchDocumentViewer() const { return m_launchViewer; }
+  void SetLaunchDocumentViewer( bool enable ) { m_launchViewer = enable; }
+
+  const wxString& GetDocumentTitle() const { return m_documentTitle; }
+  const wxString& GetDocumentSubject() const { return m_documentSubject; }
+  const wxString& GetDocumentAuthor() const { return m_documentAuthor; }
+  const wxString& GetDocumentKeywords() const { return m_documentKeywords; }
+  const wxString& GetDocumentCreator() const { return m_documentCreator; }
+
+  void SetDocumentTitle(const wxString& title) { m_documentTitle = title; }
+  void SetDocumentSubject(const wxString& subject) { m_documentSubject = subject; }
+  void SetDocumentAuthor(const wxString& author) { m_documentAuthor = author; }
+  void SetDocumentKeywords(const wxString& keywords) { m_documentKeywords = keywords; }
+  void SetDocumentCreator(const wxString& creator) { m_documentCreator = creator; }
+
+  bool IsProtectionEnabled() const { return  m_protectionEnabled; }
+
+  void SetDocumentProtection(int permissions,
+                             const wxString& userPassword = wxEmptyString,
+                             const wxString& ownerPassword = wxEmptyString,
+                             wxPdfEncryptionMethod encryptionMethod = wxPDF_ENCRYPTION_RC4V1,
+                             int keyLength = 0);
+
+  const wxString& GetUserPassword() const { return m_userPassword; }
+  const wxString& GetOwnerPassword() const { return m_ownerPassword; }
+  int GetPermissions() const { return m_permissions; }
+  wxPdfEncryptionMethod GetEncryptionMethod() const { return m_encryptionMethod; }
+  int GetKeyLength() const { return m_keyLength; }
+
+  void ClearDocumentProtection();
+
+  void UpdateDocument(wxPdfDocument* pdfDoc);
+
+  // Utility methods
+  wxPrintData* CreatePrintData() const;
+
+private:
+  void Init();
+
+  wxString              m_documentTitle;
+  wxString              m_documentSubject;
+  wxString              m_documentAuthor;
+  wxString              m_documentKeywords;
+  wxString              m_documentCreator;
+  bool                  m_protectionEnabled;
+  wxString              m_userPassword;
+  wxString              m_ownerPassword;
+  int                   m_permissions;
+  wxPdfEncryptionMethod m_encryptionMethod;
+  int                   m_keyLength;
+#if wxCHECK_VERSION(2,9,0)
+  wxPrintOrientation    m_printOrientation;
+#else
+  int                   m_printOrientation;
+#endif
+  int                   m_printQuality;
+  wxPaperSize           m_paperId;
+  wxString              m_filename;
+
+  int                   m_printFromPage;
+  int                   m_printToPage;
+  int                   m_printMinPage;
+  int                   m_printMaxPage;
+
+  int                   m_printDialogFlags;
+  bool                  m_launchViewer;
+
+  wxPdfDocument*        m_templateDocument;
+  double                m_templateHeight;
+  double                m_templateWidth;
+  bool                  m_templateMode;
+
+private:
+  DECLARE_DYNAMIC_CLASS(wxPdfPrintData)
+};
+
+
+//----------------------------------------------------------------------------
+// wxPdfPrinter
+//----------------------------------------------------------------------------
+
+class WXDLLIMPEXP_PDFDOC wxPdfPrinter : public wxPrinterBase
+{
+public:
+  wxPdfPrinter();
+  wxPdfPrinter(wxPrintDialogData* data);
+  wxPdfPrinter(wxPdfPrintData* data);
+  wxPdfPrinter(wxPrintData* data);
+
+  // standard implementation
+  virtual bool Print(wxWindow* parent, wxPrintout* printout, bool prompt = true);
+  virtual wxDC* PrintDialog(wxWindow* parent);
+  virtual bool Setup(wxWindow* parent);
+
+  // our additions
+  void ShowProgressDialog(bool show) { m_showProgressDialog = show; } 
+
+private:
+
+  void GetPdfScreenPPI(int* x, int* y);
+
+  bool            m_showProgressDialog;
+  wxPdfPrintData  m_pdfPrintData;
+
+  DECLARE_DYNAMIC_CLASS(wxPdfPrinter)
+};
+
+// ----------------------------------------------------------------------------
+// wxPdfPrintPreview: programmer creates an object of this class to preview a
+// wxPrintout.
+// ----------------------------------------------------------------------------
+
+class WXDLLIMPEXP_PDFDOC wxPdfPrintPreview : public wxPrintPreviewBase
+{
+public:
+  wxPdfPrintPreview(wxPrintout* printout,
+                    wxPrintout* printoutForPrinting );
+
+  wxPdfPrintPreview(wxPrintout* printout,
+                    wxPrintout* printoutForPrinting,
+                    wxPrintDialogData* data);
+
+  wxPdfPrintPreview(wxPrintout* printout,
+                    wxPrintout* printoutForPrinting,
+                    wxPrintData* data);
+
+  wxPdfPrintPreview(wxPrintout* printout,
+                    wxPrintout* printoutForPrinting,
+                    wxPdfPrintData* data);
+
+  virtual ~wxPdfPrintPreview();
+
+  virtual bool SetCurrentPage(int pageNum);
+  virtual int GetCurrentPage() const;
+  virtual void SetPrintout(wxPrintout* printout);
+  virtual wxPrintout* GetPrintout() const;
+  virtual wxPrintout* GetPrintoutForPrinting() const;
+  virtual void SetFrame(wxFrame* frame);
+  virtual void SetCanvas(wxPreviewCanvas* canvas);
+
+  virtual wxFrame* GetFrame() const;
+  virtual wxPreviewCanvas* GetCanvas() const;
+  virtual bool PaintPage(wxPreviewCanvas* canvas, wxDC& dc);
+#if wxCHECK_VERSION(2,9,0)    
+  virtual bool UpdatePageRendering();
+#endif
+  virtual bool DrawBlankPage(wxPreviewCanvas* canvas, wxDC& dc);
+  virtual void AdjustScrollbars(wxPreviewCanvas* canvas);
+  virtual bool RenderPage(int pageNum);
+  virtual void SetZoom(int percent);
+  virtual int GetZoom() const;
+
+  virtual bool Print(bool interactive);
+  virtual void DetermineScaling();
+
+  virtual wxPrintDialogData& GetPrintDialogData();
+
+  virtual int GetMaxPage() const;
+  virtual int GetMinPage() const;
+
+  virtual bool Ok() const { return IsOk(); }
+  virtual bool IsOk() const;
+  virtual void SetOk(bool ok);
+
+private:
+  wxPrintPreviewBase* m_pimpl;
+
+private:
+  DECLARE_CLASS(wxPdfPrintPreview)
+  DECLARE_NO_COPY_CLASS(wxPdfPrintPreview);
+};
+
+
+class WXDLLIMPEXP_PDFDOC wxPdfPrintPreviewImpl : public wxPrintPreviewBase
+{
+public:
+  wxPdfPrintPreviewImpl(wxPrintout* printout,
+                        wxPrintout* printoutForPrinting );
+
+  wxPdfPrintPreviewImpl(wxPrintout* printout,
+                        wxPrintout* printoutForPrinting,
+                        wxPrintDialogData* data);
+
+  wxPdfPrintPreviewImpl(wxPrintout* printout,
+                        wxPrintout* printoutForPrinting,
+                        wxPrintData* data);
+
+  wxPdfPrintPreviewImpl(wxPrintout* printout,
+                        wxPrintout* printoutForPrinting,
+                        wxPdfPrintData* data);
+
+  virtual ~wxPdfPrintPreviewImpl();
+
+  virtual bool Print(bool interactive);
+  virtual void DetermineScaling();
+
+#if wxCHECK_VERSION(2,9,0)
+
+protected:
+  virtual bool RenderPageIntoBitmap(wxBitmap& bmp, int pageNum);
+
+#else
+
+public:
+  bool RenderPageIntoDCImpl(wxDC& dc, int pageNum);
+  bool RenderPageIntoBitmapImpl(wxBitmap& bmp, int pageNum);
+  virtual bool RenderPage(int pageNum);
+
+#endif
+
+private:
+
+  void GetPdfScreenPPI(int* x, int* y);
+
+private:
+
+  wxPdfPrintData*  m_pdfPrintData;
+  wxPdfDC*         m_pdfPreviewDC;
+  wxPdfDocument*   m_pdfPreviewDoc;
+
+  DECLARE_CLASS(wxPdfPrintPreviewImpl)
+};
+
+enum
+{
+  wxPDF_PRINTDIALOG_CTRLID_FILEPICKER = 30,
+  wxPDF_PRINTDIALOG_CTRLID_PROTECT
+};
+
+// -------------------------------------------------------------------------
+// wxPdfPrintDialog: populate wxPdfPrintData with user choices
+// -------------------------------------------------------------------------
+
+class WXDLLIMPEXP_PDFDOC wxPdfPrintDialog : public wxPrintDialogBase
+{
+public:
+
+  wxPdfPrintDialog(wxWindow* parent, wxPdfPrintData* data);
+
+  virtual ~wxPdfPrintDialog();
+
+  void OnOK(wxCommandEvent& event);
+
+  virtual bool TransferDataFromWindow();
+  virtual bool TransferDataToWindow();
+
+  virtual int ShowModal();
+
+  wxPdfDC* GetPrintDC();
+
+  wxPrintData& GetPrintData() { return m_printDialogData.GetPrintData(); }
+
+  wxPrintDialogData& GetPrintDialogData() { return m_printDialogData; }
+
+  wxPdfPrintData& GetPdfPrintData() { return m_pdfPrintData; }
+
+private:
+
+  wxTextCtrl*         m_title;
+  wxTextCtrl*         m_subject;
+  wxTextCtrl*         m_author;
+  wxTextCtrl*         m_creator;
+  wxTextCtrl*         m_keywords;
+
+  wxTextCtrl*         m_filepath;
+  wxFilePickerCtrl*   m_filepicker;
+  wxCheckBox*         m_launchViewer;
+
+  wxTextCtrl*         m_ownerpwd;
+  wxTextCtrl*         m_userpwd;
+  wxTextCtrl*         m_ownerpwdconfirm;
+  wxTextCtrl*         m_userpwdconfirm;
+
+  wxChoice*           m_compat;
+
+  wxCheckBox*         m_protect;
+  wxCheckBox*         m_canprint;
+  wxCheckBox*         m_canmodify;
+  wxCheckBox*         m_cancopy;
+  wxCheckBox*         m_canannot;
+  wxCheckBox*         m_canform;
+  wxCheckBox*         m_canextract;
+  wxCheckBox*         m_canassemble;
+
+  wxPrintDialogData   m_printDialogData;
+  wxPdfPrintData      m_pdfPrintData;
+
+protected:
+  void Init(wxWindow* parent);
+
+private:
+
+  void UpdateProtectionControls();
+  void OnProtectCheck(wxCommandEvent&);
+  void OnFilepathChanged(wxFileDirPickerEvent&);
+
+  DECLARE_EVENT_TABLE()
+  DECLARE_DYNAMIC_CLASS(wxPdfPrintDialog)
+};
+
+// ----------------------------------------------------------------------------
+// wxPdfPageSetupDialogCanvas: internal use only
+// ----------------------------------------------------------------------------
+
+class WXDLLIMPEXP_PDFDOC wxPdfPageSetupDialogCanvas : public wxWindow
+{
+
+  DECLARE_CLASS(wxPdfPageSetupDialogCanvas)
+
+public:
+  wxPdfPageSetupDialogCanvas(wxWindow *parent);
+
+  virtual ~wxPdfPageSetupDialogCanvas();
+
+  void OnPaint(wxPaintEvent& event);
+
+  void UpdatePageMetrics(int paperWidth, int paperHeight, int marginLeft,
+                         int marginRight, int marginTop, int marginBottom)
+  {
+    m_paperWidth   = paperWidth;
+    m_paperHeight  = paperHeight;
+    m_marginLeft   = marginLeft;
+    m_marginRight  = marginRight;
+    m_marginTop    = marginTop;
+    m_marginBottom = marginBottom;
+  }
+
+private:
+
+  int m_paperWidth;
+  int m_paperHeight;
+  int m_marginLeft;
+  int m_marginRight;
+  int m_marginTop;
+  int m_marginBottom;
+
+  DECLARE_EVENT_TABLE()
+  DECLARE_NO_COPY_CLASS(wxPdfPageSetupDialogCanvas)
+};
+
+// ----------------------------------------------------------------------------
+// wxPdfPageSetupDialog: a wxPdfDocument friendly page setup dialog
+// ----------------------------------------------------------------------------
+
+enum
+{
+  wxPDF_PAGEDIALOG_CTRLID_MARGINUNIT = 30,
+  wxPDF_PAGEDIALOG_CTRLID_MARGINLEFT,
+  wxPDF_PAGEDIALOG_CTRLID_MARGINRIGHT,
+  wxPDF_PAGEDIALOG_CTRLID_MARGINTOP,
+  wxPDF_PAGEDIALOG_CTRLID_MARGINBOTTOM,
+  wxPDF_PAGEDIALOG_CTRLID_PAPER,
+  wxPDF_PAGEDIALOG_CTRLID_ORIENTATION,
+};
+
+class WXDLLIMPEXP_PDFDOC wxPdfPageSetupDialog : public wxDialog
+{
+  DECLARE_CLASS(wxPdfPageSetupDialog)
+
+public:
+  wxPdfPageSetupDialog(wxWindow *parent,
+                       wxPageSetupDialogData* data,
+                       const wxString& title = wxEmptyString);
+
+  virtual ~wxPdfPageSetupDialog();
+
+  void OnOK(wxCommandEvent& event);
+  void OnMarginUnit(wxCommandEvent& event);
+  void OnPaperType(wxCommandEvent& event);
+  void OnOrientation(wxCommandEvent& event);
+  void OnMarginText(wxCommandEvent& event);
+
+  virtual bool TransferDataFromWindow();
+  virtual bool TransferDataToWindow();
+
+  virtual wxPageSetupDialogData& GetPageSetupDialogData();
+  // support old name used in wxPageSetupDialog
+  wxPageSetupDialogData& GetPageSetupData();
+
+protected:
+
+  wxChoice*       m_orientationChoice;
+  wxChoice*       m_marginUnits;
+  wxTextCtrl*     m_marginLeftText;
+  wxTextCtrl*     m_marginTopText;
+  wxTextCtrl*     m_marginRightText;
+  wxTextCtrl*     m_marginBottomText;
+  wxChoice*       m_paperTypeChoice;
+
+private:
+  int             m_marginLeft;
+  int             m_marginTop;
+  int             m_marginRight;
+  int             m_marginBottom;
+#if wxCHECK_VERSION(2,9,0)
+  wxPrintOrientation m_orientation;
+#else
+  int             m_orientation;
+#endif
+  wxPaperSize     m_paperId;
+  wxPaperSize     m_defaultPaperId;
+  int             m_defaultUnitSelection;
+  int             m_pageWidth;
+  int             m_pageHeight;
+    
+  wxPdfPageSetupDialogCanvas*       m_paperCanvas;
+  wxPageSetupDialogData             m_pageData;
+
+  void Init();
+
+  void TransferMarginsToControls();
+  void TransferControlsToMargins();
+  void UpdatePaperCanvas();
+    
+  DECLARE_EVENT_TABLE()
+  DECLARE_NO_COPY_CLASS(wxPdfPageSetupDialog)
+};
+
+
+// ----------------------------------------------------------------------------
+// wxPdfPreviewDC allows to return text extents from a wxPdfDC
+// Internal use Only
+// ----------------------------------------------------------------------------
+
+#if wxCHECK_VERSION(2,9,0)
+// 2.9.x implementation
+
+class WXDLLIMPEXP_PDFDOC wxPdfPreviewDCImpl : public wxDCImpl
+{
+public:
+
+  wxPdfPreviewDCImpl(wxDC* owner, wxDCImpl& dc, wxPdfDC* pdfdc)
+    : wxDCImpl(owner), m_dc(dc)
+  {
+    m_pdfdc = pdfdc;
+  }
+
+  //////////////////////////////////////////////////////////////////
+  // Overrides passed to wxPdfDC
+  //////////////////////////////////////////////////////////////////
+
+  wxPdfDocument* GetPdfDocument() const
+  {
+    return m_pdfdc->GetPdfDocument();
+  }
+
+  virtual wxRect GetPaperRect() const
+  {
+    int w = 0; 
+    int h = 0; 
+    m_pdfdc->GetImpl()->DoGetSize(&w, &h);
+    return wxRect(0,0,w,h);
+  }
+
+  virtual int GetResolution() const { return m_pdfdc->GetResolution(); }
+
+  virtual bool CanGetTextExtent() const { return m_pdfdc->CanGetTextExtent(); }
+
+  virtual wxCoord GetCharHeight() const { return m_pdfdc->GetCharHeight(); }
+  virtual wxCoord GetCharWidth() const { return m_pdfdc->GetCharWidth(); }
+
+  virtual void DoGetFontMetrics(int* height,
+                                int* ascent,
+                                int* descent,
+                                int* internalLeading,
+                                int* externalLeading,
+                                int* averageWidth) const
+  {
+    m_pdfdc->GetImpl()->DoGetFontMetrics(height, ascent, descent, internalLeading, externalLeading, averageWidth);
+  }
+
+  virtual void DoGetTextExtent(const wxString& string,
+                               wxCoord* x, wxCoord* y,
+                               wxCoord* descent = NULL,
+                               wxCoord* externalLeading = NULL,
+                               const wxFont* theFont = NULL) const
+  {
+    m_pdfdc->GetTextExtent(string, x, y, descent, externalLeading, theFont);
+  }
+
+  virtual bool DoGetPartialTextExtents(const wxString& text, wxArrayInt& widths) const
+  {
+    return m_pdfdc->GetPartialTextExtents(text, widths);
+  }
+
+  virtual void GetMultiLineTextExtent(const wxString& string,
+                                      wxCoord* width,
+                                      wxCoord* height,
+                                      wxCoord* heightLine = NULL,
+                                      const wxFont* font = NULL) const
+  {
+    m_pdfdc->GetMultiLineTextExtent(string, width, height, heightLine, font);
+  }
+
+  virtual wxSize GetPPI() const { return m_pdfdc->GetPPI(); }
+
+private:
+
+  void UpdateBoundingBox() const
+  {
+    ((wxDCImpl*)this)->wxDCImpl::CalcBoundingBox(m_dc.MinX(), m_dc.MinY());
+    ((wxDCImpl*)this)->wxDCImpl::CalcBoundingBox(m_dc.MaxX(), m_dc.MaxY());
+  }
+
+public:
+
+  //////////////////////////////////////////////////////////////////
+  // Overrides passed to wxMemory DC
+  //////////////////////////////////////////////////////////////////
+
+  virtual void DoGetSize(int* w, int* h) const
+  {
+    m_dc.DoGetSize(w,h);
+  }
+
+  virtual void DoGetSizeMM(int* w, int* h) const
+  {
+    m_dc.DoGetSizeMM(w,h);
+  }
+
+  virtual bool IsOk() const { return m_dc.IsOk(); }
+
+  // wxDCBase operations
+  virtual bool CanDrawBitmap() const { return m_dc.CanDrawBitmap(); }
+
+  virtual void Clear() { m_dc.Clear(); }
+
+  virtual int GetDepth() const { return m_dc.GetDepth(); }
+
+  virtual void CalcBoundingBox(wxCoord x, wxCoord y)
+  {
+    m_dc.CalcBoundingBox( x, y);
+    UpdateBoundingBox();
+  }
+
+  virtual void SetFont(const wxFont& font)
+  {
+    m_dc.SetFont(font);
+    m_pdfdc->SetFont(font);
+  }
+
+  virtual const wxFont& GetFont() const { return m_dc.GetFont(); }
+
+  virtual void SetPen(const wxPen& pen) { m_dc.SetPen(pen); }
+  virtual const wxPen& GetPen() const { return m_dc.GetPen(); }
+  virtual void SetBrush(const wxBrush& brush) { m_dc.SetBrush(brush); }
+  virtual const wxBrush& GetBrush() const { return m_dc.GetBrush(); }
+  virtual void SetBackground(const wxBrush& brush) { m_dc.SetBackground(brush); }
+  virtual const wxBrush& GetBackground() const { return m_dc.GetBackground(); }
+  virtual void SetBackgroundMode(int mode){ m_dc.SetBackgroundMode(mode); }
+  virtual int GetBackgroundMode() const { return m_dc.GetBackgroundMode(); }
+
+  virtual void SetTextForeground(const wxColour& colour) { m_dc.SetTextForeground(colour); }
+  virtual const wxColour& GetTextForeground() const { return m_dc.GetTextForeground(); }
+
+  virtual void SetTextBackground(const wxColour& colour) { m_dc.SetTextBackground(colour); }
+  virtual const wxColour& GetTextBackground() const { return m_dc.GetTextBackground(); }
+
+#if wxUSE_PALETTE
+  virtual void SetPalette(const wxPalette& palette) { m_dc.SetPalette(palette); }
+#endif // wxUSE_PALETTE
+
+  virtual void InheritAttributes(wxWindow* win) { m_dc.InheritAttributes(win); }
+
+  virtual void SetLogicalFunction(wxRasterOperationMode function) { m_dc.SetLogicalFunction(function); }
+  virtual wxRasterOperationMode GetLogicalFunction() const { return m_dc.GetLogicalFunction(); }
+
+  virtual void DoSetClippingRegion(wxCoord x, wxCoord y, wxCoord w, wxCoord h)
+  {
+    m_dc.DoSetClippingRegion(x,y,w,h);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoSetDeviceClippingRegion(const wxRegion& region)
+  {
+    m_dc.DoSetDeviceClippingRegion(region);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoGetClippingBox(wxCoord* x, wxCoord* y, wxCoord* w, wxCoord* h) const
+  {
+    m_dc.DoGetClippingBox(x, y, w, h);
+    UpdateBoundingBox();
+  }
+
+  virtual void DestroyClippingRegion()
+  {
+    m_dc.DestroyClippingRegion();
+    UpdateBoundingBox();
+  }
+
+  virtual wxCoord DeviceToLogicalX(wxCoord x) const { return m_dc.DeviceToLogicalX(x); }
+  virtual wxCoord DeviceToLogicalY(wxCoord y) const { return m_dc.DeviceToLogicalY(y); }
+  virtual wxCoord DeviceToLogicalXRel(wxCoord x) const { return m_dc.DeviceToLogicalXRel(x); }
+  virtual wxCoord DeviceToLogicalYRel(wxCoord y) const { return m_dc.DeviceToLogicalYRel(y); }
+  virtual wxCoord LogicalToDeviceX(wxCoord x) const { return m_dc.LogicalToDeviceX(x); }
+  virtual wxCoord LogicalToDeviceY(wxCoord y) const { return m_dc.LogicalToDeviceY(y); }
+  virtual wxCoord LogicalToDeviceXRel(wxCoord x) const { return m_dc.LogicalToDeviceXRel(x); }
+  virtual wxCoord LogicalToDeviceYRel(wxCoord y) const { return m_dc.LogicalToDeviceYRel(y); }
+
+  virtual void SetMapMode(wxMappingMode mode) { m_dc.SetMapMode(mode); }
+  virtual wxMappingMode GetMapMode() const { return m_dc.GetMapMode(); }
+
+  virtual void SetUserScale(double x, double y) { m_dc.SetUserScale(x,y); }
+  virtual void GetUserScale(double* x, double* y) const { m_dc.GetUserScale(x, y); }
+
+  virtual void SetLogicalScale(double x, double y) { m_dc.SetLogicalScale(x,y); }
+  virtual void GetLogicalScale(double* x, double* y) const { m_dc.GetLogicalScale(x,y); }
+
+  virtual void SetLogicalOrigin(wxCoord x, wxCoord y) { m_dc.SetLogicalOrigin(x,y); }
+  virtual void DoGetLogicalOrigin(wxCoord* x, wxCoord* y) const { m_dc.DoGetLogicalOrigin(x,y); }
+
+  virtual void SetDeviceOrigin(wxCoord x, wxCoord y) { m_dc.SetDeviceOrigin(x,y); }
+  virtual void DoGetDeviceOrigin(wxCoord* x, wxCoord* y) const { m_dc.DoGetDeviceOrigin(x,y); }
+
+  virtual void SetDeviceLocalOrigin( wxCoord x, wxCoord y ) { m_dc.SetDeviceLocalOrigin(x,y); }
+  virtual void ComputeScaleAndOrigin() { m_dc.ComputeScaleAndOrigin(); }
+  virtual void SetAxisOrientation(bool x, bool y) { m_dc.SetAxisOrientation(x,y); }
+
+  virtual bool DoFloodFill(wxCoord x, wxCoord y, const wxColour& col,
+                           wxFloodFillStyle style = wxFLOOD_SURFACE)
+  {
+    bool rval = m_dc.DoFloodFill(x, y, col, style);
+    UpdateBoundingBox();
+    return rval;
+  }
+
+  virtual void DoGradientFillLinear(const wxRect& rect,
+                                    const wxColour& initialColour,
+                                    const wxColour& destColour,
+                                    wxDirection nDirection = wxEAST)
+  {
+    m_dc.DoGradientFillLinear(rect, initialColour, destColour, nDirection);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoGradientFillConcentric(const wxRect& rect,
+                                        const wxColour& initialColour,
+                                        const wxColour& destColour,
+                                        const wxPoint& circleCenter)
+  {
+    m_dc.DoGradientFillConcentric(rect, initialColour, destColour, circleCenter);
+    UpdateBoundingBox();
+  }
+
+  virtual bool DoGetPixel(wxCoord x, wxCoord y, wxColour* col) const
+  {
+    bool rval = m_dc.DoGetPixel(x, y, col);
+    UpdateBoundingBox();
+    return rval;
+  }
+
+  virtual void DoDrawPoint(wxCoord x, wxCoord y)
+  {
+    m_dc.DoDrawPoint(x,y);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawLine(wxCoord x1, wxCoord y1, wxCoord x2, wxCoord y2)
+  {
+    m_dc.DoDrawLine(x1,y1,x2,y2);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawArc(wxCoord x1, wxCoord y1,
+                         wxCoord x2, wxCoord y2,
+                         wxCoord xc, wxCoord yc)
+  {
+    m_dc.DoDrawArc(x1,y1, x2,y2, xc, yc);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawCheckMark(wxCoord x, wxCoord y,
+                               wxCoord w, wxCoord h)
+  {
+    m_dc.DoDrawCheckMark(x,y,w,h);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawEllipticArc(wxCoord x, wxCoord y, wxCoord w, wxCoord h,
+                                 double sa, double ea)
+  {
+    m_dc.DoDrawEllipticArc(x,y,w,h,sa, ea);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawRectangle(wxCoord x, wxCoord y, wxCoord w, wxCoord h)
+  {
+    m_dc.DoDrawRectangle(x,y,w,h);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawRoundedRectangle(wxCoord x, wxCoord y,
+                                      wxCoord w, wxCoord h,
+                                      double radius)
+  {
+    m_dc.DoDrawRoundedRectangle(x,y,w,h,radius);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawEllipse(wxCoord x, wxCoord y, wxCoord w, wxCoord h)
+  {
+    m_dc.DoDrawEllipse(x,y,w,h);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoCrossHair(wxCoord x, wxCoord y)
+  {
+    m_dc.DoCrossHair(x,y);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawIcon(const wxIcon& icon, wxCoord x, wxCoord y)
+  {
+    m_dc.DoDrawIcon(icon, x,y);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawBitmap(const wxBitmap &bmp, wxCoord x, wxCoord y,
+                            bool useMask = false)
+  {
+    m_dc.DoDrawBitmap(bmp, x,y, useMask);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawText(const wxString& text, wxCoord x, wxCoord y)
+  {
+    m_dc.DoDrawText(text, x, y);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawRotatedText(const wxString& text,
+                                 wxCoord x, wxCoord y, double angle)
+  {
+    m_dc.DoDrawRotatedText(text, x, y, angle);
+    UpdateBoundingBox();
+  }
+
+  virtual bool DoBlit(wxCoord xdest, wxCoord ydest,
+                      wxCoord w, wxCoord h,
+                      wxDC* source, wxCoord xsrc, wxCoord ysrc,
+                      wxRasterOperationMode rop = wxCOPY,
+                      bool useMask = false,
+                      wxCoord xsrcMask = wxDefaultCoord, wxCoord ysrcMask = wxDefaultCoord)
+  {
+    bool rval = m_dc.DoBlit(xdest, ydest, w, h, source, xsrc, ysrc, rop, useMask, xsrcMask, ysrcMask);
+    UpdateBoundingBox();
+    return rval;
+  }
+
+  virtual bool DoStretchBlit(wxCoord xdest, wxCoord ydest,
+                             wxCoord dstWidth, wxCoord dstHeight,
+                             wxDC* source,
+                             wxCoord xsrc, wxCoord ysrc,
+                             wxCoord srcWidth, wxCoord srcHeight,
+                             wxRasterOperationMode rop = wxCOPY,
+                             bool useMask = false,
+                             wxCoord xsrcMask = wxDefaultCoord,
+                             wxCoord ysrcMask = wxDefaultCoord)
+  {
+    bool rval = m_dc.DoStretchBlit(xdest, ydest, dstWidth, dstHeight, source, xsrc, ysrc,
+                                   srcWidth, srcHeight, rop, useMask, xsrcMask, ysrcMask);
+    UpdateBoundingBox();
+    return rval;
+  }
+
+  virtual void DoDrawLines(int n, wxPoint points[],
+                           wxCoord xoffset, wxCoord yoffset)
+  {
+    m_dc.DoDrawLines(n, points,xoffset, yoffset);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawPolygon(int n, wxPoint points[],
+                             wxCoord xoffset, wxCoord yoffset,
+                             wxPolygonFillMode fillStyle = wxODDEVEN_RULE)
+  {
+    m_dc.DoDrawPolygon(n, points, xoffset, yoffset, fillStyle);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoSetClippingRegionAsRegion(const wxRegion& region)
+  {
+    wxCoord x, y, w, h;
+    region.GetBox(x, y, w, h);
+    m_dc.DoSetClippingRegion(x, y, w, h);
+    UpdateBoundingBox();
+  }
+
+private:
+  wxDCImpl&    m_dc;
+  wxPdfDC*  m_pdfdc;
+
+  wxDECLARE_NO_COPY_CLASS(wxPdfPreviewDCImpl);
+};
+
+class WXDLLIMPEXP_PDFDOC wxPdfPreviewDC : public wxDC
+{
+public:
+  wxPdfPreviewDC(wxDC& dc, wxPdfDC* pdfdc)
+    : wxDC(new wxPdfPreviewDCImpl(this, *dc.GetImpl(), pdfdc)) { }
+
+private:
+
+    wxDECLARE_NO_COPY_CLASS(wxPdfPreviewDC);
+};
+
+#else
+
+/////////////////////////////////////////////////////////////////
+// 2.8.x wxPdfPreview implementation
+/////////////////////////////////////////////////////////////////
+
+class WXDLLIMPEXP_PDFDOC wxPdfPreviewDC : public wxDC
+{
+public:
+  wxPdfPreviewDC(wxDC& dc, wxPdfDC* pdfdc)
+    : m_dc((wxPdfPreviewDC&)dc)
+  {
+    m_pdfdc = pdfdc;
+  }
+
+  //////////////////////////////////////////////////////////////////
+  // Overrides passed to wxPdfDC
+  //////////////////////////////////////////////////////////////////
+
+  wxPdfDocument* GetPdfDocument() const
+  {
+    return m_pdfdc->GetPdfDocument();
+  }
+
+  virtual wxRect GetPaperRect() const
+  {
+    int w = 0;
+    int h = 0;
+    m_pdfdc->GetSize(&w, &h);
+    return wxRect(0, 0, w, h);
+  }
+
+  virtual int GetResolution() const { return m_pdfdc->GetResolution(); }
+
+  virtual bool CanGetTextExtent() const { return m_pdfdc->CanGetTextExtent(); }
+
+  virtual wxCoord GetCharHeight() const { return m_pdfdc->GetCharHeight(); }
+  virtual wxCoord GetCharWidth() const { return m_pdfdc->GetCharWidth(); }
+
+protected:
+
+  virtual void DoGetTextExtent(const wxString& string,
+                               wxCoord* x, wxCoord* y,
+                               wxCoord* descent = NULL,
+                               wxCoord* externalLeading = NULL,
+                               wxFont* theFont = NULL) const
+  {
+    m_pdfdc->GetTextExtent(string, x, y, descent, externalLeading, theFont);
+  }
+
+  virtual bool DoGetPartialTextExtents(const wxString& text, wxArrayInt& widths) const
+  {
+    return m_pdfdc->GetPartialTextExtents(text, widths);
+  }
+
+public:
+
+  virtual void GetMultiLineTextExtent(const wxString& string,
+                                      wxCoord* width,
+                                      wxCoord* height,
+                                      wxCoord* heightLine = NULL,
+                                      wxFont* font = NULL) const
+  {
+    m_pdfdc->GetMultiLineTextExtent(string, width, height, heightLine, font);
+  }
+
+private:
+
+  void UpdateBoundingBox() const
+  {
+    ((wxDC*)this)->wxDC::CalcBoundingBox( m_dc.MinX(), m_dc.MinY());
+    ((wxDC*)this)->wxDC::CalcBoundingBox( m_dc.MaxX(), m_dc.MaxY());
+  }
+
+public:
+
+  //////////////////////////////////////////////////////////////////
+  // Overrides passed to wxMemory DC
+  //////////////////////////////////////////////////////////////////
+
+  virtual wxSize GetPPI() const { return m_dc.GetPPI(); }
+
+  // wxDCBase operations
+  virtual bool CanDrawBitmap() const { return m_dc.CanDrawBitmap(); }
+  virtual void Clear() { m_dc.Clear(); }
+
+  virtual int GetDepth() const { return m_dc.GetDepth(); }
+  virtual bool IsOk() const { return m_dc.IsOk(); }
+
+  virtual void CalcBoundingBox(wxCoord x, wxCoord y)
+  {
+    m_dc.CalcBoundingBox(x, y);
+    UpdateBoundingBox();
+  }
+
+  virtual void SetFont(const wxFont& font)
+  {
+    m_dc.SetFont(font);
+    m_pdfdc->SetFont(font);
+  }
+  virtual const wxFont& GetFont() const { return m_dc.GetFont(); }
+
+  virtual void SetPen(const wxPen& pen) { m_dc.SetPen(pen); }
+  virtual const wxPen& GetPen() const { return m_dc.GetPen(); }
+  virtual void SetBrush(const wxBrush& brush) { m_dc.SetBrush(brush); }
+  virtual const wxBrush& GetBrush() const { return m_dc.GetBrush(); }
+  virtual void SetBackground(const wxBrush& brush) { m_dc.SetBackground(brush); }
+  virtual const wxBrush& GetBackground() const { return m_dc.GetBackground(); }
+  virtual void SetBackgroundMode(int mode){ m_dc.SetBackgroundMode(mode); }
+  virtual int GetBackgroundMode() const { return m_dc.GetBackgroundMode(); }
+
+  virtual void SetTextForeground(const wxColour& colour) { m_dc.SetTextForeground(colour); }
+  virtual const wxColour& GetTextForeground() const { return m_dc.GetTextForeground(); }
+
+  virtual void SetTextBackground(const wxColour& colour) { m_dc.SetTextBackground(colour); }
+  virtual const wxColour& GetTextBackground() const { return m_dc.GetTextBackground(); }
+
+#if wxUSE_PALETTE
+  virtual void SetPalette(const wxPalette& palette) { m_dc.SetPalette(palette); }
+#endif // wxUSE_PALETTE
+
+  virtual void DestroyClippingRegion()
+  {
+    m_dc.DestroyClippingRegion();
+    UpdateBoundingBox();
+  }
+
+  virtual wxCoord DeviceToLogicalX(wxCoord x) const { return m_dc.DeviceToLogicalX(x); }
+  virtual wxCoord DeviceToLogicalY(wxCoord y) const { return m_dc.DeviceToLogicalY(y); }
+  virtual wxCoord DeviceToLogicalXRel(wxCoord x) const { return m_dc.DeviceToLogicalXRel(x); }
+  virtual wxCoord DeviceToLogicalYRel(wxCoord y) const { return m_dc.DeviceToLogicalYRel(y); }
+  virtual wxCoord LogicalToDeviceX(wxCoord x) const { return m_dc.LogicalToDeviceX(x); }
+  virtual wxCoord LogicalToDeviceY(wxCoord y) const { return m_dc.LogicalToDeviceY(y); }
+  virtual wxCoord LogicalToDeviceXRel(wxCoord x) const { return m_dc.LogicalToDeviceXRel(x); }
+  virtual wxCoord LogicalToDeviceYRel(wxCoord y) const { return m_dc.LogicalToDeviceYRel(y); }
+
+  virtual void SetMapMode(int mode) { m_dc.SetMapMode(mode); }
+  virtual int GetMapMode() const { return m_dc.GetMapMode(); }
+
+  virtual void SetUserScale(double x, double y) { m_dc.SetUserScale(x,y); }
+  virtual void GetUserScale(double* x, double* y) const { m_dc.GetUserScale(x, y); }
+
+  virtual void SetLogicalScale(double x, double y) { m_dc.SetLogicalScale(x,y); }
+  virtual void GetLogicalScale(double* x, double* y) const { m_dc.GetLogicalScale(x,y); }
+
+  virtual void SetLogicalOrigin(wxCoord x, wxCoord y) { m_dc.SetLogicalOrigin(x,y); }
+  virtual void DoGetLogicalOrigin(wxCoord* x, wxCoord* y) const { m_dc.DoGetLogicalOrigin(x,y); }
+
+  virtual void SetDeviceOrigin(wxCoord x, wxCoord y) { m_dc.SetDeviceOrigin(x,y); }
+  virtual void DoGetDeviceOrigin(wxCoord* x, wxCoord* y) const { m_dc.DoGetDeviceOrigin(x,y); }
+
+  virtual void SetDeviceLocalOrigin( wxCoord x, wxCoord y ) { m_dc.SetDeviceLocalOrigin(x,y); }
+  virtual void ComputeScaleAndOrigin() { m_dc.ComputeScaleAndOrigin(); }
+  virtual void SetAxisOrientation(bool x, bool y) { m_dc.SetAxisOrientation(x,y); }
+
+  virtual void SetLogicalFunction(int function) { m_dc.SetLogicalFunction(function); }
+
+protected:
+
+  // wxDCBase functions
+  virtual bool DoFloodFill(wxCoord x, wxCoord y, const wxColour& col,
+                           int style = wxFLOOD_SURFACE)
+  {
+    bool rval = m_dc.DoFloodFill(x,y, col, style);
+    UpdateBoundingBox();
+    return rval;
+  }
+
+  virtual void DoGradientFillLinear(const wxRect& rect,
+                                    const wxColour& initialColour,
+                                    const wxColour& destColour,
+                                    wxDirection nDirection = wxEAST)
+  {
+    m_dc.DoGradientFillLinear(rect, initialColour, destColour, nDirection);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoGradientFillConcentric(const wxRect& rect,
+                                        const wxColour& initialColour,
+                                        const wxColour& destColour,
+                                        const wxPoint& circleCenter)
+  {
+    m_dc.DoGradientFillConcentric(rect, initialColour, destColour, circleCenter);
+    UpdateBoundingBox();
+  }
+
+  virtual bool DoGetPixel(wxCoord x, wxCoord y, wxColour* col) const
+  {
+    bool rval = m_dc.DoGetPixel(x, y, col);
+    UpdateBoundingBox();
+    return rval;
+  }
+
+  virtual void DoDrawPoint(wxCoord x, wxCoord y)
+  {
+    m_dc.DoDrawPoint(x,y);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawLine(wxCoord x1, wxCoord y1, wxCoord x2, wxCoord y2)
+  {
+    m_dc.DoDrawLine(x1,y1,x2,y2);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawArc(wxCoord x1, wxCoord y1,
+                         wxCoord x2, wxCoord y2,
+                         wxCoord xc, wxCoord yc)
+  {
+    m_dc.DoDrawArc(x1, y1, x2, y2, xc, yc);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawCheckMark(wxCoord x, wxCoord y,
+                               wxCoord w, wxCoord h)
+  {
+    m_dc.DoDrawCheckMark(x,y,w,h);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawEllipticArc(wxCoord x, wxCoord y, wxCoord w, wxCoord h,
+                                 double sa, double ea)
+  {
+    m_dc.DoDrawEllipticArc(x, y, w, h, sa, ea);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawRectangle(wxCoord x, wxCoord y, wxCoord w, wxCoord h)
+  {
+    m_dc.DoDrawRectangle(x, y, w, h);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawRoundedRectangle(wxCoord x, wxCoord y,
+                                      wxCoord w, wxCoord h,
+                                      double radius)
+  {
+    m_dc.DoDrawRoundedRectangle(x, y, w, h, radius);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawEllipse(wxCoord x, wxCoord y, wxCoord w, wxCoord h)
+  {
+    m_dc.DoDrawEllipse(x, y, w, h);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoCrossHair(wxCoord x, wxCoord y)
+  {
+    m_dc.DoCrossHair(x, y);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawIcon(const wxIcon& icon, wxCoord x, wxCoord y)
+  {
+    m_dc.DoDrawIcon(icon, x, y);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawBitmap(const wxBitmap &bmp, wxCoord x, wxCoord y,
+                            bool useMask = false)
+  {
+    m_dc.DoDrawBitmap(bmp, x, y, useMask);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawText(const wxString& text, wxCoord x, wxCoord y)
+  {
+    m_dc.DoDrawText(text, x, y);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawRotatedText(const wxString& text,
+                                 wxCoord x, wxCoord y, double angle)
+  {
+    m_dc.DoDrawRotatedText(text, x, y, angle);
+    UpdateBoundingBox();
+  }
+
+  virtual bool DoBlit(wxCoord xdest, wxCoord ydest,
+                      wxCoord w, wxCoord h,
+                      wxDC* source, wxCoord xsrc, wxCoord ysrc,
+                      int rop = wxCOPY,
+                      bool useMask = false,
+                      wxCoord xsrcMask = wxDefaultCoord, wxCoord ysrcMask = wxDefaultCoord)
+  {
+    bool rval = m_dc.DoBlit(xdest, ydest, w, h, source, xsrc, ysrc, rop, useMask, xsrcMask, ysrcMask);
+    UpdateBoundingBox();
+    return rval;
+  }
+
+  virtual void DoGetSize(int* w, int* h) const
+  {
+    m_dc.DoGetSize(w,h);
+  }
+
+  virtual void DoGetSizeMM(int* w, int* h) const
+  {
+    m_dc.DoGetSizeMM(w,h);
+  }
+
+  virtual void DoDrawLines(int n, wxPoint points[],
+                           wxCoord xoffset, wxCoord yoffset)
+  {
+    m_dc.DoDrawLines(n, points,xoffset, yoffset);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoDrawPolygon(int n, wxPoint points[],
+                             wxCoord xoffset, wxCoord yoffset,
+                             int fillStyle = wxODDEVEN_RULE)
+  {
+    m_dc.DoDrawPolygon(n, points, xoffset, yoffset, fillStyle);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoSetClippingRegion(wxCoord x, wxCoord y,
+                                   wxCoord w, wxCoord h)
+  {
+    m_dc.DoSetClippingRegion(x,y,w,h);
+  }
+
+  virtual void DoSetClippingRegionAsRegion(const wxRegion& region)
+  {
+    wxCoord x, y, w, h;
+    region.GetBox(x, y, w, h);
+    m_dc.DoSetClippingRegion(x, y, w, h);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoSetDeviceClippingRegion(const wxRegion& region)
+  {
+    m_dc.DoSetDeviceClippingRegion(region);
+    UpdateBoundingBox();
+  }
+
+  virtual void DoGetClippingBox(wxCoord* x, wxCoord* y,
+                                wxCoord* w, wxCoord* h) const
+  {
+    m_dc.DoGetClippingBox(x, y, w, h);
+    UpdateBoundingBox();
+  }
+
+private:
+  wxPdfPreviewDC&  m_dc;
+  wxPdfDC*         m_pdfdc;
+
+  DECLARE_NO_COPY_CLASS(wxPdfPreviewDC);
+};
+
+#endif   // end of 2.8.x wxPdfPreviewDC
+
+#endif //  _PDF_PRINTING_H_
+
+
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/include/wx/pdfxml.h wxPdfDoc-copy/include/wx/pdfxml.h
--- wxpdfdoc-0.9.2.1/include/wx/pdfxml.h	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/include/wx/pdfxml.h	2012-05-22 01:23:11.805400000 +0100
@@ -96,6 +96,12 @@
   /// Set flag that alignment has been taken care of
   void SetAligned() { m_aligned = true; }
 
+  /// Get cell fill style
+  int GetFillStyle() { return m_fillStyle; }
+
+  /// Set cell fill style
+  void SetFillStyle(int fillStyle) { m_fillStyle = fillStyle; }
+
   /// Get the number of contexts
   unsigned int GetContextCount() { return (unsigned int) m_contexts.GetCount(); }
 
@@ -142,6 +148,7 @@
   wxArrayPtrVoid   m_contexts;        ///< list of contexts
   unsigned int     m_currentLine;     ///< index of current line
   bool             m_aligned;         ///< alignment flag
+  int              m_fillStyle;       ///< cell fill style
   wxPdfArrayDouble m_linewidth;       ///< list of line widths
   wxArrayInt       m_spaces;          ///< list of space counters
   wxChar           m_lastChar;        ///< last character of a chunk
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/Makefile.in wxPdfDoc-copy/Makefile.in
--- wxpdfdoc-0.9.2.1/Makefile.in	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/Makefile.in	2012-05-22 01:03:35.769200000 +0100
@@ -1,6 +1,6 @@
 # =========================================================================
 #     This makefile was generated by
-#     Bakefile 0.2.8 (http://www.bakefile.org)
+#     Bakefile 0.2.9 (http://www.bakefile.org)
 #     Do not modify, all changes will be overwritten!
 # =========================================================================
 
@@ -90,6 +90,7 @@
 	pdfdoc_lib_pdfocg.o \
 	pdfdoc_lib_pdfparser.o \
 	pdfdoc_lib_pdfpattern.o \
+	pdfdoc_lib_pdfprint.o \
 	pdfdoc_lib_pdfrijndael.o \
 	pdfdoc_lib_pdftemplate.o \
 	pdfdoc_lib_pdfutility.o \
@@ -143,6 +144,7 @@
 	include/wx/pdfobjects.h \
 	include/wx/pdfparser.h \
 	include/wx/pdfpattern.h \
+	include/wx/pdfprint.h \
 	include/wx/pdfproperties.h \
 	include/wx/pdfrijndael.h \
 	include/wx/pdfshape.h \
@@ -199,6 +201,7 @@
 	pdfdoc_dll_pdfocg.o \
 	pdfdoc_dll_pdfparser.o \
 	pdfdoc_dll_pdfpattern.o \
+	pdfdoc_dll_pdfprint.o \
 	pdfdoc_dll_pdfrijndael.o \
 	pdfdoc_dll_pdftemplate.o \
 	pdfdoc_dll_pdfutility.o \
@@ -252,6 +255,7 @@
 	include/wx/pdfobjects.h \
 	include/wx/pdfparser.h \
 	include/wx/pdfpattern.h \
+	include/wx/pdfprint.h \
 	include/wx/pdfproperties.h \
 	include/wx/pdfrijndael.h \
 	include/wx/pdfshape.h \
@@ -271,6 +275,7 @@
 MINIMAL_CXXFLAGS = -I$(srcdir)/include -I$(srcdir)/samples/minimal \
 	$(WX_CXXFLAGS) $(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  \
+	minimal_attachment.o \
 	minimal_barcodes.o \
 	minimal_bookmark.o \
 	minimal_charting.o \
@@ -687,6 +692,9 @@
 pdfdoc_lib_pdfpattern.o: $(srcdir)/src/pdfpattern.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(srcdir)/src/pdfpattern.cpp
 
+pdfdoc_lib_pdfprint.o: $(srcdir)/src/pdfprint.cpp
+	$(CXXC) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(srcdir)/src/pdfprint.cpp
+
 pdfdoc_lib_pdfrijndael.o: $(srcdir)/src/pdfrijndael.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(srcdir)/src/pdfrijndael.cpp
 
@@ -810,6 +818,9 @@
 pdfdoc_dll_pdfpattern.o: $(srcdir)/src/pdfpattern.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(srcdir)/src/pdfpattern.cpp
 
+pdfdoc_dll_pdfprint.o: $(srcdir)/src/pdfprint.cpp
+	$(CXXC) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(srcdir)/src/pdfprint.cpp
+
 pdfdoc_dll_pdfrijndael.o: $(srcdir)/src/pdfrijndael.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(srcdir)/src/pdfrijndael.cpp
 
@@ -822,6 +833,9 @@
 pdfdoc_dll_pdfxml.o: $(srcdir)/src/pdfxml.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(srcdir)/src/pdfxml.cpp
 
+minimal_attachment.o: $(srcdir)/samples/minimal/attachment.cpp
+	$(CXXC) -c -o $@ $(MINIMAL_CXXFLAGS) $(srcdir)/samples/minimal/attachment.cpp
+
 minimal_barcodes.o: $(srcdir)/samples/minimal/barcodes.cpp
 	$(CXXC) -c -o $@ $(MINIMAL_CXXFLAGS) $(srcdir)/samples/minimal/barcodes.cpp
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/Makefile28.in wxPdfDoc-copy/Makefile28.in
--- wxpdfdoc-0.9.2.1/Makefile28.in	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/Makefile28.in	2012-05-22 01:03:37.535400000 +0100
@@ -1,6 +1,6 @@
 # =========================================================================
 #     This makefile was generated by
-#     Bakefile 0.2.8 (http://www.bakefile.org)
+#     Bakefile 0.2.9 (http://www.bakefile.org)
 #     Do not modify, all changes will be overwritten!
 # =========================================================================
 
@@ -90,6 +90,7 @@
 	pdfdoc_lib_pdfocg.o \
 	pdfdoc_lib_pdfparser.o \
 	pdfdoc_lib_pdfpattern.o \
+	pdfdoc_lib_pdfprint.o \
 	pdfdoc_lib_pdfrijndael.o \
 	pdfdoc_lib_pdftemplate.o \
 	pdfdoc_lib_pdfutility.o \
@@ -143,6 +144,7 @@
 	include/wx/pdfobjects.h \
 	include/wx/pdfparser.h \
 	include/wx/pdfpattern.h \
+	include/wx/pdfprint.h \
 	include/wx/pdfproperties.h \
 	include/wx/pdfrijndael.h \
 	include/wx/pdfshape.h \
@@ -199,6 +201,7 @@
 	pdfdoc_dll_pdfocg.o \
 	pdfdoc_dll_pdfparser.o \
 	pdfdoc_dll_pdfpattern.o \
+	pdfdoc_dll_pdfprint.o \
 	pdfdoc_dll_pdfrijndael.o \
 	pdfdoc_dll_pdftemplate.o \
 	pdfdoc_dll_pdfutility.o \
@@ -252,6 +255,7 @@
 	include/wx/pdfobjects.h \
 	include/wx/pdfparser.h \
 	include/wx/pdfpattern.h \
+	include/wx/pdfprint.h \
 	include/wx/pdfproperties.h \
 	include/wx/pdfrijndael.h \
 	include/wx/pdfshape.h \
@@ -271,6 +275,7 @@
 MINIMAL_CXXFLAGS = -I$(srcdir)/include -I$(srcdir)/samples/minimal \
 	$(WX_CXXFLAGS) $(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  \
+	minimal_attachment.o \
 	minimal_barcodes.o \
 	minimal_bookmark.o \
 	minimal_charting.o \
@@ -687,6 +692,9 @@
 pdfdoc_lib_pdfpattern.o: $(srcdir)/src/pdfpattern.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(srcdir)/src/pdfpattern.cpp
 
+pdfdoc_lib_pdfprint.o: $(srcdir)/src/pdfprint.cpp
+	$(CXXC) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(srcdir)/src/pdfprint.cpp
+
 pdfdoc_lib_pdfrijndael.o: $(srcdir)/src/pdfrijndael.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(srcdir)/src/pdfrijndael.cpp
 
@@ -810,6 +818,9 @@
 pdfdoc_dll_pdfpattern.o: $(srcdir)/src/pdfpattern.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(srcdir)/src/pdfpattern.cpp
 
+pdfdoc_dll_pdfprint.o: $(srcdir)/src/pdfprint.cpp
+	$(CXXC) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(srcdir)/src/pdfprint.cpp
+
 pdfdoc_dll_pdfrijndael.o: $(srcdir)/src/pdfrijndael.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(srcdir)/src/pdfrijndael.cpp
 
@@ -822,6 +833,9 @@
 pdfdoc_dll_pdfxml.o: $(srcdir)/src/pdfxml.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(srcdir)/src/pdfxml.cpp
 
+minimal_attachment.o: $(srcdir)/samples/minimal/attachment.cpp
+	$(CXXC) -c -o $@ $(MINIMAL_CXXFLAGS) $(srcdir)/samples/minimal/attachment.cpp
+
 minimal_barcodes.o: $(srcdir)/samples/minimal/barcodes.cpp
 	$(CXXC) -c -o $@ $(MINIMAL_CXXFLAGS) $(srcdir)/samples/minimal/barcodes.cpp
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/Makefile29.in wxPdfDoc-copy/Makefile29.in
--- wxpdfdoc-0.9.2.1/Makefile29.in	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/Makefile29.in	2012-05-26 17:57:54.191300000 +0100
@@ -1,6 +1,6 @@
 # =========================================================================
 #     This makefile was generated by
-#     Bakefile 0.2.8 (http://www.bakefile.org)
+#     Bakefile 0.2.9 (http://www.bakefile.org)
 #     Do not modify, all changes will be overwritten!
 # =========================================================================
 
@@ -90,6 +90,7 @@
 	pdfdoc_lib_pdfocg.o \
 	pdfdoc_lib_pdfparser.o \
 	pdfdoc_lib_pdfpattern.o \
+	pdfdoc_lib_pdfprint.o \
 	pdfdoc_lib_pdfrijndael.o \
 	pdfdoc_lib_pdftemplate.o \
 	pdfdoc_lib_pdfutility.o \
@@ -143,6 +144,7 @@
 	include/wx/pdfobjects.h \
 	include/wx/pdfparser.h \
 	include/wx/pdfpattern.h \
+	include/wx/pdfprint.h \
 	include/wx/pdfproperties.h \
 	include/wx/pdfrijndael.h \
 	include/wx/pdfshape.h \
@@ -199,6 +201,7 @@
 	pdfdoc_dll_pdfocg.o \
 	pdfdoc_dll_pdfparser.o \
 	pdfdoc_dll_pdfpattern.o \
+	pdfdoc_dll_pdfprint.o \
 	pdfdoc_dll_pdfrijndael.o \
 	pdfdoc_dll_pdftemplate.o \
 	pdfdoc_dll_pdfutility.o \
@@ -252,6 +255,7 @@
 	include/wx/pdfobjects.h \
 	include/wx/pdfparser.h \
 	include/wx/pdfpattern.h \
+	include/wx/pdfprint.h \
 	include/wx/pdfproperties.h \
 	include/wx/pdfrijndael.h \
 	include/wx/pdfshape.h \
@@ -271,6 +275,7 @@
 MINIMAL_CXXFLAGS = -I$(srcdir)/include -I$(srcdir)/samples/minimal \
 	$(WX_CXXFLAGS) $(CPPFLAGS) $(CXXFLAGS)
 MINIMAL_OBJECTS =  \
+	minimal_attachment.o \
 	minimal_barcodes.o \
 	minimal_bookmark.o \
 	minimal_charting.o \
@@ -686,6 +691,9 @@
 pdfdoc_lib_pdfpattern.o: $(srcdir)/src/pdfpattern.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(srcdir)/src/pdfpattern.cpp
 
+pdfdoc_lib_pdfprint.o: $(srcdir)/src/pdfprint.cpp
+	$(CXXC) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(srcdir)/src/pdfprint.cpp
+
 pdfdoc_lib_pdfrijndael.o: $(srcdir)/src/pdfrijndael.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_LIB_CXXFLAGS) $(srcdir)/src/pdfrijndael.cpp
 
@@ -809,6 +817,9 @@
 pdfdoc_dll_pdfpattern.o: $(srcdir)/src/pdfpattern.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(srcdir)/src/pdfpattern.cpp
 
+pdfdoc_dll_pdfprint.o: $(srcdir)/src/pdfprint.cpp
+	$(CXXC) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(srcdir)/src/pdfprint.cpp
+
 pdfdoc_dll_pdfrijndael.o: $(srcdir)/src/pdfrijndael.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(srcdir)/src/pdfrijndael.cpp
 
@@ -821,6 +832,9 @@
 pdfdoc_dll_pdfxml.o: $(srcdir)/src/pdfxml.cpp
 	$(CXXC) -c -o $@ $(PDFDOC_DLL_CXXFLAGS) $(srcdir)/src/pdfxml.cpp
 
+minimal_attachment.o: $(srcdir)/samples/minimal/attachment.cpp
+	$(CXXC) -c -o $@ $(MINIMAL_CXXFLAGS) $(srcdir)/samples/minimal/attachment.cpp
+
 minimal_barcodes.o: $(srcdir)/samples/minimal/barcodes.cpp
 	$(CXXC) -c -o $@ $(MINIMAL_CXXFLAGS) $(srcdir)/samples/minimal/barcodes.cpp
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/makefont/makefont.cpp wxPdfDoc-copy/makefont/makefont.cpp
--- wxpdfdoc-0.9.2.1/makefont/makefont.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/makefont/makefont.cpp	2012-05-26 17:57:54.284900000 +0100
@@ -106,6 +106,7 @@
   wxString m_patchFile;
   wxString m_fontType;
   wxString m_volt;
+  wxString m_outputDir;
 };
 
 /// Fast string search (KMP method): initialization
@@ -953,7 +954,7 @@
         return false;
       }
       size_t len = ttfFile.GetLength();
-      wxFileOutputStream outFontFile(baseName + wxT(".z"));
+      wxFileOutputStream outFontFile(m_outputDir + baseName + wxT(".z"));
       wxZlibOutputStream zOutFontFile(outFontFile);
       zOutFontFile.Write(ttfFile);
       zOutFontFile.Close();
@@ -1005,7 +1006,7 @@
         delete [] f;
         if (size2 >= 0)
         {
-          wxFileOutputStream outFontFile(baseName + wxT(".z"));
+          wxFileOutputStream outFontFile(m_outputDir + baseName + wxT(".z"));
           wxZlibOutputStream zOutFontFile(outFontFile);
           zOutFontFile.Write(buf1, size1);
           zOutFontFile.Write(buf2, size2);
@@ -1034,7 +1035,7 @@
   }
 
   // Create XML file
-  CreateFontMetricsFile(baseName + wxT(".xml"), *afmFont, hasGlyphNumbers);
+  CreateFontMetricsFile(m_outputDir + baseName + wxT(".xml"), *afmFont, hasGlyphNumbers);
   wxLogMessage(wxT("Font definition file generated (") + baseName + wxT(".xml)."));
 
   //delete widths;
@@ -1372,7 +1373,7 @@
       return false;
     }
     size_t len = fontFile.GetLength();
-    wxFileOutputStream outFontFile(baseName + wxT(".z"));
+    wxFileOutputStream outFontFile(m_outputDir + baseName + wxT(".z"));
     wxZlibOutputStream zOutFontFile(outFontFile);
     if (cff)
     {
@@ -1406,7 +1407,7 @@
   if (embeddingAllowed)
   {
     // Create CID to GID map file
-    wxFileOutputStream outCtgFile(baseName + wxT(".ctg.z"));
+    wxFileOutputStream outCtgFile(m_outputDir + baseName + wxT(".ctg.z"));
     wxZlibOutputStream zOutCtgFile(outCtgFile);
     if (cff)
     {
@@ -1433,7 +1434,7 @@
   }
 
   // Create XML file
-  CreateFontMetricsFile(baseName + wxT(".xml"), *ufmFont, cff);
+  CreateFontMetricsFile(m_outputDir + baseName + wxT(".xml"), *ufmFont, cff);
   wxLogMessage(wxT("Font definition file generated (") + baseName + wxT(".xml)."));
 
   if (cff)
@@ -1474,11 +1475,11 @@
     wxString baseName = fileName.GetName();
     if (loadedFont->EmbedSupported())
     {
-      wxFileOutputStream outFontFile(baseName + wxT(".z"));
+      wxFileOutputStream outFontFile(m_outputDir + baseName + wxT(".z"));
       loadedFont->WriteFontData(&outFontFile);
       outFontFile.Close();
       wxLogMessage(wxT("Font file compressed (") + baseName + wxT(".z)"));
-      wxFileOutputStream outCtgFile(baseName + wxT(".ctg.z"));
+      wxFileOutputStream outCtgFile(m_outputDir + baseName + wxT(".ctg.z"));
       if (!cff)
       {
         static size_t CC2GNSIZE = 131072; // 2*64kB
@@ -1521,7 +1522,7 @@
     }
 
     // Create XML file
-    CreateFontMetricsFile(baseName + wxT(".xml"), *loadedFont, cff);
+    CreateFontMetricsFile(m_outputDir + baseName + wxT(".xml"), *loadedFont, cff);
     wxLogMessage(wxT("Font definition file generated (") + baseName + wxT(".xml)."));
     delete loadedFont;
   }
@@ -1546,6 +1547,7 @@
   { wxCMD_LINE_OPTION, "e", "enc",       "Character encoding of the font (for AFM only)",   wxCMD_LINE_VAL_STRING, wxCMD_LINE_PARAM_OPTIONAL },
   { wxCMD_LINE_OPTION, "p", "patch",     "Patch file (for AFM only)",                       wxCMD_LINE_VAL_STRING, wxCMD_LINE_PARAM_OPTIONAL },
   { wxCMD_LINE_OPTION, "t", "type",      "Font type (type = otf, ttf or t1, default: ttf)", wxCMD_LINE_VAL_STRING, wxCMD_LINE_PARAM_OPTIONAL },
+  { wxCMD_LINE_OPTION, "o", "output",    "Path to output directory",                        wxCMD_LINE_VAL_STRING, wxCMD_LINE_PARAM_OPTIONAL },
 #else
   { wxCMD_LINE_OPTION, wxT("a"), wxT("afm"),       wxT("Adobe Font Metric file (AFM)"),                    wxCMD_LINE_VAL_STRING, wxCMD_LINE_PARAM_OPTIONAL },
 #if wxUSE_UNICODE
@@ -1559,6 +1561,7 @@
   { wxCMD_LINE_OPTION, wxT("e"), wxT("enc"),       wxT("Character encoding of the font (for AFM only)"),   wxCMD_LINE_VAL_STRING, wxCMD_LINE_PARAM_OPTIONAL },
   { wxCMD_LINE_OPTION, wxT("p"), wxT("patch"),     wxT("Patch file (for AFM only)"),                       wxCMD_LINE_VAL_STRING, wxCMD_LINE_PARAM_OPTIONAL },
   { wxCMD_LINE_OPTION, wxT("t"), wxT("type"),      wxT("Font type (type = otf, ttf or t1, default: ttf)"), wxCMD_LINE_VAL_STRING, wxCMD_LINE_PARAM_OPTIONAL },
+  { wxCMD_LINE_OPTION, wxT("o"), wxT("output"),    wxT("Path to output directory"),                        wxCMD_LINE_VAL_STRING, wxCMD_LINE_PARAM_OPTIONAL },
 #endif
   { wxCMD_LINE_NONE }
 };
@@ -1573,7 +1576,7 @@
   wxPdfFontManager::GetFontManager()->AddSearchPath(fontPath);
   wxSetWorkingDirectory(cwdPath);
 
-  m_version = wxT("1.5.0 (December 2010)");
+  m_version = wxT("1.6.0 (June 2012)");
   bool valid = false;
   //gets the parameters from cmd line
   wxCmdLineParser parser (cmdLineDesc, argc, argv);
@@ -1592,6 +1595,7 @@
     bool hasPatch     = parser.Found(wxT("patch"), &m_patchFile);
     bool hasType      = parser.Found(wxT("type"),  &m_fontType);
     bool hasVolt      = parser.Found(wxT("volt"),  &m_volt);
+    bool hasOutput    = parser.Found(wxT("output"), &m_outputDir);
 
 #if wxUSE_UNICODE
     m_unicode = hasUfm || hasImmediate;
@@ -1601,6 +1605,10 @@
     m_unicode = false;
     m_immediate = false;
 #endif
+    if (!hasOutput)
+    {
+      m_outputDir = wxEmptyString;
+    }
     valid = ( hasImmediate && !hasAfm && !hasUfm && !hasVolt) ||
             (!hasImmediate &&  hasAfm && !hasUfm && !hasVolt) ||
             (!hasImmediate && !hasAfm &&  hasUfm);
@@ -1635,6 +1643,27 @@
   bool valid;
   wxLogMessage(wxT("wxPdfDocument MakeFont Utility Version ") + m_version);
   wxLogMessage(wxT("*** Starting to create font support files for ..."));
+  if (!m_outputDir.IsEmpty())
+  {
+    wxFileName outputDirName(m_outputDir, wxEmptyString);
+    if (outputDirName.DirExists())
+    {
+      m_outputDir = outputDirName.GetPath(wxPATH_GET_VOLUME | wxPATH_GET_SEPARATOR);
+    }
+    else
+    {
+      wxLogMessage(wxT("*** Warning: Output directory doesn't exist: ") + m_outputDir);
+      m_outputDir = wxEmptyString;
+    }
+  }
+  if (!m_outputDir.IsEmpty())
+  {
+    wxLogMessage(wxT("  OutputDir: ") + m_outputDir);
+  }
+  else
+  {
+    wxLogMessage(wxT("  OutputDir: (current working directory)"));
+  }
 #if wxUSE_UNICODE
   if (m_unicode)
   {
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/Readme.txt wxPdfDoc-copy/Readme.txt
--- wxpdfdoc-0.9.2.1/Readme.txt	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/Readme.txt	2012-05-26 17:57:54.940100000 +0100
@@ -2,7 +2,7 @@
 ----------------------------
 
 Website:      http://wxcode.sourceforge.net/components/wxpdfdoc
-Version:      0.9.2
+Version:      0.9.3
 Description:
 wxPdfDocument allows wxWidgets applications to generate PDF documents.
 The code is a port of FPDF - a free PHP class for generating PDF files
@@ -117,11 +117,14 @@
 incorporated into wxPdfDocument.
 
 Support for Indic scripts is based on the efforts of Ian Back, creator of
-the PHP library mPDF (http://www.mpdf1.com/mpdf/); special thanks to K Vinod
-Kumar of the Centre for Development of Advanced Computing, Mumbai
+the PHP library mPDF (http://mpdf.bpm1.com); special thanks to K Vinod Kumar
+of the Centre for Development of Advanced Computing, Mumbai
 (http://www.cdacmumbai.in), for clearing license issues of the Raghu font
 series.
 
+Kudos to Mark Dootson for contributing major enhancements of wxPdfDC and
+it's integration into the wxWidgets printing framework.
+
 Since wxPdfDocument is based on the great FPDF PHP class and several of the
 contributions to it found on the FPDF website (http://www.fpdf.org) I would
 like to thank 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/samples/minimal/attached.txt wxPdfDoc-copy/samples/minimal/attached.txt
--- wxpdfdoc-0.9.2.1/samples/minimal/attached.txt	1970-01-01 00:00:00.000000000 +0000
+++ wxPdfDoc-copy/samples/minimal/attached.txt	2012-05-22 01:03:37.727400000 +0100
@@ -0,0 +1 @@
+Sample attached file.
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/samples/minimal/attachment.cpp wxPdfDoc-copy/samples/minimal/attachment.cpp
--- wxpdfdoc-0.9.2.1/samples/minimal/attachment.cpp	1970-01-01 00:00:00.000000000 +0000
+++ wxPdfDoc-copy/samples/minimal/attachment.cpp	2012-05-22 01:03:37.730400000 +0100
@@ -0,0 +1,39 @@
+///////////////////////////////////////////////////////////////////////////////
+// Name:        attachment.cpp
+// Purpose:     Demonstration of file attachments in wxPdfDocument
+// Author:      Ulrich Telle
+// Modified by:
+// Created:     2012-05-20
+// Copyright:   (c) Ulrich Telle
+// Licence:     wxWindows licence
+///////////////////////////////////////////////////////////////////////////////
+
+// For compilers that support precompilation, includes "wx/wx.h".
+#include "wx/wxprec.h"
+
+#ifdef __BORLANDC__
+#pragma hdrstop
+#endif
+
+#ifndef WX_PRECOMP
+#include "wx/wx.h"
+#endif
+
+#include "wx/pdfdoc.h"
+
+/**
+* Attachments
+* 
+* This example shows how to attach a file to a PDF document.
+*/
+
+void
+attachment()
+{
+  wxPdfDocument pdf;
+  pdf.AttachFile(wxT("attached.txt"), wxT(""), wxT("A simple text file"));
+  pdf.AddPage();
+  pdf.SetFont(wxT("Helvetica"),wxT(""),14);
+  pdf.Write(5,wxT("This PDF contains an attached file."));
+  pdf.SaveAsFile(wxT("attachment.pdf"));
+}
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/samples/minimal/minimal.cpp wxPdfDoc-copy/samples/minimal/minimal.cpp
--- wxpdfdoc-0.9.2.1/samples/minimal/minimal.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/samples/minimal/minimal.cpp	2012-05-22 01:03:37.734400000 +0100
@@ -68,6 +68,7 @@
 void layers();
 
 void kerning();
+void attachment();
 
 #if defined(__WXMSW__)
 #if wxUSE_UNICODE
@@ -122,6 +123,7 @@
         cout << "(1) Kerning example" << endl;
         cout << "(2) Glyph writing example" << endl;
         cout << "(3) Indic Fonts and Languages example" << endl;
+        cout << "(4) File attachment example" << endl;
         break;
       case 3:
         cout << "(1) Label printing example" << endl;
@@ -242,6 +244,7 @@
 #else
         case '3': cout << endl << "'indicfonts' is available in Unicode build only!" << endl; break;
 #endif
+        case '4': cout << endl << "Running 'attachment' ..." << endl; attachment(); break;
 
 #if 0
         case 'z': cout << endl << "Running 'w' ..." << endl; w(); break;
@@ -275,7 +278,7 @@
     cout << "(2) Group 2: Protection, Diverse graphic operations, Charting" << endl;
     cout << "(3) Group 3: Label, Barcode, Javascript, Forms, Markup, Transparency," << endl;
     cout << "             Templates, Layers (ordering, grouping, nesting ...)" << endl;
-    cout << "(4) Group 4: Kerning, Direct glyph writing, Indic fonts" << endl;
+    cout << "(4) Group 4: Kerning, Direct glyph writing, Indic fonts, Attachments" << endl;
     cout << endl;
     cout << "(x) Exit program" << endl << endl << "Select program (Enter 1..4 or x): ";
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/samples/pdfdc/printing.cpp wxPdfDoc-copy/samples/pdfdc/printing.cpp
--- wxpdfdoc-0.9.2.1/samples/pdfdc/printing.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/samples/pdfdc/printing.cpp	2012-05-30 00:36:25.992700000 +0100
@@ -20,6 +20,8 @@
 #include "wx/wx.h"
 #endif
 
+//#include "vld.h"
+
 #if !wxUSE_PRINTING_ARCHITECTURE
 #error "You must set wxUSE_PRINTING_ARCHITECTURE to 1 in setup.h, and recompile the library."
 #endif
@@ -30,14 +32,18 @@
 
 #include <ctype.h>
 #include <wx/filename.h>
+#include "wx/mimetype.h"
 #include <wx/stdpaths.h>
 #include "wx/metafile.h"
 #include "wx/print.h"
 #include "wx/printdlg.h"
 #include "wx/image.h"
 #include "wx/accel.h"
+#include "wx/sizer.h"
+
 #include "wx/pdfdc.h"
 #include "wx/pdffontmanager.h"
+#include "wx/pdfprint.h"
 
 #if wxTEST_POSTSCRIPT_IN_MSW
 #include "wx/generic/printps.h"
@@ -52,17 +58,31 @@
     #endif
 #endif
 
+#if wxUSE_RICHTEXT
+  #include "wx/richtext/richtextctrl.h"
+  #include "wx/richtext/richtextstyles.h"
+  #include "wx/richtext/richtextprint.h"
+  #include "zebra.xpm"
+  #include "smiley.xpm"
+#endif
+
+#if wxUSE_HTML
+  #include <wx/html/htmprint.h>
+#endif
+
 #include "printing.h"
 
 #ifndef __WXMSW__
 #include "mondrian.xpm"
 #endif
 
+// Link to gnome_print disabled (causes a linking error when using wxWidgtes 2.9.3)
+#if 0
 #if wxUSE_LIBGNOMEPRINT
 #include "wx/html/forcelnk.h"
 FORCE_LINK(gnome_print)
 #endif
-
+#endif
 
 // Declare a frame
 MyFrame   *frame = (MyFrame *) NULL;
@@ -100,9 +120,9 @@
   wxSetWorkingDirectory(cwdPath);
 
 #if wxCHECK_VERSION(2,9,0)
-    m_testFont.Create(10, wxFONTFAMILY_SWISS, wxFONTSTYLE_NORMAL, wxFONTWEIGHT_NORMAL);
+    m_testFont.Create(10, wxFONTFAMILY_SWISS, wxFONTSTYLE_NORMAL, wxFONTWEIGHT_NORMAL, false, wxT("Arial"));
 #else
-    m_testFont.Create(10, wxSWISS, wxNORMAL, wxNORMAL);
+    m_testFont.Create(10, wxSWISS, wxNORMAL, wxNORMAL, false, wxT("Arial"));
 #endif
 
     g_printData = new wxPrintData;
@@ -162,12 +182,27 @@
     file_menu->AppendSeparator();
     file_menu->Append(WXPRINT_QUIT, _T("E&xit"),                _T("Exit program"));
 
+    wxMenu *printing_menu = new wxMenu;
+    printing_menu->Append(WXPDFPRINT_PAGE_SETUP_ALL, _T("PDF Page Setup All..."), _T("PDF Page Setup (All)"));
+    printing_menu->Append(WXPDFPRINT_PAGE_SETUP_MINIMAL, _T("PDF Page Setup Minimal..."), _T("PDF Page Setup (Minimal)"));
+    printing_menu->Append(WXPDFPRINT_PRINT_DIALOG_ALL, _T("PDF Print Dialog All..."), _T("PDF Print Dialog (All)"));
+    printing_menu->Append(WXPDFPRINT_PRINT_DIALOG_MINIMAL, _T("PDF Print Dialog Minimal..."), _T("PDF Print Dialog (Minimal)"));
+#if wxUSE_RICHTEXT
+    printing_menu->Append(WXPDFPRINT_RICHTEXT_PRINT, _T("PDF RichText Print..."), _T("PDF RichText (Print)"));
+    printing_menu->Append(WXPDFPRINT_RICHTEXT_PREVIEW, _T("PDF RichText Preview..."), _T("PDF RichText (Preview)"));
+#endif
+#if wxUSE_HTML
+    printing_menu->Append(WXPDFPRINT_HTML_PRINT, _T("PDF Html Print..."), _T("PDF Html (Print)"));
+    printing_menu->Append(WXPDFPRINT_HTML_PREVIEW, _T("PDF Html Preview..."), _T("PDF Html (Preview)"));
+#endif
+
     wxMenu *help_menu = new wxMenu;
     help_menu->Append(WXPRINT_ABOUT, _T("&About"),              _T("About this demo"));
 
     wxMenuBar *menu_bar = new wxMenuBar;
 
     menu_bar->Append(file_menu, _T("&File"));
+    menu_bar->Append(printing_menu, _T("wxPdf&Printing"));
     menu_bar->Append(help_menu, _T("&Help"));
 
     // Associate the menu bar with the frame
@@ -178,7 +213,11 @@
     // Give it scrollbars: the virtual canvas is 20 * 50 = 1000 pixels in each direction
     canvas->SetScrollbars(20, 20, 50, 50);
 
+    wxBoxSizer *mainsizer = new wxBoxSizer( wxVERTICAL );
+    mainsizer->Add(canvas,1,wxALL|wxEXPAND, 0);
+
     frame->canvas = canvas;
+    frame->SetSizer(mainsizer);
 
     frame->Centre(wxBOTH);
     frame->Show();
@@ -217,6 +256,18 @@
 #endif
 EVT_MENU(WXPRINT_ANGLEUP, MyFrame::OnAngleUp)
 EVT_MENU(WXPRINT_ANGLEDOWN, MyFrame::OnAngleDown)
+EVT_MENU(WXPDFPRINT_PAGE_SETUP_ALL, MyFrame::OnPdfPageSetupAll)
+EVT_MENU(WXPDFPRINT_PAGE_SETUP_MINIMAL, MyFrame::OnPdfPageSetupMinimal)
+EVT_MENU(WXPDFPRINT_PRINT_DIALOG_ALL, MyFrame::OnPdfPrintDialogAll)
+EVT_MENU(WXPDFPRINT_PRINT_DIALOG_MINIMAL, MyFrame::OnPdfPrintDialogMinimal)
+#if wxUSE_RICHTEXT
+EVT_MENU(WXPDFPRINT_RICHTEXT_PRINT, MyFrame::OnPdfRichTextPrint)
+EVT_MENU(WXPDFPRINT_RICHTEXT_PREVIEW, MyFrame::OnPdfRichTextPreview)
+#endif
+#if wxUSE_HTML
+EVT_MENU(WXPDFPRINT_HTML_PRINT, MyFrame::OnPdfHtmlPrint)
+EVT_MENU(WXPDFPRINT_HTML_PREVIEW, MyFrame::OnPdfHtmlPreview)
+#endif
 END_EVENT_TABLE()
 
 // Define my frame constructor
@@ -241,6 +292,19 @@
       m_bitmap = wxBitmap(image);
       m_imgUp.LoadFile(rscPath + wxT("up.gif"));
     }
+#if wxUSE_RICHTEXT
+    m_richtext = new wxRichTextCtrl(this, wxID_ANY, wxEmptyString);
+    m_richtext->Show(0);
+    m_richtextPrinting = new wxRichTextPrinting();
+    WriteRichTextBuffer();
+#endif
+}
+
+MyFrame::~MyFrame()
+{
+#if wxUSE_RICHTEXT
+  delete m_richtextPrinting;
+#endif
 }
 
 void MyFrame::OnExit(wxCommandEvent& WXUNUSED(event))
@@ -278,6 +342,11 @@
   printData.SetFilename(fileName.GetFullPath());
   {
     wxPdfDC dc(printData);
+    // set wxPdfDC mapping mode style so
+    // we can scale fonts and graphics
+    // coords with a single setting
+    dc.SetMapModeStyle(wxPDF_MAPMODESTYLE_PDF);
+    dc.SetMapMode(wxMM_POINTS);
     bool ok = dc.StartDoc(_("Printing ..."));
     if (ok)
     {
@@ -287,9 +356,17 @@
       dc.EndDoc();
     }
   }
-#if defined(__WXMSW__)
-  ShellExecute(NULL, _T("open"), fileName.GetFullPath(), _T(""), _T(""), 0);
-#endif
+
+  wxFileType* fileType = wxTheMimeTypesManager->GetFileTypeFromExtension(wxT("pdf"));
+  if (fileType != NULL)
+  {
+    wxString cmd = fileType->GetOpenCommand(fileName.GetFullPath());
+    if (!cmd.IsEmpty())
+    {
+      wxExecute(cmd);
+    }
+    delete fileType;
+  }
 }
 
 void MyFrame::OnPDFTemplate(wxCommandEvent& WXUNUSED(event))
@@ -302,14 +379,14 @@
   pdf.AddPage();
   pdf.SetFont(wxT("Helvetica"),wxT("B"),16);
   pdf.Cell(40,10,wxT("Hello World!"));
-  double w = 75;
-  double h = 125;
+  double w = /*350*/ 125;
+  double h = /*350*/ 125;
   int tpl = pdf.BeginTemplate(0, 0, w, h);
 
   {
     wxPdfDC dc(&pdf, w, h);
-    dc.SetMapMode(wxMM_METRIC);
-    dc.SetResolution(720);
+    //dc.SetMapMode(wxMM_METRIC);
+    //dc.SetResolution(720);
     bool ok = dc.StartDoc(_("Printing ..."));
     if (ok)
     {
@@ -320,12 +397,19 @@
     }
   }
   pdf.EndTemplate();
-  pdf.UseTemplate(tpl, 40, 30);
+  pdf.UseTemplate(tpl, 40, 30, 75);
   pdf.SaveAsFile(fileName.GetFullPath());
 
-#if defined(__WXMSW__)
-  ShellExecute(NULL, _T("open"), fileName.GetFullPath(), _T(""), _T(""), 0);
-#endif
+  wxFileType* fileType = wxTheMimeTypesManager->GetFileTypeFromExtension(wxT("pdf"));
+  if (fileType != NULL)
+  {
+    wxString cmd = fileType->GetOpenCommand(fileName.GetFullPath());
+    if (!cmd.IsEmpty())
+    {
+      wxExecute(cmd);
+    }
+    delete fileType;
+  }
 }
 
 void MyFrame::OnPrintPreview(wxCommandEvent& WXUNUSED(event))
@@ -429,6 +513,44 @@
     // can check that different types of object are being drawn consistently
     // between the screen image, the print preview image (at various zoom
     // levels), and the printed page.
+    double fontScaleX, fontScaleY, coordScaleX, coordScaleY, baseScaleX, baseScaleY;
+    double txtPosScaleX, txtPosScaleY;
+    dc.GetUserScale(&baseScaleX, &baseScaleY);
+
+    wxClassInfo *cinfo = wxClassInfo::FindClass(wxT("wxPdfDC"));
+    if ((cinfo != NULL) &&
+        (dc.GetClassInfo()->IsKindOf(cinfo)) &&
+        (((wxPdfDC*) &dc)->GetMapModeStyle() == wxPDF_MAPMODESTYLE_PDF))
+    {
+      // We are in a special wxPdfDC mode where everything
+      // is mapped correctly using SetMapMode so we make
+      // all scaling factors effectively noops
+      fontScaleX = fontScaleY = coordScaleX = txtPosScaleX = txtPosScaleY = coordScaleY = ( 1.0 * baseScaleX );
+    }
+    else
+    {
+      // We need to use the base user scale to account for any
+      // zoom factor that may have been set before a call here.
+      // Our coords are in points
+      wxSize devicePPI = dc.GetPPI();
+      coordScaleX = baseScaleX * (double) devicePPI.GetWidth()  / 72.0;
+      coordScaleY = baseScaleY * (double) devicePPI.GetHeight() / 72.0;
+
+      // The font size will be scaled by the dc to screenres / 72.0
+      // we want the font size to be scaled back to points and be
+      // the correct size relative to our coord scale
+      // Note: wxGetScreenPPI returns the wrong number on wxMSW at least
+      wxScreenDC sdc;
+      fontScaleX = baseScaleX * (double) devicePPI.GetWidth()  / (double) sdc.GetPPI().GetWidth();
+      fontScaleY = baseScaleY * (double) devicePPI.GetHeight() / (double) sdc.GetPPI().GetHeight();
+
+      // When using draw text functions we will be using fontScale, but the x y pos needs
+      // to be in coord scale
+      txtPosScaleX = coordScaleX / fontScaleX;
+      txtPosScaleY = coordScaleY / fontScaleY;
+    }
+    dc.SetUserScale(coordScaleX, coordScaleY);
+
     dc.SetBackground(*wxWHITE_BRUSH);
     dc.Clear();
     dc.SetFont(wxGetApp().m_testFont);
@@ -438,6 +560,7 @@
     dc.SetPen(*wxBLACK_PEN);
     dc.SetBrush(*wxLIGHT_GREY_BRUSH);
 //    dc.SetBackground(*wxWHITE_BRUSH);
+
     dc.DrawRectangle(0, 0, 230, 350);
     dc.DrawLine(0, 0, 229, 349);
     dc.DrawLine(229, 0, 0, 349);
@@ -448,16 +571,20 @@
 
     dc.DrawRoundedRectangle(0, 20, 200, 80, 20);
 
-    dc.DrawText( wxT("Rectangle 200 by 80"), 40, 40);
+    dc.SetUserScale(fontScaleX, fontScaleY);
+    dc.DrawText(wxT("Rectangle 200 by 80"), 40 * txtPosScaleX, 40 * txtPosScaleY);
+    dc.SetUserScale(coordScaleX, coordScaleY);
 
     dc.SetPen( wxPen(*wxBLACK,0,wxDOT_DASH) );
     dc.DrawEllipse(50, 140, 100, 50);
     dc.SetPen(*wxRED_PEN);
 
-    dc.DrawText( wxT("Test message: this is in 10 point text"), 10, 180);
+    dc.SetUserScale(fontScaleX, fontScaleY);
+    dc.DrawText(wxT("Test message: this is in 10 point text"), 10 * txtPosScaleX, 180 * txtPosScaleY);
+    dc.SetUserScale(coordScaleX, coordScaleY);
     
 #if wxUSE_UNICODE
-    //char *test = "Hebrew    שלום -- Japanese (日本語)";
+    //char *test = "Hebrew    ???? -- Japanese (???)";
     //wxString tmp = wxConvUTF8.cMB2WC( test );
     //dc.DrawText( tmp, 10, 200 );
 #endif
@@ -493,11 +620,14 @@
     wxString str;
     int i = 0;
     str.Printf( wxT("---- Text at angle %d ----"), i );
-    dc.DrawRotatedText( str, 100, 300, i );
+    dc.SetUserScale(fontScaleX, fontScaleY);
+    dc.DrawRotatedText(str, 100 * txtPosScaleX, 300 * txtPosScaleY, i);
 
     i = m_angle;
     str.Printf( wxT("---- Text at angle %d ----"), i );
-    dc.DrawRotatedText( str, 100, 300, i );
+    dc.SetUserScale(fontScaleX, fontScaleY);
+    dc.DrawRotatedText(str, 100 * txtPosScaleX, 300 * txtPosScaleY, i);
+    dc.SetUserScale(coordScaleX, coordScaleY);
 
     wxIcon my_icon = wxICON(mondrian) ;
 
@@ -512,7 +642,794 @@
       dc.DrawBitmap(m_imgUp, 300, 200);
       dc.DrawBitmap(m_imgUp, 300, 250, true);
     }
+    dc.SetUserScale(baseScaleX, baseScaleY);
+}
+
+void MyFrame::OnPdfPageSetupAll(wxCommandEvent&  WXUNUSED(event) )
+{
+   wxPageSetupDialogData* dialogData = new wxPageSetupDialogData;
+   dialogData->SetMarginTopLeft(wxPoint(25,25));
+   dialogData->SetMarginBottomRight(wxPoint(25,25));
+   dialogData->EnableMargins(true);
+   dialogData->EnablePaper(true);
+   dialogData->EnableOrientation(true);
+
+   wxPdfPageSetupDialog* dialog = new wxPdfPageSetupDialog(this, dialogData);
+   if( dialog->ShowModal() == wxID_OK )
+   {
+     // dialogData now has user choices
+   }
+
+   delete dialog;
+   delete dialogData;
+}
+
+void MyFrame::OnPdfPageSetupMinimal(wxCommandEvent&  WXUNUSED(event) )
+{
+   wxPageSetupDialogData* dialogData = new wxPageSetupDialogData;
+   dialogData->SetMarginTopLeft(wxPoint(25,25));
+   dialogData->SetMarginBottomRight(wxPoint(25,25));
+   dialogData->EnableMargins(false);
+   dialogData->EnablePaper(true);
+   dialogData->EnableOrientation(false);
+
+   wxPdfPageSetupDialog* dialog = new wxPdfPageSetupDialog(this, dialogData, _T("Minimal PDF Page Setup"));
+   if( dialog->ShowModal() == wxID_OK )
+   {
+     // dialogData now has user choices
+   }
+
+   delete dialog;
+   delete dialogData;
+}
+
+void MyFrame::OnPdfPrintDialogAll(wxCommandEvent&  WXUNUSED(event) )
+{
+   wxPageSetupDialogData* dialogData = new wxPageSetupDialogData;
+   dialogData->SetMarginTopLeft(wxPoint(25,25));
+   dialogData->SetMarginBottomRight(wxPoint(25,25));
+   dialogData->EnableMargins(true);
+   dialogData->EnablePaper(true);
+   dialogData->EnableOrientation(true);
+
+   wxPdfPageSetupDialog* dialog = new wxPdfPageSetupDialog(this, dialogData);
+   if( dialog->ShowModal() == wxID_OK )
+   {
+      wxPdfPrintData* printData = new wxPdfPrintData( dialogData );
+      wxPdfPrintDialog* printDialog =  new wxPdfPrintDialog(this, printData );
+      if( printDialog->ShowModal() == wxID_OK )
+      {
+       // printData now has user info
+      }
+      delete printDialog;
+      delete printData;
 }
+   delete dialog;
+   delete dialogData;
+}
+
+void MyFrame::OnPdfPrintDialogMinimal(wxCommandEvent&  WXUNUSED(event) )
+{
+    wxPdfPrintData* printData = new wxPdfPrintData();
+    // restrict what we see in dialog
+    printData->SetPrintDialogFlags( wxPDF_PRINTDIALOG_OPENDOC|wxPDF_PRINTDIALOG_FILEPATH );
+    wxPdfPrintDialog* printDialog =  new wxPdfPrintDialog(this, printData );
+    if( printDialog->ShowModal() == wxID_OK )
+    {
+      // printData now has user info
+    }
+    delete printDialog;
+   delete printData;
+}
+
+#if wxUSE_RICHTEXT
+void MyFrame::OnPdfRichTextPrint(wxCommandEvent&  WXUNUSED(event) )
+{
+   wxPageSetupDialogData dialogData = wxPageSetupDialogData();
+   dialogData.SetMarginTopLeft(wxPoint(25,25));
+   dialogData.SetMarginBottomRight(wxPoint(25,25));
+   dialogData.EnableMargins(true);
+   dialogData.EnablePaper(true);
+   dialogData.EnableOrientation(true);
+
+   wxPdfPageSetupDialog* dialog = new wxPdfPageSetupDialog(this, &dialogData);
+   if( dialog->ShowModal() == wxID_OK )
+   {
+      dialogData = dialog->GetPageSetupData();
+      wxPdfPrintData printData = wxPdfPrintData( &dialogData );
+
+      wxPdfPrintDialog *printDialog =  new wxPdfPrintDialog(this, &printData );
+      if( printDialog->ShowModal() == wxID_OK )
+      {
+        printData = printDialog->GetPdfPrintData();
+        // printData now has user info.
+        // We will use richtextprinting as a convenient storage container for
+        // the copy richtext buffers. If we did not do this, we would need to handle
+        // deletion of the buffers in our code.
+        m_richtextPrinting->SetRichTextBufferPrinting(
+            new wxRichTextBuffer(m_richtext->GetBuffer())
+            );
+
+        wxRichTextPrintout *printPrintout = new wxRichTextPrintout(wxT("Demo PDF Printing"));
+        // richtext printout accepts margins in tenths of mm
+        printPrintout->SetMargins(
+                      10 * dialogData.GetMarginTopLeft().y,
+                      10 * dialogData.GetMarginBottomRight().y,
+                      10 * dialogData.GetMarginTopLeft().x,
+                      10 * dialogData.GetMarginBottomRight().x
+                      );
+
+        printPrintout->SetRichTextBuffer(  m_richtextPrinting->GetRichTextBufferPrinting() );
+
+        wxPdfPrinter *printer = new wxPdfPrinter( &printData );
+        // don't show a print dialog again - we have already done so
+        printer->Print(this, printPrintout, false);
+        delete printer;
+        delete printPrintout;
+      }
+      delete printDialog;
+   }
+   delete dialog;
+}
+
+void MyFrame::OnPdfRichTextPreview(wxCommandEvent&  WXUNUSED(event) )
+{
+   wxPageSetupDialogData dialogData = wxPageSetupDialogData();
+   dialogData.SetMarginTopLeft(wxPoint(25,25));
+   dialogData.SetMarginBottomRight(wxPoint(25,25));
+   dialogData.EnableMargins(true);
+   dialogData.EnablePaper(true);
+   dialogData.EnableOrientation(true);
+
+   wxPdfPageSetupDialog* dialog = new wxPdfPageSetupDialog(this, &dialogData);
+   if( dialog->ShowModal() == wxID_OK )
+   {
+      dialogData = dialog->GetPageSetupData();
+      wxPdfPrintData printData = wxPdfPrintData( &dialogData );
+      // We will use richtextprinting as a convenient storage container for
+      // the copy richtext buffers. If we did not do this, we would need to handle
+      // deletion of the buffers in our code.
+      m_richtextPrinting->SetRichTextBufferPrinting(
+        new wxRichTextBuffer(m_richtext->GetBuffer())
+      );
+      
+      m_richtextPrinting->SetRichTextBufferPreview(
+        new wxRichTextBuffer(m_richtext->GetBuffer())
+      );
+
+      wxRichTextPrintout *printPrintout = new wxRichTextPrintout(wxT("Demo PDF Printing"));   
+      // richtext printout accepts margins in tenths of mm
+      printPrintout->SetMargins(
+                      10 * dialogData.GetMarginTopLeft().y,
+                      10 * dialogData.GetMarginBottomRight().y,
+                      10 * dialogData.GetMarginTopLeft().x,
+                      10 * dialogData.GetMarginBottomRight().x
+                      );
+      printPrintout->SetRichTextBuffer(  m_richtextPrinting->GetRichTextBufferPrinting() );
+
+      wxRichTextPrintout *previewPrintout = new wxRichTextPrintout(wxT("Demo PDF Printing"));   
+      // richtext printout accepts margins in tenths of mm
+      previewPrintout->SetMargins(
+                      10 * dialogData.GetMarginTopLeft().y,
+                      10 * dialogData.GetMarginBottomRight().y,
+                      10 * dialogData.GetMarginTopLeft().x,
+                      10 * dialogData.GetMarginBottomRight().x
+                      );
+      previewPrintout->SetRichTextBuffer(  m_richtextPrinting->GetRichTextBufferPreview() );
+
+      wxPdfPrintPreview *preview = new wxPdfPrintPreview(previewPrintout, printPrintout, &printData);
+      if (preview->IsOk())
+      {
+        wxPreviewFrame *frame = new wxPreviewFrame(preview, this,
+                _("PDF Document RichText Preview"), wxDefaultPosition, wxSize(600,600));
+        frame->Centre(wxBOTH);
+        frame->Initialize();
+        frame->Show(true);
+      }
+      else
+      {
+        delete preview;
+      }
+   }
+   delete dialog;
+}
+
+void MyFrame::WriteRichTextBuffer()
+{
+    wxRichTextCtrl& r = *m_richtext;
+
+    r.SetFont(wxGetApp().m_testFont);
+    // load our images
+    // wxRichText does not know at what scale our bitmaps are meant to be displayed
+    // so we must scale them - they are designed at 96 dpi
+    wxScreenDC sdc;
+    wxImage imgZebra = wxBitmap(zebra_xpm).ConvertToImage();
+    wxImage imgSmile = wxBitmap(smiley_xpm).ConvertToImage();
+
+    imgZebra.Rescale(imgZebra.GetWidth() * sdc.GetPPI().GetWidth() / 96,
+                     imgZebra.GetHeight() * sdc.GetPPI().GetHeight() / 96,
+                     wxIMAGE_QUALITY_HIGH
+                    );
+    imgSmile.Rescale(imgSmile.GetWidth() * sdc.GetPPI().GetWidth() / 96,
+                     imgSmile.GetHeight() * sdc.GetPPI().GetHeight() / 96,
+                     wxIMAGE_QUALITY_HIGH
+                    );
+
+#if wxMAJOR_VERSION > 2 || (wxMAJOR_VERSION == 2 && wxMINOR_VERSION == 9)
+
+    r.SetDefaultStyle(wxRichTextAttr());
+
+    r.BeginSuppressUndo();
+
+    r.Freeze();
+
+    r.BeginParagraphSpacing(0, 20);
+
+    r.BeginAlignment(wxTEXT_ALIGNMENT_CENTRE);
+    r.BeginBold();
+
+    r.BeginFontSize(14);
+
+    wxString lineBreak = (wxChar) 29;
+
+    r.WriteText(wxString(wxT("Welcome to wxRichTextCtrl, a wxWidgets control")) + lineBreak + wxT("for editing and presenting styled text and images\n"));
+    r.EndFontSize();
+
+    r.BeginItalic();
+    r.WriteText(wxT("by Julian Smart"));
+    r.EndItalic();
+
+    r.EndBold();
+    r.Newline();
+
+    r.WriteImage(imgZebra);
+
+    r.Newline();
+    r.Newline();
+
+    r.EndAlignment();
+
+    r.BeginAlignment(wxTEXT_ALIGNMENT_LEFT);
+    wxRichTextAttr imageAttr;
+    imageAttr.GetTextBoxAttr().SetFloatMode(wxTEXT_BOX_ATTR_FLOAT_LEFT);
+    r.WriteText(wxString(wxT("This is a simple test for a floating left image test. The zebra image should be placed at the left side of the current buffer and all the text should flow around it at the right side. This is a simple test for a floating left image test. The zebra image should be placed at the left side of the current buffer and all the text should flow around it at the right side. This is a simple test for a floating left image test. The zebra image should be placed at the left side of the current buffer and all the text should flow around it at the right side.")));
+    r.WriteImage(imgZebra, wxBITMAP_TYPE_PNG, imageAttr);
+
+    imageAttr.GetTextBoxAttr().GetTop().SetValue(200);
+    imageAttr.GetTextBoxAttr().GetTop().SetUnits(wxTEXT_ATTR_UNITS_PIXELS);
+    imageAttr.GetTextBoxAttr().SetFloatMode(wxTEXT_BOX_ATTR_FLOAT_RIGHT);
+    r.WriteImage(imgZebra, wxBITMAP_TYPE_PNG, imageAttr);
+    r.WriteText(wxString(wxT("This is a simple test for a floating right image test. The zebra image should be placed at the right side of the current buffer and all the text should flow around it at the left side. This is a simple test for a floating left image test. The zebra image should be placed at the right side of the current buffer and all the text should flow around it at the left side. This is a simple test for a floating left image test. The zebra image should be placed at the right side of the current buffer and all the text should flow around it at the left side.")));
+    r.EndAlignment();
+    r.Newline();
+
+    int i;
+    for ( i = 0; i < 10; ++i)
+    {
+
+        r.WriteText(wxT("What can you do with this thing? "));
+
+        r.WriteImage(imgSmile);
+        r.WriteText(wxT(" Well, you can change text "));
+
+        r.BeginTextColour(wxColour(255, 0, 0));
+        r.WriteText(wxT("colour, like this red bit."));
+        r.EndTextColour();
+
+        wxRichTextAttr backgroundColourAttr;
+        backgroundColourAttr.SetBackgroundColour(*wxGREEN);
+        backgroundColourAttr.SetTextColour(wxColour(0, 0, 255));
+        r.BeginStyle(backgroundColourAttr);
+        r.WriteText(wxT(" And this blue on green bit."));
+        r.EndStyle();
+
+        r.WriteText(wxT(" Naturally you can make things "));
+        r.BeginBold();
+        r.WriteText(wxT("bold "));
+        r.EndBold();
+        r.BeginItalic();
+        r.WriteText(wxT("or italic "));
+        r.EndItalic();
+        r.BeginUnderline();
+        r.WriteText(wxT("or underlined."));
+        r.EndUnderline();
+
+        r.BeginFontSize(14);
+        r.WriteText(wxT(" Different font sizes on the same line is allowed, too."));
+        r.EndFontSize();
+
+        r.WriteText(wxT(" Next we'll show an indented paragraph."));
+
+        r.Newline();
+
+        r.BeginLeftIndent(60);
+        r.WriteText(wxT("It was in January, the most down-trodden month of an Edinburgh winter. An attractive woman came into the cafe, which is nothing remarkable."));
+        r.Newline();
+
+        r.EndLeftIndent();
+
+        r.WriteText(wxT("Next, we'll show a first-line indent, achieved using BeginLeftIndent(100, -40)."));
+
+        r.Newline();
+
+        r.BeginLeftIndent(100, -40);
+
+        r.WriteText(wxT("It was in January, the most down-trodden month of an Edinburgh winter. An attractive woman came into the cafe, which is nothing remarkable."));
+        r.Newline();
+
+        r.EndLeftIndent();
+
+        r.WriteText(wxT("Numbered bullets are possible, again using subindents:"));
+        r.Newline();
+
+        r.BeginNumberedBullet(1, 100, 60);
+        r.WriteText(wxT("This is my first item. Note that wxRichTextCtrl can apply numbering and bullets automatically based on list styles, but this list is formatted explicitly by setting indents."));
+        r.Newline();
+        r.EndNumberedBullet();
+
+        r.BeginNumberedBullet(2, 100, 60);
+        r.WriteText(wxT("This is my second item."));
+        r.Newline();
+        r.EndNumberedBullet();
+
+        r.WriteText(wxT("The following paragraph is right-indented:"));
+        r.Newline();
+
+        r.BeginRightIndent(200);
+
+        r.WriteText(wxT("It was in January, the most down-trodden month of an Edinburgh winter. An attractive woman came into the cafe, which is nothing remarkable."));
+        r.Newline();
+
+        r.EndRightIndent();
+
+        r.WriteText(wxT("The following paragraph is right-aligned with 1.5 line spacing:"));
+        r.Newline();
+
+        r.BeginAlignment(wxTEXT_ALIGNMENT_RIGHT);
+        r.BeginLineSpacing(wxTEXT_ATTR_LINE_SPACING_HALF);
+        r.WriteText(wxT("It was in January, the most down-trodden month of an Edinburgh winter. An attractive woman came into the cafe, which is nothing remarkable."));
+        r.Newline();
+        r.EndLineSpacing();
+        r.EndAlignment();
+
+        wxArrayInt tabs;
+        tabs.Add(400);
+        tabs.Add(600);
+        tabs.Add(800);
+        tabs.Add(1000);
+        wxRichTextAttr attr;
+        attr.SetFlags(wxTEXT_ATTR_TABS);
+        attr.SetTabs(tabs);
+        r.SetDefaultStyle(attr);
+
+        r.WriteText(wxT("This line contains tabs:\tFirst tab\tSecond tab\tThird tab"));
+        r.Newline();
+
+        r.WriteText(wxT("Other notable features of wxRichTextCtrl include:"));
+        r.Newline();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("Compatibility with wxTextCtrl API"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("Easy stack-based BeginXXX()...EndXXX() style setting in addition to SetStyle()"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("XML loading and saving"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("Undo/Redo, with batching option and Undo suppressing"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("Clipboard copy and paste"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("wxRichTextStyleSheet with named character and paragraph styles, and control for applying named styles"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("A design that can easily be extended to other content types, ultimately with text boxes, tables, controls, and so on"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        // Make a style suitable for showing a URL
+        wxRichTextAttr urlStyle;
+        urlStyle.SetTextColour(*wxBLUE);
+        urlStyle.SetFontUnderlined(true);
+
+        r.WriteText(wxT("wxRichTextCtrl can also display URLs, such as this one: "));
+        r.BeginStyle(urlStyle);
+        r.BeginURL(wxT("http://www.wxwidgets.org"));
+        r.WriteText(wxT("The wxWidgets Web Site"));
+        r.EndURL();
+        r.EndStyle();
+        r.WriteText(wxT(". Click on the URL to generate an event."));
+
+        r.Newline();
+
+        r.WriteText(wxT("Note: this sample content was generated programmatically from within the MyFrame constructor in the demo. The images were loaded from inline XPMs. Enjoy wxRichTextCtrl!\n"));
+    }
+    
+    r.EndParagraphSpacing();
+
+    // Add a text box
+    if (1)
+    {
+  
+      r.Newline();
+
+      wxRichTextAttr attr;
+      attr.GetTextBoxAttr().GetMargins().GetLeft().SetValue(20, wxTEXT_ATTR_UNITS_PIXELS);
+      attr.GetTextBoxAttr().GetMargins().GetTop().SetValue(20, wxTEXT_ATTR_UNITS_PIXELS);
+      attr.GetTextBoxAttr().GetMargins().GetRight().SetValue(20, wxTEXT_ATTR_UNITS_PIXELS);
+      attr.GetTextBoxAttr().GetMargins().GetBottom().SetValue(20, wxTEXT_ATTR_UNITS_PIXELS);
+
+      attr.GetTextBoxAttr().GetBorder().SetColour(*wxBLACK);
+      attr.GetTextBoxAttr().GetBorder().SetWidth(1, wxTEXT_ATTR_UNITS_PIXELS);
+      attr.GetTextBoxAttr().GetBorder().SetStyle(wxTEXT_BOX_ATTR_BORDER_SOLID);
+
+      wxRichTextBox* textBox = r.WriteTextBox(attr);
+      r.SetFocusObject(textBox);
+
+      r.WriteText(wxT("This is a text box. Just testing! Once more unto the breach, dear friends, once more..."));
+
+      r.SetFocusObject(NULL); // Set the focus back to the main buffer
+      r.SetInsertionPointEnd();
+    }
+    if(1)
+    {
+      // Add a table
+
+      r.Newline();
+
+      wxRichTextAttr attr;
+      attr.GetTextBoxAttr().GetMargins().GetLeft().SetValue(5, wxTEXT_ATTR_UNITS_PIXELS);
+      attr.GetTextBoxAttr().GetMargins().GetTop().SetValue(5, wxTEXT_ATTR_UNITS_PIXELS);
+      attr.GetTextBoxAttr().GetMargins().GetRight().SetValue(5, wxTEXT_ATTR_UNITS_PIXELS);
+      attr.GetTextBoxAttr().GetMargins().GetBottom().SetValue(5, wxTEXT_ATTR_UNITS_PIXELS);
+      attr.GetTextBoxAttr().GetPadding() = attr.GetTextBoxAttr().GetMargins();
+
+      attr.GetTextBoxAttr().GetBorder().SetColour(*wxBLACK);
+      attr.GetTextBoxAttr().GetBorder().SetWidth(1, wxTEXT_ATTR_UNITS_PIXELS);
+      attr.GetTextBoxAttr().GetBorder().SetStyle(wxTEXT_BOX_ATTR_BORDER_SOLID);
+
+      wxRichTextAttr cellAttr = attr;
+      cellAttr.GetTextBoxAttr().GetWidth().SetValue(200, wxTEXT_ATTR_UNITS_PIXELS);
+      cellAttr.GetTextBoxAttr().GetHeight().SetValue(150, wxTEXT_ATTR_UNITS_PIXELS);
+
+      wxRichTextTable* table = r.WriteTable(3, 2, attr, cellAttr);
+      int i, j;
+      for (j = 0; j < table->GetRowCount(); j++)
+      {
+          for (i = 0; i < table->GetColumnCount(); i++)
+          {
+              wxString msg = wxString::Format(wxT("This is cell %d, %d"), (j+1), (i+1));
+              r.SetFocusObject(table->GetCell(j, i));
+              r.WriteText(msg);
+          }
+      }
+      r.SetFocusObject(NULL); // Set the focus back to the main buffer
+      r.SetInsertionPointEnd();
+    }
+
+    r.Thaw();
+
+    r.EndSuppressUndo();
+
+#else
+// 2.8.x implementation
+    r.SetDefaultStyle(wxRichTextAttr());
+
+    r.BeginSuppressUndo();
+
+    r.BeginParagraphSpacing(0, 20);
+
+    r.BeginAlignment(wxTEXT_ALIGNMENT_CENTRE);
+    r.BeginBold();
+
+    r.BeginFontSize(14);
+
+    wxString lineBreak = (wxChar) 29;
+
+    r.WriteText(wxString(wxT("Welcome to wxRichTextCtrl, a wxWidgets control")) + lineBreak + wxT("for editing and presenting styled text and images\n"));
+    r.EndFontSize();
+    //r.Newline();
+
+    r.BeginItalic();
+    r.WriteText(wxT("by Julian Smart"));
+    r.EndItalic();
+
+    r.EndBold();
+    r.Newline();
+
+    r.WriteImage(imgZebra);
+
+    r.Newline();
+    r.Newline();
+
+    r.EndAlignment();
+
+    int i;
+    for ( i = 0; i < 10; ++i)
+    {
+
+        r.WriteText(wxT("What can you do with this thing? "));
+
+        r.WriteImage(imgSmile);
+        r.WriteText(wxT(" Well, you can change text "));
+
+        r.BeginTextColour(wxColour(255, 0, 0));
+        r.WriteText(wxT("colour, like this red bit."));
+        r.EndTextColour();
+
+        wxRichTextAttr backgroundColourAttr;
+        backgroundColourAttr.SetBackgroundColour(*wxGREEN);
+        backgroundColourAttr.SetTextColour(wxColour(0, 0, 255));
+        r.BeginStyle(backgroundColourAttr);
+        r.WriteText(wxT(" And this blue on green bit."));
+        r.EndStyle();
+
+        r.WriteText(wxT(" Naturally you can make things "));
+        r.BeginBold();
+        r.WriteText(wxT("bold "));
+        r.EndBold();
+        r.BeginItalic();
+        r.WriteText(wxT("or italic "));
+        r.EndItalic();
+        r.BeginUnderline();
+        r.WriteText(wxT("or underlined."));
+        r.EndUnderline();
+
+        r.BeginFontSize(14);
+        r.WriteText(wxT(" Different font sizes on the same line is allowed, too."));
+        r.EndFontSize();
+
+        r.WriteText(wxT(" Next we'll show an indented paragraph."));
+
+        r.Newline();
+
+        r.BeginLeftIndent(60);
+        r.WriteText(wxT("It was in January, the most down-trodden month of an Edinburgh winter. An attractive woman came into the cafe, which is nothing remarkable."));
+        r.Newline();
+
+        r.EndLeftIndent();
+
+        r.WriteText(wxT("Next, we'll show a first-line indent, achieved using BeginLeftIndent(100, -40)."));
+
+        r.Newline();
+
+        r.BeginLeftIndent(100, -40);
+
+        r.WriteText(wxT("It was in January, the most down-trodden month of an Edinburgh winter. An attractive woman came into the cafe, which is nothing remarkable."));
+        r.Newline();
+    
+        r.EndLeftIndent();
+    
+        r.WriteText(wxT("Numbered bullets are possible, again using subindents:"));
+        r.Newline();
+
+        r.BeginNumberedBullet(1, 100, 60);
+        r.WriteText(wxT("This is my first item. Note that wxRichTextCtrl can apply numbering and bullets automatically based on list styles, but this list is formatted explicitly by setting indents."));
+        r.Newline();
+
+        r.EndNumberedBullet();
+
+        r.BeginNumberedBullet(2, 100, 60);
+        r.WriteText(wxT("This is my second item."));
+        r.Newline();
+
+        r.EndNumberedBullet();
+
+        r.WriteText(wxT("The following paragraph is right-indented:"));
+        r.Newline();
+
+        r.BeginRightIndent(200);
+
+        r.WriteText(wxT("It was in January, the most down-trodden month of an Edinburgh winter. An attractive woman came into the cafe, which is nothing remarkable."));
+        r.Newline();
+
+        r.EndRightIndent();
+
+        r.WriteText(wxT("The following paragraph is right-aligned with 1.5 line spacing:"));
+        r.Newline();
+
+        r.BeginAlignment(wxTEXT_ALIGNMENT_RIGHT);
+        r.BeginLineSpacing(wxTEXT_ATTR_LINE_SPACING_HALF);
+        r.WriteText(wxT("It was in January, the most down-trodden month of an Edinburgh winter. An attractive woman came into the cafe, which is nothing remarkable."));
+        r.Newline();
+        r.EndLineSpacing();
+        r.EndAlignment();
+
+        wxArrayInt tabs;
+        tabs.Add(400);
+        tabs.Add(600);
+        tabs.Add(800);
+        tabs.Add(1000);
+        wxTextAttrEx attr;
+        attr.SetFlags(wxTEXT_ATTR_TABS);
+        attr.SetTabs(tabs);
+        r.SetDefaultStyle(attr);
+
+        r.WriteText(wxT("This line contains tabs:\tFirst tab\tSecond tab\tThird tab"));
+        r.Newline();
+
+        r.WriteText(wxT("Other notable features of wxRichTextCtrl include:"));
+        r.Newline();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("Compatibility with wxTextCtrl API"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("Easy stack-based BeginXXX()...EndXXX() style setting in addition to SetStyle()"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("XML loading and saving"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("Undo/Redo, with batching option and Undo suppressing"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("Clipboard copy and paste"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("wxRichTextStyleSheet with named character and paragraph styles, and control for applying named styles"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        r.BeginSymbolBullet(wxT('*'), 100, 60);
+        r.WriteText(wxT("A design that can easily be extended to other content types, ultimately with text boxes, tables, controls, and so on"));
+        r.Newline();
+        r.EndSymbolBullet();
+
+        // Make a style suitable for showing a URL
+        wxRichTextAttr urlStyle;
+        urlStyle.SetTextColour(*wxBLUE);
+        urlStyle.SetFontUnderlined(true);
+
+        r.WriteText(wxT("wxRichTextCtrl can also display URLs, such as this one: "));
+        r.BeginStyle(urlStyle);
+        r.BeginURL(wxT("http://www.wxwidgets.org"));
+        r.WriteText(wxT("The wxWidgets Web Site"));
+        r.EndURL();
+        r.EndStyle();
+        r.WriteText(wxT(". Click on the URL to generate an event."));
+
+        r.Newline();
+
+        r.WriteText(wxT("Note: this sample content was generated programmatically from within the MyFrame constructor in the demo. The images were loaded from inline XPMs. Enjoy wxRichTextCtrl!"));
+
+        r.Newline();
+    }
+
+    r.EndParagraphSpacing();
+
+    r.EndSuppressUndo();
+
+#endif
+
+}
+
+#endif
+
+#if wxUSE_HTML
+void MyFrame::OnPdfHtmlPrint(wxCommandEvent&  WXUNUSED(event) )
+{
+  wxPageSetupDialogData dialogData = wxPageSetupDialogData();
+  dialogData.SetMarginTopLeft(wxPoint(25,25));
+  dialogData.SetMarginBottomRight(wxPoint(25,25));
+  dialogData.EnableMargins(false);
+  dialogData.EnablePaper(true);
+  dialogData.EnableOrientation(true);
+   
+  wxPdfPageSetupDialog* dialog = new wxPdfPageSetupDialog(this, &dialogData);
+  if( dialog->ShowModal() == wxID_OK )
+  {
+      dialogData = dialog->GetPageSetupData();
+      wxPdfPrintData printData = wxPdfPrintData( &dialogData );
+      
+      // restrict user choices in printdialog
+      printData.SetPrintDialogFlags( wxPDF_PRINTDIALOG_OPENDOC|wxPDF_PRINTDIALOG_FILEPATH );
+      // set launchviewer default to true
+      printData.SetLaunchDocumentViewer(true);
+      
+      wxPdfPrintDialog *printDialog =  new wxPdfPrintDialog(this, &printData );
+      if( printDialog->ShowModal() == wxID_OK )
+      {
+        printData = printDialog->GetPdfPrintData();
+        
+        wxHtmlPrintout *printPrintout = new wxHtmlPrintout(wxT("Demo PDF Printing"));   
+        printPrintout->SetMargins(
+                        dialogData.GetMarginTopLeft().y,
+                        dialogData.GetMarginBottomRight().y,
+                        dialogData.GetMarginTopLeft().x,
+                        dialogData.GetMarginBottomRight().x
+                        );
+        printPrintout->SetHtmlFile(wxT("test.html"));
+        printPrintout->SetStandardFonts(10, wxT("Arial"), wxT("Courier New"));
+        wxPdfPrinter *printer = new wxPdfPrinter( &printData );
+        // don't show a print dialog again - we have already done so
+        printer->Print(this, printPrintout, false);
+        delete printer;
+        delete printPrintout;
+      }
+      delete printDialog;
+  }
+  delete dialog;
+}
+
+void MyFrame::OnPdfHtmlPreview(wxCommandEvent&  WXUNUSED(event) )
+{
+  wxPageSetupDialogData dialogData = wxPageSetupDialogData();
+  dialogData.SetMarginTopLeft(wxPoint(25,25));
+  dialogData.SetMarginBottomRight(wxPoint(25,25));
+  dialogData.EnableMargins(true);
+  dialogData.EnablePaper(true);
+  dialogData.EnableOrientation(true);
+   
+  wxPdfPageSetupDialog* dialog = new wxPdfPageSetupDialog(this, &dialogData);
+  if( dialog->ShowModal() == wxID_OK )
+  {
+      dialogData = dialog->GetPageSetupData();
+      wxPdfPrintData printData = wxPdfPrintData( &dialogData );
+    
+      wxHtmlPrintout *printPrintout = new wxHtmlPrintout(wxT("Demo PDF Printing"));   
+      printPrintout->SetMargins(
+                      dialogData.GetMarginTopLeft().y,
+                      dialogData.GetMarginBottomRight().y,
+                      dialogData.GetMarginTopLeft().x,
+                      dialogData.GetMarginBottomRight().x
+                      );
+      printPrintout->SetHtmlFile(wxT("test.html"));
+      printPrintout->SetStandardFonts(10, wxT("Arial"), wxT("Courier New"));
+      
+      wxHtmlPrintout *previewPrintout = new wxHtmlPrintout(wxT("Demo PDF Printing"));   
+      previewPrintout->SetMargins(
+                      dialogData.GetMarginTopLeft().y,
+                      dialogData.GetMarginBottomRight().y,
+                      dialogData.GetMarginTopLeft().x,
+                      dialogData.GetMarginBottomRight().x
+                      );
+      previewPrintout->SetHtmlFile(wxT("test.html"));
+      previewPrintout->SetStandardFonts(10, wxT("Arial"), wxT("Courier New"));
+      
+      wxPdfPrintPreview *preview = new wxPdfPrintPreview(previewPrintout, printPrintout, &printData);
+      if (preview->IsOk())
+      {
+        wxPreviewFrame *frame = new wxPreviewFrame(preview, this,
+                _("PDF Document Html Preview"), wxDefaultPosition, wxSize(600,600));
+        frame->Centre(wxBOTH);
+        frame->Initialize();
+        frame->Show(true);
+      }
+      else
+      {
+        delete preview;
+      }
+  }
+  delete dialog;
+}
+#endif
 
 void MyFrame::OnSize(wxSizeEvent& event )
 {
@@ -590,8 +1507,9 @@
 
     // We know the graphic is 230x350. If we didn't know this, we'd need to
     // calculate it.
-    wxCoord maxX = 230;
-    wxCoord maxY = 350;
+    wxSize devicePPI = GetDC()->GetPPI();
+    wxCoord maxX = wxRound(230.0 * (double)devicePPI.GetWidth()  / 72.0);
+    wxCoord maxY = wxRound(350.0 * (double)devicePPI.GetHeight() / 72.0);
 
     // This sets the user scale and origin of the DC so that the image fits
     // within the paper rectangle (but the edges could be cut off by printers
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/samples/pdfdc/printing.h wxPdfDoc-copy/samples/pdfdc/printing.h
--- wxpdfdoc-0.9.2.1/samples/pdfdc/printing.h	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/samples/pdfdc/printing.h	2012-05-26 17:57:54.394100000 +0100
@@ -34,7 +34,15 @@
     wxImage  m_imgUp;
     int      m_angle;
     MyFrame(wxFrame *frame, const wxString& title, const wxPoint& pos, const wxSize& size);
+    ~MyFrame();
 
+// Need a richtext ctrl to create a richtext buffer.
+// Use wxRichTextPrinting as a convenient manager
+// for richtext buffers
+#if wxUSE_RICHTEXT
+    wxRichTextCtrl *m_richtext;
+    wxRichTextPrinting *m_richtextPrinting;
+#endif
     void Draw(wxDC& dc);
     void OnAngleUp(wxCommandEvent& event);
     void OnAngleDown(wxCommandEvent& event);
@@ -56,7 +64,27 @@
 
     void OnExit(wxCommandEvent& event);
     void OnPrintAbout(wxCommandEvent& event);
+
+// printing framework
+    void OnPdfPageSetupAll(wxCommandEvent& event);
+    void OnPdfPageSetupMinimal(wxCommandEvent& event);
+    void OnPdfPrintDialogAll(wxCommandEvent& event);
+    void OnPdfPrintDialogMinimal(wxCommandEvent& event);
+#if wxUSE_RICHTEXT
+    void OnPdfRichTextPrint(wxCommandEvent& event);
+    void OnPdfRichTextPreview(wxCommandEvent& event);
+#endif
+#if wxUSE_HTML
+    void OnPdfHtmlPrint(wxCommandEvent& event);
+    void OnPdfHtmlPreview(wxCommandEvent& event);
+#endif
+
 DECLARE_EVENT_TABLE()
+
+#if wxUSE_RICHTEXT
+private:
+    void WriteRichTextBuffer();
+#endif
 };
 
 // Define a new canvas which can receive some events
@@ -87,22 +115,27 @@
 
 };
 
-#define WXPRINT_QUIT            100
-#define WXPRINT_PRINT           101
-#define WXPRINT_PDF             102
-#define WXPRINT_PDF_TPL         103
-#define WXPRINT_PAGE_SETUP      104
-#define WXPRINT_PREVIEW         105
-
-#define WXPRINT_PRINT_PS        106
-#define WXPRINT_PAGE_SETUP_PS   107
-#define WXPRINT_PREVIEW_PS      108
-
-#define WXPRINT_ABOUT           109
-
-#define WXPRINT_ANGLEUP         110
-#define WXPRINT_ANGLEDOWN       111
-
-#ifdef __WXMAC__
-    #define WXPRINT_PAGE_MARGINS 112
-#endif
+enum
+{
+  WXPRINT_QUIT = 100,
+  WXPRINT_PRINT,
+  WXPRINT_PDF,
+  WXPRINT_PDF_TPL,
+  WXPRINT_PAGE_SETUP,
+  WXPRINT_PREVIEW,
+  WXPRINT_PRINT_PS,
+  WXPRINT_PAGE_SETUP_PS,
+  WXPRINT_PREVIEW_PS,
+  WXPRINT_ABOUT,
+  WXPRINT_ANGLEUP,
+  WXPRINT_ANGLEDOWN,
+  WXPRINT_PAGE_MARGINS,
+  WXPDFPRINT_PAGE_SETUP_ALL,
+  WXPDFPRINT_PAGE_SETUP_MINIMAL,
+  WXPDFPRINT_PRINT_DIALOG_ALL,
+  WXPDFPRINT_PRINT_DIALOG_MINIMAL,
+  WXPDFPRINT_RICHTEXT_PRINT,
+  WXPDFPRINT_RICHTEXT_PREVIEW,
+  WXPDFPRINT_HTML_PRINT,
+  WXPDFPRINT_HTML_PREVIEW
+};
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/samples/pdfdc/smiley.xpm wxPdfDoc-copy/samples/pdfdc/smiley.xpm
--- wxpdfdoc-0.9.2.1/samples/pdfdc/smiley.xpm	1970-01-01 00:00:00.000000000 +0000
+++ wxPdfDoc-copy/samples/pdfdc/smiley.xpm	2012-05-22 01:03:37.687400000 +0100
@@ -0,0 +1,42 @@
+/* XPM */
+static const char *const smiley_xpm[] = {
+/* columns rows colors chars-per-pixel */
+"32 32 4 1",
+". c Black",
+"X c #FFFF00",
+"  c None",
+"o c #C00000",
+/* pixels */
+"                                ",
+"             .....              ",
+"          ...XXXXX...           ",
+"        ..XXXXXXXXXXX..         ",
+"       .XXXXXXXXXXXXXXX.        ",
+"     ..XXXXXXXXXXXXXXXXX..      ",
+"     .XXXXXXXXXXXXXXXXXXXX.     ",
+"    .XXXXXX.XXXXXXX.XXXXXX.     ",
+"   .XXXXXX.X.XXXXX.X.XXXXXX.    ",
+"   .XXXXX.XXX.XXX.XXX.XXXXXX.   ",
+"  .XXXXX.XXXXXXXXXXXXX.XXXXX.   ",
+"  .XXXXXXXX.XXXXXXX.XXXXXXXX.   ",
+"  .XXXXXXXX.XXXXXXX.XXXXXXXX.   ",
+" .XXXXXXXXXXXXXXXXXXXXXXXXXXX.  ",
+" .XXXXXXXXXXXXXXXXXXXXXXXXXXX.  ",
+" .XXXXXXXXXXXXXXXXXXXXXXXXXXX.  ",
+" .XXXXXXXXXXXXXXXXXXXXXXXXXXX.  ",
+" .XXXXXXX.XXXXXXXXXXX.XXXXXXX.  ",
+"  .XXXXXX...XXXXXXX...XXXXXX.   ",
+"  .XXXXXX.oo..XXX..oo.XXXXXX.   ",
+"  .XXXXXXX.ooo...ooo.XXXXXXX.   ",
+"   .XXXXXXX.ooooooo.XXXXXXXX.   ",
+"   .XXXXXXXX..ooo..XXXXXXXX.    ",
+"    .XXXXXXXXX...XXXXXXXXX.     ",
+"     .XXXXXXXXXXXXXXXXXXXX.     ",
+"     ..XXXXXXXXXXXXXXXXX..      ",
+"       .XXXXXXXXXXXXXXX.        ",
+"        ..XXXXXXXXXXX..         ",
+"          ...XXXXX...           ",
+"             .....              ",
+"                                ",
+"                                "
+};
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/samples/pdfdc/test.html wxPdfDoc-copy/samples/pdfdc/test.html
--- wxpdfdoc-0.9.2.1/samples/pdfdc/test.html	1970-01-01 00:00:00.000000000 +0000
+++ wxPdfDoc-copy/samples/pdfdc/test.html	2012-05-22 01:03:37.684400000 +0100
@@ -0,0 +1,349 @@
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
+<title>wxPdfDocument: wxPdfDocument</title>
+<link href="tabs.css" rel="stylesheet" type="text/css"/>
+<link href="doxygen.css" rel="stylesheet" type="text/css"/>
+</head>
+<body>
+<!-- Generated by Doxygen 1.7.4 -->
+<div id="top">
+<div id="titlearea">
+<h1>wxPdfDocument&#160;0.9.2</h1>
+<div class="header">
+  <div class="headertitle">
+<div class="title"><a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> </div>  </div>
+</div>
+<div class="contents">
+<div class="textblock"><h2><a class="anchor" id="intro"></a>
+What is wxPdfDocument?</h2>
+<p><a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> is a C++ class which allows wxWidgets applications to generate PDF files. The code is a port of <a href="http://www.fpdf.org"><b>FPDF</b></a> - a
+ free PHP class for generating PDF files - to C++ using the <a href="http://www.wxwidgets.org"><b>wxWidgets</b></a> library. <a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> does not make use of any
+ libraries like <a href="http://www.pdflib.com"><b>PDFlib</b></a> or <a href="http://www.fastio.com"><b>ClibPDF</b></a> which require a fee at least for commercial usage. <a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument
+</a> is published under the <b>wxWidgets (formerly wxWindows) license</b>. This means you may use it for any kind of usage and modify it to suit your needs.</p>
+<p><a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> offers all advantages of <b>FPDF</b>. Several add-on PHP scripts found on the FPDF web site are incorporated into <a class="el" href="classwx_pdf_document.html"
+ title="Class representing a PDF document.">wxPdfDocument</a>. The main features are:</p>
+<ul>
+<li>Choice of measure unit, page format and margins</li>
+<li>Page header and footer management</li>
+<li>Automatic page break</li>
+<li>Automatic line break and text justification</li>
+<li>Image support (GIF, JPEG, PNG and WMF)</li>
+<li>Colours (Grayscale, RGB, CMYK, Spot colours)</li>
+<li>Links (internal and external)</li>
+<li>14 Adobe standard fonts</li>
+<li>TrueType and Type1 fonts (with or without embedding) and encoding support</li>
+<li>TrueType Unicode and Type0 fonts (for Chinese, Japanese and Korean) support in the Unicode build</li>
+<li>OpenType Unicode fonts support in the Unicode build</li>
+<li>Page compression</li>
+<li>Graphics primitives for the creation of simple drawings</li>
+<li>Definition of clipping areas</li>
+<li>Bookmarks for outlining the document</li>
+<li>Rotation</li>
+<li>Protecting the document by passwords and/or access permissions</li>
+<li>Text annotations</li>
+<li>PDF forms (supported field types: text, combo box, check box, radio button, push button)</li>
+<li>JavaScript</li>
+<li>Fill gradients</li>
+<li>Templates</li>
+<li>Layers (optional content groups)</li>
+<li>Simple bitmap patterns as draw and fill colours</li>
+</ul>
+<p>The class can produce documents in many languages other than the Western European ones: Central European, Cyrillic, Greek, Baltic and Thai, provided you own TrueType or Type1 fonts with the desired character set. In the Unicode build Chinese, Japanese and
+ Korean are supported, too.</p>
+<p>A <a class="el" href="overview.html">Reference Manual</a> showing all available methods in alphabetical order is provided. A sample application including more than 20 examples demonstrates the different features. Separate detailed descriptions are available
+ for the <a class="el" href="makefont.html">MakeFont Utility</a> and the <a class="el" href="showfont.html">ShowFont Utility</a>. The chapter <a class="el" href="writexml.html">Styling text using a simple markup language</a> describes the supported tags of
+ the simple XML markup language used by the method <a class="el" href="classwx_pdf_document.html#a96ea3ddf8d36744be7886638082bbb66" title="Prints a string containing simple XML markup.">wxPdfDocument::WriteXml</a>.</p>
+<p><a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> is hosted as a component of <a href="http://wxcode.sourceforge.net"><b>wxCode</b></a>. For any remark, question or problem, you can leave a message
+ on the appropriate <b>wxCode</b> tracker accessible from the <a href="http://wxcode.sourceforge.net/support.php">wxCode support</a> page. Or you can send a mail to me <a href="&amp;#109;&amp;#97;&amp;#105;&amp;#108;&amp;#116;&amp;#111;:&amp;#117;&amp;#108;&amp;#114;&amp;#105;&amp;#99;&amp;#104;&amp;#46;&amp;#116;&amp;#101;&amp;#108;&amp;#108;&amp;#101;&amp;#64;&amp;#103;&amp;#109;&amp;#120;&amp;#46;&amp;#100;&amp;#101;">directly
+</a>.</p>
+<h2><a class="anchor" id="version"></a>
+Version history</h2>
+<dl>
+<dt><b>0.9.2</b> - <em>September 2011</em> </dt>
+<dd><p class="startdd"><a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> is compatible with wxWidgets version 2.8.12 and version 2.9.2. Compatibility with older wxWidgets versions is not guaranteed,
+ but it should work with all 2.8.x versions.</p>
+<p>General changes:<br/>
+</p>
+<ul>
+<li>added method <a class="el" href="classwx_pdf_d_c.html#a797b4548d802e23d670d6ccde1085b2f">wxPdfDC::GetPdfDocument</a> for builds based on wxWidgets 2.9.x</li>
+<li>added method <a class="el" href="classwx_pdf_document.html#a96ea3ddf8d36744be7886638082bbb66" title="Prints a string containing simple XML markup.">wxPdfDocument::WriteXml</a> for direct handling of wxXmlNode instances</li>
+<li>added support for optionally activating/deactivating message translation (<b>msg</b> tag) in XML output method</li>
+<li>added optional document id parameter for method <a class="el" href="classwx_pdf_encrypt.html#a67010bce5bcddf1c6d7a880849828d3a" title="Generate encryption key from user and owner passwords and protection key.">wxPdfEncrypt::GenerateEncryptionKey</a></li>
+</ul>
+<p>Fixed bugs:<br/>
+</p>
+<ul>
+<li>fixed a bug in method <a class="el" href="classwx_pdf_document.html#aa215c51f8f61cabb8960420a2eaddca8">wxPdfDocument::CalculatePageSize</a></li>
+<li>fixed a bug in <a class="el" href="classwx_pdf_font_data_core.html#a6b8f5a2c9e8126d5258b8cc369a33036" title="Convert character codes to glyph numbers.">wxPdfFontDataCore::ConvertCID2GID</a></li>
+<li>fixed several scaling bugs in <a class="el" href="classwx_pdf_d_c.html" title="Class representing a PDF drawing context.">wxPdfDC</a></li>
+<li>fixed several warnings in pdfkernel regarding formatted output of size_t variables</li>
+<li>fixed minor issues with Bengali font</li>
+</ul>
+<p></p>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.9.1</b> - <em>January 2011</em> </dt>
+<dd><p class="startdd"><a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> is compatible with wxWidgets version 2.8.11 and version 2.9.1. Compatibility with older wxWidgets versions is not guaranteed,
+ but it should now work with all 2.8.x versions.</p>
+<p>Added features:<br/>
+</p>
+<ul>
+<li>added support for Apple Unicode TrueType fonts</li>
+<li>added the <a class="el" href="showfont.html">ShowFont Utility</a></li>
+</ul>
+<p>General changes:<br/>
+</p>
+<ul>
+<li>optimized the processing speed of VOLT rules</li>
+<li>modified the code for wxMac support</li>
+<li>modified the sample tutorial7 to test the new wxMac font loading code</li>
+<li>added check for valid 'cmap' table in <a class="el" href="classwx_pdf_font_parser_true_type.html" title="Class representing a TrueType/OpenType font parser.">wxPdfFontParserTrueType</a></li>
+<li>added call to method wc_str for wxString parameters in calls to FromWChar</li>
+<li>implemented method RegisterSystemFonts for wxMac</li>
+<li>samples changed to set the executable path as the current working directory</li>
+</ul>
+<p>Fixed bugs:<br/>
+</p>
+<ul>
+<li>fixed a memory leak on registering a font identified by a wxFont object</li>
+<li>fixed a bug in method ShowGlyph</li>
+<li>fixed several wxMac compile time bugs (missing includes, some typos)</li>
+<li>changed the wxMac print dialog includes in the printing sample</li>
+</ul>
+<p></p>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.9.0</b> - <em>December 2010</em> </dt>
+<dd><p class="startdd"><a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> is compatible with wxWidgets version 2.8.11 and version 2.9.1. Compatibility with older wxWidgets versions is not guaranteed.
+</p>
+<p>This is the first release of <a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> containing a <b>PDF drawing context</b> (<a class="el" href="classwx_pdf_d_c.html" title="Class representing a PDF drawing
+ context.">wxPdfDC</a>). There are implementations for wxWidgets 2.8.x and 2.9.x; the matching implementation is selected automatically at compile time. Please report your experiences with <a class="el" href="classwx_pdf_d_c.html" title="Class representing
+ a PDF drawing context.">wxPdfDC</a> to the author of <a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a>, be it bug reports, contributions or feature requests.</p>
+<p><b>Note:</b> A <b>PDF graphics context</b> is planned for one of the next releases of <a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a>. Most likely only wxWidgets 2.9.x will be supported since the
+ internals of the base class wxGraphicsContext differ considerably between wxWidgets 2.8.x and 2.9.x.</p>
+<p>Added features:<br/>
+</p>
+<ul>
+<li>methods to draw Bezier splines through a list of points; the drawing sample has been extended to show the new functionality</li>
+<li>PDF drawing context (<a class="el" href="classwx_pdf_d_c.html" title="Class representing a PDF drawing context.">wxPdfDC</a>); not yet all methods are implemented</li>
+<li>support for fonts with VOLT (Visual Ordering and Layout Tables) data (currently visual ordering only, preprocessing of the fonts required); fonts for 9 Indic scripts are included to demonstrate this feature</li>
+</ul>
+<p>General changes:<br/>
+</p>
+<ul>
+<li>increased output speed for method SaveAsFile (if large graphics files are involved)</li>
+<li>all currently supported CJK font families are now registered automatically at startup of the font manager</li>
+<li>MS CJK fonts aren't automatically registered as Type0 fonts, since this conflicts with registering these fonts as TrueType Unicode fonts</li>
+<li>handling of image masks has been improved</li>
+</ul>
+<p>Fixed bugs:<br/>
+</p>
+<ul>
+<li>opening font files could fail if the file path contained non-latin characters Now wxFileSystem::FileNameToURL is used to create valid file names for use in method OpenFile of wxFileSystem</li>
+<li>invalid format codes in method <a class="el" href="classwx_pdf_utility.html#aaf326d375b589032d6cd6a7a89bc1fbb" title="Formats a floating point number with a fixed precision.">wxPdfUtility::Double2String</a> could cause problems in MinGW environment</li>
+<li>registering half-width CJK fonts didn't work</li>
+<li>bug in page size handling</li>
+<li>no file was written when Close was called before SaveAsFile</li>
+<li>bug in the handling of transparency for image masks</li>
+<li>uninitialized member variables in layer objects possibly causing invisibility of layers</li>
+<li>cleaned up output formatting codes for building on 64-bit systems</li>
+<li>compile time bugs for wxWidgets built with wxUSE_STL</li>
+<li>several minor bugs</li>
+</ul>
+<p></p>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.8.5</b> - <em>October 2009</em> </dt>
+<dd><p class="startdd"><a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> is compatible with wxWidgets version 2.8.10. Some preparations were done to make <a class="el" href="classwx_pdf_document.html"
+ title="Class representing a PDF document.">wxPdfDocument</a> compatible with version 2.9.x and above, too.</p>
+<p>Added features in <b>all</b> builds:<br/>
+</p>
+<ul>
+<li>support for individual page sizes</li>
+<li>support for setting fill rule to <em>odd/even</em> or <em>winding</em></li>
+<li>support for setting the text render mode</li>
+<li>support for layers (optional content groups)</li>
+<li>support for patterns as draw and fill colours</li>
+<li>support for Code 128 barcodes</li>
+</ul>
+<p>Added features in <b>Unicode</b> build:<br/>
+</p>
+<ul>
+<li>support for kerning</li>
+<li>support for different encodings for Type1 and TrueType fonts</li>
+<li>support for using TrueType and OpenType fonts loaded directly from .ttf or .otf file</li>
+<li>support for using Type1 fonts loaded directly from .pfb and .afm file</li>
+<li>support for using TrueType and OpenType fonts defined by a wxFont object</li>
+<li>font subsetting for OpenType Unicode fonts (experimental, currently non-CID fonts only)</li>
+<li>direct positioning and writing of glyph numbers for TrueType/OpenType Unicode fonts<br/>
+ this may be used in conjunction with tools for writing complex scripts like ICU</li>
+</ul>
+<p>Added features in <b>ANSI</b> build:<br/>
+</p>
+<ul>
+<li>support for fonts defined by a wxFont object (mapped by family, weight and style to the Adobe core fonts)</li>
+</ul>
+<p>General changes:<br/>
+</p>
+<ul>
+<li>coordinate transformation (location of origin and y axis orientation) is now done directly in PDF. This was a prerequisite to add wxGraphicsContext support in an upcoming version. User unit scaling is done programmatically.</li>
+<li>unified the naming of all methods manipulating colours. Now always the British spelling is used, i.e. <em>colour</em> instead of <em>color</em>.</li>
+</ul>
+<p>Fixed bugs:<br/>
+</p>
+<ul>
+<li>line style measurements did not use user units</li>
+<li>encryption support for big endian platforms.</li>
+<li>method <a class="el" href="classwx_pdf_document.html#a75e682eff61934c888afd051343af76b" title="Define text as clipping area.">wxPdfDocument::ClippingText</a>. </li>
+</ul>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.8.0</b> - <em>December 2006</em> </dt>
+<dd><p class="startdd">Added features:<br/>
+</p>
+<ul>
+<li>support for external templates: pages of existing PDF documents may be imported and used as templates</li>
+<li>font subsetting for TrueType and TrueType Unicode fonts, often resulting in much smaller PDF file sizes</li>
+<li>support for using and embedding OpenType Unicode fonts</li>
+<li>enhanced support for password based encryption, encryption key length freely definable between 40 and 128 bits (<b>Attention</b>: Adobe Reader supports only keys with 40 or 128 bits.)</li>
+<li>support for AES encryption (additional standard encryption method in PDF version 1.6 and above)</li>
+</ul>
+<p><a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> is compatible with wxWidgets version 2.8.0 as well as with version 2.6.x.</p>
+<p>As an add-on preprocessed font files for the free <a href="http://dejavu.sourceforge.net">DejaVu fonts</a> (version 2.12) are provided in the file release <b><a href="http://sourceforge.net/project/showfiles.php?group_id=51305&amp;package_id=45182&amp;release_id=468705">wxPdfDocument
+ Add-Ons</a></b>.</p>
+<p><b>Attention</b>: For supporting font subsetting for ordinary non-Unicode TrueType fonts the format of the font definition files has been extended. Font definition files created with prior versions of the <a class="el" href="makefont.html">MakeFont Utility
+</a> are still usable, but do not support font subsetting. It is recommended to regenerate own font definition files. Unfortunately common AFM font metric files do not contain glyph information which is required by the <a class="el" href="makefont.html">MakeFont
+ Utility</a> to create the character-to-glyph mapping. Therefore the utility <code>ttf2ufm</code> had to be changed. The modified version including a Windows executable is available in the file release <b><a href="http://sourceforge.net/project/showfiles.php?group_id=51305&amp;package_id=45182&amp;release_id=468705">wxPdfDocument
+ Add-Ons</a></b>. </p>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.7.6</b> - <em>October 2006</em> </dt>
+<dd><p class="startdd">Added features (thanks to Stuart Smith):<br/>
+</p>
+<ul>
+<li>setting/getting the default path used for loading font files</li>
+<li>getting the description of the current font</li>
+<li>loading images from a wxInputStream (in addition to loading from file or wxImage)</li>
+</ul>
+<p><b>Attention</b>: The structure of the font definition files has changed due to the addition of the font attribute <code>xHeight</code>. It is necessary to regenerate own font definition files using the <a class="el" href="makefont.html">MakeFont Utility
+</a>. To support the <code>xHeight</code> attribute the utility <code>ttf2ufm</code> had to be changed.</p>
+<p><a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> is now compatible with wxWidgets version 2.7.1 and above as well as with version 2.6.x.</p>
+<p>Fixed several bugs </p>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.7.5</b> - <em>September 2006</em> </dt>
+<dd><p class="startdd">Added or enhanced features:<br/>
+</p>
+<ul>
+<li>support for tables in simple XML markup spanning more than a page</li>
+<li>support for internal links in simple XML markup</li>
+<li>support for transparency</li>
+<li>support for image masks</li>
+<li>support for internal templates</li>
+<li>support for polygon and shape clipping</li>
+<li>support for printing text along a path</li>
+<li>extended support for fill gradients (<b>API changed!</b>)</li>
+<li>internal colour management reworked</li>
+</ul>
+<p>Fixed some minor bugs </p>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.7</b> - <em>April 2006</em> </dt>
+<dd><p class="startdd">Added features:<br/>
+</p>
+<ul>
+<li>support for CMYK and spot colours</li>
+<li>support for named colours (486 predefined names for RGB colours) (<a class="el" href="classwx_pdf_colour.html" title="Class representing wxPdfDocument colours.">wxPdfColour</a>)</li>
+<li>support for colour names in HTML notation (#rrggbb) (<a class="el" href="classwx_pdf_colour.html" title="Class representing wxPdfDocument colours.">wxPdfColour</a>)</li>
+<li>text annotations</li>
+<li>additional font decorations: overline, strikeout</li>
+<li>PDF forms</li>
+<li>JavaScript at the document level</li>
+<li>Simple XML markup language for styling and structuring text</li>
+</ul>
+<p>Added or modified methods:<br/>
+</p>
+<ul>
+<li><a class="el" href="classwx_pdf_document.html#ab088245b7bd878346ed857eaac448c0d" title="This method counts the number of lines a text would occupy in respect to a given maximal width...">wxPdfDocument::LineCount</a>, <a class="el" href="classwx_pdf_document.html#ab1c68234e49efaa3e6d170f0c3014483"
+ title="This method counts the number of lines a text will occupy in respect to a given maximal width...">wxPdfDocument::TextBox</a> and several getter methods were added for convenience</li>
+<li><a class="el" href="classwx_pdf_document.html#a19eff882e8ed85134189ffc604671da8" title="This method allows printing text with line breaks.">wxPdfDocument::MultiCell</a> now respects a maximal line count</li>
+<li><a class="el" href="classwx_pdf_document.html#a96ea3ddf8d36744be7886638082bbb66" title="Prints a string containing simple XML markup.">wxPdfDocument::WriteXml</a> allows to print text containing simple XML markup </li>
+</ul>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.6</b> - <em>November 2005</em> </dt>
+<dd><p class="startdd">Added features:</p>
+<ul>
+<li>gradients</li>
+<li>transformations</li>
+<li>barcodes<br/>
+</li>
+<li><a class="el" href="makefont.html">MakeFont Utility</a><br/>
+</li>
+</ul>
+<p>Changed API of graphics primitives: line style and fill colour parameters deleted, line style and fill colour have to be set using <a class="el" href="classwx_pdf_document.html#acde5c89b926954b0f4b346fc599c7947" title="Sets line style.">wxPdfDocument::SetLineStyle
+</a> and <a class="el" href="classwx_pdf_document.html#acea8e25d150e0ccc59954cfe6f98cdd5" title="Defines the colour used for all filling operations.">wxPdfDocument::SetFillColour</a>. </p>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.5</b> - <em>September 2005</em> </dt>
+<dd><p class="startdd">First public release </p>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.4</b> - <em>August 2005</em> </dt>
+<dd><p class="startdd">Support for embedding fonts </p>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.3</b> - <em>July 2005</em> </dt>
+<dd><p class="startdd">Support for embedding images </p>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.2</b> - <em>June 2005</em> </dt>
+<dd><p class="startdd">Several add-ons implemented </p>
+<p class="enddd"></p>
+</dd>
+<dt><b>0.1</b> - <em>May 2005</em> </dt>
+<dd>Planning and basic PDF features implemented  </dd>
+</dl>
+<dl class="author"><dt><b>Author:</b></dt><dd>Ulrich Telle (<a href="&amp;#109;&amp;#97;&amp;#105;&amp;#108;&amp;#116;&amp;#111;:&amp;#117;&amp;#108;&amp;#114;&amp;#105;&amp;#99;&amp;#104;&amp;#46;&amp;#116;&amp;#101;&amp;#108;&amp;#108;&amp;#101;&amp;#64;&amp;#103;&amp;#109;&amp;#120;&amp;#46;&amp;#100;&amp;#101;">ulrich
+ DOT telle AT gmx DOT de</a>)</dd></dl>
+<h2><a class="anchor" id="issues"></a>
+Known issues</h2>
+<p>Currently there are no known issues regarding the functionality of the <a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> component. All features were thoroughly tested individually, but it's almost
+ impossible to check all potential combinations. <b>If you find bugs please report them to the author!</b></p>
+<h2><a class="anchor" id="acknowledgement"></a>
+Acknowledgements</h2>
+<p>I'm very grateful to <b>Bruno Lowagie</b>, the main author of the <b>iText Java library</b> (<a href="http://www.lowagie.com/iText">http://www.lowagie.com/iText</a>), for allowing to take lots of ideas and inspirations from this great Java PDF library.
+ Especially the font handling and font subsetting was influenced in that way.</p>
+<p>Many thanks go to <b>Ben Moores</b> who provided code for layers and patterns he wrote for his PDF extension for <b>Mapnik</b> (<a href="http://www.mapnik.org">http://www.mapnik.org</a>). This code has been extended based on ideas from the <b>iText Java
+ library</b> and was incorporated into <a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a>.</p>
+<p>Support for Indic scripts is based on the efforts of <b>Ian Back</b>, creator of the PHP library <b>mPDF</b> (<a href="http://mpdf.bpm1.com">http://mpdf.bpm1.com</a>); special thanks to <b>K Vinod Kumar</b> of the Centre for Development of Advanced Computing,
+ Mumbai (<a href="http://www.cdacmumbai.in">http://www.cdacmumbai.in</a>), for clearing license issues of the Raghu font series.</p>
+<p>Since <a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> is based on the great <b>FPDF</b> PHP class and several of the contributions to it found on the <a href="http://www.fpdf.org"><b>FPDF website
+</b></a> I would like to thank</p>
+<ul>
+<li>Olivier Plathey (FPDF, Barcodes, Bookmarks, Rotation),</li>
+<li>Maxime Delorme (Sector)</li>
+<li>Johannes Guentert (JavaScript)</li>
+<li>Martin Hall-May (WMF images, Transparency)</li>
+<li>Emmanuel Havet (Code39 barcodes)</li>
+<li>Shailesh Humbad (POSTNET barcodes)</li>
+<li>Matthias Lau (i25 barcodes)</li>
+<li>Pierre Marletta (Diagrams)</li>
+<li>Laurent Passebecq (Labels)</li>
+<li>David Hernandez Sanz (additional graphics primitives)</li>
+<li>Valentin Schmidt (Transparency, Alpha channel)</li>
+<li>Jan Slabon (FPDI)</li>
+<li>Klemen Vodopivec (Protection)</li>
+<li>Moritz Wagner (Transformation)</li>
+<li>Andreas Wuermser (Clipping, Gradients, Transformation)</li>
+</ul>
+<p>The <a class="el" href="classwx_pdf_document.html" title="Class representing a PDF document.">wxPdfDocument</a> encryption methods use the RSA Data Security, Inc. MD5 Message Digest Algorithm (RSA Data Security license) and the Rijndael cipher implementation
+ of Szymon Stefanek (Public Domain). For detailed license information </p>
+<dl class="see"><dt><b>See also:</b></dt><dd>files pdfencrypt.cpp and <a class="el" href="pdfrijndael_8h.html" title="Interface of the Rijndael cipher.">pdfrijndael.h</a>. </dd></dl>
+</div></div>
+<hr class="footer"/><address class="footer"><small>Generated on Tue Sep 6 2011 22:09:26 for wxPdfDocument by&#160;
+ 1.7.4 </small></address>
+</body>
+</html>
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/samples/pdfdc/zebra.xpm wxPdfDoc-copy/samples/pdfdc/zebra.xpm
--- wxpdfdoc-0.9.2.1/samples/pdfdc/zebra.xpm	1970-01-01 00:00:00.000000000 +0000
+++ wxPdfDoc-copy/samples/pdfdc/zebra.xpm	2012-05-22 01:03:37.691400000 +0100
@@ -0,0 +1,409 @@
+/* XPM */
+static const char *const zebra_xpm[] = {
+/* columns rows colors chars-per-pixel */
+"200 167 236 2",
+"`  c #A68369",
+"   c #FCFEFC",
+"). c #9AA45B",
+"wX c #CBCEA4",
+"0. c #C7CB71",
+"aX c #5A7120",
+"S. c #1E180D",
+"+. c #D9CAAB",
+"f. c #96A43B",
+"L  c #51501B",
+"4. c #FAF2CF",
+"tX c #401E0C",
+"x. c #979459",
+"&X c #B5835B",
+"jX c #838D77",
+"e  c #3A3014",
+"zX c #424734",
+"z. c #DCBF7D",
+"X. c #8E8D2F",
+"o. c #939441",
+"r. c #98785B",
+"_. c #6E7828",
+"W. c #748C28",
+"E. c #D6C866",
+"Z. c #ACAE61",
+"T  c #AAB460",
+"yX c #3A3025",
+"<  c #D0BD89",
+",. c #E6CDA4",
+"/  c #A69147",
+"^  c #97823C",
+"qX c #4E4031",
+"&  c #998254",
+"-X c #7C4829",
+"P  c #C5A287",
+"kX c #54573D",
+"8X c #ACBA94",
+"%X c #A47150",
+"'. c #7F7828",
+"1. c #8C7056",
+"U  c #B9A088",
+"Q. c #8F942E",
+"B. c #C6A35F",
+" . c #6A7818",
+"X  c #ECEDE1",
+";X c #A77855",
+"3X c #6E492C",
+"$  c #95947A",
+"bX c #142108",
+"%  c #99826B",
+"vX c #1C2F0A",
+"N. c #3A4710",
+"[  c #A4B444",
+"xX c #4A6012",
+"w  c #3E3816",
+"9. c #9DAD31",
+"m  c #6E692B",
+"x  c #B5945B",
+"H  c #26310B",
+"F. c #966644",
+"3  c #D0B4A0",
+"j. c #838F48",
+"}  c #A5BB39",
+"M  c #6F5029",
+"F  c #52680E",
+"C. c #A6A544",
+";  c #CEB18C",
+"*. c #B4C748",
+"=  c #B8A175",
+"=X c #603E1F",
+"4  c #D9DBCC",
+":X c #DCA47C",
+"]. c #948C42",
+"9  c #6E6028",
+"I  c #D1BEA3",
+"s  c #918B63",
+"=. c #ACBC5E",
+"R  c #AABC49",
+"l. c #4F351F",
+"i. c #D8D06B",
+"{  c #B6BE4F",
+"v  c #5F542F",
+"|. c #F4E0C8",
+"%. c #977052",
+"A. c #939C3C",
+".. c #44401B",
+":  c #E8D8B5",
+"/. c #959C55",
+"L. c #A69C45",
+"c. c #BBC873",
+"@  c #A8AB98",
+"uX c #534F38",
+"6  c #747D67",
+"Y  c #BBBF61",
+"v. c #CEBF69",
+"5  c #BCBEAC",
+"K. c #7E7028",
+"k. c #2D1D10",
+"fX c #545F3F",
+"k  c #302712",
+"+X c #C7CA8D",
+"u  c #96773F",
+"p  c #BAAC64",
+"U. c #415010",
+"y  c #4E3F1F",
+"4X c #81512C",
+"<. c #8C785F",
+",  c #DEC1A2",
+",X c #D1D8A8",
+"J. c #44570E",
+"6X c #6E5743",
+"M. c #5F6517",
+"7X c #727148",
+"N  c #A58354",
+"lX c #2C3020",
+"#. c #C1B399",
+"R. c #9CA52B",
+"t. c #737E43",
+"+  c #C9CDC4",
+">  c #E6CFB8",
+"t  c #6F6446",
+"Y. c #59710E",
+"dX c #5C7B10",
+"W  c #A1AC43",
+"J  c #7E7058",
+"n  c #836832",
+"8  c #635F49",
+"y. c #727161",
+"z  c #1E280B",
+"2X c #DCB89A",
+"q. c #81912B",
+"u. c #BEC082",
+"@X c #806149",
+"2. c #F6DFB2",
+"}. c #D49868",
+":. c #728229",
+"-. c #738C15",
+"2  c #BFAD97",
+"d. c #8E9D27",
+"@. c #D9CB8A",
+"~  c #5F5617",
+"V. c #A1AC60",
+"5. c #E6DA83",
+"w. c #444815",
+"C  c #E8E9CD",
+"K  c #83684F",
+"oX c #82783C",
+"g. c #546113",
+"b  c #5E4931",
+"f  c #878259",
+"`. c #6E8216",
+"h  c #89826F",
+"OX c #B58D5E",
+"5X c #C6905C",
+"*X c #749314",
+"8. c #9EB331",
+"rX c #714025",
+"#X c #7E583C",
+"!. c #DCD8B1",
+"|  c #8FA426",
+";. c #60632B",
+"g  c #A99179",
+"E  c #94AB37",
+"eX c #5E402E",
+"l  c #3E2813",
+"O  c #D9CEBE",
+"iX c #413828",
+"S  c #B9C75B",
+"0  c #5F5643",
+")  c #E6CE8E",
+"D. c #B5A448",
+".X c #ECB684",
+"I. c #819C18",
+"{. c #7E9219",
+"hX c #4A563A",
+"0X c #80785B",
+"i  c #B7A15D",
+".  c #F5EFE2",
+"h. c #1F200E",
+"XX c #84A317",
+"3. c #E9DEB3",
+"1X c #9C9F8E",
+"gX c #636748",
+"<X c #68361A",
+"[. c #84833A",
+"!  c #505815",
+"G. c #2B3F0A",
+"e. c #CEB569",
+"d  c #83703C",
+"*  c #A88F62",
+"q  c #4F481E",
+"-  c #C1AC86",
+"j  c #514835",
+"o  c #E9DECC",
+"(. c #8CAB23",
+"O. c #6E702A",
+" X c #825728",
+">. c #806031",
+"m. c #808326",
+"7  c #6F6657",
+"Q  c #849D28",
+"c  c #6F572B",
+"'  c #E3E7BA",
+"^. c #94B625",
+"b. c #B9B562",
+"p. c #B7B54D",
+"V  c #F6EACE",
+"(  c #CEAC63",
+"#  c #AB9C84",
+"a. c #CDBF58",
+"$X c #8C5F3C",
+"]  c #C9CE63",
+">X c #4E2C15",
+"1  c #C2B385",
+"pX c #F0BE88",
+"B  c #C6A176",
+"$. c #958C78",
+"&. c #D5D98F",
+"r  c #5E481F",
+"sX c #434032",
+"A  c #C9D487",
+"P. c #DFB27C",
+"~. c #94B336",
+"_  c #B79275",
+"6. c #D8D770",
+"n. c #B7AC4E",
+"T. c #94AD27",
+"H. c #687017",
+"s. c #C4BE52",
+"cX c #14160B",
+"D  c #849A49",
+"9X c #805135",
+"Z  c #DAE0B2",
+"7. c #C7C85E",
+"G  c #383F10",
+"a  c #A8A059",
+/* pixels */
+"                                                                                                                                                                                                    .         .   .                                                                                                                                                                                             ",
+"                                                                                                                                                                        X X o O + @ # $ % & # * = # = - ; : > , < 1 2 < 3 O O o o o . .                                                                                                                                                                         ",
+"                                                                                                                                                            . 4 5 # 6 7 8 9 0 q w e e r t y q y r u * = i p # a s & d & & u s = f t & g g 3 : o .                                                                                                                                                               ",
+"                                                                                                                                                    + 2 h 8 j w e k e l e w e z e e e y r w w y 9 9 x = * & t t c v b n d m c & & M N * B < , , : V > : V .                                                                                                                                                     ",
+"                                                                                                                                            C Z A S D F G k k H k e k e k e H e k e H e w e e r m r n J K 9 v L y e e y c b r n * i * x = P 3 , I ; P U , , > > o o X                                                                                                                                           ",
+"                                                                                                                                      X A Y T R R R E W Q ! e e k k H k e k k e e e w k k e y ~ ^ v c v y b y y w e k e e e c / & u N x ( ) , ; # _ g g ; I < ; P ` g 3 I V                                                                                                                                     ",
+"                                                                                                                                ' Z ] S S W [ T { [ E R } |  .G k k H k H k e z e H e w e ..X.o.O.q y r r e l k e l e k l y u u ^ & N N B ; +.@.U # = g ; #.= - = $.%.` _ ; > V                                                                                                                                 ",
+"                                                                                                                          C &.] S *.S S =.=.R { R R =.[ R W E -.G H k k l H k e k e k e e w w ;.:.e e e k l k k l k k e l y >.>.d d N i - = < ,.I = P = ; - = = = <.%.1.%._ P ,.2.3.O 4 .                                                                                                                       ",
+"                                                                                                                    4.3.5.5.6.7.7.{ S R [ 8.9.{ *.{ S 0.=.T W 9.q.w.k k k k k H k k k H k H w.L :.G k k k k k k k k k k e y q r r M & = = e.> 3.: a & = = = B - = = & * r.= ; < ,.2.Z t.y.@ C                                                                                                                   ",
+"                                                                                                              . Z ' u.7.7.i.] 7.S { ] 7.{ p.W W p.{ a.6.s.7.9.d.R f.g.H k k H k e k k k h.k w.~ j.G H k h.h.k.h.k.k k w l.q y ..y r ^ - = = z.@.) = N x = a & - < - = # 1.* B ,.) : 2.u.;.;.x.T o                                                                                                               ",
+"                                                                                                          . A T W c.Y A A A i.v.Y s.7.b.i.v.i.Y p.n.n.{ p.T [ [ { Y =.m.G z k k z k z z z z e M.t.! N.h.k.e z k l ~ e M.w.L ....w.~ i z.< ; = B e.B.x i = < < 1 - - = x x.* % B , ) @.u.b.V.C.Z.1 u.o                                                                                                           ",
+"                                                                                                      X &.c.[ E W =.=.{ Y =.=.S 7.Y s.{ Y 7.] i.7.{ { s.7.Y p.R [ ] ] ] A.G z k k k z k z G ! ;.O.M.w.z S.H w k q L M.! M.w...w.~ 9 x < e.B.D.e.x a i B.p ; ( p - p 1 # g ` d F.; u.b.b.a p = B = ; < ; : .                                                                                                     ",
+"                                                                                                  . A ] c.S S R [ [ { Y 0.] S c.S =.R R { =.Y 7.i.0.] ] 0.S 0.{ { S { [ | D G z k z z z k G.G H.j.m.m.~ e e G k m.:.q. .F ! N.J.L K./ e.e.e.b.v.b.e.n.n.v.D.L./ / x @.z.1 <.d x , 1 b.p i _ i B.B.B.P.D.( < o .                                                                                                 ",
+"                                                                                              4.&.7.0.7.] 0.S { { S { =.] S =.S S S *.R R *.S S 7.7.] ] 6.] 7.6.7.7.=.I.E =.q.N.G.~ w.U.! U.U. .m.m.X.-.Y.M.m.g.q.W f.T.q.d.m.m.R.X.n.p.b.e.E.Y p.[ T p.7.b.D.n.b.s.e.E.p x B.; < 1 ; e.e.( ( ( e.( ( ( B.B.( z.:                                                                                               ",
+"                                                                                          4.V 5.: &.7.c.T { =.=.Y 7.=.=.S V.R =.[ =.=.*.S ] *.R Y Y 7.7.] 7.Y A 6.] R Q [ S =.W :.W.f.Q.f.f.m.W f.[ f.d.W A.f.C.p.W f.[ W [ W [ Z.C.s.s.b.Y 7.T R [ 7.R 7.p.n.p.a.v.E.i.v.0.e.@.v.b.v.v.v.( ( ( z.( P.( ( e.E.z.z.E.3.                                                                                          ",
+"                                                                                      . !.v.1 z.3.: &.Y =.[ T { T V.[ E V.~.[ =.R [ f.W E T.=.[ } R [ [ V.{ [ R =.c.=.8.8.8.^.R } [ =.W f.d.f.b.Y T R Y c.{ { { { R [ 9.[ [ W [ W [ Z.=.p.p.{ R 9.[ S p.Y Y Y Y 7.s.E.i.) i.0.7.Y p.p.p.{ a.E.n.a.( e.e.E.5.E.i.) e.v.@.V                                                                                       ",
+"                                                                                    V u.p p p p @.: 2.3.@.=.[ T Z.{ T W =.T Y T b./.:.m.d.A.[ W E A.[ R 9.Y W =.[ [ [ ~.E E T.(.^.^.} R [ W =.c.S S Y *.c.R { R } R [ 8.[ 9.C.[ 9.W { W C.{ { W 9.{ 7.R.[ { { { p.=.{ { 7.a.7.a.i.i.E.a.s.s.s.n.s.a.E.E.E.i.) E.E.7.E.i.i.: 4.                                                                                  ",
+"                                                                                C 0.=./.o.u.=.W p.n.e.< @.5.u.p b.@.u.[ =.W R ).W.:.M.m.V.A.W =.[ R [ [ 9.} R ~.[ ~.[ } R } } R [ R { R R R Y S R } 8.R R R S [ [ 8.[ 8.W 9.9.p.{ W p.p.Z.L.p.p.p.{ { L.C.{ C.{ { Y 7.s.Y { 7.7.7.i.E.E.e.B.a.a.a.E.v.a.s.Q.^ p.a.e.a.a.v.s.7.3.                                                                                ",
+"                                                                            . Z =.W W T | 9.[ W [ [ b.s.1 e.b.T a C.V.W T f.V.W /.f.E W { =.R R R R [ ~.} R } R } } } ~.[ [ } S *.{ E ~.8.R R =.E [ } R R *.*.R R E [ W W [ { Y S Z.R.C.p.p C.{ p.s.7.7.7.s.7.E.7.s.{ p.[ s.7.{ p.s.a.s.( L.B.i e.i.a.s.b.p.p.C.p.i L.E.s.C.7.s.# o                                                                             ",
+"                                                                          X A =.W [ [ T E E =.f.q.f.f.Z.T V./.:.t._.o.W ).q.D f.[ R S *.} R R } R } } } [ } ~.R ^.^.~.8.~.^.8.} { R W | E E ~.[ [ [ R R S Y R *.{ R p.{ Y 7.s.{ s.S p.{ p.{ 7.{ s.s.{ a.i.] a.7.7.7.S p.C.C.n.a.a.s.s.{ p.( ; e.e.n.p p s.7.s.7.a.v.i.i.i.i.v./ 9 & :                                                                           ",
+"                                                                      . #._.m.A.W A.C.f.f.q.D A.A.f.E E q.W.`.W.q.q.[ f.d.E 8.[ R R R R R } } [ R =.*.} R ^.~.} ^.} ^.} *.} ^.8.8.9.{ d.d.V.=.=.=.R *.} *.*.p.7.{ Z.[ W p.C.D.n.a.{ A.Q.A.R.{ } { { p.{ { 7.7.s.7.Y { { S p.n.e.s.9.p.p.a.a.p b.e.b.C./ L.L.p.p.p.a.E.7.a.s.u u d n u ,..                                                                       ",
+"                                                                    o $ '.].a Y Y { Y c.[ [ [ R =.R [ R R R R [ R [ [ R R R } R R } } } } 8.~.E R ~.E } ~.^.^.} *.^.} } *.*.R R *.{ 9.[ =.S R } { *.[ } 7.p.D.s.p.n.a X.d.m.^ '.^ m.[.K.m.K.Q.{.| D.a.9.C.C.p.{ s.S Y } { { { s.{ { s.7.7.7.s.{ Y Y { T b.i n.n.a.b.a.p.L.K.'.u n n >.}.) |.                                                                    ",
+"                                                                  o p s.v.7.7.7.Y Y 7.i.7.c.*.{ { 8.[ R S *.=.=.} [ R } } } ~.~.[ [ R ~.~.(.(.E E ~.(.Q (.(.~.} ^.^.*.*.*.*.*.} R S { *.[ R [ 9.} R *.s.7.{ p.D.x / u r r ~ ~ M  Xc >.c 9 ~ m.{.X.Q.D.n.C.C.{ { S Y *.} { { p.{ Y Y S 7.R Y Y Y S 7.{ p.s.e.v.b.s.n.a o.u n u / u '.>.u e..X@.                                                                  ",
+"                                                                : E.v.7.7.0.7.{ S Y s.a.S 7.W 9.f.8.*.*.S [ ~.[ } R R ~.~.} ~.} ~.E ~.~.~.(.| E | Q ~.Q (.(.XX} } ~.^.} ^.XX} } [ } R [ [ 9.| [ 9.8.} { *.*.] b.B.i B./ m.m.m.X.X.^ oXn ~ X.R.*.A./ b.Y p.C.[ 7.[ { { { { { { S s.7.{ S p.{ Y { { p.v.7.Y s.Y s.=.p.C.'.'.m.L.n.e.s.p./ B.v.B., .                                                               ",
+"                                                            V < e.e.a.7.7.E.i.s.Y { p.W D.{ f.Z.8.8.=.R R 8.8.8.8.} } ~.} ~.^.*.~.~.E ~.[ ~.=.~.~.R (.E (.~.E ~.E 9.d.8.8.8.} R } [ R [ } 9.[ R R *.*.R } } { s.7.s.b.p.p.n.W W C.n.p.n.C.} [ p.C.C.C.{ { R { [ } } { Y { { s.Y s.{ p.{ 7.{ S 7.{ { { Y Y 7.{ Z.[ [ W R.9.W [ p.n.p.[ p.n.i e.e.@.o                                                             ",
+"                                                          . < s.E.7.i.i.i.7.i.] S 7.S { p.[ R [ [ } R *.R } [ } ~.~.} ~.~.~.~.R ~.~.~.[ } R ~.} R [ E E W [ [ p.p = = p p p.} } *.Y Y [ } } } R *.R *.} { } p.R.n.p.W p.8.8.9.} } R.p.s.*.} 8.9.8.*.} *.{ { [ [ 8.[ [ W W { { { { R { { { { { { =.{ [ { R { R n.W d.d.E W R.R.W 9.W R.p.W L.D.p b.n.!.                                                          ",
+"                                                        V 0.E.0.7.s.7.] ] 7.7.7.{ { { } } 8.W | 8.E 8.7.R } ~.8.} ^.~.8.~.~.8.[ } R R ~.~.} ~.~.} R [ V.i = OXOX` * OXOXOX_ i p.p.i.7.7.R =.W | 9.9.9.9.8.{ [ X.C.[ R.| 9.} ^.} } { *.} 8.*.*.*.*.R } *.R { C.d.Q.X./ ^ ^ D.a.p.p.{ [ [ A.C.W T W p.R [ p.p.{ { { p.W f.f.9.W W p.C.Q.L.C.R.X.Q.].X.A.+X.                                                       ",
+"                                                      Z b.{ Y b.Y b.s.s.Y { { { R W 8.[ [ ~.8.R R E | ~.8.} ~.E XX} R ~.(.XX| E E E (.~.(.| [ T.} =./.r.u ` B , +.g @X#X$X$X%X&X; 5.1 Y T Z.f.R.W 9.[ d.Q.C.7.{ R [ 9.R.} } } } } 8.} 8.8.} [ R R | {.8.[ W ].'.K.M M r  X XL.D.A.Q.A.f.W [ p.p.p.[ p.8.n.=.0.Z !.c.W W [ C.9.p.p.p.R.D.n.Q. .'.H.;.M.[.s .                                                     ",
+"                                                    3.W C.A.R.C.{ s.Y n.W n.[ 9.W 9.} W 8.} ~.~.^.E E ~.8.E ~.E } Q I.Q W.{.*X*X-.*XQ (.E | [ E f.A.i < : 2.4.4.4.I 7 b =X-X$X%X;X:Xo C : +Xu.C.A.o.n.C.L./ W R.D.*.[ } } 8.8.T.} 9.d.I.T.9.W W T f.q.d.A.x.<.9 v r y >Xr =X/ D.D.Q.L.m.C.a.s.s.S { W p.@.V C : o C ,XT C.W p.p.a.p.n.Q.o.m w...w e H e H 7 o                                                   ",
+"                                                  !.{ A.A.q.Q.C.s.a.C.C.f.d.Q q.| W } 8.[ (.I.I.E T.XX(.Q XXQ I.q.XX| (.| | E ~.E [ ~.~.R ~.~.W W ) 4.4.2.2.: 4.4.3.5 g b <X-X$XF.F.P |.V V V o !.x.n K./ ].C.L.R.} } } } ^.R.| R.d.{.| R.9.C.i.4.,XZ.x.s d @X@Xr t q y 9 =X>.L.v.p.=.C.s.Y s.{ W p.s.a % g g 1X# I 4.&.7.a.p.p.a.C.m.9 g.w.G w H e m L w.k y.o                                                 ",
+"                                                u.q.d.d.d.A.Q.C.C.C.o.Q.q.{.m.| d.| W 8.R E (.XXXX| E E (.} ~.~.Q f.E } R =.*.*.=.~.[ R } } R { 5.2.@.B 2X2X,.z.> |.2.o @ @X3X-X4X$XF.5Xo o O O o V o +XD.p.n.p.{ 8.p.{ } } } 8.[ T.XXT.T.[ v.  . X = f 7 v 0 @X0 t 6X0 K 6X>XM L.{ =.{ { s.a.s.n.e.7Xw k.k.l.0 y.1.I : v.i.E.5.o.;.L L G w q ..L '.o.[.o.G M.D C                                               ",
+"                                            . 8Xd.{.q.Q.Q.| d.R.W d.d.d.Q.q.E [ 8.9.8.| ~.I.| Q E Q (.~.~.E ^.} [ } } } R [ [ [ R R ~.} ~.8.7.< ; P OX= B - P 3 ; +.V C V !.g #X-X9XF.F._ |.. > > o |.C 3.@.s.p.p.n.[ { Y S R R 8.T.8.^.8.R p !.O % 0Xt b qXb 0 @X8 t 0 t f e >Xn W C.p.p.b.s.v.E.a e k.k.k k k.k.k =Xx z.E.E.E.m.~ ~ M.q ~ L ~ M.C.p.C.C.C.f.d.T X                                             ",
+"                                            ,XQ.W A.d.f.Q d.f.{.| `.X.-.d.f.R ~.~.E E XXf.d.`.-.| Q {.f.f.E 9.8.~.8.R } 8.8.E } R *.~.[ 9.0.; * & r.g _ _ B _ P > I ; > . . . wXr.#X$X$X%X&X> . : O > o X C 5 [.oX/ A.C.} } R 8.R ^.8.} 8.T & ` K @X3X8 qXl 0 b t 6XJ 7 8 % e e =XQ.p.[ D.p.v.v.b.t k k.>XeX3Xl.k.S.k.M a.a.E.E.p.Q.D.L.Q.X.L.p./ p.a.( C.{ { R.[ c..                                           ",
+"                                          ,XY E E f.| Q.d.{.{.{.{.{.`.{.f.Q Q Q.A.C.[ | R.C.W d.d.m.`.W.E 9.R { W W [ [ 8.} T.~.~.~.8.{ < - J @XK r.%.;XP % ; I g P o : 3 > 4.. o # @X$XF.%.&X2X. X o o o V . wX^ ^ Q.[ R } R } } R 8.E f.A.r >XrX9X#XM j k l.0 6X0 6 t 6Xh 6Xr >X^ p.s.s.p.7.a.f >XtX=X9X#X$X#XyXS.k.rXn.p.p.E.p.s.s.a.a.s.7.p.D.L.L.s.a.n.{ 9.{ 8.Y .                                         ",
+"                                        Z ~.(.E f.XXQ *Xq.Q q.| 8.[ E E E | *XO.'./ C.f.9.T.9.f.f.| W 9.8.*.9.| L.].].m.`.{.W.`. .R.a B.U h 6Xt @X@X<.` r.; g ` +.O 2 3 : o I +.. . O %.@X$XF.;XP > o o |.X |.. C u.b.[ 8.[ R [ E W | Q Q.f l.tX<XrX4X$X6XqXk t 0 uX0X8 8 0XK uXtX>.n.E.7.s.a.p.r e eX$X9X$XF.$Xl.k.k.M n.p.s.s.( E.s.( p.p.s.p.n.n.D.D.p.s.s.p.} W 9.A                                         ",
+"                                      4 ~.E | f.(.Q {.{.| E E ~.[ [ W f.E [ q.Y.m.A.[ 9.8.9.[ } W R p.*.8.R.I.{.X.X.K.;.M.M.J.w.'.V.* * s 6X6Xt K %.r.%.; r.` +.U g 3 o I 3 > |.+.o . O r.F.F.F.%X_ > X > > o . . V ,XA.A.X.[.m.m.A.C.A.o.[.l tX<X<X-X4X$X@XyXt 0 uX7 8 8 0XK b k. Xe.a.7.s.7./.b K N ` $XF.F.F.M k.l n s.a.E.a.( e.v.v.a.s.a.a.s.s.p.D.p.p.s.p.n.[ p.p.&.                                      ",
+"                                    C XXQ q.Q | XXXX-.{.8.R [ R [ =.[ W [ [ V.| E [ =.R R R } [ [ =.[ 8.9.p.C.R.R.L.m.X.~ L w.'.X.o.<.& <.7 0 6X1.1.@X_ @X;XO g r.+.+.g 2 o O 3 > C O o o # K F.F.%X;X3 . . . .     V 1 ].[.~ 9 [.oX]./ & @X>XtX>X<XrX-X4X%X$XM t 0 b 8 7 0X8 iXk.rX= n.D.p.s.[.%.; pX, , P x %X Xl =XD.a.s.a.D./ }.B.( e.E.5.i.E.a.i.p.p.p.n.s.p.p.{ p.p.@.                                    ",
+"                                  X [ {.*X-.*XI.*X*X-.Q.W [ E 8.=.R [ ~.[ E ^.E 9.~.=.~.E E E ~.[ { S 8.[ [ n.m.n L.X.L.:.m.-.R.A.m t r.J 0 b 6X6X6X` @Xr.I 1.r.O # r.3 O U 3 o I P I |.o O 2 ` F.F.F.%XP , |.o |.o . V +.Z.o.].N ^ / a & @Xe >XtXtX>X<X-X5X2.1 0Xy.j 0 7 7 eXk.S.>XK u %./ Z./ P _ _ ; 4.    : d M.D.s.s.a.n.].N / B.n.n.n.E.E.i.] E.E.s.a.a.a.E.p.s.p.p.7.3.                                  ",
+"                                  ).-.-.I.*X-.`.`.-.I.{.W.:.A.W [ V.E E T.(.| (.XXf.f.f.Q XXQ 9.[ [ [ R *.S } { W p.n.{ =.[ 8.} D v j 7 0 0 j qX3X@X6X6X2 @XK , % 1.; #.` 2 O # g , o 2 P |.. I % %.F.F.%X_ , X |.. V V V !.b.p ( p a a x.<.y l k.>XrX>.` 2X4.V g @Xj qXl.qXyXk.S.k.<XF.OXB.x * ,.P $X;X|.    wXT W 7.7.*.a.{ R.'.A.p.p.p.E.s.*.s.s.a.E.s.p.a.7.{ [ { p.p.7.7.X                                 ",
+"                                8XF `.W.{.*XF Y.F g.[.aXF :.q.Q W.q.Q Q {.d.E E f.~.V.~.E | [ [ ~.*.R *.*.R R } } ^.} R [ R } [ O.uX0 b 0 sXj qXqX7 l.` 6X3X2 <.M U 2 @XU I <.;X> I g _ , |.O I o 2 r.F.F.%X&X_ O . . . . . V ,XY Y Y p <.K 6XyXy d s $.$ U +.> u %.6XqXqXb l.S.S.S.>X$XOXB , ; _ ` OX&X,   ' =.} R p.{ { { 8.{ p.9.n.} { { s.R C.p.s.E.7.p.p.p.[ p.W p.n.[ W S                                 ",
+"                              5 ! M. .{.-. .dXU.N.G H L q.E q.W. .q.{.:.`.q.Q f.~.~.R =.} E [ [ E R =.} R } E E 8.} 8.8.d.f.=.D fXuX0 uXsXqXsXqX8 yX@X8 l.U 7 eX_ # 3X` I @XK , U 1._ > I g P |.o 3 U g ;X1.%X&XP 3 > |.. X o V > u.b.a t b c 0 y v J s $.$.= ` F.5Xr.0 0 j qXk.S.S.>XF.2.,.4.I r.$XP ` 2X3.u.W [ n.{ 9.} 8.n.7.8.8.9.9.R R s.{ 7.s.s.b.a.s.{ p.p.[ R.p.8.p.C.p.A                               ",
+"                            o gX~ A.Q.A.Q.q. .G G G w.O.Q W.`.Y.N.J.! J.H.d.[ E ~.[ } *.[ R R c.[ R *.R R ~.| E f.} *.[ | [ +XD hX0 j 0 uXj qXqX0 yX7 yX1.7 l.%.# eX$X2 6X3X3 # @X` > g % ; O 2 U : o P U _ ` ;X&X_ P > > V o o 3.3.I $ 6XqXiXb uXqXv J f <.K @X` r.eX7 uXj j k.S.tX>X%X> : > C +.- ,.|.+.b.[ 9.9.R.{ 8.{ 7.R ] S 8.p.{ { 8.{ { s.p.p.n.p.n.p.p.a.a.s.*.{ { p.p.[ !.                            ",
+"                            jX..H.Q.^ x a A._.m w.~ m.q.`.`.H.J.H w.! N.:.E [ ~.R } R R *.=.9.S R [ Y } } [ E E E } c.=.dXD ).7X8 y 8 j qXqXuXj j 6XiXb J l.%.3 j eXP 7 rX_ 2 3X;X+.% K 3 I ` g > I 3 : O _ _ g ` &X_ P 3 > |.|.o > #.0XqXl yXl.j b v 0 0X9 6Xt K 1.0XJ uX6Xj iXk.tXtX-X; V |., > o 4.  Z =.[ p.[ { S Y 7.7.R 7.{ R { } s.{ p.8.s.p.p.p.R s.a.a.a.E.a.p.s.7.7.s.p.a..                           ",
+"                          ,X'.K.X.X.m.Z.i Y C.X.X.o.C._.`.m.oXO.M.'.q.W.8.~.E (.[ } } ~.*.R [ *.[ [ } ~.~.E XXE Q R ~.W.f.V.E ;.w.8 yXuXuXsXqX8 sX6XiXJ iXF.2 7 eXP $.<Xg I 6X` , <.%., #.1._ > g _ > I I o 2 U _ _ P _ P P 3 3 3 # J qXiXiXiXiX7 j 8 v 7XJ 0Xf h $.h y.7 uXiXk.k.tX>X-X2X: o o +.:   C b.=.R.n.W L.W C.9.s.{ { a.7.p.s.C.a.[ p.{ p.} p.p.E.E.s.p.a.a.s.C.X.9.a.s.s.i.                          ",
+"                        . b.Z.p.R W [ Y } =.W T o.L.L./ / C.L./ q.f.W d.| E R ~.~.~.~.E 8.~.(.[ E ~.R [ E Q *X*Xq.~.[ E Q Q D fX8 sXt 0 qXj sX7 qXuX8 qXqX_ 7 eX_ # eX%.I <.%., % %.O U @X; I % _ I _ 3 O 3 > I % # , P U 3 3 3 I g J 0 qXj b j j j uXqX0 9 0Xf $.$ h y.8 sXyXS.k.>X>XrX; I O : C |.V c.T T R.C.o.X.d.Q.D.C.L.L./ L.C.[ p.7.7.s.s.p.p.} n.p.p.a.6.6.a.B.D.D.p.p.a.p.p.,X                        ",
+"                        ,X[ R { R } R } } E [ 9.R.f.C.].L.L.C.T R R } ~.} 8.R ~.~.[ [ ~.8.~.(.| E =.=.~.E f.E E f.R [ E Q Q f.;.q 8 j qXj uXqX0 8 yX7 yX@X0 k.l.#.b eXU <.K 2X% % +.% 1.3 #.r.P 3 ` 3 U _ +.O U 3 o 2 U , 2 ; P g <.0 qX0 qXuXsXj j j iXuXj t f h $.h y.j uXyXl l >XeX$X_ 3 O #.I 3.+X=.=.{ [ { p.d.n.9.D.Q.K.~ K.'.L.W { s.0.s.p.n.R.n.D.D.p.a.i.E.E.a.n.a.E.s.s.p.9.W X                       ",
+"                      C } 8.8.} } E (.~.} ~.8.R R R } } 8.W 8.R } ~.~.} ~.[ 7.[ } R ~.} 8.[ 8.[ E Q E ~.D {.E [ E [ (.E ~.[ ~.fXt iXw 0 qX0 qXb 7 qXj yXh k S.l.<.k eX$.3XP g 1., g K , U %.I #.* 3 % _ !.` ` +.O ` P I 2 ; _ % 1.0 uXuXj 0 sXb qXj uXl 0 qXq J s s y.uX8 iXiXyXyXl.F.` 3 I +.4 2 ,XT W R.[ [ [ { p.s.*.{ { C.].'.^ X.L.9.} p.7.e.b.C.n./ ^ D.a.i.E.a.E.a.n.p.s.s.s.W W A                       ",
+"                    . c.E (.^.E ~.~.~.(.~.^.~.~.~.^.~.~.(.~.~.E XX(.T.E d.p.Y R ~.~.~.~.8.~.E E E | E E (.8.8.W Q E XX(.Q Q q.fXw t 7 qXj 0 j sX0 b yX6Xh S.S.b uXk.6Xb K g #X3 g @X2X# r.+.# U 2 1.; I %.P o # r.I U ; U U ` <.6X0 qX0 iXuXiXkXyXj uXk.0 w qX9 % $ kX0 j qXqXl.l.$X` OXP I : O o wXW R.W W W [ s.s.8.} 8.8.{ p.W L./ Q.p.[ { { T W p.a.v.z.) e.a.p.a.a.a.E.a.a.7.i.s.E.7.V                     ",
+"                    ,XT.XX| q.(.R } ~.8.E 8.(.I.Q Q [ (.(.(.Q (.| Q f.E | W.d.E E W | T.E 8.E T.9.9.9.T.| | Q Q Q [ f.Q *X-.Q g.8 j lXj uX0 j sXkXb yXb y.S.S.#XzXk.7 yX% b g # #XP U 1.I _ 2 U %.I 2 1.; +.% N I g ; g _ ` <.0 uXj b iX0 iX0 sXyXqXuXh.b ..iX8 0X6 8 uXj qXj yXl.;X2 ` I g 2X+.o +X[ [ R { [ p.Y R } 8.T.8.8.{ 7.s.0.s.{ p.p.[ p.[ { v.v.) E.a.a.E.a.E.i.E.i.7.7.s.7.] { 0.                    ",
+"                    =.E E E ~.[ ~.(.| 8.~.| | T.E Q Q XXXXQ XX(.(.Q Q | E E Q q.Q d.| E | | | | | {.XXm.d.q.Q I.Q D q.q.I.W.| gXw q 7 t 0 uXzXqXj qXyXqX0XS.S.@XsXk.7 qX0 eXU 6X;XI 6X; g ; # 1.> # K 2XwXK N +.% ; % U r.% b uX7 yX8 yX0 qX0 yXk iXiXiXw qXj 0 y.7 0 j sXj sXqXj %.3 U P # 2 I > wX[ [ p.{ [ R } 8.^.I.9.T.8.8.T f.[ { p.{ { { p.{ Y { s.a.p.( ( P.e.n.E.a.E.7.s.p.*.{ { { '                   ",
+"                  A } 8.E E E E XXI.E | Q | Q f.Q ~.XXE E ~.(.Q E E E D | f.:.{.f.E q.q.f.Q d.| {.`.`.M. .{.Q q.Q {.Q f.f.E E xXt 0 iXj 0 0 qXqXuXiXsXyX0XcXk.@XyXk 8 uXyXK uX3XU 6X_ ` # ` %.> # F.I #.#XU I 1.; 1._ J <.j 7 j 0 qXqXqXuXqX0 yXyXl k.j l iXuXb 0 7 j sXsXuXkXqX6X6X_ 2 % U * I +.+.=.[ [ R 8.8.^.[ R 7.} *.R R 8.W 9.R Y T p.7.7.7.7.s.s.n.n.n.a.( s.n.p.s.{ s.7.7.7.*.{ { 0.                  ",
+"                X [ ~.^.E XX*XXX(.E f.q.q.W.`.q.Q XXXXI.XXQ XXI.Q Q {.{.q.q.q.f.W | {.-.Q.Q.9.T.XXm.M.M.W.W.*X{.Q d.f.E ~.(.(.gXsXw e e 0 uXsXj 0 k 8 k.h S.S.y.lXk.0 qXqX7 k.J 6X9Xg ;X% #X< g @X< U 6X= I K P <.r.r.1.6X6XqX7 yX7 lX7 qXqXj iXiXk k j e qXqXuX0 fXiXqX0 j j K 8 @X` U U g _ 2 5 +.Z W [ } ~.} 8.} 8.R R R R R [ R Y R { =.{ 7.Y p.p.{ s.{ { s.s.p.p.} 8.{ } S *.*.} { } { } Z                 ",
+"                A Q I.XXE *X*XXXI.f.).A.A.`.`.H.-.{.Q *XQ -.-.*X`.-.*X`._.q.| 9.E Q XX*Xm.d.9.| R.{ R.q.Q {.-.{.[ E E E E (.E J.fX7X0X8 qX0 qX0 j yX8 k J h.k.<.h.l 0 k.6XiXyXJ l.J @X` qX_ ` M P U b ;XI 6X` g 6X$.b % iX7 iX0 qXj qXuXj j j sXsXk.yXiXyXsX..0 8 j sXqXy.iX0 6X%.K % <.% U U - ; I V =.[ } ~.[ } E [ R } [ 8.R R p.{ T p.[ s.b.Z.W Z.Z.s.{ { { *.[ { } } [ 8.p.s.[ 8.9.{ [ p.S                 ",
+"              X E *X*XXXQ I.| Q q.W R.9.9.q.q.*X{.Q Q -.`.`.dXdX{. .A.q.q.f.Q | (.(.XX| | d.| T.9.[ R d.W E E ~.E (.(.I.E E | j.uXe k.0 j qXuXuXiX0 b iXJ k k.h lXk 8 k y.k.7 sXl.0 @XqX3X% qX$X2 eX6XP 0 6X# l.<.qX% qX0 qX6XqX8 k 6XiXqX0 j yXqXk.j iXw sXiXj uXsXj qX0 b qX@XK @X7 3X6X%.P #.U +.V T E E 8.8.[ ~.8.[ 8.~.W [ [ [ R [ p.W T Y n.n.n.p.{ } p.[ [ [ } [ } } R 8.8.9.p.8.9.n.[ } Z               ",
+"              u.W.I.Q Q Q Q Q I.d.| XXXXXXQ q.*XW.`.-.-.`.dX .:.Y.H.m.R.f.| | (.~.(.E T.A.{.d.| 9.8.{ R ~.E ~.~.~.E ~.(.~.} ~.t.N.sXw k 6XlXb uXiX8 yXk J lXk.% S.yX8 qXj k h k 0 qX7 yXJ qXeX$.0 yXr.7 >X% 0 J 0 b 6XqX7 yX7 iXuXiXuXuXyX0 0 S.j S.0 iXiXqXiXuXj sXsXj sXuXb K eXr.@X@X6X1.K ` - 2 o c.W E ~.(.E | (.T.E f.T.f.E W W C.[ n.p.p.Y s.p.W W C.} } 9.9.p.[ p.[ 9.[ 8.{ } 8.R.} { { Y               ",
+"            . D q.XXE | Q Q {.I.(.I.XX(.| XX(.I.dXY. .F `.`.q.`.W.f.E f.E | (.(.| | d.| Q.X.{.| 8.~.[ ~.E XXXXE (.(.Q (.| =.E D 7XJ J uXw 8 >X0 uXqXsXS.7 yXk.h S.qX0 qXyXl.y.iXb 7 sXb y.k.6X<.k eX<.yX@X7 eX% qX7 k 7 sX0 sX8 yX0 yX0 k 0 8 S.j S.6XiXiXiXiXj sXj qXsXuXl.g b K K J @XM r.` b _ U : wX~.T.| | I.I.(.E 9.8.9.E f.| | 8.C.[ s.W 9.n.C.[ W 9.p.s.{ [ R.d.^ b.p C.C.p.n.p.R.R p.} } '             ",
+"            Z D Q | (.~.f.[ Q {.(.(.^.T.^.~.~.XX(.I.`.dX-.{.9.E f.f.{.I.-.{.Q XX(.I.`.`.m. .m.d.| Q XXXXQ I.| Q *X*X(.~.E ~.D D G.k.e 6Xy j uXk 7 k 7 S.b zXk 6 cXeXuXb yX0 7 k j y.k.y.sXyXh sXk.K zXyX% l.J qX0 j qX7 yX7 yX7 k 8 iXj iXqX7 S.j cXuXiXl.yXsXuXj sXzXuXyXr.<.@X@XJ @XK 6XK >.g r.U !.wX| E Q E -.XX| | | 8.[ [ | Q d.T.T.9.p.| Q.Q.L.R.C.R.9.R.n.} R.d.| A.z.< i e.C.W C.{ [ 9.8.]             ",
+"            ).Q XXXX{.8.~.E Q I.XXXXXX^.(.I.I.^.~.(.(.8.T.(.d.9.f.XXdX`.dXdX`.-.T.(.9.9.9.p.f.`.*X*X*XI.*XI.Q XXI.(.D ~.R D E D O.uXk k b j 8 sXl.uX8 iXyXj yX7 S.6XsXuXyX8 sXk.K iXl.y.k.6Xy.k.qX0 k @Xj b y.k 7 yXJ yXb j 7 iXuXiX0 yX0 sX8 S.qXcXb yXzXiXiX0 kX7 yXk k 6X0 @XK 1.<.K @X;X% >._ % . Z D I.I.*XdX-.{.I.f.9.W W {.XXI.| T.9.8.R.X.X.'./ C.C.C.9.d.R.R.{.Q.q.'.1 ,.z.) p D.{ [ 8.9.R C           ",
+"          C | 9.8.R ~.(.^.(.| *XI.I.XX(.(.I.I.8.~.} E E E E E E Q Q -.I.`.`.*X{.| E E E f.W A.-.Q *X*X*X-.*XI.(.~.*XQ ~.E (.(.*XhXt 8 w k y e t iX6XqXuXS.0 iX8 S.7 yX6XyX8 yXsXy.h.7 j k.h j k.7 yXiXy.k 7 j b 0 yXy.k 7 yXJ k 7 yX8 h.6Xj 0 S.j cXqXyXj j ..uX0 y.7 lXj yX6X@XJ % J 6X1.r.# # ` g % Z.f.I.T.~.E | | | q.d.A.f.| | d.XXT.T.T.9.C.Q./ X.X.R.R.R.Q.R.Q.`.`.X.X.f.@.: ,.) b.n.p.8.9.9.&.          ",
+"          +X(.E } ~.~.XXXX(.(.I.XXXXI.XXXXI.T.~.~.[ ~.E E ~.(.~.~.(.(.(.I.{.| f.9.E ~.E E | Q *X*XI.XXXX*XXXXX(.(.Q E E Q I.-.`.L l y 7Xt sXh.l.7 qXiX7 S.0 qX0 k.J k 6XlX6Xk 0 0 k.<.yXl.h k yX7 k.6XuXl.y.k J yX6X8 qX0 b j yX0 qXsXk.7 0 uXS.j cXsXiXuX0 sXuXj y.kXqX8 sXb K 1.$.K qX@X` - U # t & /.XX(.9.R R =.R Y [ 9.{ [ [ R | R.} 9.R.9.[ C.X.L.Q.R.L.d.R.R.| Q.^  .Q.A.p.b.@.@.e.[ L.R.R.9.{ .         ",
+"        X =.E E D | Q *X*XI.(.(.(.^.XXXXI.Q E E ~.} ~.~.[ =.| (.~.XXXX(.~.E ~.E [ ~.Q ^.T.~.=.T Q XX~.(.*XXXXX(.(.(.*X*XQ *X*X`._.L h.k.iXt t yXy 7Xk.0 sX0 j j k 7 k.y.lX0 k K sXyX7 S.7 kXk.6XsXyXy.yX6Xj sX8 k J yX0 qXy.S.0 sX8 h.yX7 8 qXcXqXS.qXiXuX8 zX0 kXj yX0 0 8 yX6X6X% J qXb U ` O +.f +.f.{.| 8.=.8.[ [ 8.R [ [ 9.R [ 8.9.R 8.I.Q.R.p.a.[ 9.[ C.d.X.R.p.Q.W.H.d.| W [ W f.| C.R.R.9.C.R.&.        ",
+"        ,XW.aXdX:.W.:.W.Q XX~.~.XX(.(.A.A.L.E E f.~.E E q.~.Q {.I.XXI.(.^.~.| XXE [ XX*XXXQ E W.Q *XI.*XdX*X*XI.(.(.XXXX*X-.*Xq.gX9 fXiXk.k.j 7 yX0 0 k 8 qXuXj yX7 S.J k 0 k 7 k 6Xj k.h yXyXJ h.j 7 k.y.yX0 iXqX7 k 8 uXj k.7 yX8 k.b kX7 yXS.qXcXiXsX0 0 ..8 uXj e qX6Xj qX7 6Xg J qXl.* # I : - o D -.`.I.f.d.d.| I.T.~.8.[ [ 9.| 9.} 8.R.9.W [ p.{ R p.9.C.Q.m.Q.{ p.R.9.T.T.T.| | 9.f.R.9.9.9.| Y         ",
+"        @ J.N.J.xXM.W.-.Q | [ 8.(.(.| m.o.[.A.Q W.`.dX-.`.| Q I.XXd.| XXI.q.I.Q -.q.E Q I.E E W.Y. .dXq.:.dX*X-.W.*XXX*X:.:.q.j.t.w iXv 8 ..k.iXj S.7 iX8 qXuXsXyX8 S.7 k.8 k 7 k J lXl.y.S.6X7 S.J qXiX7 k 7 h.7 j qXj 7 h.qX7 yXfXk.7 qXy.k cXqXS.l j 0 0 j uX0 kXj w 0 0 j 7 eX_ 0Xb b $.1 I 3.4.C D q.W.C.f.W f.| XX| | 9.~.} W C.9.[ [ } } { } { { { *.} { } A.L.n.Z.9.8.T.T.T.T.| | | d.d.9.9.| [ .       ",
+"      X t.H H G U.M.`.I.:.m.-.o.Q 9.f.q.A.D W.q.`.*XQ {.-.q.[ Q {.Q.dX-.dX`.W.*XdX-.-.f.f.).o.].^ & [.& O.X.W.dXdXdXdXY.U.F M._.f gXe k.l.t 7XuXiXS.>X7 iX0 j j >X8 k.7 k 7 k 0 k J S.0 8 k.h sXk.h yX7 sXqX0 k 7 yX0 sX8 S.J j j sXyXy.yXy.k cXj S.k.b 0 8 b iXv 7X0 <.J 0 8 0 b g g 7 6X% I I V o +.T [ s.C.W f.d.| d.I.| 8.} 8.} p.} } p.} 8.} *.} } } R { *.{ p.C.W p.R.| T.T.| } 8.W [ 9.| T.9.9.W Z       ",
+"      O ;.H e w ! M.`.j.q.H.;.M.o.=.A.q.:.:.:.W.Q Q | (.Q q.C.Y :.:.`.q.| W.dXXXQ *XQ d.x.m 9 M >.n  XF.%.& d :.H.aXF J.F G.v s f gXt w.k k.b t J 8 z y 0 uXuXj iX0 k.8 yX0 yXj yX8 S.J sXyX<.lXl.6 yXJ S.7 iXyXK yX0 8 sXyXh yX0 yXiXh k 7 h.cXb S.k.uX0 8 qXj j zXb ;.J 7 8 j b 1.g <.@Xg I > V g !.).9.[ R.f.Q `.I.*X{.| | R.R.} 8.R.} 8.8.9.8.8.8.p.8.9.} } } } [ { =.[ [ 8.8.[ [ 8.8.9.E ~.T.9.[ W +X      ",
+"      1 x.K.n ~ H.'._._.Y.U.e r o.V._.m.:.| A.d.W.Q {.{.m.d.W W j.q.W.`.*X*X*X^.E ~.f.Q [.g._.;.v M & >.M v r O.D `.F N.J.N.7Xh 6 kXiX0 uXw S.h.l t t yXy 0 uXj iXkXk.0 iXuXiXj iXuXk.<.lXeXy.S.0 7 yXy.k.J yXqX8 sXqXJ k 7 kXk.y.h.qXy.S.7 k.cX0 S.S.j 8 0 sX8 ..0 8 8 0 7 8 0 0 7 % ` $.U 3 > V wX4 A.| T.| XX(.| I.(.q.d.{.{.m.Q.R.9.9.9.9.9.} 9.8.9.9.9.R.8.8.8.9.[ [ } 8.7.S R R E E E 9.| d.9.=.Y Y       ",
+"      s OX/ N ^ L.o.[.M.G k k y ~ C.q.[.q.f.f.D m.M._.m.Q.W [ f.f.W.dXY.-.Q | XX*X[ =.E {.q.m.[.].N x b e l e k H.-.-.W.F  .f h gXj e k.y 0 b e S.S.qX7 w qXkXzXiX0 k j l.j qXsXqXsXiXy.S.6X8 S.7 j qX8 yXy.h.0 uXkXqX7 yX<.sXyXJ k.j y.k.6XS.cXb S.S.qX0 b j 0 j 7X7 0 8 7 7 0 0 6X` _ P 3 +.,.V . !.f.9.| I.(.XXI.I.Q W.F  . . . .m.m.X.Q.R.R.8.R [ } 8.R.R.XXR.T.XXQ.C.9.9.R { R 9.8.8.8.~.T.8.[ | W [ C     ",
+"      ( K.n K.^ / OXo.M.w.L e ~ / C.A.{.W.m.o.m H.m.{.{.{.`.| [ E Q *XdX-.Q *X`.dXf.V.E f.| Q Q.'.~ >.%.n [.;.L m.q.Q | q.o.jXy.hXiX0 G k.k.qXv j k h.>Xt e r j qX0 k uXqXj j iXuXyXb 8 S.J zXk.h iX0 uXl.7 h.6Xj b uXsXj uX8 iXh k qX7 S.7 S.cX8 S.h.j 7 iX7 l.8 8 j 0 8 7 8 8 0 6Xg _ I , ,.+.3.. 5 f.T.~.I.I.^.I.| f.{.`.`.-.M.H.m.{.C.f.{.9.R.8.9.8.R.| XXXX| I.d.{.| d.R.9.9.9.| E E 8.T.9.T.8.8.[ } ,X    ",
+"    V = L.).Q.L.L.C.o.A. .w.r u ^ p.[ E q.m.].m 9 C.W | R.d.q.d.D Q D Q Q W.dXdXm.j.:.W.*X:.W E D ! 3Xn / a ~ m '.Q.A.D /.$ f fXyXyXiXv q k k.k.y b w h.e 6Xy q sXv k j y j j iXuXyX0 sXS.h yXk.h k 6XsXqX8 S.8 uXj 7 yX7 qXkXyXJ k qX8 k 8 cXS.8 cXk.j 7 yXy.h.t 0 sX8 0 7 8 8 0 @X_ 2 > > > +.+.O 1 D | T.(.XX(.(.^.9.| d.q.d.m.Q.Q.d.C.f.R.9.8.8.9.| XXXX| | XX{.d.{.R.{.| | T.9.9.| 9.[ W (.f.| E 8.8.c.    ",
+"    Z W T p.T Z.b.).X.o.L.L.'.m.L.=.W Q.L.].^ N & u ].D.Q.A.Q.Q d.-.q.W.W.W.:.q.q.:.F g.dX .f.W q.M.K.u n c c n a m.q.W /.jX6 sXlXyX....r v y k S.l b uXk.e y y iXj e j e uXj e 0 S.7 yXk.h k k h h.7 lXb kXS.6X0 iX7 k 7 8 qXiX7 yXj 0 k 0 S.k.8 cXS.uX8 k 7 yXw t 8 uX7 8 7 8 uX@XU ; +.V 3.O O # +Xq.Q | 8.T.^.T.(.8.} R { { Y s.[ W f.[ 9.W W 9.T.{.*XXX| XXd.{.Q.| { { W T.| | 9.8.W E 8.~.8.E | Q | =..   ",
+"    p C.C.9.C.8.W [ R.p.p.{ [ p.8.[ } W m.u >.^ r =X-X$Xn D.T.| d.9.{ f.f.f.=.D Q W A.W E W.o.W d.X.9 y y l rXn a o.A./.x.6 fXlXh.lX~ :.w k l.r y h.k.e 9 yXk.q y j iXuXl uXy yX0 h.t lXk h h.yX0Xk.y.lXb 0 S.b kXk.J qX0 7 0 qX6XsXqX0 qXkXcXk.7 cXS.0 8 yXqX8 h.b 8 t 0 7 0 0 0 7 3 , > V 4.!.4 - +Xf.T.| ^.8.T.8.^.} *.{ { 9.} 8.9.[ | W W R.9.{.d.-.{.*X| R.{. .{.R.C.9.I.| I.I.8.} 8.E (.T.8.R f.d.{.E X   ",
+"  . f K.m.{.d.W [ W p.n.b.7.{ [ { [ [ A.^ c >.X.L l e M >.Q.8.| W W =.V.=.T =.f.[ *.R S R [ | d.A.^ / oXoX9 '.i b.A.A./.6 7XsXh.h.w m.D M.w.k k.l =Xw k l v ..e r ..q uXe uXiXw 0 k 8 k yX0XS.l.7 k.7 h.qXkXS.qX8 k.0XqX0 8 qXqX0 j qXkXj uXcXk 7 cXS.uX0 sXh.J sXz 0 y 8 gX7 uX7 6XP > |.4.. o O I =.[ T.(.T.9.8.8.9.T.} { p.T.T.^.(.T.| T.9.E 9.| {.I.XXI.(.T.L.A.A.W W W 9.f.q.d.d.| d.XXT.(.(.9.d.q.m.q.,X  ",
+"  X t ~ '.`.X.R.n.C.Z.a p.{ W C.p.9.A.K.3Xr rXoX>.L ~ K.X.d.| Q.| R 9.E [ [ { [ =.=.[ R { E | d.o./ ^ / OX^ b.b.Z.Z.f.j.f hXvXh.h.L C.| _.q L y e h.l y e e q ..q w.uXy ..j iXiX0 k.7 k yX7 h.uX0 k.7Xh.qXt cXl.7Xk y.qX8 qX8 kXqXuXqX0 qXuXcXyXy.cXcX0 qX8 S.y 7Xk v iX..uX7 8 6X7 3 > 4.    4.O 1 =.R (.8.T.8.~.9.T.T.R.p.} 9.(.T.T.^.T.~.| T.T.8.| R.9.T.T.8.R.C.} 8.8.8.9.d.d.{.{.`.I.I.| (.(.^.T.d.Q.m.<   ",
+"  C ].H.{.Q.L.n.Z.p.[ { { R 8.C.{ a o.g.l.>.n K.'.X.R.f.| E 8.| d.| E ~.W f.[ [ [ R { W R p.8.9.Q.R.Q.L.C.L.V.C.f.Z.).j.7XlXk z e m.| | q.g.l e y =Xw k.h.l y r q ~ v ..uXiXw uXj e t yXe 7 S.t sXiXt h.l.7XS.e y.k t qX7 7 sX8 k 0 qX0 sX0 cXtX6 S.S.0 yX0XlXS.t gXw j 0Xj 0 7 7 <.3 : 4.      o +X| 9.T.T.T.8.T.^.T.| 9.{ R.I.(.^.^.T.| 8.T.9.E W E W f.| [ [ 8.R.9.I.d.d.{.| W 9.R.{.{.q.d.| (.8.| XXR.X.u.  ",
+"  o [ [ 9.W | [ 9.9.W [ [ } [ 9.C.f.L.m.m M.^ A.W W E d.d.| XX| (.9.E | {.[ W W [ R W { A.X.L.p.W f.].^ L.n.[ C.f.f./.t.zXlXz k ! q.d.f.[ Q L ..l k l r w y y w w L O.q v w j 0 y iX0 w k 7 k.t k 0 7XS.l.7Xh.l 0Xw 8 j 8 kXyX8 l 8 j uXiX8 cXk.h h.S.0 iX0 8 S.l f kXw 7 h v 7 y.% , |.V       4.+Xo.| d.| I.(.XXXXI.XXR.9.E d.XX8.(.T.^.T.^.T.T.| Q E f.f.R E E (.E | 8.8.| T.9.[ 9.T.XX(.XXXXXX^.(.9.| d.b.  ",
+"  Z } W 9.9.[ 8.f.[ 8.[ R 8.E T.(.| | d.R.W W T [ [ 8.R f.Q Q 9.8.[ R E A.[ [ R b.=.f.W [ A.T T [ W A.d.W T R [ f.j.x.aXG e e L X.A.d.W W E g.e y y k l M L ......~ [.m.v ..0 b iXuXy j k.J h.t k b t S.w 0Xe h.t iXqXv t uX7 0 yX7 b uXyX8 S.S.h yXcXk 8 yXf k S.y f 8 uXs 7 7 6 r.2X2.: 4.    X u.[.A.d.X.{.d.{.{.Q.d.W W | {.XX8.T.XX(.(.I.T.^.(.(.(.[ 9.| I.(.XX(.(.E 8.(.| 8.T.I.d.| T.XX(.(.(.(.^.8.8.c.  ",
+"  &.[ [ W f.R.f.[ R [ [ [ E | (.~.^.(.E 8.S S *.R R R } f.[ 8.| (.8.R R =.=.=.b.[ =.T R.9.[ R 9.9.R W W W =.8.E | f.j.! U.G ! m.A.| 9.8.} R :.L e tXy y k l.q y w.Q.C.x.;.uX8 q j 0 e 0 h.K lX0 e q t S.>X0XsXS.c kXk t 0 j 0 j iX8 b 0 iX7 cXS.% hXcXcX0 yX0 8 S.S.r f oXuXf 7Xh r.3 |.|.4.  V !.Z.A.C.A.A.C.X.Q.L.d.R.W | d.{.I.| XX| T.T.T.9.8.^.^.^.(.~.XXXXT.| | (.| | I.{.T.9.-.dX{.T.9.(.XXXX(.^.} [ S X ",
+"  c.[ W | I.| [ C.{ R Q (.| ~.E T.8.[ 8.} R *.=.*.R { =.8.[ E T.| 9.9.} Y R T S =.=.Y [ E [ E f.E f.~.~.[ ~.| | | f.:.g.;.U.m.f.C.{ R [ W E W.e ..y e e r r ..y m.[ ).j.t 9 ;.j v uXw 8 e b j w uXe 7 h.k 0XkXS.y 0Xk.9 uXt uXj j 0 j 8 yXy.S.cXy.y.cXcXl t iX6 ..S.S.y d t 8 h h K U |.|.2.|.o - C.f.n.R.R.8.R.d.R.d.d.| XXT.8.| T.8.T.T.9.*.} {.-.T.XX(.XXT.T.| I.| (.XXXXI.XX| I.(.| XXd.T.9.T.XXXXT.^.9.=.X ",
+"  c.T.9.| | d.R.9.R.f.Q.W 9.R } 9.9.R E 9.8.} 8.R } R } R R } } 8.9.[ =.{ W W R { { S [ [ [ W E E E E R [ ~.D ~.V.Q aXM.U. .| W T { [ E E q.D ..h.k y y w e w w.R.8.W ;.b 9 ;.v ;.y 0 j hXw 8 e t k 9 iXS.>.7Xz >Xf zXb t kX0 j j 0 sX7 k.7 S.S.6Xh sXcXcXk l b 0X..cXS.k d 7X7 0XqX%.> |.pX,.o +Xf.W f.| | | R.9.9.R.d.I.{.d.8.8.} } 9.{ R.R.n.T.d.| | T.T.^.| T.T.T.9.{.| {.d.I.d.I.d.R.9.| [ [ T.XXXXXX8.[ C ",
+"  c.| 8.9.8.T.d.XXd.m.C.S =.S T E I.q.{.f.E f.[ } 8.} } } } ~.} 8.} { Y c.A.| 9.R.T R [ R [ R =.[ [ 8.~.[ [ [ T E m.H.g.H.A.| f.W [ =.V.E [ :.8 v e k.l y q w ~ R.f.q.w v l.t d v v t ..7Xe 7 w t e qX7Xh.y 0XiXk J gX..d hXuXuXuX8 yXJ k y.h.S.yXh 7 cXcXcXcXS.j 0XhXh.S.k j qXK l.9X:X, .XpX4.!.T 9.9.T.| d.| T.R.9.9.9.d.I.d.E W W 9.).Q.R.d.R.Q.R.R.| 8.8.(.T.8.9.9. .m.d.W d.I.| T.9.R [ R T.T.XXI.I.| 8.' ",
+"  c.| 9.R.9.d.X.H.~ L.R [ Y =.E W d.| Q.A.-.-.{.T.[ ^.| 8.^.8.8.~.} } 9.[ | Q d.A.C.[ W [ T.8.[ ~.=.[ ~.[ ~.E [ f.t.M.H.R.W C.W Y [ V.| } R D G b v kXq y y w.M.| q._.d q uXe v m 7Xv v v v v 0 v gXe f ..e oXgXk J 0X..0X7X0 0 0 0 yXJ yXh lXcXS.J jXzXcXcXcXcXcXk t 9 w S.uX7Xy.l.<X%.P }..X4.o T W T.d.I.| | | T.T.E T.T.9.d.d.[ f.W f.A.Q.`.X.Q.{.X.{.d.R.9.T.| | f.Q.Q.W.C.[ W Q.| Q.d.d.R.R.9.8.8.9.f.| Z ",
+"  Y R.W Q.R.L.L.n.p.f.W W E W 9.W W R { W R.R.R.9.9.| 8.8.~.8.~.8.W [ [ W E T W T [ [ [ 9.E E T [ [ E f.A.E W R D  .:.q.W [ W R R Y =.R =.[ ).! k k e y y w L X.T f.w.b uXy v w w 7Xm m t t.v 7Xj 0X..d 7 qXm 0Xw t s v J hXqX0 0 0 iX7 iXy.sXS.S.j % jXuXS.cXcXcXS.S.b m ..q h y.>Xl.9XF.}..XV +Xp f.d.9.R.9.W f.f.9.} E 9.[ 8.E [ E W W W [ A.9.9.d.R.Q.Q.d.| d.| | d.A.Q.Q | E f.| q. .f.A.d.| 8.8.R } E [ Z ",
+"  =.[ E R.L.C.p.{ V.Q.d.[ W [ f.W 8.} } [ R W C.C.R.9.[ E ~.E E W ~.W [ [ ).A.f.d.W 9.[ E ~.W [ f.E D Q Q ~.| f.:.`.{.9.~.8.E R [ { c.[ [ R ~.fXv w k k w q ~ A.[ o.gXy r q y 7Xt m m d d oX7Xt t 0Xt 0 t.b 0Xf 7Xv s 7X0X7 8 j 8 b uX0 uX0 7 S.cXk.J h $.gXiXS.S.cXS.S.w c v 7 J l.>X<X9X&X:X2.+.Y { W 9.9.f.[ W W [ [ [ T.8.^.T.T.| | A.W W f.W 8.9.W W W A.R.f.9.| f.| E Q I.9.f.A.[ f.o.f.f.E [ [ 8.[ =.[ Z ",
+"  *.9.8.} { p.C.V.d.q.Q.W [ [ [ W E 8.8.9.A.d.d.f.{ R } 9.[ E | E [ f.f.V.W A.).| f.E E E 8.~.E [ E [ [ W =.f.q.{.Q | 8.E 9.~.R *.[ W R ~.[ V.kXe r v ;.;.q v C.T ;.L v uXy 0 w ..iXw v m oXoXoXoX7Xf ;.& t oXf h m h h f 0 qXj 0 j 7 qX8 qXy.sXcXS.l h $.s jX7XuXG k h.S.h.e 7Xy.>X>Xl.<XF.5X2.3.Y R | W [ | A.f.[ W f.T.| XXI.I.XX~.W E 9.d.T.| 8.8.9.{ [ W W 9.| | E [ W [ E T.} [ [ q.m.W D | W [ W W T.~.&.",
+"  =.9.8.[ [ { Y =.T E 9.8.8.9.E Q | 9.[ f.W [ | f.{ =.[ W T E 9.Q f.f.f.| A.f.I.I.| E [ R } (.(.^.[ [ ~.[ A ~.| Q | E Q ~.E | T.[ ~.} [ E =.j.~ q w w w q v m f.[.j v q q uXw w j v q q m.o.[.[.oXoXoX0XoX0Xf f s f s f f 8 7 v j 0 0 qXy.0 0 7 h.S.S.qXh f h f f t.t.'.m ;.m 0X0 k l.>XrXF.F..X2.E.R 9.d.R.p.9.C.f.W Q Q Q I.`.`.{.8.9.E E f.W E T.(.XX8.| 8.W [ d.f.E E E E f.E | E Q.W ).Q.A.f.q.f.q.{.I.I.A ",
+". { C.} [ S S Y Y R { { ~.T.[ [ 8.E 8.[ R { R W f.W =.[ =.{ 9.9.9.W Y [ [ 9.| | | [ ~.8.R } (.(.^.E 8.~.E ~.E ~.E 8.8.R 8.[ E 8.E [ W *.[ =.aX..y q v 0 L w m ).m r iXb j qX;.7XgXkX~ `.Q f.q.j.[.[.oXoXd d oXf & s s f f 8 uX0 v fXb uX7 j 7 j yXcXS.S.eXf s f j.f f oXK.O.7Xy.qXl e <X<X;X%X;X:X,.s.} C.R.f.f.W Q.f.f.d.W T.I.q.d.9.T.8.T.f.E E ^.| T.T.| [ 9.9.| | I.W E E W f.Q.d.A.W p.A.W q.f.| | q.Q I.,X",
+"  0.p.p.C.[ { =.W [ [ R =.8.R [ 8.[ 8.| 9.[ T [ W W R [ R 8.8.8.8.[ R [ 8.E [ 8.8.9.T.~.~.~.XXXX(.8.} 8.| ^.8.} 8.E 8.=.=.R E { } f.(.W | 8._.uXy v L uX;.v  .| ;.iXy qXw w k e e w ~ f.} Q I.-.q.O.oXoXoXoXO.d f f s f f 7XhXuXv b 8 0 0 j 6Xy.lXcXS.S.S.y J s s f [.[.t.d 7Xb yXl l.=X=X%X}.N N s u.C.R.A.Z.C.].j.m.Q.A.{.d.9.8.8.8.8.[ } } } E T.8.^.^.XX} T.T.d.Q.{.d.| 9.W [ =.f.A.[ b.C.Z.R.9.=.=.9.| Q wX",
+"  u.[ f.d.C.[ W W T { W n.R n.C.d.[ R.Q.R R [ [ 9.[ 8.} T.| 9.8.8.} R ~.[ 8.8.} T.I.XX8.} I.*XI.T.| Q T.| I.8.E [ } R 8.~.8.8.E f.Q d.| *Xf.U...w w q j G q g.A._.b b v 0 7 7X7Xm q [.f.d.9.9.f.f.M.j.q.j.oXK.O.K.oXoX[.t.kXt 8 v kX8 uXb t iXJ gXlXS.S.S.k.k v 7X7XgXuXv t uXiXk l l.r rXM u K N 1 Z.R.9.A.R.X. .'.M.9 m.Q.C.[ R.T.8.8.*.8.} } 8.8.XXXXXXI.T.T.R.} } [ d.{.9.9.f.[ R W W u.c.[ Q W [ R 9.8.} ' ",
+"  Y [ f.A.9.f.[ 9.W Y Y W R.R.f.L.R.C.| [ [ { 8.9.T.8.^.8.8.T.} } 8.8.R [ ~.| XXQ {.d.T.} T.d.T.9.{.{.R.R [ [ 8.[ [ [ E E E E f.D -.q.f.f.Q aXw.e y q q q y r d.j.w.uXj iXe yXqXqXr a q.m.A.C.W W A.9.W W ).V.o.X.[.[.m.m.;.uXuX8 v uXv 8 v kXy 0X7XlXS.S.S.S.k.e ;.gXw.e e w y k k.y r ~ r r r _ @.=.p.R R.[ C.A.^ '.H. .C.T A.-.| R.| | 8.*.8.8.8.T.I.I.I.I.R.9.8.[ { [ R.| | I.9.9.R } { Y Y R 8.8.[ R f.[ ' ",
+"  +X[ [ [ 8.| T.T.^.[ 8.8.d.R.9.8.n.9.n.C.R.} | {.XXT.8.T.T.8.R R } =.R } R 8.^.{.| T.9.*.8.8.R.C.p.W W { { } [ E [ ).E d.| E W E E D ).).E D v w w b L v L ..'.o.L j b 7X7 kXv L u s.W C.X.R.C.W R.8.| 9.C.S Z.W A.d.f.[ D w.8 qX9 v c uXv 8 j c 6 6 w h.S.S.h.k 6Xf f 7X8 w zXk e w y ~ L q =X- +X7.S Y R { [ C.A.'._.Q.m.[._. .A.9.d.R.| R.R.T.T.^.(.I.XXI.| | [ 9.9.R.XX| XXI.XX9.8.9.} *.{ [ 8.8.R R 8.W C ",
+"  A p.[ f.9.XX| T.} 8.} [ { 9.[ n.d.^ / ^ Q.I.d.{.| 9.9.8.9.} } [ T.E [ 8.(.(.} ^.T.d.I.Q.Q.Q.m.'.x 7.T S T E E | | E | Q Q E 8.[ E W E ~.[ D aXl y q qXy y w K.O.v v w z e e e =XN Y S T { f.Q d.Q 8.} p.[ p.C.A.R.f.f.[ E j uX7 uXv kX;.b L t iXc f f gXN.k h.k k ;.f 0X....gXw.iXw y L uXq r @.v.{ { =.[ } R [ W | R./.:.W.A.A.f.f.{.I.-.*XI.R.XXI.T.9.8.| 9.} 9.R.| d.| T.{.{.I.| } *.8.} } } { } 8.8.9.R X ",
+"  &.W p.n.9.XXT.8.} { { R { { p.R.X.X.u ~ ~ '. .Q.R.Z.c.=.9.| 9.d.W R.| 9.XXXXT.8.| *X .`.A.Q.o.o.A.Z.p.T W E T.E E Q Q I.E E E E f.[ 8.E R | _.q w b y w y y ].].! b t t fXy l.v p V.R.[ 9.[ | A.R.[ [ 9.R p.n.p.p.[ W Q A.;.8 L 8 uX;.j v b ;.8 e v f f f t.L lXk k q uXe 7X0Xv L w w q y w.& @.u.=.{ 8.9.[ R | | 9.=.f.).b.].p.=.=.f.XX| {.{.{.d.| {.d.{.9.XX8.8.9.^.T.8.8.9.| XXI.XX8.8.R.8.} T.} } 8.8.c.  ",
+"  Z C.p.Z.R.9.9.8.} p.*.p.D.B.B.e.a.L./ m ..! X.| T T f.T E :.m.q.d.W.-.d.| Q.| {.d.-.F  .o.o.Q.X.W [ 8.} [ 9.| I.| ).*X| E W [ E E f.[ R.A.8.:.e w y y q y ~ / / 0XL iXw iXq q F.C.W | | R.R.C.Z.W C.C.9.p.[ p.W { [ [ | f._.hX8 q v uXv v q b t.;.lXy d f f f t.8 G k e ;.7X8 ..L L G G w q p v.R Z.[ f.T.9.9.| 9.[ [ R S T [ V.=.{ Y A.Q Q.E -.R.T.Q.| | I.| XXXXT.(.XX8.8.E 8.9.| | | T.8.9.9.[ 8.8.8.9.S   ",
+"  C C.A.9.R.p.8.9.8.L.D.B.B.[.n 5X) 3.a O.`._.q.Y =.[ T [ f.{.-.A.A.-.H. .X.X.d.A.W `.`.Q.q.m X.W { [ [ } T.T.| ^.8.8.| [ W Q {.d.R.d.W | f.f._.e q v L ..y O.C.x oXb 7X7X;.y l.d b.[ A.f.f.R.f.Q.C.C.{ [ [ [ [ 9.W } 9.T.~.Q ~ L 0 J t.w.r ;.v w J _.e y d s f h f t.;.;.~ q L 7X;.;._.! g.m.[ W A.| R.W } E [ 8.R R [ } R R R R R [ [ W =.f.T T T T 8.[ R 9.| XXI.I.T.T.9.f.9.[ 9.8.9.[ [ R R 8.9.8.8.8.E c.  ",
+"  . p.C.n.{ p.*.8.9.d.C.C./.m.K.x E.( e.j.X.A.R.C.T T [.W Q | [ W V.q.W.d.q.m._.X.D :.`.A.o.[.H./ W {.Q.A.{.d.XX{.Q.I.`.R.d.Q {.-.q.'.Q.X.d.W j.y y iXw y y ^ [.1.oX8 j j y y M ^ Z.E E XXd.W f.E W W T W [ R 8.(.| | | T.XX| m.fX;.iXy J fXv ;.O.v 7X[.gX;.;.t m t m 9 ~ ~ ;.'.[.0X* a f.8.| 8.S S { { =.[ E E 8.} R *.{ } } 8.R R [ 9.E W [ [ W T { R p.C.b.[ W 9.Q I.{.f.=.=.W | 8.f.R 8.=.=.W 8.} T.8.8.A   ",
+"  . V.W W { } 9.9.} 9.8.C.W R.C.C.C.Y n.Z.A.o.).A././.q.q.Q d.E 8.[ W | f.f.f.T ).A.f.f.W j.).m.A.f.A.d.C.XXd.T.d.Q.Q.Q.C.V.R.A.q.q.~ 9 `.Q.[ H.q q v y y ..X.;.n m.m uXv j w c N f.[ | | E | E f.R [ E 9.E T.| ~.| I.| T.T.| f.~ 8 h gXw t 7X;.O.oX;.oX[.f ;.y ..w.9 H.'._.'.7Xv ..c a W T.T.8.} R [ W W } W R *.} ^.} 8.T.8.8.Y { [ R.9.} [ Y { [ Z.b.W Q.[ p.[ [ V.d.R.W W E | | T.T.[ [ [ [ [ =.E | [ 9.Z   ",
+"    0.{ [ p.8.9.d.Q.R.R.9.{ R.W { A.n.{ { b.p.b.W j.H.X.o.Q.f.9.[ [ [ 8.Y *.T { [ | E [ T R [ E 8.9.W 8.[ [ | 9.{ [ [ 7.n.e.T W W W :.H.q.X.D _.O.q e y y r Q.Q.X.X.H.v L q y M x f.f.[ W W [ ~.8.8.8.E T.T.E I.| (.XX| | Q d.(.W.w l.y.0XiXr 7XoX'.t.[.f [.m._.H.m H.'.m.O.m m 7Xf a b.8.9.| T.8.{ { R f.E A.f.W | ^.} ^.^.T.| 9.9.Y s.R [ W { [ W C.n.{ 7.Y R 8.{ W 9.9.| Q q.| ~.f.(.~.E [ =.E [ [ 8.9.9.C   ",
+"    +XR.d.-.Q.9.9.d.d.R.D.Z.q.C.p.{ p.Y { 7.=.C./.X._.m.C.A.W p.[ [ 8.[ [ R V.f.d.E W 8.[ 9.=.8.T.E | | | 9.| [ { R R [ W Z.C.C.C.V.V.f.V.V.A.`.D v v y e O.Q.Q.d.{.H.uXw w b %.i [ C.o.m o.f.| W =.R E E I.| XXXXE | T.XX| XXT.W.7XgXyXqX7X7XuX! 7X'.[.m.W.Q _.O.O.K._.d m ;.uXuX..6XC.].{.m.Q.| | 9.W W f.f.).Q.d.{.T.^.^.| A.f.C.R.n.{ 7.p.C.9.9.R p.{ W 8.8.W [ f.(.| | Q `.F D | T.E E f.E E | 8.} R S .   ",
+"    Z -.M.m.'.m.C.X.C.m.Q.o.o.Q.C.L.( D.n.b.0.p.n.p /.A.L.p [ W W Q d.C.p.W W Q.f.f.f.| f.q.8.8.9.9.Q A.[ 9.[ { 8.{ *.} { R Z.R Z.p.[ C.8.f.Q {.Q ;.q w >X'.Q.| | Q j.t v v b  X* o.m.K.'.[.A.q.C.W f.(.Q (.Q (.XXE Q E XX(.(.(.*XsXv y.7X0 j t 7XoXt.[.m.| | Q.O.m m oXd m t 7XoX7Xa o.[.Q.-.d.R.W [ R [ f.f.f.A.Q {.| 9.9.C.C.D.T R.A.C.Z.Q.9.q.d.9.{ Y p.{ =.9.R | | 9.f.q.`.m.W A.q.f.R R 8.E (.(.^.} *.    ",
+"    X  .'.'.'.^ ]./ C.p.).Q.C.o.p ^ ]./ p p.0.Y Y Y u.wXb.D.[ 9.W A.A.W W p.T W =.9.8.d.| Q.R.9.C.Q.{ R { p.} } p.} 9.{ s.W W 9.9.[ W 9.9.Q I.d.f.O.uXe e m.Q Q q.f.V.gXj w l.$Xx [.H.9 K.oX].m.f.E Q Q I.I.XXE Q E Q q.q.W E | Q ;.uXe iXsXyXe ..;.t.q.| T.| D oXm m 7XoX7X8 q iXd Z.C.Q.Z.A.q.Q.C.f.9.W Q d.A.A.W.d.D.e.L.p.n.L.Z.d.C.C.f.W 9.f.9.[ [ 9.W W [ 8.[ R [ R [ W | A.V.o.q.m.I.8.~.(.(.XXXX(.A     ",
+"      W.M.~ u ^ L.C.C.V.A.C.o.o.Q.o.^ L.C.{ Y =.R 8.C.A.a C.n.R [ [ [ W W =.8.~.9.9.9.W [ [ W d.n.C.Q.m.m.{.R.} 9.R.XXQ.d.W [ 9.9.E 9.R.[ d.d.W T t.G e e '.R.=.R W E t.m 0 w  XOX[.X.].m.^ '.d.d.| f.W.I.(.XXI.| E [ q.d.[ I.I.Q U.y 8 t J 0Xf f 7Xd o.| XX[ /.oX7XO.oXt L j q q /.f.[ T A.R.{ [ W W Y [ W W E E -.].L.D.n.[ p.Q.Q.8.9.} } R [ } 8.} } R } 8.8.8.W R R ~.} [ E T [ V.d.d.| T.(.| {.| {.I.Z     ",
+"      Z.^ m.^ L.^ n.f.d.X.o.A.W Q.C.D.W R [ 8.p.[ W W V.o.L.a b.b.).A.| C.[ (.| | | 9.d.[ d.C.W 9.A.X.H.m. .X.R.W q.m.d.C.[ [ f.W [ | E f.W W W =.aXv w e O.9.[ [ E 8.s v v b 3Xu Z.d.Q.q.Q.j.m.Q D f.| XX(.XXXXXX| [ [ E {.(.XXI.;.kX..e k e G uX7X[.E T.9.9.Q.t.t oX7Xt 8 v 0 m W 9.T.8.~.[ R [ =.R [ ~.[ | f.9.d.[.L.f.C.[ R [ | 9.R 8.8.9.8.T.T.^.^.^.T.(.T.| 8.8.9.E | 8.[ { [ { ).f.| T.8.E m.q.W.`.X     ",
+"      !./.Q.Q.Q.].C.9.9.9.W T C.oXL.Z.W =.q.j.Q.^ ].n.b.( 5.< Y e.Y C.A.d.d.C.8.T.| E f.d.d.9.[ 9.W Z.Z.A.C.R.f.Z.A.Q.A.f.f.d.q.{.E `.| 8.[ T =.E :.sXe l.9 R.T.T.E ~.o.t y w l F.Z.| 8.f.).[ f.Q | E f.XX(.^.^.(.^.8.[ ~.I.XX*X`.F G y j q t 7Xt gXD | T.| (.| 0Xm 0X0X7Xv q q [.f.| (.(.XX| T.W [ 9.8.} [ 9.[ } } W [ E | | 9.T.| | f.Q I.T.I.{.-.XXXXI.T.(.| 9.| [ d.E q.I.8.[ 9.8.T.} [ =.c.f.A.A.b.Y       ",
+"      X f.| | d.Q.d.W 8.8.[ Y T [.o.C.q.m.M.x.;.>.;XB.B.x - L.C.9.9.[ T f.A.Q.9.9.E | `.-.Q.| 9.| W R.[ W [ f.f.W d.| q.Q.m.o.Q Q A.W.| ).W W d.W.:.L y l ~ d.9.| d.XX*X..j j l.&Xp | 8.9.8.[ [ [ W R R 9.8.8.(.T.8.XXf.E | {.{.H.O.uXq w k e ..gXoXq.Q (.T.| d.7Xd f t.t y 0 t o.I.*XI.d.| I.C.8.8.R } T.T.E 8.8.[ [ f.| ~.8.T.8.(.f.d.`.`.8.*X`.-.I.-.*XXXT.XX| R.| q.f.q.Q d.9.8.[ 8.W [ 0.Z.Y b.Z.b.wX      ",
+"        R E 9.W 8.| 8.T.9.[ Z.A.).A.A.j.m.m /.o.N N / u / p o.A.R.C.W [ [ f.R T W [ T [ (.T.| T.8.8.| W R W W W 8.| | :.H.:.A.d.E E E E [ W f.E I.:...k e r m.Q.Q.d.Q A.t.v y y 3Xp Q (.(.T.E E T p.B.p.W 9.[ Q `.{.:.Q :.f.Q.d.X.m.q w w q j j sXgXf.E | W E Q m gX0Xt uX8 uXO.V.E | {.9.W W W R } [ E | | XXT.| T.| d.9.| | E ^.E f.=.C.o.X.-.{.{.`.*XI.{.| | I.R.A.R.W f.W =.[ [ E [ R 9.W } { [ T [ X       ",
+"        A | E f.| {.| } } R 8.R =.[ f.V.=.A.C.L.N L.[.A.[ R [ p.W [ Q.W W d.f.9.f.E E E E 8.[ I.8.=.E E =.=.9.} 8.E E f.Q Q Q | Q ~.(.| 8.E E f.d.W.q y w M ^ [.X.o.Q.f.O.uXy l $X; E XX| E | f.f.L.].].f.W E | Q aX:.*X-.m.R.L.[.Q.H.j q j q 0 7X;.A.8.E E Q q.v J t.v 8 w j ].W [ [ | W W W W [ W [ E E E (.T.T.d.| | | d.| W R W W T j.q.o. . .F Y. .`.-.-.T.d.W C.C.C.D.p.T f.| ~.8.} 8.f.9.E [ R [         ",
+"        C [ [ d.T A.d.C.[ f.9.} [ [ f.9.s.Y R p.Z.n.[ [ s.{ [ f.[ W f.q.| W V.W A.f.V.W {.9.XX*Xd.[ [ [ Y =.[ [ 8.~.~.E Q 8.f.E E Q XX*X{.| A.W q.:...e e rXC.C.L.o.o.o.[.uXq e l.N Z.[ E [ Y =.f.W f.m.Q.9.f.f.f.q.-.q.Q | f.q.H.m.t.q q G e e kX0XA.f.[ E W.d.gXd t t qX8 9 [.W E A.I.E | | 9.E E 8.8.~.~.~.^.(.| I.(.9.E Q | E 8.9.9.d.f.:.m.:.H._.H.m.Q.`.{.m.Q.A.'.N ].o.W R T.~.} ^.} T.d.q.8.T.+X        ",
+"          T D V.o.D )./.s ^ C.p.{ [ W R.7.R 8.[ [ W C.Z.Y =.f.A.f.q.f.Q E f.f.E E f.E f.q.q.A.Q f.~.[ W [ R ~.E (.I.T.~.~.| E Q D Q dX{.d.{.o.f.o.W q w w c D.Z.T f.d.Q j.9 v e =XOXY [ c.W =.V.E { R [ 9.{ W f.d.:.q.Q.f.f.E | d.Q A.! y j uXb uXL D } E E D q.oXgXt uXuXb d T Q [ Q {.d.I.| 9.[ } } 8.T.T.T.^.(.XXXXXXT.^.(.(.XX{.| (.| 9.T D f.m.M.m. .H.{.{.X.L.].'.m.X.W R T.XX(.(.| T.} T.9.R.f.'         ",
+"          I ].b.f.T _.t.[.q >.'.Q.R.A.A.W W 8.[ R T R b.=.a W W D W.q.d.T.T.T.T.T.E W f.q.A.E q.q.W./.f.f.E [ | ~.(.T.| } ~.E (.(.D dX`.-.m.[.b.T D q w l. Xp W T.8.| *XQ w.qXe l.u < E E 8.E [ [ =.[ [ W f.E E f.Q E f.E XXQ | XXT.| m uXkXL uX8 t o.9.9.E f.o.gX0Xj 0 v j * p.d.=.E {.{.*XXX9.{ [ W 9.| d.XXXXT.(.E XX| (.XX(.XXI.I.I.| | =.C.T ).f.D f.Q.d.R.D.C.C.{ W 8.T.9.I.I.XXXXXXXXT.XX| [ b..         ",
+"          o / = b.).D O.:.'.L.o.'.R.X.d.W W ).f.Y Z.C.[ { S c.R 9.E d.| d.T.| | ~.[ R E Q D f.f.o.o.W.f.=.E ~.} ^.R R R =.[ E (.E (.q.Q A.f.q.V.[ D w e y c p Q | XXE *Xo.;.b y y $X< (.(.(.8.~.E [ f.8.[ W [ T f.| I.Q I.{.{.XX| T.Q :...qXw e w fX[.9.d.C.f.x.7Xv j 0 b y * V.f.} | XXI.{.d.R.A.^ A.Q.X.Q.{.I.I.| E (.~.(.~.E ~.(.XXE 9.W C.f.[ T b.Z.W W d.9.R.C.L.f.d.`.{.XXI.*XI.XX*XXX| d.| [ ,X          ",
+"            u.C./.o.D q.C.).W D.C.A.X.Q.W W /.A.C.W W A.R.W R [ R 9.W d.{.| XXd.Q c.=.R *.R =.=.=.[ R [ [ E T.^.~.} ~.~.~.[ E E ~.~.~.E f.[ f.W [ /...e l.4Xe.f.f.q.`.A.W v b w l.$X@.[ E (.8.} [ E I.8.[ W [ [ f.Q I.I.Q *Xf.Q | | | q.;.uXq v t 0 d C.A.L./.K.d ..8 y uX=X* a -.| | XX9.R.R.9.Q.X.X.Q.d.q.XXXXXXXX*XXXXX(.8.E ~.E | E E V.W [ C.W /.C.f.Q.`.A.f.W f.:.g.Y.:._.dXY.-.*X-.| d.o.o.C..           ",
+"            4 d.A.9.W E | f.W p.@.u.V.f.f.o.o.1 /./.A.f.R C.[ [ } { [ f.f.| T.E f.E [ *.S R =.E W } [ [ | ~.(.(.XXT.(.T.8.} [ } R } [ [ ~.[ =.[ =.t.j y e 3XI T E E A.Q m.L y y =XF.2Xu.| d.| [ E f.:.A.q.f.W j.A.f.f.E E | f.Q XX{.-.`.v j q iXe y t L.b.n./ oXm 8 j q j v g b.q.I.{.XXR.T.R.9.R.d.W Q.| I.{.I.T.(.(.I.{.I.q.W =.E f.[ [ | R.W 9.R.C.A.d.| Q.C.W V.f.D `.g.g.N.M.`.F Y. .o._.m.o.u.            ",
+"              c.=.[ [ R [ 9.[ W A S [ 9.9.[ { /.m.W.m.Y T C.[ { } S S E E E | 8.[ [ R c.R [ W [ E E (.XX(.| (.XX*XI.I.I.Q./ L.C.8.~.8.8.8.R ~.} } aXw qXqX=X5X- f.W W =.j.kXy y =XF.B b.Q.9.Q.C.)._.[.^ O._.[.:.f.f.E E Q D Q Q q.{.-.`.;.uXw j v j t L.a L.x.[.v t ..qXy c * @ q.d.`.-.{.9.d.R.W f.A.| Q Q `.I.XXXX| | d.f.j.Q.d.f.E E (.| | | T.[ E 9.Q.{.d.C.n.C.W W A.:. .F U.! ! H. .m.t._.o.4             ",
+"              3.T *.8.[ [ 8.d.R./ W 9.W d.d.f.f.T /.q.W D q.f.R f.R [ Q | } ~.E } R } R R =.E f.(.8.~.~.~.I.E [ I.{.m.K.N N N x.o.| E (.8.} (.} ~.U.e e e l.& a =.[ W Y ).v iXqXl.>.* U a Y m.m.q.]./ & ].]./.o.Z.f.q.Q Q Q *X*XQ Q `.M.O.y j w iXb v ].x.Z.Z.j.;.qXuXq j eXN p ).A.| | d.f.W T f.W E f.f.q.| `.-.{.{.| A.d.W W d.XX| | T.^.[ | d.[ f.R.R.Q.A.X.X./ b.[ V.V.f._.H.M.o.f.).W ).o.Z.              ",
+"                Y [ [ 9.8.9.q.m.'.L.L.f.m.q.q.f.f.E V.[ V.W E W E E E Q q.| | E f.~.E [ R ~.).W.q.W.{.*X-.*XE I.Q q.9 3XrXM %.K.W.I.(.| 9.E -.(.R aX..yXl iX%.p S R W T /.G e e iXr ;X; x.].o.j.[.oX].u ^ x.o.A.f.f.| Q | | | D f.f.q.:.t.zXw b v j v f Z.[ R.j.v j qXj q M ` ; C.C.[ [ 9.[ W | W E f.W R f.).R.m.W q.q.d.f.d.{.-.{.{.{.{.I.| 9.9.W W f.| | Q.C.A.C.p.W [ [ =.W T ).9.[ Y S =.c.C               ",
+"                4 W | d.-.f.`.Q.X.oX/ f.q.Q A.[ E ~.V.f.f.d.f.E E E V.f.{.D Q A.A.W Z.T V.W ).m.;.w.{.(.XX{.XX| [ W.N.k e k rXL.A.d.E f.Q.H.{.T.=.V.N.e e l.* 1 E R 8.[ ).;.iXe e l.%.< u.A.q./.X.X.].].x.L./.V.A.f.W Q Q Q E V.E V.f.E j.q y w qXL gX7Xf.R f.D w.b y qXuXr r.= C.C.A.R.9.W R.R.9.T.E E 9.f.[ T.(.f.W d.Q Q q.q.`.q.{.`. .M.`.d.f.f.W ).f.[ A.A.n.p.W W [ p.[ { 8.9.T 9.T [ Z.c.                ",
+"                  Z.f.A.f.p.o./ A.A.A.E I.I.I.Q d.A.E f.D q.q.A.f.E E E D f./.o.o.'.[.^ L.n 9 O.j.O.:.-.XXd.q.d.9.H.G.h.q S.k K.A.).W V.A.f.E 9.Y [ W.sXiXeX_ ,.V.~.[ | T [...y y y F.P < V.A.f.f.f.f.L.W W C.0.f.E Q W.`.Q q.A.f.D q.q.t...iXqXj b g f A.R.E /.g.iXb y y b N = p.W Q.A.p.Z.9.R.9.9.9.T.8.E Q T.E T.| I.d.d.d.f./.q.Q q.Y. .`.R.A.A.A.| [ T W T A.C.).R.C.[ 9.R.[ { { W C.d.C.C                 ",
+"                  X A.j.f.L.a C.C.W 9.=.Q Q {.E 9.[ [ [ f.D m.q.q.I.Q Q I.:.'.o.d ^ ;Xu OXN oX=Xy ! m ~ :.E [ q.A.O.z h.h.k q X.C.W W p [ b.T /.D o.Q.kXe yX3XP T f.E d.W V.q.;.j iXrX%.` x.d.| W V.d.C.p.T =.W W f.Q Q d.q.Q.d.A.).Q {._...l.e y b x - f [ E f.L w y y y j u i f.9.[ A.Q.T.9.| R.n.9.| f.[ R 8.f.I.I.d.f.f.A.).W ).f.W 9.f.W A.X.'.m.X.W W f.{ R W A.d.[ C.W R.C.W C.d.f.d.+X                  ",
+"                    u.A.a V.o.Q.q.[ E [ f.[ } f.Z.W p.[ R E f.).D q. .`.`.q.m.q.oX^ n u & * ^ t 9 ;.w.G m.D f.V.W j.J.w c [.[.X./.].X.f.C.V.W.H.m.K.m.m z k.k.>X% o.| d.W C.f./.kXe l.6X@X1.x.W f.E f.q.d.Z.[ 8.f.I.f.f.W Y Q.R.C.R.f.D ;.w w qXy q r.1 1 T =.~.;.q y y qXr & a d.9.R.Q.9.[ W p.C.C.d.d.d.E [ E E | | {.| q.d.d.d.f.| E | [ T [ X.'.! H.[.'.Q.b.=.Z.9.W W W A.f.f.W {.d.| 9.X                   ",
+"                    o ).].j.Q.q.q.| 8.9.T.[ W X./ L.A.R 8.E | E A.W.j.q.`.M.m.X.X.x.X.A.C.L.a ].[.[.j.g.:.A.f.E Q f.o.'.x 1 D o.]./.m./.A.D H.M.w...M.;.h.cXcXS.l.x.W.m.q.q.q.D g.k l eX@X% - +XQ Q Q Q Q I.f.E E E A.o.x.].K.m.Z.W c.).;.w iXk sXb $X= +.T W W aXq l.y e r n Q.Q.d.d.C.a Q.a L.C.W o.A.8.~.E f.E E f.Q f.d.j.f.| d.XXQ Q [ W =.).f.'.m.].X.X.o.Q.f.d.[ W { A.[ 9.E {.Q q.c.                    ",
+"                      wX].x.Z.f.-.H.A.Q.A.L.'.oX9 K.'.`.d.(.| Q q.W A.V.).[.o.f.Z.R W f.E W [ f.T f.Q.q.f.W q.Q Q f.~.D A.n.p V.W T Q.X./.:.xXH e k w.w h.S.k.yXqX>.x.W.H.:.H.m.O.z yX3X&X,.2.!.A.f.f.[ f.E Q {.d.f.D a / x.].m.Q.n.Y D ;.k iXw y qX6X_ = T E } Q ..y e l.w 9 A.{.q.d.Q.X.L.n.b.a { p.{ [ R.8.[ } ~.~.R T ).f.9.=.W | f.Q (.| [ ~.[ ).W ).a X.).C.[.d.[ [ [ p.T [ [ R E V..                     ",
+"                      . p ].L.A.d.x.C.C.L.L.^ u ^ o.m.{.R.W 9.d.X.W f.[ T f.f.o.o.C.Z.W | Q f.Q.f.A.f.9.o.d.d.d.j.Q A.A.f.).W [ [.D j.[.F m M.U.G.e w H h.yXiXyXe l._. .! ! xXH.N.k w r M N :Xz.f.| D f.W =.V.:.A.Q.X.oXoXL.W C.9.C.n.Y gXw iXy iXy r * = o.[ E f.! y y e y ^ C.A.W.m.o.A.W C.b.n.[ b.C.f.m.| E [ } [ R =.[ } [ [ [ ~.~.Q | | E 8.8.[ [ A.o.o.f.).q.f.c.0.{ { c.R R [ =.'                       ",
+"                        4 o.X.L.f.f.f.A.m./ / / oXA.Q.Q.R.p.p.C.R.W f.f.C.).:.w.w y oXo.o.q. . .m.X.Q.f.W.`.W.Q.Q.q.m.:.W.[.[.;.J.! hXJ.N.G G.N.G U.N.G k e w.lXk w L H.U.F H._.F U...y l.%X( , /.R.).A.A.b.Z.b.V.q.m.d ^ R.9.A.L./ L.L.0Xe e e iXy M _ i A.9.| d.m ~ r y r N o.C.a L.V.f.9.W n.A.o.W ).f.f.o.f.[ [ [ T { { W [ 8.T.[ E Q | W Y =.R R R W /.C.C.T V.T c.Y [ =.9.E [ 8.A                         ",
+"                        . u.C.f.f.E R.d.m.m ^ ].a V.R.R.L.D.p.n.A.C.q.x.hXO.L H z k e q ! M.N.G.G ..J.M.O.m.[.O.L ~ w.w.w.w H lXlXG U.aXN.U.;.xXxX_.g.xXN.U.N.w lXG m g.'.Q.f.W.q. .H.J.~ K./ i o.q.A.q.I.A.A.A.f.q.X.oXX.q. .~ d m.9 =Xl.e l iXw l.y F.L.| | q.{.m y y w M = L.p Y b.{ W W R { =.Y [ [ { b.V.Q.A.R.R.C.T d.Q.| T.^.^.T.8.E [ C.p.S S S R R.W W Y { p.Y T A.C.d.T.| f.C                         ",
+"                          C f.f.W R C.C.p /.A.f.C.W W C.A.Q.m.m._.H.w.e H e H H H H H H e G.H H vXH H k k H w lXz h.z z k vXz e G F H.-.W.q.D -.-.D W.D A.D W.xXM.O.j.H.m Q.q.W.W E f.d.Q {.f.f.A.d.{.`.Q I.| Q f.f.d.A.Q.q.A.t.w.~ w k k e H l l e e >.R.R.[ f.9.j.m v c u p b.[ Z.W [ R [ W [ [ 8.R =.9.f.E f.f.X.X.m.D.f.f.| T.8.8.| | (.8.[ f.T.} } R *.{ p.T { R p.T { [ 8.8.[ &.                          ",
+"                            wXA.[.o.[.s x./ j.[.:.q.f.q.m.:.M.U.G H z z H h.h.k H H H H G.H vXvXH z k z z z h.bXh.h.z z H z H G xXq.d.W.K.L.{.{.I.q.f.f.Q f.Q :.q.`.j.q.m.q.:.W.Q f.d.E f.Y R W [ E E f.(.(.E f.E f.f.[ A.d.A._.O.~ ! w.U.;.e e e e w u W f.D.W | o.t v w c p V.A.C.X.Q.9.[ } 9.d.f.9.f.Q.| d.{.Q.a A.Q.W [ 8.8.} } } } E (.(.| | T.8.T.T.T.[ ] Y W f.R.R.[ { 8.R c.                            ",
+"                              $ G G G e G ..G G w.'.Q.{.H.! G.H vXz h.h.k.S.S.S.h.H H vXz vXvXH H k k k H H z h.h.h.H w H k H g.`.{.d.:.~ Q.q.| *X{.XXQ A.[ E E f.).f.D q.q.q.d.| Q Q E f.[ W E 8.E ~.| E T.T.9.[ | R.9.R.f.A.T V.O.m.A.[.j.! w w e M C.C.o.o.d.Q [.q b M K 1 p.C.f.[ | d.R f.W d.X.L.L.[.Q.W A.W C.p.{ } 8.9.} *.^.^.^.^.^.T.T.9.[ 8.8.T.{.d.[ S p.S { R.R.Q.R b.X                             ",
+"                              X hXz bXh.z z H z H ..m O.! H h.h.S.S.cXcXS.S.S.k.H h.h.z z z h.h.h.h.h.h.H H H H H z z e 8 m '.o.m.W.m.X.m.Q.q.{.{.q.d.W f.f.V.j.A.W | Q | Q W E } R [ Y Y T f.f.8.8.8.T.| 8.8.[ [ R.C.f.W W [ { b.C.V.W [ f.:...w y m X.I.I.R.f.W A.oXb .. XL.W } W =.[ T W [ E Q.m.u * & / f.C.9.{ 9.} 9.(.T.T.8.9.} T.XX(.| 9.[ [ f.W E T.{.{.9.f.n.[ C.L.o._.C                               ",
+"                                + G bXh.z z z z z z k e z h.cXcXcXcXcXcXcXS.S.h.h.cXh.h.k.k.h.S.k.S.S.h.z H H H H G.H G N.O.].m.L./.oXL.A.A./.q.m.Q D q.f.Q.Q.q.q.| XX| f.| R.[ p.W W A./.'.o.C.=.8.8.[ 8.[ [ 9.W [ f.C.W R.W C.C.V.9.[ E | d.uXq y & | | | T.| d./.;.v b c i | R.[ [ 9.| 9.R W Q.q.X.N N / a f.d.| I.T.T.(.T.R.| | 9.8.T.d.[ f.{.d.E (.T.} W Q.C.f._.X.V.[.q.+X                                ",
+"                                  1XH z z H h.z h.h.bXS.cXcXcXcXcXS.cXcXcXcXS.h.bXS.h.S.h.k h.S.S.bXh.S.h.z vXH vXG.N.j.f.o.j.[.[.o.X.A.A.A.f.).A.q.D f.{.Y.X.Q.-.-.q.| f.f.-.C.].:.o.X.j.O.t.'.p p.Y *.8.{ { R 9.C.A.Q.W f.i C.Z.C.A.A.Q.{.Q.g.j b a W XXT.8.~.(.A.0Xc b q & d.m.X.A.d.m.Q.C.9.| Q.]./ N oXa f.Q E d.XXXX| | ^.| 9.} E | d.R f.| E | | f.R [ W. .j.m.[.C.A.T                                   ",
+"                                    $ H H H H z h.h.h.h.S.S.cXcXh.h.z S.S.cXS.S.cXS.h.S.h.h.h.S.S.h.bXbXz bXz H vXH g.j.O.q.f.Z./.o.q.q.A.j.Q.f.q.D W f.I.{.{.d.m.'.'.q.W.`.M.[.L ~ g.m._.;.`.[.o.W f.[ 9.9.C.9.R.R.R.C.Z.C.A.o.X.K.Q.C.q.m. .;.b r N T f.d.W R } W v ;.0 r a C.m._.H.A.Q.X.R.R.f.A.]./ N / N X.d.f.T.I.I.XXXX(.T.8.[ 8.8.W [ f.[ ~.E E E E =.d.:.q.f.D { b.X                                   ",
+"                                    X 6 H H H H h.bXbXcXh.h.h.z z z z z cXcXcXcXcXh.S.h.S.h.cXh.h.z h.h.h.h.z vXvXH G G M._.o.o.:.[.q._.'.H.o.:.W.o.q.-.{.I.m.Q._._.m.q.q. .xXH G U.m q.q.m.R.W =.f.W C.A.C.X.Q.m.d.f.9.9.f.f.f.f.m.d.W d.f.q.gX..y * ].O.m.d.A.d.o.f t b 3X* p C.x./ a L.A.C.W W | C.Q.X./ oXm.{.I.d.XX(.| { T.8.T.| (.I.(.| 8.[ | E E 8.[ [ E Q f.W W c.X                                     ",
+"                                      X gXvXH H H z h.h.h.z z H z h.z h.bXcXcXh.S.h.h.h.S.bXh.z z z h.cXbXbXz z z z vXvXH G G G G w.w.J.M.m.:.q.o.m.Q :.{.| W [ W T.f.f.V.W._.N.N.O.oXo.).W 9.9.W | E [ 9.W W f.{.| T [ 9.9.9.d.| f.9.R A.9.f.:...b & x._.R.R.A.W [.t v c r N & u ^ ].].o.L.L.n.f.d.XX| R.A.X.o.A.T.{.| T.T.T.T.XX| | ~.*XI.I.I.XX| 8.9.[ E 8.[ V.[ [ E C                                       ",
+"                                        4 8 vXvXH z z z z h.h.bXh.bXh.h.cXh.cXcXcXS.k.z z z z H z z z bXcXh.z cXh.h.z z z z h.h.z z H H H G `.`.q.W.q.-.*Xf.| f.| | d.E T E q.D W.m.X.o./ s.T 9.| | | T.[ [ T [ D A.| f.[ d.d.q.I.{.{.Q {.d.| W.q b 1.b.d.d.R.f.[ o.v 8 y y ;Xx.'.m.X.A.^ ^ K.u i C.I.| R.W ).d.d.9.T.8.T.T.T.8.T.(.XX(.E Q XXQ Q Q R [ E [ [ E Q [ [ Z                                         ",
+"                                          4 hXz vXvXvXz lXh.h.h.h.z bXcXbXS.cXS.cXz z h.lXz z z H z z z bXcXbXcXcXbXz z z bXbXz vXH z z H H G w.! xXF xX`.-.q.E f.E I.| W W 9.f.W T W m.K.x 1 A.q.f.| | 9.E f.E | | Q q.D m.`.`.{.`. .d.{.d.| W.j v u p f.d.XXd.f.[.8 b 3XM OX- ).R.f.R.Q./.`.{.X.q.| | | 9.W d.d.f.T.~.T.T.T.~.} ~.~.~.E T.Q ~.E f.[ V.~.f.D Q | E ,X                                          ",
+"                                            + G H H H z bXz vXz vXH z z z bXbXcXcXh.H z h.h.z z H H vXz bXbXbXbXbXbXbXh.z z z H vXH H z z H H H G.G.G.N.xXF :.A.Q {.Q d.d.d.Q.W A.].K.M. .^ n.Z.D Q d.| | q.Q | {.Q Q q. .o.H.m.q.d.Q.{.X.R.d.q.L r ;XT f.d.XX| q.! b eXqX3Xr.= b.E | | T f.q.| T.Q | T.^.E E Q Q | T.| | E ~.} } E ~.(.^.^.(.} 8.~.E =.[ Q W Q Q +X                                            ",
+"                                              5 sXvXH H H vXvXvXvXvXH H vXh.bXbXh.vXz z h.h.k z lXz z vXz z vXz bXvXz z z z z H z z H vXz z H H H H H H G.G xXH. .`.-.Q.Q. . .q.`.W.L -.{.q.q.R.W A.E f.W E | | | | E | q.o._.m.X.q.Q.X.A.A.Q.f.y b N u.Q.I.T.9.| ;.q l.y l.%.` V.d.| (.| E 8.XXT.(.(.(.(.^.Q (.I.Q Q | XXXXE [ ~.(.^.(.XX^.^.} } ~.E [ [ ~.V.E c.                                              ",
+"                                                + fXH vXvXG.vXvXH H vXvXH vXz bXz z z bXbXz z vXbXvXz z z z vXz h.z H z z H z z z vXvXH vXH vXH G.H vXvXvXH G.N.g.Y.H.`.d.[ :.m.Q.T `. . .A.W.{.f.A.).f.W | I.T.f.d.Q.f.A.W V.A.q.Q.o.'.oXq.Q.t.uXM * 1 d.{.d.| Q :.w l.e iX=X& V.T.(.(.| f.Q XXXX(.XXI.(.XX*X(.(.Q | Q Q Q ~.E ~.T.^.^.XXI.T.T.~.~.(.~.=.~.(.,X                                                ",
+"                                                  4 fXvXH vXvXz z z bXz H z bXz bXbXbXh.bXh.z z bXz z bXvXbXz bXh.z h.z H z H vXz H z H G.vXvXvXz vXz z z z z G.G G G J.'.q. .Y.Q.W f.[ W f.A.W [ f.T W f.Q d.| A.A.d.d.R.W W W T A.o.X.'.X.Q.m q b OX,.E q.`.`.{.Y.g.w.y r uX` 1 Q | I.(.(.XX-.*XXX*X-.XXXX*X*XI.Q *X{.| E E I.(.(.XXXX(.XXXXXX(.T.XX8.} [ ,X                                                  ",
+"                                                    X fXvXz vXvXh.bXh.z z bXz z bXz bXbXcXbXbXz bXz bXbXvXbXz z bXz z z z H z vXvXH vXvXvXG.vXvXz z z z bXz z vXH vXH G N.F xXF d.q.d.d.d.[ Z.[ R { ).d.d.q.q.f.R.R.| {.A.A.A.9.{ =.C.p f.f.A.g.qXl.%X,.+XA.`.H.! U.H. .L b b r.I W | I.I.XXI.XX*X*X-.dX*XXXXX-.`.*XI.dXq.E E Q Q I.I.XX8.^.(.XXI.| E E [ ,X                                                    ",
+"                                                      X y.vXvXvXbXz bXz bXvXvXbXz z bXbXbXh.h.z bXz z z bXbXvXbXz bXbXbXh.z z z vXH H H z vXH vXvXvXvXvXbXz bXz H z z z H G.G.F I.{.I.{.{.f.W W 9.p.| | | f.9.f.d.f.f.W A.! Q.o.u.Y b.Z.f.9.).w.qXl.$XB < x.X.H.w.J.! M.~ j j %._ 2 ).(.-.I.I.| `.-.dXxXF xX-.Q -.-.Q :.o.j.q.q.:. .d.T.I.XX^.XXI.| T.[ Z                                                       ",
+"                                                        X jXvXvXvXz vXz vXz vXz z bXbXbXbXbXbXz bXbXbXbXbXbXbXbXbXbXbXbXbXz bXz z z h.h.h.z vXH vXG.H vXbXz bXh.z bXz bXz z G.dX*X`.*XXXXXW 9.R.f.| f.| d.| Q | Q m.{.q.Q.M.X./ ].o.V./.[ [ D q w iX3X` ; / N K.[.m :.U.;...y 0 r.g = ).dX`.*X`.W.W.`.g.U.G :.H.M.m.`.`.M.O.~ ~ w.H.A.f.8.(.(.I.-.I.~.'                                                         ",
+"                                                            jXG.H bXbXz bXz bXz vXz z bXbXcXcXz bXbXbXbXbXbXbXcXbXbXz z bXbXbXbXS.cXbXcXcXS.h.bXz H H H H vXH z z bXz z z vXG.F `.-.XXXX(.| [ | Q q.f.Q I.| d.9.| f.q.W.A.o.M.Q.[.o.o.f.b.V.).J.k yX=X1.= d u u L.[.o._.g.k yX6XJ % # = j.-.-.`.Y.M.U.aX_.aXt.aXG ..M.`.M.~ '.~ L 9 [.'.q.*X| (.{.E X                                                           ",
+"                                                              5 fXbXbXbXbXz bXz z z z z bXcXcXbXz bXbXbXh.z bXbXbXz z z cXbXcXbXcXcXS.S.S.S.cXbXh.h.z vXH H H vXbXz bXbXz H J.F Y.F -.-.(.XX| | {.Q -.-.-.{.`.Q f.f.f.Z.Z.=.`.-.W =.q.A.W.).j.aXiXe b _ wX[.'.O._.o./.:.k h.l.b @Xr._ - p A.Q :.W._.xX;._.t.;.:.J.G M.H.m O.K.d 9 M M m m.d.XX~.A .                                                             ",
+"                                                                C gXz bXbXbXbXz bXbXz h.cXS.cXh.h.bXbXh.z z bXbXbXz bXcXcXcXcXcXbXcXh.S.h.h.h.cXcXh.z z z z bXbXbXbXbXbXz G.xXxXJ.xXY.-.I.d.XX| Q *XW.`.*X{.`.m.V.V.{ [ [ A.m.Q.Q. .M.M.g.! M.O.w.iX#XP I j. .M._.m.W.gXe lXk e qX4Xu B Y W Q W.f.D j.[.:.q.aXW. . .-.q.L M.'.v q ! ..m M.:.d.,X                                                                ",
+"                                                                  X jXH bXbXbXbXbXbXbXbXh.bXh.bXbXbXh.bXz z vXvXvXz cXbXcXbXcXcXcXcXcXcXS.h.S.h.S.h.h.h.z z h.bXbXcXbXz z J.q.dXY.dX{.-.m.d.{.{.q.W. .`.A. .`.:.A.f.A./.]. .M.M.! N.G H G.G H N.q w #XU +.j.H.J.J. .! U.H k w w w r u N L.| XXQ f.A.V.E ).~.| E V.f.A.d.dX .m._.F H.M.q.A.T Z                                                                   ",
+"                                                                      5 G z bXbXz z z bXz z h.h.bXz z z vXz vXvXvXvXbXbXbXcXcXcXcXcXcXcXcXh.S.h.h.h.h.h.h.z bXS.bXbXbXh.H U.U.F Y.M.H.O.L m.`.F F :.M._.H. .q.Q.f.j.[.a [.M...e G.H G.z k U.G.J.! sX@X_ I ).:.dX:.dXJ.U.G.H J.w.! ~ oX/ W E } ~.E ).[ V.V.f.f.E R [ ~.Q | Q V.D W.`.:.A.u.X                                                                     ",
+"                                                                        . jXN.z z bXz vXH H H vXh.h.z z H vXH H vXvXz bXcXcXcXcXcXcXS.h.z lXh.z z h.h.h.z z z bXh.h.bXh.N. .:.q.q.m.m.H.K.[.t.~ m ! N.G G g.m [.O.m ! w.N.G G.G.J.J.xXJ.H Y.`.-.N.r <.$ U #.D Q Q ~.I.-.dXdXY.`.{.{.X.Q.f.[ | E ~.E W Y b.D d.Q f.D :.Q f.E V.W D f.=.'                                                                         ",
+"                                                                            5 hXvXvXH z z vXH vXvXbXvXH H vXH vXvXz bXbXbXcXcXcXcXcXh.z z H z z z z h.h.z lXlXz z vXz H U.H.Y.H.;.m oXr ~ 9 w.H lXH vXH vXH G w.N.U.N.N.U.N.J.N. .:.q._.F `.`. .M.t.& & g 2 @ q.| XXI.Q d.-.-.I.I.{.d.{.Q.A.o.Q.q.).H.D T [ Q D A.f.Q D E [ W f.W u.X                                                                           ",
+"                                                                              X jXG H z z z z H vXvXz H H vXvXlXvXvXvXbXbXbXcXcXcXcXbXz bXbXh.z h.h.z vXz vXvXH vXH H H .._._.g.w.r v k y w H k z z vXH G.G G.G.U.J.J.Y.W.dXdXY.`.q.f.Q W.`.-.`._.m.j.[.# ( < D Q XXd.| f.E {.{.XX{.q.Q./.a /.L _.o.q.V.=.S ).f.f.E =.R E E E V.,X                                                                              ",
+"                                                                                  + fXH H H vXz z vXvXz bXvXz vXz vXvXz bXbXcXcXcXcXh.h.bXcXbXz bXz z z z vXlXvXG.vXvXe M.[.9 ~ '.m G z k h.z z z z z H G.U.xXvXF dXdX*X{.| Q *X*Xq.Q E E | | E Q -.q.m.f.x @.A.{.I.Q f.9.f.W f.d.W { D s e./.t.b.).W.[.f.T =.[ V.[ R V.| [ +X                                                                                  ",
+"                                                                                    X @ hXH H H vXvXvXz z vXvXvXz z vXvXvXbXz bXbXh.h.z z h.z H z vXH H z z vXvXvXH H H ..q ;.G oXd t lXz z z H bXvXz H J.F :.dX-.I.XX{.-.{.q.Q Q Q | {.`.-.| 9.{.I.{.d.9.9.v.[ Q I.E | W E =.Y ).W v././.[ Z.b.p V.o.q.q.).f.W f.A.E E V.Z                                                                                     ",
+"                                                                                        4 jXN.H H vXH vXvXz z bXz z z vXvXvXvXlXlXH lXlXH z z vXH vXH H vXz H z H z vXH H z H w q q w H H z z H z G.N.J.W.q.Q Q Q (.I.-.-.*X{.{.d.f.Q.| Q.-.{.I.{.| I.I.XX9.8.T.| ~.E E =.[ Y V.[ W b.{ b.Z.p a L.a o.[.[.^ K._.O.g.j.,X.                                                                                       ",
+"                                                                                            4 y.G.vXvXvXvXvXvXvXbXz vXvXvXz H z H lXe lXlXz z z z z vXH vXz vXbXz z bXbXz z h.z H H H H k h.z H H U.W.E E f.W.Q I.I.8.| *XY.`.d.A.d.Q.X.R.m.X.d.Q XX*XI.I.XXXX| | | f.f.b.Y D [ W 9.f.Z.p.=.v.o.L.L.C.o.K.K.9 ;.7X@ X                                                                                           ",
+"                                                                                                5 y.G.vXvXvXvXvXz bXz bXbXcXbXh.k k z z h.h.cXbXh.bXh.bXz vXz z z bXz bXbXbXbXz z z z H H H H H G. .Q E Q I.Q W.`. .`.`.Y.-.{.m.M.'.Q.'.X.m.X.{.W.q.I.I.-.I.I.| d.f.V.T u.A.f.Y [ E Q f.p.b.W 9.d.C.C.Q.'.m d - X                                                                                               ",
+"                                                                                                  . + 6 zXH z z bXbXbXh.cXcXS.h.S.h.S.h.S.h.z h.bXh.bXbXh.vXvXvXz vXbXz bXbXh.z z z z z H G.U.J.F q.{.I.| E D W.:. .Y.*XY.m.[.H.g.~ m.X.m.'.X.q.:.`.*X-.`.I.| [ ).Q A.A.T o.9.[ E [ W f.[ [ | R.d.R.9.C.).I X                                                                                                   ",
+"                                                                                                        + jXG.z bXcXbXh.bXcXcXS.cXcXcXS.S.z h.h.z z bXbXbXz vXz z bXvXbXvXz z vXH vXvXG.N.xXF `.d.W f.Q ).A.D q.q.W. .f.q.*XW.:.-.`.Q.{.m.m.H. ._.! :.F dX*X| Q q.Q | A.[ {.| T.d.8.| | Q.d.I.I.d.Q.{ ,X.                                                                                                       ",
+"                                                                                                            X @ fXvXz z H z h.bXcXcXcXcXS.h.h.h.z vXvXvXH bXbXbXvXvXvXvXG.G.z H vXvXU.`.`.-.*X| Q (.| | Q o.d.d.W f.8.XXd.~.Q W.q. .8.d.X.Q.X.H. .xX:.q.`.`.W.q.f.Q | E R } (.E f.q.W Q 9.8.[ f.c.Z                                                                                                             ",
+"                                                                                                                X 5 6 sXvXvXz vXz z lXz bXz h.bXvXz z z H vXz z vXvXvXH N.N.G.H G.U.xX-.Q Q Q E 9.9.d.| 9.[ [ [ R Q XXXX| | | D W.f.[ W Q.{.Q.{.Q.`.H.q.:.m.q.q.{.Q Q ~.[ | E =.E f.E [ f.+X,XX                                                                                                                 ",
+"                                                                                                                      4 $ hXH H z lXz vXlXlXlXlXlXh.h.h.z G.H vXvXG.G.F F xXF F F `.W.Q E f.Q | W 8.| f.R [ ~.=.*.E | {.{.f.E Q D  .C.R.R.X.-.d.d.d. .:.A.q.q. .q.Q I.XXE (.E 9.[ f.E u.' .                                                                                                                     ",
+"                                                                                                                            + $ kXlXlXz z vXz z lXbXbXz z z G.G.G.xXF `.*X-.*X*XXXD Q W.f.D Q I.Q {.E f.d.| W ~.[ R ~.T.[ c.E W | q.f.Q.R.8.d.| | W Q.d.A.Q.A.q.*XW.{.XXQ | Q | =.,XX                                                                                                                           ",
+"                                                                                                                                X 4 1XgXzXvXz vXlXvXvXz vXz H G.G Y.W.Q E (.~.E | f.Q V.~.E *X*XXX| d.8.E [ R =.R R 8.[ [ =.| T.| E A.m.A.A.W T f.d.W d.f.q.d.f.| {.{.| [ 8X,XX                                                                                                                                 ",
+"                                                                                                                                      . 4 8XjXfXN.lXlXH vXlXH G.g.{.| E f.[ c.T Q Q Q V.D XXQ Q *XI.Q Q f.d.[ R 8.[ ^.} R { E T.| | A.q.Q q.A.W | f.q.E T.{.Q f.T T A ' X                                                                                                                                       ",
+"                                                                                                                                                4 5 jXgXzXH N.! `.I.| d.Q E [ D | f.I.E XX^.^.*X{.E W D `.M.q.f.d.| | 9.} T.XXI.| ~.[ A.| Q Q Q | V.E | V.=.A C .                                                                                                                                               ",
+"                                                                                                                                                        X 4 5 u.V.C.| | | T.8.(.E | Q I.-.| XXXXI.f.A.Q.f.f.q.| W.-.-.d.XX| XXI.| 9.[ E V.~.~.).8XA Z X                                                                                                                                                         ",
+"                                                                                                                                                                  X X ' Z A A Y =.V.=.T E Q (.(.`.q.q.j.:.f.f.| q.d.| E | 8.V.f.).,XwX,XZ X X X                                                                                                                                                                 ",
+"                                                                                                                                                                                  X   X X C ' ' + wXwXwXO Z Z 4 ,X' C X X X .                                                                                                                                                                                   "
+};
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdfbarcode.cpp wxPdfDoc-copy/src/pdfbarcode.cpp
--- wxpdfdoc-0.9.2.1/src/pdfbarcode.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdfbarcode.cpp	2012-05-29 23:51:29.414100000 +0100
@@ -331,7 +331,7 @@
   size_t i;
   for (i = 0 ; i < code.Length(); i++)
   {
-    codeExt += code39_encode[code[i]];
+    codeExt += code39_encode[(long int) code[i]];
   }
   return codeExt;
 }
@@ -1395,7 +1395,7 @@
   wxString::const_iterator ch;
   for (ch = barcode.begin(); ch != barcode.end(); ++ch)
   {
-    bars = code128_bars[*ch];
+    bars = code128_bars[(long int) (*ch)];
     for (j = 0; j < 6 && bars[j] != 0; j = j+2)
     {
       barWidth = bars[j] * w;
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdfdc28.inc wxPdfDoc-copy/src/pdfdc28.inc
--- wxpdfdoc-0.9.2.1/src/pdfdc28.inc	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdfdc28.inc	2012-05-29 23:51:28.679100000 +0100
@@ -71,7 +71,10 @@
 {
   if (m_pdfDocument != NULL)
   {
-    EndDoc();
+    if (!m_templateMode)
+	  {
+	    delete m_pdfDocument;
+    }
   }
 }
 
@@ -98,6 +101,10 @@
   m_userScaleX = 1.0;
   m_userScaleY = 1.0;
 
+  wxScreenDC screendc;
+  m_ppiPdfFont = screendc.GetPPI().GetHeight();
+  m_mappingModeStyle = wxPDF_MAPMODESTYLE_STANDARD;
+
   m_mappingMode = wxMM_TEXT;
 
   m_pdfDocument = NULL;
@@ -155,7 +162,7 @@
   {
     m_pdfDocument = new wxPdfDocument(m_printData.GetOrientation(), wxString(wxT("pt")), m_printData.GetPaperId());
     m_pdfDocument->Open();
-    m_pdfDocument->SetCompression(false);
+    //m_pdfDocument->SetCompression(false);
     m_pdfDocument->SetAuthor(wxT("wxPdfDC"));
     m_pdfDocument->SetTitle(wxT("wxPdfDC"));
 
@@ -242,35 +249,35 @@
 
   if (ok)
   {
-    // TODO: point size adjustment is not always reliable
-#if wxCHECK_VERSION(2,8,10)
-    double size = (double) font.GetPointSize() * GetFontPointSizeAdjustment(72.0) * 4./3.;
-#else
-    // GetFontPointSizeAdjustment is not available in wxWidgets versions < 2.8.10
-    // TODO: apply a correction nevertheless?
-    double size = (double) font.GetPointSize() * 4./3.;
-#endif    
-    ok = m_pdfDocument->SetFont(regFont, styles, ScaleToPdf(LogicalToDeviceXRel(size) * m_pdfDocument->GetScaleFactor()));
+    ok = m_pdfDocument->SetFont(regFont, styles, ScaleFontSizeToPdf(font.GetPointSize()));    
   }
 }
 
 void
 wxPdfDC::SetPen(const wxPen& pen)
 {
+  if (pen.Ok())
+  {
   m_pen = pen;
 }
+}
 
 void
 wxPdfDC::SetBrush(const wxBrush& brush)
 {
+  if (brush.Ok())
+  {
   m_brush = brush;
 }
+}
 
 void
 wxPdfDC::SetBackground(const wxBrush& brush)
 {
-  // Not yet implemented
-  wxUnusedVar(brush);
+  if (brush.Ok())
+  {
+    m_backgroundBrush = brush;
+  }
 }
 
 void
@@ -288,6 +295,15 @@
 }
 
 void
+wxPdfDC::SetTextForeground(const wxColour& colour)
+{
+  if (colour.IsOk())
+  {
+    m_textForegroundColour = colour;
+  }
+}
+
+void
 wxPdfDC::DestroyClippingRegion()
 {
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
@@ -310,10 +326,12 @@
 wxCoord
 wxPdfDC::GetCharHeight() const
 {
-  wxCoord height = 12;
+  // Default for 12 point font
+  int height = 18;
+  int width;
   if (m_font.Ok())
   {
-    height = m_font.GetPointSize();
+    DoGetTextExtent(wxT("x"), &width, &height);
   }
   return height;
 }
@@ -321,8 +339,13 @@
 wxCoord
 wxPdfDC::GetCharWidth() const
 {
-  // Chris Breeze: reasonable approximation using wxMODERN/Courier
-  return (wxCoord) (GetCharHeight() * 72.0 / 120.0);
+  int height;
+  int width = 8;
+  if (m_font.Ok())
+  {
+    DoGetTextExtent(wxT("x"), &width, &height);
+  }
+  return width;
 }
 
 bool
@@ -352,6 +375,13 @@
 }
 
 void
+wxPdfDC::ComputeScaleAndOrigin()
+{
+  m_scaleX = m_logicalScaleX * m_userScaleX;
+  m_scaleY = m_logicalScaleY * m_userScaleY;
+}
+
+void
 wxPdfDC::SetMapMode(int mode)
 {
   m_mappingMode = mode;
@@ -421,6 +451,7 @@
 {
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
   // TODO: check implementation
+  m_logicalFunction = function;
   switch(function)
   {
     case wxAND:
@@ -487,8 +518,8 @@
 {
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
   SetupPen();
-  double xx = ScaleToPdf(LogicalToDeviceX(x));
-  double yy = ScaleToPdf(LogicalToDeviceY(y));
+  double xx = ScaleLogicalToPdfX(x);
+  double yy = ScaleLogicalToPdfY(y);
   m_pdfDocument->SetFillColour(m_pdfDocument->GetDrawColour());
   m_pdfDocument->Rect(xx-0.5, yy-0.5, xx+0.5, yy+0.5);
   CalcBoundingBox(x, y);
@@ -525,15 +556,15 @@
   wxList::compatibility_iterator node = points->GetFirst();
   wxPoint* p = (wxPoint*) node->GetData();
 
-  x1 = ScaleToPdf(LogicalToDeviceX(p->x));
-  y1 = ScaleToPdf(LogicalToDeviceY(p->y));
+  x1 = ScaleLogicalToPdfX(p->x);
+  y1 = ScaleLogicalToPdfY(p->y);
   m_pdfDocument->MoveTo(x1, y1);
 
   node = node->GetNext();
   p = (wxPoint*) node->GetData();
 
-  bx1 = x2 = ScaleToPdf(LogicalToDeviceX(p->x));
-  by1 = y2 = ScaleToPdf(LogicalToDeviceY(p->y));
+  bx1 = x2 = ScaleLogicalToPdfX(p->x);
+  by1 = y2 = ScaleLogicalToPdfY(p->y);
   cx1 = ( x1 + x2 ) / 2;
   cy1 = ( y1 + y2 ) / 2;
   bx3 = bx2 = cx1;
@@ -549,8 +580,8 @@
     p = (wxPoint*) node->GetData();
     x1 = x2;
     y1 = y2;
-    x2 = ScaleToPdf(LogicalToDeviceX(p->x));
-    y2 = ScaleToPdf(LogicalToDeviceY(p->y));
+    x2 = ScaleLogicalToPdfX(p->x);
+    y2 = ScaleLogicalToPdfY(p->y);
     cx4 = (x1 + x2) / 2;
     cy4 = (y1 + y2) / 2;
     // B0 is B3 of previous segment
@@ -585,8 +616,8 @@
   {
     SetupBrush();
     SetupPen();
-    m_pdfDocument->Line(ScaleToPdf(LogicalToDeviceX(x1)), ScaleToPdf(LogicalToDeviceY(y1)), 
-                        ScaleToPdf(LogicalToDeviceX(x2)), ScaleToPdf(LogicalToDeviceY(y2)));
+    m_pdfDocument->Line(ScaleLogicalToPdfX(x1), ScaleLogicalToPdfY(y1), 
+                        ScaleLogicalToPdfX(x2), ScaleLogicalToPdfY(y2));
     CalcBoundingBox(x1, y1);
     CalcBoundingBox(x2, y2);
   }
@@ -614,12 +645,12 @@
     double yyc = yc;
     double start = angleByCoords(xx1, yy1, xxc, yyc);
     double end   = angleByCoords(xx2, yy2, xxc, yyc);
-    xx1 = ScaleToPdf(LogicalToDeviceX(xx1));
-    yy1 = ScaleToPdf(LogicalToDeviceY(yy1));
-    xx2 = ScaleToPdf(LogicalToDeviceX(xx2));
-    yy2 = ScaleToPdf(LogicalToDeviceY(yy2));
-    xxc = ScaleToPdf(LogicalToDeviceX(xxc));
-    yyc = ScaleToPdf(LogicalToDeviceY(yyc));
+    xx1 = ScaleLogicalToPdfX(xx1);
+    yy1 = ScaleLogicalToPdfY(yy1);
+    xx2 = ScaleLogicalToPdfX(xx2);
+    yy2 = ScaleLogicalToPdfY(yy2);
+    xxc = ScaleLogicalToPdfX(xxc);
+    yyc = ScaleLogicalToPdfY(yyc);
     double rx = xx1 - xxc;
     double ry = yy1 - yyc;
     double r = sqrt(rx * rx + ry * ry);
@@ -628,7 +659,7 @@
     {
       style = (doFill) ? wxPDF_STYLE_FILL : wxPDF_STYLE_DRAW;
     }
-    m_pdfDocument->Sector(xxc, yyc, r, start, end, style, false, 0.0);
+    m_pdfDocument->Ellipse(xxc, yyc, r, 0, 0, start, end, style, 8, false);
     wxCoord radius = (wxCoord) sqrt( (double)((x1-xc)*(x1-xc)+(y1-yc)*(y1-yc)) );
     CalcBoundingBox(xc-radius, yc-radius);
     CalcBoundingBox(xc+radius, yc+radius);
@@ -681,16 +712,16 @@
     bool doDraw = (curPen != wxNullPen) && curPen.GetStyle() != wxTRANSPARENT;
     if (doDraw || doFill)
     {
-      m_pdfDocument->SetLineWidth(ScaleToPdf(LogicalToDeviceXRel(1))); // pen width != 1 sometimes fools readers when closing paths
+      m_pdfDocument->SetLineWidth(ScaleLogicalToPdfXRel(1)); // pen width != 1 sometimes fools readers when closing paths
       int style = wxPDF_STYLE_FILL | wxPDF_STYLE_DRAWCLOSE;
       if (!(doDraw && doFill))
       {
         style = (doFill) ? wxPDF_STYLE_FILL : wxPDF_STYLE_DRAWCLOSE;
       }
-      m_pdfDocument->Ellipse(ScaleToPdf(LogicalToDeviceX(x + 0.5 * width)), 
-                             ScaleToPdf(LogicalToDeviceY(y + 0.5 * height)),
-                             ScaleToPdf(LogicalToDeviceXRel(0.5 * width)), 
-                             ScaleToPdf(LogicalToDeviceYRel(0.5 * height)), 
+      m_pdfDocument->Ellipse(ScaleLogicalToPdfX(x + 0.5 * width), 
+                             ScaleLogicalToPdfY(y + 0.5 * height),
+                             ScaleLogicalToPdfXRel(0.5 * width), 
+                             ScaleLogicalToPdfYRel(0.5 * height), 
                              0, sa, ea, style, 8, true);
       CalcBoundingBox(x, y);
       CalcBoundingBox(x+width, y+height);
@@ -704,8 +735,8 @@
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
   SetupBrush();
   SetupPen();
-  m_pdfDocument->Rect(ScaleToPdf(LogicalToDeviceX(x)), ScaleToPdf(LogicalToDeviceY(y)),
-                      ScaleToPdf(LogicalToDeviceXRel(width)), ScaleToPdf(LogicalToDeviceYRel(height)), 
+  m_pdfDocument->Rect(ScaleLogicalToPdfX(x), ScaleLogicalToPdfY(y),
+                      ScaleLogicalToPdfXRel(width), ScaleLogicalToPdfYRel(height), 
                       GetDrawingStyle()); 
   CalcBoundingBox(x, y);
   CalcBoundingBox(x+width, y+height);
@@ -726,9 +757,9 @@
   }
   SetupBrush();
   SetupPen();
-  m_pdfDocument->RoundedRect(ScaleToPdf(LogicalToDeviceX(x)), ScaleToPdf(LogicalToDeviceY(y)), 
-                             ScaleToPdf(LogicalToDeviceXRel(width)), ScaleToPdf(LogicalToDeviceYRel(height)), 
-                             ScaleToPdf(LogicalToDeviceXRel(radius)), wxPDF_CORNER_ALL, GetDrawingStyle());  
+  m_pdfDocument->RoundedRect(ScaleLogicalToPdfX(x), ScaleLogicalToPdfY(y), 
+                             ScaleLogicalToPdfXRel(width), ScaleLogicalToPdfYRel(height), 
+                             ScaleLogicalToPdfXRel(radius), wxPDF_CORNER_ALL, GetDrawingStyle());  
   CalcBoundingBox(x, y);
   CalcBoundingBox(x+width, y+height);
 }
@@ -739,8 +770,10 @@
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
   SetupBrush();
   SetupPen();
-  m_pdfDocument->Ellipse(ScaleToPdf(LogicalToDeviceX(x + width / 2.0)), ScaleToPdf(LogicalToDeviceY(y + height / 2.0)), 
-                         ScaleToPdf(LogicalToDeviceXRel(width / 2.0)), ScaleToPdf(LogicalToDeviceYRel(height / 2.0)), 
+  m_pdfDocument->Ellipse(ScaleLogicalToPdfX(x + width / 2.0), 
+                         ScaleLogicalToPdfY(y + height / 2.0), 
+                         ScaleLogicalToPdfXRel(width / 2.0), 
+                         ScaleLogicalToPdfYRel(height / 2.0), 
                          0, 0, 360, GetDrawingStyle()); 
   CalcBoundingBox(x-width, y-height);
   CalcBoundingBox(x+width, y+height);
@@ -757,7 +790,7 @@
 void
 wxPdfDC::DoDrawIcon(const wxIcon& icon, wxCoord x, wxCoord y)
 {
-  DrawBitmap(icon, x, y, true);
+  DoDrawBitmap(icon, x, y, true);
 }
 
 void
@@ -781,11 +814,11 @@
   wxCoord w = image.GetWidth();
   wxCoord h = image.GetHeight();
 
-  wxCoord ww = ScaleToPdf(LogicalToDeviceXRel(w));
-  wxCoord hh = ScaleToPdf(LogicalToDeviceYRel(h));
+  wxCoord ww = ScaleLogicalToPdfXRel(w);
+  wxCoord hh = ScaleLogicalToPdfYRel(h);
 
-  wxCoord xx = ScaleToPdf(LogicalToDeviceX(x));
-  wxCoord yy = ScaleToPdf(LogicalToDeviceY(y));
+  wxCoord xx = ScaleLogicalToPdfX(x);
+  wxCoord yy = ScaleLogicalToPdfY(y);
 
   wxString imgName = wxString::Format(wxT("pdfdcimg%d"), ++m_imageCount);
 
@@ -818,30 +851,25 @@
                            double angle)
 {
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
+
   wxFont* fontToUse = &m_font;
-  if (!fontToUse->IsOk())
+  if (fontToUse->IsOk())
   {
-    return;
-  }
-#ifdef wx_msw
-  y += m_pdfDocument->GetFontSize();
-#else
-  y += 0.8f * GetCharHeight();
-#endif
   wxFont old = m_font; 
+    wxPdfFontDescription desc = m_pdfDocument->GetFontDescription();
+    int height, descent;
+    CalculateFontMetrics(&desc, fontToUse->GetPointSize(), &height, NULL, &descent, NULL);
+    if (m_mappingModeStyle != wxPDF_MAPMODESTYLE_PDF)
+    {
+      y += (height - abs(descent));
+    }
+
   m_pdfDocument->SetTextColour(m_textForegroundColour.Red(), m_textForegroundColour.Green(), m_textForegroundColour.Blue());
-#if wxCHECK_VERSION(2,8,10)
-  double fontSize = ScaleToPdf(LogicalToDeviceXRel(m_font.GetPointSize() * GetFontPointSizeAdjustment(72.0) * 4./3.));
-  m_pdfDocument->SetFontSize(fontSize * m_pdfDocument->GetScaleFactor());
-#else
-  // GetFontPointSizeAdjustment is not available in wxWidgets versions < 2.8.10
-  // TODO: apply a correction nevertheless?
-  double fontSize = ScaleToPdf(LogicalToDeviceXRel(m_font.GetPointSize() * 4./3.));
-  m_pdfDocument->SetFontSize(fontSize * m_pdfDocument->GetScaleFactor());
-#endif  
-  m_pdfDocument->RotatedText(ScaleToPdf(LogicalToDeviceX(x)), ScaleToPdf(LogicalToDeviceY(y)), text, angle);
+    m_pdfDocument->SetFontSize(ScaleFontSizeToPdf(fontToUse->GetPointSize()));
+    m_pdfDocument->RotatedText(ScaleLogicalToPdfX(x), ScaleLogicalToPdfY(y), text, angle);
   SetFont(old);
 }
+}
 
 bool
 wxPdfDC::DoBlit(wxCoord xdest, wxCoord ydest, wxCoord width, wxCoord height,
@@ -882,9 +910,7 @@
   else
   {
     wxPaperSize id = m_printData.GetPaperId();
-
     wxPrintPaperType *paper = wxThePrintPaperDatabase->FindPaperType(id);
-
     if (!paper) paper = wxThePrintPaperDatabase->FindPaperType(wxPAPER_A4);
 
     w = 595;
@@ -917,14 +943,48 @@
 void
 wxPdfDC::DoGetSizeMM(int* width, int* height) const
 {
-  // Not yet implemented
-  wxUnusedVar(width);
-  wxUnusedVar(height);
+  int w;
+  int h;
+  if (m_templateMode)
+  {
+    w = wxRound(m_templateWidth * m_pdfDocument->GetScaleFactor() * 25.4/72.0);
+    h = wxRound(m_templateHeight * m_pdfDocument->GetScaleFactor() * 25.4/72.0);
+  }
+  else
+  {
+    wxPaperSize id = m_printData.GetPaperId();
+    wxPrintPaperType *paper = wxThePrintPaperDatabase->FindPaperType(id);
+    if (!paper) paper = wxThePrintPaperDatabase->FindPaperType(wxPAPER_A4);
+
+    w = 210;
+    h = 297;
+    if (paper)
+    {
+      w = paper->GetWidth() / 10;
+      h = paper->GetHeight() / 10;
+    }
+ 
+    if (m_printData.GetOrientation() == wxLANDSCAPE)
+    {
+      int tmp = w;
+      w = h;
+      h = tmp;
+    }
+  }
+
+  if (width)
+  {
+    *width = w;
+  }
+
+  if (height)
+  {
+    *height = h;
+  }
 }
 
 void
-wxPdfDC::DoDrawLines(int n, wxPoint points[],
-                     wxCoord xoffset, wxCoord yoffset)
+wxPdfDC::DoDrawLines(int n, wxPoint points[], wxCoord xoffset, wxCoord yoffset)
 {
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
   SetupPen();
@@ -932,8 +992,8 @@
   for (i = 0; i < n; ++i)
   {
     wxPoint& point = points[i];
-    double xx = ScaleToPdf(LogicalToDeviceX(xoffset + point.x));
-    double yy = ScaleToPdf(LogicalToDeviceY(yoffset + point.y));
+    double xx = ScaleLogicalToPdfX(xoffset + point.x);
+    double yy = ScaleLogicalToPdfY(yoffset + point.y);
     CalcBoundingBox(point.x+xoffset, point.y+yoffset);
     if (i == 0)
     {
@@ -961,8 +1021,8 @@
   for (i = 0; i < n; ++i)
   {
     wxPoint& point = points[i];
-    xp.Add(ScaleToPdf(LogicalToDeviceX(xoffset + point.x)));
-    yp.Add(ScaleToPdf(LogicalToDeviceY(yoffset + point.y)));
+    xp.Add(ScaleLogicalToPdfX(xoffset + point.x));
+    yp.Add(ScaleLogicalToPdfY(yoffset + point.y));
     CalcBoundingBox(point.x + xoffset, point.y + yoffset);
   }
   int saveFillingRule = m_pdfDocument->GetFillingRule();
@@ -995,8 +1055,8 @@
       for (i = 0; i < count[j]; ++i)
       {
         wxPoint& point = points[ofs+i];
-        xp.Add(ScaleToPdf(LogicalToDeviceX(xoffset + point.x)));
-        yp.Add(ScaleToPdf(LogicalToDeviceY(yoffset + point.y)));
+        xp.Add(ScaleLogicalToPdfX(xoffset + point.x));
+        yp.Add(ScaleLogicalToPdfY(yoffset + point.y));
         CalcBoundingBox(point.x + xoffset, point.y + yoffset);
       }
       m_pdfDocument->Polygon(xp, yp, style);
@@ -1029,10 +1089,10 @@
   m_clipY2 = (int) (y + height);
 
   // Use the current path as a clipping region
-  m_pdfDocument->ClippingRect(ScaleToPdf(LogicalToDeviceX(x)), 
-                              ScaleToPdf(LogicalToDeviceY(y)), 
-                              ScaleToPdf(LogicalToDeviceXRel(width)), 
-                              ScaleToPdf(LogicalToDeviceYRel(height)));
+  m_pdfDocument->ClippingRect(ScaleLogicalToPdfX(x), 
+                              ScaleLogicalToPdfY(y), 
+                              ScaleLogicalToPdfXRel(width), 
+                              ScaleLogicalToPdfYRel(height));
   m_clipping = true;
 }
 
@@ -1044,9 +1104,7 @@
                          wxFont* theFont) const
 {
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
-  // TODO
-  wxUnusedVar(externalLeading);
-  wxFont* fontToUse = theFont;
+  const wxFont* fontToUse = theFont;
   if (!fontToUse)
   {
     fontToUse = const_cast<wxFont*>(&m_font);
@@ -1056,27 +1114,64 @@
   {
     wxFont old = m_font;
     const_cast<wxPdfDC*>(this)->SetFont(*fontToUse);
+    wxPdfFontDescription desc = const_cast<wxPdfDC*>(this)->m_pdfDocument->GetFontDescription();
+    int myAscent, myDescent, myHeight, myExtLeading;
+    CalculateFontMetrics(&desc, fontToUse->GetPointSize(), &myHeight, &myAscent, &myDescent, &myExtLeading);
+
     if (descent)
     {
-      *descent = DeviceToLogicalYRel(m_pdfDocument->GetFontSize() * (m_pdfDocument->GetFontDescription().GetDescent() / 1000.0));
+      *descent = abs(myDescent);
+    }
+    if (externalLeading)
+    {
+      *externalLeading = myExtLeading;
     }
-    *x = DeviceToLogicalXRel(const_cast<wxPdfDC*>(this)->m_pdfDocument->GetStringWidth(text));
-    *y = DeviceToLogicalYRel(GetCharHeight());
+    *x = ScalePdfToFontMetric((double) const_cast<wxPdfDC*>(this)->m_pdfDocument->GetStringWidth(text));
+    *y = myHeight;
     const_cast<wxPdfDC*>(this)->SetFont(old);
   }
   else
   {
     *x = *y = 0;
+    if (descent)
+    {
+      *descent = 0;
+    }
+    if( externalLeading )
+    {
+      *externalLeading = 0;
+    }
   }
 }
 
 bool
 wxPdfDC::DoGetPartialTextExtents(const wxString& text, wxArrayInt& widths) const
 {
-  // Not yet implemented
-  wxUnusedVar(text);
-  wxUnusedVar(widths);
-  return false;
+  wxCHECK_MSG( m_pdfDocument, false, wxT("wxPdfDC::DoGetPartialTextExtents - invalid DC") );
+
+  /// very slow - but correct ??
+  const size_t len = text.length();
+  if (len == 0)
+  {
+    return true;
+  }
+    
+  widths.Empty();
+  widths.Add(0, len);
+  int w, h;
+    
+  wxString buffer;
+  buffer.Alloc(len);
+
+  for (size_t i = 0; i < len; ++i)
+  {
+    buffer.Append(text.Mid(i, 1));
+    DoGetTextExtent(buffer, &w, &h);
+    widths[i] = w;
+  }
+    
+  buffer.Clear();
+  return true;
 }
 
 void
@@ -1094,7 +1189,7 @@
                              curPen.GetColour().Blue()));
     if (curPen.GetWidth())
     {
-      style.SetWidth(ScaleToPdf(LogicalToDeviceXRel(curPen.GetWidth())));
+      style.SetWidth(ScaleLogicalToPdfXRel(curPen.GetWidth()));
     }
     switch (curPen.GetStyle())
     {
@@ -1132,7 +1227,7 @@
   else
   {
     m_pdfDocument->SetDrawColour(0, 0, 0);
-    m_pdfDocument->SetLineWidth(ScaleToPdf(LogicalToDeviceXRel(1.0)));
+    m_pdfDocument->SetLineWidth(ScaleLogicalToPdfXRel(1.0));
   }
 }
 
@@ -1177,7 +1272,137 @@
 }
 
 double
-wxPdfDC::ScaleToPdf(wxCoord x) const
+wxPdfDC::ScaleLogicalToPdfX(wxCoord x) const
+{
+  double docScale = 72.0 / (m_ppi * m_pdfDocument->GetScaleFactor());
+  return docScale * (((double)((x - m_logicalOriginX) * m_signX) * m_scaleX) + m_deviceOriginX);
+}
+  
+double
+wxPdfDC::ScaleLogicalToPdfXRel(wxCoord x) const
+{
+  double docScale = 72.0 / (m_ppi * m_pdfDocument->GetScaleFactor());
+  return (double)(x) * m_scaleX * docScale;
+}
+
+double
+wxPdfDC::ScaleLogicalToPdfY(wxCoord y) const
+{
+  double docScale = 72.0 / (m_ppi * m_pdfDocument->GetScaleFactor());
+  return docScale * (((double)((y - m_logicalOriginY) * m_signY) * m_scaleY) + m_deviceOriginY);
+}
+ 
+double
+wxPdfDC::ScaleLogicalToPdfYRel(wxCoord y) const
+{
+  double docScale = 72.0 / (m_ppi * m_pdfDocument->GetScaleFactor());
+  return (double) (y) * m_scaleY * docScale;
+}
+
+double
+wxPdfDC::ScaleFontSizeToPdf(int pointSize) const
+{
+  double fontScale;
+  double rval;
+  switch (m_mappingModeStyle)
+  {
+    case wxPDF_MAPMODESTYLE_MSW:
+      // as implemented in wxMSW
+      fontScale = (m_ppiPdfFont / m_ppi);
+      rval = (double) pointSize * fontScale * m_scaleY;
+      break;
+    case wxPDF_MAPMODESTYLE_GTK:
+      // as implemented in wxGTK / wxMAC / wxOSX
+      fontScale = (m_ppiPdfFont / m_ppi);
+      rval = (double) pointSize * fontScale * m_userScaleY;
+      break;
+    case wxPDF_MAPMODESTYLE_MAC:
+      // as implemented in wxGTK / wxMAC / wxOSX
+      fontScale = (m_ppiPdfFont / m_ppi);
+      rval = (double) pointSize * fontScale * m_userScaleY;
+      break;
+    case wxPDF_MAPMODESTYLE_PDF:
+      // an implementation where a font size of 12 gets a 12 point font if the
+      // mapping mode is wxMM_POINTS and suitable scaled for other modes
+      fontScale = (m_mappingMode == wxMM_TEXT) ? (m_ppiPdfFont / m_ppi) : (72.0 / m_ppi);
+      rval = (double) pointSize * fontScale * m_scaleY;
+      break;
+    default:
+      // standard and fall through
+#if defined(__WXMSW__)
+      fontScale = (m_ppiPdfFont / m_ppi);
+      rval = (double) pointSize * fontScale * m_scaleY;
+#else
+      fontScale = (m_ppiPdfFont / m_ppi);
+      rval = (double) pointSize * fontScale * m_userScaleY;
+#endif
+      break;
+  }
+  return rval;
+}
+
+int
+wxPdfDC::ScalePdfToFontMetric(double metric) const
+{
+  double fontScale = (72.0 / m_ppi) / (double) m_pdfDocument->GetScaleFactor();
+  return wxRound(((metric * m_signY) / m_scaleY ) / fontScale);
+}
+
+void
+wxPdfDC::CalculateFontMetrics(wxPdfFontDescription* desc, int pointSize,
+                              int* height, int* ascent, int* descent, int* extLeading) const
+{
+  double em_height, em_ascent, em_descent, em_externalLeading;
+  int hheaAscender, hheaDescender, hheaLineGap;
+
+  double size;
+  if ((m_mappingModeStyle == wxPDF_MAPMODESTYLE_PDF) && (m_mappingMode != wxMM_TEXT))
+  {
+    size = (double) pointSize;
+  }
+  else
+  {
+    size = (double) pointSize * (m_ppiPdfFont / 72.0);
+  }
+
+  int os2sTypoAscender, os2sTypoDescender, os2sTypoLineGap, os2usWinAscent, os2usWinDescent;
+
+  desc->GetOpenTypeMetrics(&hheaAscender, &hheaDescender, &hheaLineGap,
+                           &os2sTypoAscender, &os2sTypoDescender, &os2sTypoLineGap,
+                           &os2usWinAscent, &os2usWinDescent);
+
+  if (hheaAscender)
+  {
+    em_ascent  = os2usWinAscent;
+    em_descent = os2usWinDescent;
+    em_externalLeading = (hheaLineGap - ((em_ascent + em_descent) - (hheaAscender - hheaDescender)));
+    em_height = em_ascent + em_descent;
+  }
+  else
+  {
+    // magic numbers 1120 and 25 give reasonable defaults
+    // for core fonts etc.
+    // This may need adjustment for CJK fonts ??
+    em_height  = 1120;
+    em_descent = desc->GetDescent();
+    em_ascent  = em_height + em_descent;
+    em_externalLeading = 25;
+  }
+
+  if (ascent)
 {
-  return (double) x * (72. / m_ppi);
+    *ascent = wxRound(em_ascent * size / 1000.0);
+  }
+  if (descent)
+  {
+    *descent = wxRound(em_descent * size / 1000.0);
+  }
+  if (height)
+  {
+    *height = wxRound(em_height * size / 1000.0);
+  }
+  if (extLeading)
+  {
+    *extLeading = wxRound(em_externalLeading * size / 1000.0);
+  }
 }
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdfdc29.inc wxPdfDoc-copy/src/pdfdc29.inc
--- wxpdfdoc-0.9.2.1/src/pdfdc29.inc	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdfdc29.inc	2012-05-30 00:33:02.136700000 +0100
@@ -53,6 +53,24 @@
   ((wxPdfDCImpl*) m_pimpl)->SetResolution(ppi);
 }
 
+int
+wxPdfDC::GetResolution() const
+{
+  return ((wxPdfDCImpl*) m_pimpl)->GetResolution();
+}
+
+void
+wxPdfDC::SetMapModeStyle(wxPdfMapModeStyle style)
+{
+  ((wxPdfDCImpl*) m_pimpl)->SetMapModeStyle(style);
+}
+
+wxPdfMapModeStyle
+wxPdfDC::GetMapModeStyle() const
+{
+  return ((wxPdfDCImpl*) m_pimpl)->GetMapModeStyle();
+}
+
 static double
 angleByCoords(wxCoord xa, wxCoord ya, wxCoord xc, wxCoord yc)
 {
@@ -117,7 +135,10 @@
 {
   if (m_pdfDocument != NULL)
   {
-    EndDoc();
+    if (!m_templateMode)
+    {
+      delete m_pdfDocument;
+    }
   }
 }
 
@@ -129,6 +150,10 @@
   m_pdfDocument = NULL;
   m_imageCount = 0;
 
+  wxScreenDC screendc;
+  m_ppiPdfFont = screendc.GetPPI().GetHeight();
+  m_mappingModeStyle = wxPDF_MAPMODESTYLE_STANDARD;
+
   SetBackgroundMode(wxSOLID);
   
   m_printData.SetOrientation(wxPORTRAIT);
@@ -181,7 +206,7 @@
   {
     m_pdfDocument = new wxPdfDocument(m_printData.GetOrientation(), wxString(wxT("pt")), m_printData.GetPaperId());
     m_pdfDocument->Open();
-    m_pdfDocument->SetCompression(false);
+    //m_pdfDocument->SetCompression(false);
     m_pdfDocument->SetAuthor(wxT("wxPdfDC"));
     m_pdfDocument->SetTitle(wxT("wxPdfDC"));
 
@@ -269,32 +294,36 @@
 
   if (ok)
   {
-    // TODO: point size adjustment is not always reliable
-    double size = (double) font.GetPointSize() * GetFontPointSizeAdjustment(72.0) * 4./3.;
-    ok = m_pdfDocument->SetFont(regFont, styles, ScaleToPdf(LogicalToDeviceXRel(size) * m_pdfDocument->GetScaleFactor()));
+    ok = m_pdfDocument->SetFont(regFont, styles, ScaleFontSizeToPdf(font.GetPointSize()));    
   }
 }
 
 void
 wxPdfDCImpl::SetPen(const wxPen& pen)
 {
-  if (!pen.Ok()) return;
+  if (pen.Ok())
+  {
   m_pen = pen;
 }
+}
 
 void
 wxPdfDCImpl::SetBrush(const wxBrush& brush)
 {
-  if (!brush.Ok()) return;
+  if (brush.Ok())
+  {
   m_brush = brush;
 }
+}
 
 void
 wxPdfDCImpl::SetBackground(const wxBrush& brush)
 {
-  if (!brush.Ok()) return;
+  if (brush.Ok())
+  {
   m_backgroundBrush = brush;
 }
+}
 
 void
 wxPdfDCImpl::SetBackgroundMode(int mode)
@@ -311,6 +340,15 @@
 }
 
 void
+wxPdfDCImpl::SetTextForeground(const wxColour& colour)
+{
+  if (colour.IsOk())
+  {
+    m_textForegroundColour = colour;
+  }
+}
+
+void
 wxPdfDCImpl::DestroyClippingRegion()
 {
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
@@ -333,10 +371,12 @@
 wxCoord
 wxPdfDCImpl::GetCharHeight() const
 {
-  wxCoord height = 12;
+  // default for 12 point font
+  int height = 18;
+  int width;
   if (m_font.Ok())
   {
-    height = m_font.GetPointSize();
+    DoGetTextExtent("x", &width, &height);
   }
   return height;
 }
@@ -344,8 +384,13 @@
 wxCoord
 wxPdfDCImpl::GetCharWidth() const
 {
-  // Chris Breeze: reasonable approximation using wxMODERN/Courier
-  return (wxCoord) (GetCharHeight() * 72.0 / 120.0);
+  int height;
+  int width = 8;
+  if (m_font.Ok())
+  {
+    DoGetTextExtent("x", &width, &height);
+  }
+  return width;
 }
 
 bool
@@ -375,6 +420,13 @@
 }
 
 void
+wxPdfDCImpl::ComputeScaleAndOrigin()
+{
+  m_scaleX = m_logicalScaleX * m_userScaleX;
+  m_scaleY = m_logicalScaleY * m_userScaleY;
+}
+
+void
 wxPdfDCImpl::SetMapMode(wxMappingMode mode)
 {
   m_mappingMode = mode;
@@ -505,8 +557,8 @@
 {
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
   SetupPen();
-  double xx = ScaleToPdf(LogicalToDeviceX(x));
-  double yy = ScaleToPdf(LogicalToDeviceY(y));
+  double xx = ScaleLogicalToPdfX(x);
+  double yy = ScaleLogicalToPdfY(y);
   m_pdfDocument->SetFillColour(m_pdfDocument->GetDrawColour());
   m_pdfDocument->Rect(xx-0.5, yy-0.5, xx+0.5, yy+0.5);
   CalcBoundingBox(x, y);
@@ -528,8 +580,8 @@
   while (node)
   {
     p = (wxPoint *)node->GetData();
-    xp.Add(ScaleToPdf(LogicalToDeviceX(p->x)));
-    yp.Add(ScaleToPdf(LogicalToDeviceY(p->y)));
+    xp.Add(ScaleLogicalToPdfX(p->x));
+    yp.Add(ScaleLogicalToPdfY(p->y));
     node = node->GetNext();
   }
   m_pdfDocument->BezierSpline(xp, yp, wxPDF_STYLE_DRAW);
@@ -556,15 +608,15 @@
   wxList::compatibility_iterator node = points->GetFirst();
   wxPoint* p = (wxPoint*) node->GetData();
 
-  x1 = ScaleToPdf(LogicalToDeviceX(p->x));
-  y1 = ScaleToPdf(LogicalToDeviceY(p->y));
+  x1 = ScaleLogicalToPdfX(p->x);
+  y1 = ScaleLogicalToPdfY(p->y);
   m_pdfDocument->MoveTo(x1, y1);
 
   node = node->GetNext();
   p = (wxPoint*) node->GetData();
 
-  bx1 = x2 = ScaleToPdf(LogicalToDeviceX(p->x));
-  by1 = y2 = ScaleToPdf(LogicalToDeviceY(p->y));
+  bx1 = x2 = ScaleLogicalToPdfX(p->x);
+  by1 = y2 = ScaleLogicalToPdfY(p->y);
   cx1 = ( x1 + x2 ) / 2;
   cy1 = ( y1 + y2 ) / 2;
   bx3 = bx2 = cx1;
@@ -580,8 +632,8 @@
     p = (wxPoint*) node->GetData();
     x1 = x2;
     y1 = y2;
-    x2 = ScaleToPdf(LogicalToDeviceX(p->x));
-    y2 = ScaleToPdf(LogicalToDeviceY(p->y));
+    x2 = ScaleLogicalToPdfX(p->x);
+    y2 = ScaleLogicalToPdfY(p->y);
     cx4 = (x1 + x2) / 2;
     cy4 = (y1 + y2) / 2;
     // B0 is B3 of previous segment
@@ -616,8 +668,8 @@
   {
     SetupBrush();
     SetupPen();
-    m_pdfDocument->Line(ScaleToPdf(LogicalToDeviceX(x1)), ScaleToPdf(LogicalToDeviceY(y1)), 
-                        ScaleToPdf(LogicalToDeviceX(x2)), ScaleToPdf(LogicalToDeviceY(y2)));
+    m_pdfDocument->Line(ScaleLogicalToPdfX(x1), ScaleLogicalToPdfY(y1), 
+                        ScaleLogicalToPdfX(x2), ScaleLogicalToPdfY(y2));
     CalcBoundingBox(x1, y1);
     CalcBoundingBox(x2, y2);
   }
@@ -645,12 +697,12 @@
     double yyc = yc;
     double start = angleByCoords(xx1, yy1, xxc, yyc);
     double end   = angleByCoords(xx2, yy2, xxc, yyc);
-    xx1 = ScaleToPdf(LogicalToDeviceX(xx1));
-    yy1 = ScaleToPdf(LogicalToDeviceY(yy1));
-    xx2 = ScaleToPdf(LogicalToDeviceX(xx2));
-    yy2 = ScaleToPdf(LogicalToDeviceY(yy2));
-    xxc = ScaleToPdf(LogicalToDeviceX(xxc));
-    yyc = ScaleToPdf(LogicalToDeviceY(yyc));
+    xx1 = ScaleLogicalToPdfX(xx1);
+    yy1 = ScaleLogicalToPdfY(yy1);
+    xx2 = ScaleLogicalToPdfX(xx2);
+    yy2 = ScaleLogicalToPdfY(yy2);
+    xxc = ScaleLogicalToPdfX(xxc);
+    yyc = ScaleLogicalToPdfY(yyc);
     double rx = xx1 - xxc;
     double ry = yy1 - yyc;
     double r = sqrt(rx * rx + ry * ry);
@@ -659,7 +711,7 @@
     {
       style = (doFill) ? wxPDF_STYLE_FILL : wxPDF_STYLE_DRAW;
     }
-    m_pdfDocument->Sector(xxc, yyc, r, start, end, style, false, 0.0);
+    m_pdfDocument->Ellipse(xxc, yyc, r, 0, 0, start, end, style, 8, false);
     wxCoord radius = (wxCoord) sqrt( (double)((x1-xc)*(x1-xc)+(y1-yc)*(y1-yc)) );
     CalcBoundingBox(xc-radius, yc-radius);
     CalcBoundingBox(xc+radius, yc+radius);
@@ -709,16 +761,16 @@
     bool doDraw = (curPen != wxNullPen) && curPen.GetStyle() != wxTRANSPARENT;
     if (doDraw || doFill)
     {
-      m_pdfDocument->SetLineWidth(ScaleToPdf(LogicalToDeviceXRel(1))); // pen width != 1 sometimes fools readers when closing paths
+      m_pdfDocument->SetLineWidth(ScaleLogicalToPdfXRel(1)); // pen width != 1 sometimes fools readers when closing paths
       int style = wxPDF_STYLE_FILL | wxPDF_STYLE_DRAWCLOSE;
       if (!(doDraw && doFill))
       {
         style = (doFill) ? wxPDF_STYLE_FILL : wxPDF_STYLE_DRAWCLOSE;
       }
-      m_pdfDocument->Ellipse(ScaleToPdf(LogicalToDeviceX(x + 0.5 * width)), 
-                            ScaleToPdf(LogicalToDeviceY(y + 0.5 * height)),
-                            ScaleToPdf(LogicalToDeviceXRel(0.5 * width)), 
-                            ScaleToPdf(LogicalToDeviceYRel(0.5 * height)), 
+      m_pdfDocument->Ellipse(ScaleLogicalToPdfX(x + 0.5 * width), 
+                             ScaleLogicalToPdfY(y + 0.5 * height),
+                             ScaleLogicalToPdfXRel(0.5 * width), 
+                             ScaleLogicalToPdfYRel(0.5 * height), 
                             0, sa, ea, style, 8, true);
       CalcBoundingBox(x, y);
       CalcBoundingBox(x+width, y+height);
@@ -732,8 +784,8 @@
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
   SetupBrush();
   SetupPen();
-  m_pdfDocument->Rect(ScaleToPdf(LogicalToDeviceX(x)), ScaleToPdf(LogicalToDeviceY(y)),
-                      ScaleToPdf(LogicalToDeviceXRel(width)), ScaleToPdf(LogicalToDeviceYRel(height)), 
+  m_pdfDocument->Rect(ScaleLogicalToPdfX(x), ScaleLogicalToPdfY(y),
+                      ScaleLogicalToPdfXRel(width), ScaleLogicalToPdfYRel(height), 
                       GetDrawingStyle()); 
   CalcBoundingBox(x, y);
   CalcBoundingBox(x+width, y+height);
@@ -754,9 +806,9 @@
   }
   SetupBrush();
   SetupPen();
-  m_pdfDocument->RoundedRect(ScaleToPdf(LogicalToDeviceX(x)), ScaleToPdf(LogicalToDeviceY(y)), 
-                             ScaleToPdf(LogicalToDeviceXRel(width)), ScaleToPdf(LogicalToDeviceYRel(height)), 
-                             ScaleToPdf(LogicalToDeviceXRel(radius)), wxPDF_CORNER_ALL, GetDrawingStyle());  
+  m_pdfDocument->RoundedRect(ScaleLogicalToPdfX(x), ScaleLogicalToPdfY(y), 
+                             ScaleLogicalToPdfXRel(width), ScaleLogicalToPdfYRel(height), 
+                             ScaleLogicalToPdfXRel(radius), wxPDF_CORNER_ALL, GetDrawingStyle());  
   CalcBoundingBox(x, y);
   CalcBoundingBox(x+width, y+height);
 }
@@ -767,10 +819,10 @@
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
   SetupBrush();
   SetupPen();
-  m_pdfDocument->Ellipse(ScaleToPdf(LogicalToDeviceX(x + width / 2.0)), 
-                         ScaleToPdf(LogicalToDeviceY(y + height / 2.0)), 
-                         ScaleToPdf(LogicalToDeviceXRel(width / 2.0)), 
-                         ScaleToPdf(LogicalToDeviceYRel(height / 2.0)), 
+  m_pdfDocument->Ellipse(ScaleLogicalToPdfX(x + width / 2.0), 
+                         ScaleLogicalToPdfY(y + height / 2.0), 
+                         ScaleLogicalToPdfXRel(width / 2.0), 
+                         ScaleLogicalToPdfYRel(height / 2.0), 
                          0, 0, 360, GetDrawingStyle()); 
   CalcBoundingBox(x-width, y-height);
   CalcBoundingBox(x+width, y+height);
@@ -810,11 +862,11 @@
   wxCoord w = image.GetWidth();
   wxCoord h = image.GetHeight();
 
-  wxCoord ww = ScaleToPdf(LogicalToDeviceXRel(w));
-  wxCoord hh = ScaleToPdf(LogicalToDeviceYRel(h));
+  wxCoord ww = ScaleLogicalToPdfXRel(w);
+  wxCoord hh = ScaleLogicalToPdfYRel(h);
 
-  wxCoord xx = ScaleToPdf(LogicalToDeviceX(x));
-  wxCoord yy = ScaleToPdf(LogicalToDeviceY(y));
+  wxCoord xx = ScaleLogicalToPdfX(x);
+  wxCoord yy = ScaleLogicalToPdfY(y);
 
   wxString imgName = wxString::Format(wxT("pdfdcimg%d"), ++m_imageCount);
 
@@ -846,21 +898,25 @@
 wxPdfDCImpl::DoDrawRotatedText(const wxString& text, wxCoord x, wxCoord y, double angle)
 {
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
+
   wxFont* fontToUse = &m_font;
   if (!fontToUse->IsOk())
   {
     return;
   }
-#ifdef wx_msw
-  y += m_pdfDocument->GetFontSize();
-#else
-  y += 0.8f * GetCharHeight();
-#endif
   wxFont old = m_font; 
+
+  wxPdfFontDescription desc = m_pdfDocument->GetFontDescription();
+  int height, descent;
+  CalculateFontMetrics(&desc, fontToUse->GetPointSize(), &height, NULL, &descent, NULL);
+  if (m_mappingModeStyle != wxPDF_MAPMODESTYLE_PDF)
+  {
+    y += (height - abs(descent));
+  }
+
   m_pdfDocument->SetTextColour(m_textForegroundColour.Red(), m_textForegroundColour.Green(), m_textForegroundColour.Blue());
-  double size = (double) m_font.GetPointSize() * GetFontPointSizeAdjustment(72.0) * 4./3.;
-  m_pdfDocument->SetFontSize(ScaleToPdf(LogicalToDeviceXRel(size)) * m_pdfDocument->GetScaleFactor());
-  m_pdfDocument->RotatedText(ScaleToPdf(LogicalToDeviceX(x)), ScaleToPdf(LogicalToDeviceY(y)), text, angle);
+  m_pdfDocument->SetFontSize(ScaleFontSizeToPdf(fontToUse->GetPointSize()));
+  m_pdfDocument->RotatedText(ScaleLogicalToPdfX(x), ScaleLogicalToPdfY(y), text, angle);
   SetFont(old);
 }
 
@@ -904,9 +960,7 @@
   else
   {
     wxPaperSize id = m_printData.GetPaperId();
-
     wxPrintPaperType *paper = wxThePrintPaperDatabase->FindPaperType(id);
-
     if (!paper) paper = wxThePrintPaperDatabase->FindPaperType(wxPAPER_A4);
 
     w = 595;
@@ -939,14 +993,21 @@
 void
 wxPdfDCImpl::DoGetSizeMM(int* width, int* height) const
 {
+  int w;
+  int h;
+  if (m_templateMode)
+  {
+    w = wxRound(m_templateWidth * m_pdfDocument->GetScaleFactor() * 25.4/72.0);
+    h = wxRound(m_templateHeight * m_pdfDocument->GetScaleFactor() * 25.4/72.0);
+  }
+  else
+  {
   wxPaperSize id = m_printData.GetPaperId();
-
   wxPrintPaperType *paper = wxThePrintPaperDatabase->FindPaperType(id);
-
   if (!paper) paper = wxThePrintPaperDatabase->FindPaperType(wxPAPER_A4);
 
-  int w = 210;
-  int h = 297;
+    w = 210;
+    h = 297;
   if (paper)
   {
     w = paper->GetWidth() / 10;
@@ -959,9 +1020,15 @@
     w = h;
     h = tmp;
   }
-
-  if (width) *width = w;
-  if (height) *height = h;
+  }
+  if (width)
+  {
+    *width = w;
+  }
+  if (height)
+  {
+    *height = h;
+  }
 }
 
 void
@@ -973,8 +1040,8 @@
   for (i = 0; i < n; ++i)
   {
     wxPoint& point = points[i];
-    double xx = ScaleToPdf(LogicalToDeviceX(xoffset + point.x));
-    double yy = ScaleToPdf(LogicalToDeviceY(yoffset + point.y));
+    double xx = ScaleLogicalToPdfX(xoffset + point.x);
+    double yy = ScaleLogicalToPdfY(yoffset + point.y);
     CalcBoundingBox(point.x+xoffset, point.y+yoffset);
     if (i == 0)
     {
@@ -1002,8 +1069,8 @@
   for (i = 0; i < n; ++i)
   {
     wxPoint& point = points[i];
-    xp.Add(ScaleToPdf(LogicalToDeviceX(xoffset + point.x)));
-    yp.Add(ScaleToPdf(LogicalToDeviceY(yoffset + point.y)));
+    xp.Add(ScaleLogicalToPdfX(xoffset + point.x));
+    yp.Add(ScaleLogicalToPdfY(yoffset + point.y));
     CalcBoundingBox(point.x + xoffset, point.y + yoffset);
   }
   int saveFillingRule = m_pdfDocument->GetFillingRule();
@@ -1036,8 +1103,8 @@
       for (i = 0; i < count[j]; ++i)
       {
         wxPoint& point = points[ofs+i];
-        xp.Add(ScaleToPdf(LogicalToDeviceX(xoffset + point.x)));
-        yp.Add(ScaleToPdf(LogicalToDeviceY(yoffset + point.y)));
+        xp.Add(ScaleLogicalToPdfX(xoffset + point.x));
+        yp.Add(ScaleLogicalToPdfY(yoffset + point.y));
         CalcBoundingBox(point.x + xoffset, point.y + yoffset);
       }
       m_pdfDocument->Polygon(xp, yp, style);
@@ -1069,18 +1136,20 @@
   m_clipY2 = (int) (y + height);
 
   // Use the current path as a clipping region
-  m_pdfDocument->ClippingRect(ScaleToPdf(LogicalToDeviceX(x)), 
-                             ScaleToPdf(LogicalToDeviceY(y)), 
-                             ScaleToPdf(LogicalToDeviceXRel(width)), 
-                             ScaleToPdf(LogicalToDeviceYRel(height)));
+  m_pdfDocument->ClippingRect(ScaleLogicalToPdfX(x), 
+                              ScaleLogicalToPdfY(y), 
+                              ScaleLogicalToPdfXRel(width), 
+                              ScaleLogicalToPdfYRel(height));
   m_clipping = true;
 }
 
 void
 wxPdfDCImpl::DoSetDeviceClippingRegion(const wxRegion& region)
 {
-  wxUnusedVar(region);
-  wxFAIL_MSG(wxString(wxT("wxPdfDCImpl::DoSetDeviceClippingRegion: "))+_("Not implemented."));
+  wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
+  wxCoord x, y, w, h;
+  region.GetBox(x, y, w, h);
+  DoSetClippingRegion(DeviceToLogicalX(x), DeviceToLogicalY(y), DeviceToLogicalXRel(w), DeviceToLogicalYRel(h));
 }
 
 void
@@ -1091,8 +1160,7 @@
                          const wxFont* theFont) const
 {
   wxCHECK_RET(m_pdfDocument, wxT("Invalid PDF DC"));
-  // TODO
-  wxUnusedVar(externalLeading);
+
   const wxFont* fontToUse = theFont;
   if (!fontToUse)
   {
@@ -1102,21 +1170,69 @@
   if (fontToUse)
   {
     wxFont old = m_font;
+    
     const_cast<wxPdfDCImpl*>(this)->SetFont(*fontToUse);
+    wxPdfFontDescription desc = const_cast<wxPdfDCImpl*>(this)->m_pdfDocument->GetFontDescription();
+    int myAscent, myDescent, myHeight, myExtLeading;
+    CalculateFontMetrics(&desc, fontToUse->GetPointSize(), &myHeight, &myAscent, &myDescent, &myExtLeading);
+
     if (descent)
     {
-      *descent = DeviceToLogicalYRel(m_pdfDocument->GetFontSize() * (m_pdfDocument->GetFontDescription().GetDescent() / 1000.0));
+      *descent = abs(myDescent);
     }
-    *x = DeviceToLogicalXRel(const_cast<wxPdfDCImpl*>(this)->m_pdfDocument->GetStringWidth(text));
-    *y = DeviceToLogicalYRel(GetCharHeight());
+    if( externalLeading )
+    {
+      *externalLeading = myExtLeading;
+    }
+    *x = ScalePdfToFontMetric((double)const_cast<wxPdfDCImpl*>(this)->m_pdfDocument->GetStringWidth(text));
+    *y = myHeight;
     const_cast<wxPdfDCImpl*>(this)->SetFont(old);
   }
   else
   {
     *x = *y = 0;
+    if (descent)
+    {
+      *descent = 0;
+    }
+    if (externalLeading)
+    {
+      *externalLeading = 0;
+    }
   }
 }
 
+bool
+wxPdfDCImpl::DoGetPartialTextExtents(const wxString& text, wxArrayInt& widths) const
+{
+  wxCHECK_MSG( m_pdfDocument, false, wxT("wxPdfDCImpl::DoGetPartialTextExtents - invalid DC") );
+    
+  /// very slow - but correct ??
+    
+  const size_t len = text.length();
+  if (len == 0)
+  {
+    return true;
+  }
+    
+  widths.Empty();
+  widths.Add(0, len);
+  int w, h;
+    
+  wxString buffer;
+  buffer.Alloc(len);
+
+  for ( size_t i = 0; i < len; ++i )
+  {
+    buffer.Append(text.Mid( i, 1));
+    DoGetTextExtent(buffer, &w, &h);
+    widths[i] = w;
+  }
+
+  buffer.Clear();
+  return true;
+}
+
 void
 wxPdfDCImpl::SetupPen()
 {
@@ -1132,7 +1248,7 @@
                              curPen.GetColour().Blue()));
     if (curPen.GetWidth())
     {
-      style.SetWidth(ScaleToPdf(LogicalToDeviceXRel(curPen.GetWidth())));
+      style.SetWidth(ScaleLogicalToPdfXRel(curPen.GetWidth()));
     }
     switch (curPen.GetStyle())
     {
@@ -1170,7 +1286,7 @@
   else
   {
     m_pdfDocument->SetDrawColour(0, 0, 0);
-    m_pdfDocument->SetLineWidth(ScaleToPdf(LogicalToDeviceXRel(1.0)));
+    m_pdfDocument->SetLineWidth(ScaleLogicalToPdfXRel(1.0));
   }
 }
 
@@ -1215,7 +1331,139 @@
 }
 
 double
-wxPdfDCImpl::ScaleToPdf(wxCoord x) const
+wxPdfDCImpl::ScaleLogicalToPdfX(wxCoord x) const
+{
+  double docScale = 72.0 / (m_ppi * m_pdfDocument->GetScaleFactor());
+  return docScale * (((double)((x - m_logicalOriginX) * m_signX) * m_scaleX) +
+         m_deviceOriginX + m_deviceLocalOriginX);
+}
+
+double
+wxPdfDCImpl::ScaleLogicalToPdfXRel(wxCoord x) const
+{
+  double docScale = 72.0 / (m_ppi * m_pdfDocument->GetScaleFactor());
+  return (double)(x) * m_scaleX * docScale;
+}
+
+double
+wxPdfDCImpl::ScaleLogicalToPdfY(wxCoord y) const
+{
+  double docScale = 72.0 / (m_ppi * m_pdfDocument->GetScaleFactor());
+  return docScale * (((double)((y - m_logicalOriginY) * m_signY) * m_scaleY) + 
+         m_deviceOriginY + m_deviceLocalOriginY);
+}
+ 
+double
+wxPdfDCImpl::ScaleLogicalToPdfYRel(wxCoord y) const
+{
+  double docScale = 72.0 / (m_ppi * m_pdfDocument->GetScaleFactor());
+  return (double)(y) * m_scaleY * docScale;
+}
+
+double
+wxPdfDCImpl::ScaleFontSizeToPdf(int pointSize) const
+{
+  double fontScale;
+  double rval;
+  switch (m_mappingModeStyle)
+  {
+    case wxPDF_MAPMODESTYLE_MSW:
+      // as implemented in wxMSW
+      fontScale = (m_ppiPdfFont / m_ppi);
+      rval = (double) pointSize * fontScale * m_scaleY;
+      break;
+    case wxPDF_MAPMODESTYLE_GTK:
+      // as implemented in wxGTK / wxMAC / wxOSX
+      fontScale = (m_ppiPdfFont / m_ppi);
+      rval = (double) pointSize * fontScale * m_userScaleY;
+      break;
+    case wxPDF_MAPMODESTYLE_MAC:
+      // as implemented in wxGTK / wxMAC / wxOSX
+      fontScale = (m_ppiPdfFont / m_ppi);
+      rval = (double) pointSize * fontScale * m_userScaleY;
+      break;
+    case wxPDF_MAPMODESTYLE_PDF:
+      // an implementation where a font size of 12 gets a 12 point font if the
+      // mapping mode is wxMM_POINTS and suitable scaled for other modes
+      fontScale = (m_mappingMode == wxMM_TEXT) ? (m_ppiPdfFont / m_ppi) : (72.0 / m_ppi);
+      rval = (double) pointSize * fontScale * m_scaleY;
+      break;
+    default:
+      // standard and fall through
+#if defined( __WXMSW__)
+      fontScale = (m_ppiPdfFont / m_ppi);
+      rval = (double) pointSize * fontScale * m_scaleY;
+#else
+      fontScale = (m_ppiPdfFont / m_ppi);
+      rval = (double) pointSize * fontScale * m_userScaleY;
+#endif
+      break;
+  }
+  return rval;
+}
+
+int
+wxPdfDCImpl::ScalePdfToFontMetric( double metric ) const
 {
-  return (double) x * (72. / m_ppi);
+  double fontScale = (72.0 / m_ppi) / (double)m_pdfDocument->GetScaleFactor();
+  return wxRound(((metric * m_signY) / m_scaleY ) / fontScale);
+}
+
+void
+wxPdfDCImpl::CalculateFontMetrics(wxPdfFontDescription* desc, int pointSize,
+                                  int* height, int* ascent, int* descent, int* extLeading) const
+{
+  double em_height, em_ascent, em_descent, em_externalLeading;
+  int hheaAscender, hheaDescender, hheaLineGap;
+
+  double size;
+  if ((m_mappingModeStyle == wxPDF_MAPMODESTYLE_PDF) && (m_mappingMode != wxMM_TEXT))
+  {
+    size = (double) pointSize;
+  }
+  else
+  {
+    size = (double) pointSize * (m_ppiPdfFont / 72.0);
+  }
+
+  int os2sTypoAscender, os2sTypoDescender, os2sTypoLineGap, os2usWinAscent, os2usWinDescent;
+
+  desc->GetOpenTypeMetrics(&hheaAscender, &hheaDescender, &hheaLineGap,
+                           &os2sTypoAscender, &os2sTypoDescender, &os2sTypoLineGap,
+                           &os2usWinAscent, &os2usWinDescent);
+
+  if (hheaAscender)
+  {
+    em_ascent  = os2usWinAscent;
+    em_descent = os2usWinDescent;
+    em_externalLeading = (hheaLineGap - ((em_ascent + em_descent) - (hheaAscender - hheaDescender)));
+    em_height = em_ascent + em_descent;
+  }
+  else
+  {
+    // magic numbers 1120 and 25 give reasonable defaults
+    // for core fonts etc.
+    // This may need adjustment for CJK fonts ??
+    em_height  = 1120;
+    em_descent = desc->GetDescent();
+    em_ascent  = em_height + em_descent;
+    em_externalLeading = 25;
+  }
+    
+  if (ascent)
+  {
+    *ascent = wxRound(em_ascent * size / 1000.0);
+  }
+  if (descent)
+  {
+    *descent = wxRound(em_descent * size / 1000.0);
+  }
+  if (height)
+  {
+    *height = wxRound(em_height * size / 1000.0);
+  }
+  if (extLeading)
+  {
+    *extLeading = wxRound(em_externalLeading * size / 1000.0);
+  }
 }
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdfdocument.cpp wxPdfDoc-copy/src/pdfdocument.cpp
--- wxpdfdoc-0.9.2.1/src/pdfdocument.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdfdocument.cpp	2012-05-24 15:25:27.905200000 +0100
@@ -41,13 +41,20 @@
 #include "wx/pdffontparser.h"
 #include "wx/pdfutility.h"
 
-#include "wxmemdbg.h"
+//#include "vld.h"
+
+#if WXPDFDOC_INHERIT_WXOBJECT
+IMPLEMENT_DYNAMIC_CLASS(wxPdfDocument, wxObject)
+#endif
 
 // ----------------------------------------------------------------------------
 // wxPdfDocument: class representing a PDF document
 // ----------------------------------------------------------------------------
 
 wxPdfDocument::wxPdfDocument(int orientation, const wxString& unit, wxPaperSize format)
+#if WXPDFDOC_INHERIT_WXOBJECT
+  : wxObject()
+#endif
 {
   m_yAxisOriginTop = true;
   SetScaleFactor(unit);
@@ -58,6 +65,9 @@
 }
 
 wxPdfDocument::wxPdfDocument(int orientation, double pageWidth, double pageHeight, const wxString& unit)
+#if WXPDFDOC_INHERIT_WXOBJECT
+  : wxObject()
+#endif
 {
   m_yAxisOriginTop = true;
   SetScaleFactor(unit);
@@ -157,6 +167,7 @@
   m_ocgs             = new wxPdfOcgMap();
   m_rgLayers         = new wxPdfLayerRGMap();
   m_lockedLayers     = NULL;
+  m_attachments      = new wxPdfAttachmentMap();
 
   m_outlineRoot      = -1;
   m_maxOutlineLevel  = 0;
@@ -454,6 +465,16 @@
     delete m_lockedLayers;
   }
 
+  wxPdfAttachmentMap::iterator attach;
+  for (attach = m_attachments->begin(); attach != m_attachments->end(); ++attach)
+  {
+    if (attach->second != NULL)
+    {
+      delete attach->second;
+    }
+  }
+  delete m_attachments;
+
   delete m_orientationChanges;
   delete m_pageSizes;
 
@@ -2247,6 +2268,35 @@
   m_javascript += javascript;
 }
 
+bool
+wxPdfDocument::AttachFile(const wxString& fileName, const wxString& attachName, const wxString& description)
+{
+  wxFileName attachFile(fileName);
+  bool ok = attachFile.FileExists();
+  if (ok)
+  {
+    wxArrayString* attachment = new wxArrayString();
+    attachment->Add(fileName);
+    if (!attachName.IsEmpty())
+    {
+      attachment->Add(attachName);
+    }
+    else
+    {
+      attachment->Add(attachFile.GetFullName());
+    }
+    attachment->Add(description);
+
+    int index = (int) (m_attachments->size() + 1);
+    (*m_attachments)[index] = attachment;
+  }
+  else
+  {
+    wxLogDebug(wxT("*** Attachment file '%s' does not exist."), fileName.c_str());
+  }
+  return ok;
+}
+
 // ---
 
 void
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdfencrypt.cpp wxPdfDoc-copy/src/pdfencrypt.cpp
--- wxpdfdoc-0.9.2.1/src/pdfencrypt.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdfencrypt.cpp	2012-05-22 01:23:12.714400000 +0100
@@ -441,6 +441,10 @@
   {
     m_documentId = CreateDocumentId();
   }
+  else
+  {
+    m_documentId = documentId;
+  }
   ComputeEncryptionKey(m_documentId, userpswd,
                        m_oValue, m_pValue, m_keyLength*8, m_rValue, m_uValue);
 }
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdffontdatacore.cpp wxPdfDoc-copy/src/pdffontdatacore.cpp
--- wxpdfdoc-0.9.2.1/src/pdffontdatacore.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdffontdatacore.cpp	2012-05-22 01:23:12.331400000 +0100
@@ -183,8 +183,7 @@
     wxString::const_iterator ch;
     for (ch = s.begin(); ch != s.end(); ++ch)
     {
-      wxUint32 cc = (unsigned char) (*ch);
-      charIter = (*convMap).find(cc);
+      charIter = (*convMap).find(*ch);
       if (charIter != (*convMap).end())
       {
 #if wxCHECK_VERSION(2,9,0)
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdffontdatatruetype.cpp wxPdfDoc-copy/src/pdffontdatatruetype.cpp
--- wxpdfdoc-0.9.2.1/src/pdffontdatatruetype.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdffontdatatruetype.cpp	2012-05-22 01:23:12.568400000 +0100
@@ -899,6 +899,14 @@
 
       // Assemble subset
       wxPdfFontSubsetTrueType subset(fontFullPath, 0, isMacCoreText);
+#if defined(__WXMAC__)
+#if wxPDFMACOSX_HAS_CORE_TEXT
+      if (m_font.IsOk())
+      {
+        subset.SetCTFontRef(m_font);
+      }
+#endif
+#endif
       wxMemoryOutputStream* subsetStream = subset.CreateSubset(fontStream, usedGlyphs, false);
       if (deleteFontStream && fontStream != NULL)
       {
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdffontdescription.cpp wxPdfDoc-copy/src/pdffontdescription.cpp
--- wxpdfdoc-0.9.2.1/src/pdffontdescription.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdffontdescription.cpp	2012-05-22 01:23:12.589400000 +0100
@@ -32,18 +32,27 @@
   : m_ascent(0), m_descent(0), m_capHeight(0), m_flags(0),
     m_fontBBox(wxEmptyString), m_italicAngle(0), m_stemV(0),
     m_missingWidth(0), m_xHeight(0),
-    m_underlinePosition(-100), m_underlineThickness(50)
+    m_underlinePosition(-100), m_underlineThickness(50),
+    m_hheaAscender(0), m_hheaDescender(0), m_hheaLineGap(0),
+    m_os2sTypoAscender(0), m_os2sTypoDescender(0), m_os2sTypoLineGap(0),
+    m_os2usWinAscent(0), m_os2usWinDescent(0)
 {
 }
 
 wxPdfFontDescription::wxPdfFontDescription (int ascent, int descent, int capHeight, int flags,
                                             const wxString& fontBBox, int italicAngle, int stemV,
                                             int missingWidth, int xHeight,
-                                            int underlinePosition, int underlineThickness)
+                                            int underlinePosition, int underlineThickness,
+                                            int hheaAscender, int hheaDescender, int hheaLineGap,
+                                            int os2sTypoAscender, int os2sTypoDescender, int os2sTypoLineGap,
+                                            int os2usWinAscent, int os2usWinDescent)
   : m_ascent(ascent), m_descent(descent), m_capHeight(capHeight), m_flags(flags),
     m_fontBBox(fontBBox), m_italicAngle(italicAngle), m_stemV(stemV),
     m_missingWidth(missingWidth), m_xHeight(xHeight),
-    m_underlinePosition(underlinePosition), m_underlineThickness(underlineThickness)
+    m_underlinePosition(underlinePosition), m_underlineThickness(underlineThickness),
+    m_hheaAscender(hheaAscender), m_hheaDescender(hheaDescender), m_hheaLineGap(hheaLineGap),
+    m_os2sTypoAscender(os2sTypoAscender), m_os2sTypoDescender(os2sTypoDescender), m_os2sTypoLineGap(os2sTypoLineGap),
+    m_os2usWinAscent(os2usWinAscent), m_os2usWinDescent(os2usWinDescent)
 {
 }
 
@@ -60,8 +69,108 @@
   m_xHeight            = desc.m_xHeight;
   m_underlinePosition  = desc.m_underlinePosition;
   m_underlineThickness = desc.m_underlineThickness;
+  m_hheaAscender       = desc.m_hheaAscender;
+  m_hheaDescender      = desc.m_hheaDescender;
+  m_hheaLineGap        = desc.m_hheaLineGap;
+  m_os2sTypoAscender   = desc.m_os2sTypoAscender;
+  m_os2sTypoDescender  = desc.m_os2sTypoDescender;
+  m_os2sTypoLineGap    = desc.m_os2sTypoLineGap;
+  m_os2usWinAscent     = desc.m_os2usWinAscent;
+  m_os2usWinDescent    = desc.m_os2usWinDescent;
 }
 
 wxPdfFontDescription::~wxPdfFontDescription()
 {
 }
+
+void
+wxPdfFontDescription::SetOpenTypeMetrics(int hheaAscender, int hheaDescender, int hheaLineGap,
+                                         int os2sTypoAscender, int os2sTypoDescender, int os2sTypoLineGap,
+                                         int os2usWinAscent, int os2usWinDescent)
+{
+  if (hheaAscender)
+  {
+    m_hheaAscender = hheaAscender;
+  }
+
+  if (hheaDescender)
+  {
+    m_hheaDescender = hheaDescender;
+  }
+
+  if (hheaLineGap)
+  {
+    m_hheaLineGap = hheaLineGap;
+  }
+
+  if (os2sTypoAscender)
+  {
+    m_os2sTypoAscender = os2sTypoAscender;
+  }
+
+  if (os2sTypoDescender)
+  {
+    m_os2sTypoDescender = os2sTypoDescender;
+  }
+
+  if (os2sTypoLineGap)
+  {
+    m_os2sTypoLineGap = os2sTypoLineGap;
+  }
+
+  if (os2usWinAscent)
+  {
+    m_os2usWinAscent = os2usWinAscent;
+  }
+
+  if (os2usWinDescent)
+  {
+    m_os2usWinDescent = os2usWinDescent;
+  }
+}
+
+void
+wxPdfFontDescription::GetOpenTypeMetrics(int* hheaAscender, int* hheaDescender, int* hheaLineGap,
+                                         int* os2sTypoAscender, int* os2sTypoDescender, int* os2sTypoLineGap,
+                                         int* os2usWinAscent, int* os2usWinDescent)
+{
+  if (hheaAscender)
+  {
+    *hheaAscender = m_hheaAscender;
+  }
+
+  if (hheaDescender)
+  {
+    *hheaDescender = m_hheaDescender;
+  }
+
+  if (hheaLineGap)
+  {
+    *hheaLineGap = m_hheaLineGap;
+  }
+
+  if (os2sTypoAscender)
+  {
+    *os2sTypoAscender = m_os2sTypoAscender;
+  }
+
+  if (os2sTypoDescender)
+  {
+    *os2sTypoDescender = m_os2sTypoDescender;
+  }
+
+  if (os2sTypoLineGap)
+  {
+    *os2sTypoLineGap = m_os2sTypoLineGap;
+  }
+
+  if (os2usWinAscent)
+  {
+    *os2usWinAscent = m_os2usWinAscent;
+  }
+
+  if (os2usWinDescent)
+  {
+    *os2usWinDescent = m_os2usWinDescent;
+  }
+}
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdffontparsertruetype.cpp wxPdfDoc-copy/src/pdffontparsertruetype.cpp
--- wxpdfdoc-0.9.2.1/src/pdffontparsertruetype.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdffontparsertruetype.cpp	2012-05-22 01:23:12.724400000 +0100
@@ -1152,6 +1152,7 @@
   wxPdfFontHeader head;
   wxPdfHorizontalHeader hhea;
   wxPdfWindowsMetrics os_2;
+  int realOS2TypoDescender;
 
   wxPdfTableDirectoryEntry* tableLocation;
   wxPdfTableDirectory::iterator entry = m_tableDirectory->find(wxT("head"));
@@ -1234,6 +1235,7 @@
     os_2.m_usLastCharIndex = ReadUShort();
     os_2.m_sTypoAscender = ReadShort();
     os_2.m_sTypoDescender = ReadShort();
+    realOS2TypoDescender = os_2.m_sTypoDescender;
     if (os_2.m_sTypoDescender > 0)
     {
       os_2.m_sTypoDescender = (short)(-os_2.m_sTypoDescender);
@@ -1259,6 +1261,16 @@
       os_2.m_sCapHeight = (int)(0.7 * head.m_unitsPerEm);
     }
     ReleaseTable();
+    m_fd.SetOpenTypeMetrics(
+      (int) (hhea.m_ascender      * 1000 / head.m_unitsPerEm),
+      (int) (hhea.m_descender     * 1000 / head.m_unitsPerEm),
+      (int) (hhea.m_lineGap       * 1000 / head.m_unitsPerEm),
+      (int) (os_2.m_sTypoAscender * 1000 / head.m_unitsPerEm),
+      (int) (realOS2TypoDescender * 1000 / head.m_unitsPerEm),
+      (int) (os_2.m_sTypoLineGap  * 1000 / head.m_unitsPerEm),
+      (int) (os_2.m_usWinAscent   * 1000 / head.m_unitsPerEm),
+      (int) (os_2.m_usWinDescent  * 1000 / head.m_unitsPerEm)
+    );
   }
   else
   {
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdffontsubsettruetype.cpp wxPdfDoc-copy/src/pdffontsubsettruetype.cpp
--- wxpdfdoc-0.9.2.1/src/pdffontsubsettruetype.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdffontsubsettruetype.cpp	2012-05-22 01:23:12.547400000 +0100
@@ -48,6 +48,22 @@
   delete [] m_locaTable;
 }
 
+#if defined(__WXMAC__)
+#if wxPDFMACOSX_HAS_CORE_TEXT
+
+void
+wxPdfFontSubsetTrueType::SetCTFontRef(const wxFont& font)
+{
+#if wxCHECK_VERSION(2,9,0)
+  m_fontRef = font.OSXGetCTFont();
+#else // wxWidgets 2.8.x
+  m_fontRef = (const void*) font.MacGetCTFont();
+#endif
+}
+
+#endif
+#endif
+
 wxMemoryOutputStream*
 wxPdfFontSubsetTrueType::CreateSubset(wxInputStream* inFont, wxPdfSortedArrayInt* usedGlyphs, bool includeCmap)
 {
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdfimage.cpp wxPdfDoc-copy/src/pdfimage.cpp
--- wxpdfdoc-0.9.2.1/src/pdfimage.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdfimage.cpp	2012-05-26 17:59:56.597500000 +0100
@@ -79,9 +79,17 @@
     fileURL = wxFileSystem::FileNameToURL(m_name);
   }
   m_imageFile = wxPdfImage::GetFileSystem()->OpenFile(fileURL);
+  if (m_imageFile != NULL)
+  {
   wxString mimeType = m_imageFile->GetMimeType();
   m_type = (mimeType != wxEmptyString) ? mimeType : type.Lower();
-  m_imageStream = (m_imageFile != NULL) ? m_imageFile->GetStream() : NULL;
+    m_imageStream = m_imageFile->GetStream();
+  }
+  else
+  {
+    m_type = type.Lower();
+    m_imageStream = NULL;
+  }
 }
 
 wxPdfImage::wxPdfImage(wxPdfDocument* document, int index, const wxString& name, const wxImage& image)
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdfkernel.cpp wxPdfDoc-copy/src/pdfkernel.cpp
--- wxpdfdoc-0.9.2.1/src/pdfkernel.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdfkernel.cpp	2012-05-22 01:23:12.685400000 +0100
@@ -21,6 +21,7 @@
 #include <wx/wx.h>
 #endif
 
+#include <wx/wfstream.h>
 #include <wx/zstream.h>
 
 #include "wx/pdfannotation.h"
@@ -601,6 +602,12 @@
 {
   Out("/Type /Catalog");
   Out("/Pages 1 0 R");
+
+  if (!m_attachments->empty())
+  {
+    OutAscii(wxString::Format(wxT("/Names <</EmbeddedFiles %d 0 R>>"), m_nAttachments));
+  }
+
   if (m_zoomMode == wxPDF_ZOOM_FULLPAGE)
   {
     OutAscii(wxString::Format(wxT("/OpenAction [%d 0 R /Fit]"), m_firstPageId));
@@ -1775,8 +1782,11 @@
     }
 
     OutAscii(wxString::Format(wxT("/Length %lu >>"), (unsigned long) CalculateStreamLength(p->TellO())));
+    int nSave = m_n;
+    m_n = currentTemplate->GetObjIndex();
     PutStream(*p);
     Out("endobj");
+    m_n = nSave;
     if (m_compress)
     {
       delete p;
@@ -1798,6 +1808,7 @@
       while ((entry = entry->GetNext()) != NULL)
       {
         wxPdfObject* resolvedObject = m_currentParser->ResolveObject(entry->GetObject());
+        resolvedObject->SetActualId(entry->GetActualObjectId());
         NewObj(entry->GetActualObjectId());
         WriteObjectValue(resolvedObject);
         Out("endobj");
@@ -1994,6 +2005,73 @@
 }
 
 void
+wxPdfDocument::PutFiles()
+{
+  int count = (int) (m_attachments->size());
+  wxArrayString* attachment;
+  wxString fileName;
+  wxString attachName;
+  wxString description;
+  wxString nameTree;
+  int j;
+  for (j = 1; j <= count; ++j)
+  {
+    attachment = (*m_attachments)[j];
+    fileName = (*attachment)[0];
+    attachName = (*attachment)[1];
+    description = (*attachment)[2];
+
+    wxFileInputStream fileContent(fileName);
+    if (fileContent.IsOk())
+    {
+      NewObj();
+      nameTree += wxString::Format(wxT("(%04d) %d 0 R "), j, m_n);
+//      $s .= $this->_textstring(sprintf('%03d',$i)).' '.$this->n.' 0 R ';
+
+      Out("<<");
+      Out("/Type /Filespec");
+      Out("/F (", false);
+      Out((const char*) attachName.mb_str(*wxConvFileName), false);
+      Out(")");
+#if wxUSE_UNICODE
+      Out("/UF ", false);
+      OutTextstring(attachName);
+#endif
+      Out("/EF <</F ", false);
+      OutAscii(wxString::Format(wxT("%d 0 R>>"), m_n+1));
+      if (!description.IsEmpty())
+      {
+        Out("/Desc ", false);
+        OutTextstring(description);
+      }
+      Out(">>");
+      Out("endobj");
+
+      wxMemoryOutputStream* p = new wxMemoryOutputStream();
+      p->Write(fileContent);
+      size_t fileLen = CalculateStreamLength(p->TellO());
+
+      NewObj();
+      Out("<<");
+      Out("/Type /EmbeddedFile");
+      OutAscii(wxString::Format(wxT("/Length %lu"), (unsigned long) fileLen));
+      Out(">>");
+      PutStream(*p);
+      Out("endobj");
+      delete p;
+    }
+  }
+  NewObj();
+  m_nAttachments = m_n;
+  Out("<<");
+  Out("/Names [", false);
+  OutAscii(nameTree, false);
+  Out("]");
+  Out(">>");
+  Out("endobj");
+}
+
+void
 wxPdfDocument::PutEncryption()
 {
   Out("/Filter /Standard");
@@ -2144,6 +2222,7 @@
 
   PutBookmarks();
   PutJavaScript();
+  PutFiles();
 
   if (m_encrypted)
   {
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdfobjects.cpp wxPdfDoc-copy/src/pdfobjects.cpp
--- wxpdfdoc-0.9.2.1/src/pdfobjects.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdfobjects.cpp	2012-05-22 01:23:12.796400000 +0100
@@ -46,6 +46,7 @@
   m_type = type;
   m_objNum = -1;
   m_objGen = -1;
+  m_actualId = -1;
   m_indirect = false;
 }
 
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdfprint.cpp wxPdfDoc-copy/src/pdfprint.cpp
--- wxpdfdoc-0.9.2.1/src/pdfprint.cpp	1970-01-01 00:00:00.000000000 +0000
+++ wxPdfDoc-copy/src/pdfprint.cpp	2012-05-30 00:24:12.360300000 +0100
@@ -0,0 +1,2062 @@
+/////////////////////////////////////////////////////////////////////////////
+// Name:        wx/pdfprint.h
+// Purpose:     wxPdfPrinter, wxPdfPrintNativeData
+// Author:      Mark Dootson
+// Modified by:
+// Created:     11 May 2012
+// SVN-ID:      $Id$
+// Copyright:   (c) 2012 Ulrich Telle
+// Licence:     wxWindows licence
+/////////////////////////////////////////////////////////////////////////////
+
+// For compilers that support precompilation, includes <wx.h>.
+#include <wx/wxprec.h>
+
+#ifdef __BORLANDC__
+#pragma hdrstop
+#endif
+
+#ifndef WX_PRECOMP
+#include <wx/wx.h>
+#endif
+
+#include <wx/utils.h>
+#include <wx/dc.h>
+#include <wx/app.h>
+#include <wx/msgdlg.h>
+#include <wx/progdlg.h>
+#include <wx/log.h>
+
+#include <wx/printdlg.h>
+#include <wx/generic/prntdlgg.h>
+#include <wx/progdlg.h>
+#include <wx/paper.h>
+
+#include <wx/stattext.h>
+#include <wx/statbox.h>
+#include <wx/button.h>
+#include <wx/checkbox.h>
+#include <wx/textctrl.h>
+#include <wx/radiobox.h>
+#include <wx/filedlg.h>
+#include <wx/combobox.h>
+#include <wx/sizer.h>
+#include <wx/cmndata.h>
+
+#include <wx/prntbase.h>
+#include <wx/printdlg.h>
+#include <wx/paper.h>
+#include <wx/filename.h>
+#include <wx/mimetype.h>
+#include <wx/tokenzr.h>
+#include <wx/imaglist.h>
+
+#include <stdlib.h>
+#include <string.h>
+
+#include "wx/pdfdoc.h"
+#include "wx/pdfdc.h"
+#include "wx/pdfprint.h"
+#include <wx/intl.h>
+
+// ----------------------------------------------------------------------------
+// PdfPrint data
+// ----------------------------------------------------------------------------
+
+IMPLEMENT_DYNAMIC_CLASS(wxPdfPrintData, wxObject)
+
+wxPdfPrintData::wxPdfPrintData()
+{    
+  Init();    
+}
+
+wxPdfPrintData::wxPdfPrintData(wxPdfPrintData* pdfPrintData)
+{
+  m_documentTitle     = pdfPrintData->m_documentTitle;
+  m_documentSubject   = pdfPrintData->m_documentSubject;
+  m_documentAuthor    = pdfPrintData->m_documentAuthor;
+  m_documentKeywords  = pdfPrintData->m_documentKeywords;
+  m_documentCreator   = pdfPrintData->m_documentCreator;
+  m_protectionEnabled = pdfPrintData->m_protectionEnabled;
+  m_userPassword      = pdfPrintData->m_userPassword;
+  m_ownerPassword     = pdfPrintData->m_ownerPassword;
+  m_permissions       = pdfPrintData->m_permissions;
+  m_encryptionMethod  = pdfPrintData->m_encryptionMethod;
+  m_keyLength         = pdfPrintData->m_keyLength;
+
+  m_printOrientation  = pdfPrintData->m_printOrientation;
+  m_printQuality      = pdfPrintData->m_printQuality;
+  m_paperId           = pdfPrintData->m_paperId;
+  m_filename          = pdfPrintData->m_filename;
+
+  m_printFromPage     = pdfPrintData->m_printFromPage;
+  m_printToPage       = pdfPrintData->m_printToPage;
+  m_printMinPage      = pdfPrintData->m_printMinPage;
+  m_printMaxPage      = pdfPrintData->m_printMaxPage;
+
+  m_printDialogFlags  = pdfPrintData->m_printDialogFlags;
+  m_launchViewer      = pdfPrintData->m_launchViewer;
+  m_templateDocument  = pdfPrintData->m_templateDocument;
+  m_templateWidth     = pdfPrintData->m_templateWidth;
+  m_templateHeight    = pdfPrintData->m_templateHeight;
+  m_templateMode      = pdfPrintData->m_templateMode;
+}
+
+wxPdfPrintData::wxPdfPrintData(wxPrintData* printData)
+{
+  Init();
+  m_printOrientation = printData->GetOrientation();
+  m_paperId          = printData->GetPaperId();
+  if (!printData->GetFilename().IsEmpty())
+  {
+    m_filename       = printData->GetFilename();
+  }
+  m_printQuality     = printData->GetQuality();
+}
+
+wxPdfPrintData::wxPdfPrintData(wxPrintDialogData* printDialogData)
+{
+  Init();
+
+  wxPrintData printData = printDialogData->GetPrintData();
+
+  if (printData.IsOk())
+  {
+    m_printOrientation = printData.GetOrientation();
+    m_paperId          = printData.GetPaperId();
+    if (!printData.GetFilename().IsEmpty())
+    {
+      m_filename       = printData.GetFilename();
+    }
+    m_printQuality     = printData.GetQuality();
+  }
+
+  m_printFromPage = printDialogData->GetFromPage();
+  m_printToPage   = printDialogData->GetToPage();
+  m_printMinPage  = printDialogData->GetMinPage();
+  m_printMaxPage  = printDialogData->GetMaxPage();
+}
+
+wxPdfPrintData::wxPdfPrintData(wxPageSetupDialogData* pageSetupDialogData)
+{
+  Init();
+
+  wxPrintData printData = pageSetupDialogData->GetPrintData();
+
+  if( printData.IsOk() )
+  {
+    m_printOrientation = printData.GetOrientation();
+    m_paperId          = printData.GetPaperId();
+    if (!printData.GetFilename().IsEmpty())
+    {
+      m_filename       = printData.GetFilename();
+    }
+    m_printQuality     = printData.GetQuality();
+  }
+}
+
+void
+wxPdfPrintData::Init()
+{
+  m_documentTitle     = wxT("PDF Document");
+  m_documentSubject   = wxEmptyString;
+  m_documentAuthor    = wxEmptyString;
+  m_documentKeywords  = wxEmptyString;
+  m_documentCreator   = wxT("wxPdfDC");
+  m_protectionEnabled = false;
+  m_userPassword      = wxEmptyString;
+  m_ownerPassword     = wxEmptyString;
+  m_permissions       = wxPDF_PERMISSION_NONE;
+  m_encryptionMethod  = wxPDF_ENCRYPTION_RC4V1;
+  m_keyLength         = 40;
+
+  m_printOrientation  = wxPORTRAIT;
+  m_paperId           = wxPAPER_A4;
+  m_filename          = wxT("default.pdf");
+  m_printQuality      = wxPDF_PRINTER_DEFAULT_RESOLUTION;
+
+  m_printFromPage = 1;
+  m_printToPage  = 9999;
+  m_printMinPage = 1;
+  m_printMaxPage = 9999;
+
+  m_printDialogFlags  = wxPDF_PRINTDIALOG_ALLOWALL;
+  m_launchViewer      = false;
+
+  m_templateDocument  = NULL;
+  m_templateWidth     = 0.0;
+  m_templateHeight    = 0.0;
+  m_templateMode      = false;
+}
+
+void
+wxPdfPrintData::SetDocumentProtection(int permissions, const wxString& userPassword,
+                                      const wxString& ownerPassword, wxPdfEncryptionMethod encryptionMethod,
+                                      int keyLength)
+{
+  m_permissions       = permissions;
+  m_userPassword      = userPassword;
+  m_ownerPassword     = ownerPassword;
+  m_encryptionMethod  = encryptionMethod;
+  m_keyLength         = keyLength;
+  m_protectionEnabled = true;
+}
+
+void
+wxPdfPrintData::ClearDocumentProtection()
+{
+  SetDocumentProtection(0);
+  m_protectionEnabled = false;
+}
+
+void
+wxPdfPrintData::UpdateDocument(wxPdfDocument* pdfDoc)
+{
+  if(!m_templateMode)
+  {
+    pdfDoc->SetTitle(m_documentTitle);
+    pdfDoc->SetAuthor(m_documentAuthor);
+    pdfDoc->SetSubject(m_documentSubject);
+    pdfDoc->SetCreator(m_documentCreator);
+    pdfDoc->SetKeywords(m_documentKeywords);
+    if(m_protectionEnabled)
+    {
+      pdfDoc->SetProtection(m_permissions, m_userPassword, m_ownerPassword, m_encryptionMethod , m_keyLength);
+    }
+  }
+}
+
+wxPrintData*
+wxPdfPrintData::CreatePrintData() const
+{
+  wxPrintData* printData = new wxPrintData();
+  printData->SetQuality(GetQuality());
+  printData->SetOrientation(GetOrientation());
+  printData->SetPaperId(GetPaperId());
+  printData->SetFilename(GetFilename());
+  return printData;
+}
+
+int
+wxPdfPrintData::GetPrintResolution() const
+{
+  int resolution;
+  // Make resolutions appear to be what user would expect
+  switch ( m_printQuality )
+  {
+    case wxPRINT_QUALITY_HIGH:
+      resolution = 1200;
+      break;
+
+    case wxPRINT_QUALITY_MEDIUM:
+      resolution = 600;
+      break;
+
+    case wxPRINT_QUALITY_LOW:
+      resolution = 300;
+      break;
+
+    case wxPRINT_QUALITY_DRAFT:
+      resolution = 150;
+      break;
+
+    default:
+      if ( m_printQuality >= 72 )
+      {
+        resolution = m_printQuality;
+      }
+      else
+      {
+        resolution = wxPDF_PRINTER_DEFAULT_RESOLUTION;
+      }
+      break;
+  }
+  return resolution;
+}
+
+void
+wxPdfPrintData::SetTemplate(wxPdfDocument* pdfDocument, double templateWidth, double templateHeight)
+{
+  m_templateDocument = pdfDocument;
+  m_templateWidth    = templateWidth;
+  m_templateHeight   = templateHeight;
+  m_templateMode     = true;
+}
+
+
+// ----------------------------------------------------------------------------
+// wxPdfPrinter
+// ----------------------------------------------------------------------------
+
+IMPLEMENT_DYNAMIC_CLASS(wxPdfPrinter, wxPrinterBase)
+
+wxPdfPrinter::wxPdfPrinter()
+{
+  m_currentPrintout = NULL;
+  sm_abortWindow = NULL;
+  sm_abortIt = false;
+  sm_lastError = wxPRINTER_NO_ERROR;
+}
+
+wxPdfPrinter::wxPdfPrinter(wxPrintDialogData* printDialogData)
+{
+  m_currentPrintout = NULL;
+  sm_abortWindow = NULL;
+  sm_abortIt = false;
+  m_printDialogData = (*printDialogData);
+  m_pdfPrintData = wxPdfPrintData(printDialogData);
+  sm_lastError = wxPRINTER_NO_ERROR;
+}
+
+wxPdfPrinter::wxPdfPrinter(wxPdfPrintData* printData)
+{
+  m_currentPrintout = NULL;
+  sm_abortWindow = NULL;
+  sm_abortIt = false;
+  m_pdfPrintData = (*printData);
+  sm_lastError = wxPRINTER_NO_ERROR;
+}
+
+wxPdfPrinter::wxPdfPrinter(wxPrintData* data)
+{
+  m_currentPrintout = NULL;
+  sm_abortWindow = NULL;
+  sm_abortIt = false;
+  m_pdfPrintData = wxPdfPrintData( data );;
+  m_printDialogData.SetPrintData(*data);
+  sm_lastError = wxPRINTER_NO_ERROR;
+}
+
+bool wxPdfPrinter::Print(wxWindow* parent, wxPrintout* printout, bool prompt)
+{
+  wxProgressDialog* progressDialog = NULL;
+
+  sm_abortIt = false;
+  sm_abortWindow = NULL;
+
+  if (!printout)
+  {
+    sm_lastError = wxPRINTER_ERROR;
+    return false;
+  }
+
+  wxPdfDC* dc;
+
+  if( m_pdfPrintData.GetTemplateMode() )
+  {
+    dc = new wxPdfDC(m_pdfPrintData.GetTemplateDocument(),
+                     m_pdfPrintData.GetTemplateWidth(),
+                     m_pdfPrintData.GetTemplateHeight());
+  }
+  else if (prompt)
+  {
+    dc = (wxPdfDC*) PrintDialog(parent);
+    if (!dc)
+    {
+      return false;
+    }
+  }
+  else
+  {
+    wxPrintData* dcPrintData = m_pdfPrintData.CreatePrintData();
+    dc = new wxPdfDC(*dcPrintData);
+    delete dcPrintData;
+  }
+
+  if (m_pdfPrintData.GetMinPage() < 1)
+  {
+    m_pdfPrintData.SetMinPage(1);
+  }
+  if (m_pdfPrintData.GetMaxPage() < 1)
+  {
+    m_pdfPrintData.SetMaxPage(9999);
+  }
+
+  // May have pressed cancel.
+  if (!dc || !dc->IsOk())
+  {
+    if (dc) delete dc;
+    sm_lastError = wxPRINTER_ERROR;
+    return false;
+  }
+
+  // Get the printdata used and check for extra info
+  // update the document if it is present
+  // we need a startdoc to get a valid dc
+
+  dc->StartDoc(wxT("PDF Document"));
+  m_pdfPrintData.UpdateDocument( dc->GetPdfDocument() );
+
+  // ---------------------------------------------------------------
+  // determine and set our printout params
+  // ---------------------------------------------------------------
+  int screenppiX, screenppiY, deviceW, deviceH, devicemmX, devicemmY;
+  GetPdfScreenPPI(&screenppiX, &screenppiY);
+
+  int resolution = m_pdfPrintData.GetPrintResolution();    
+  dc->SetResolution(resolution); 
+  dc->GetSize( &deviceW, &deviceH );
+  dc->GetSizeMM(&devicemmX, &devicemmY);
+
+  printout->SetPPIScreen(screenppiX, screenppiY);
+  printout->SetPPIPrinter(resolution,  resolution);
+  printout->SetPageSizePixels(deviceW, deviceH);
+  printout->SetPaperRectPixels(wxRect(0, 0, deviceW, deviceH));
+  printout->SetPageSizeMM(devicemmX, devicemmY);
+  printout->SetDC(dc);
+
+  // ---------------------------------------------------------------
+  // determine which pages to print
+  // ---------------------------------------------------------------
+  wxBeginBusyCursor();
+
+  // the printout will probably do all its sizing calcs on this call
+  printout->OnPreparePrinting();
+
+  int fromPage, toPage, minPage, maxPage;
+  printout->GetPageInfo(&minPage, &maxPage, &fromPage, &toPage);
+
+  if (maxPage == 0)
+  {
+    sm_lastError = wxPRINTER_ERROR;
+    wxEndBusyCursor();
+    return false;
+  }
+
+  // merge info from printout with user / programmer choices in the dialog info
+  m_printDialogData.SetMinPage(minPage);
+  m_printDialogData.SetMaxPage(maxPage);
+  if ((m_printDialogData.GetFromPage() < minPage ) ||  (m_printDialogData.GetFromPage() < 1 ))
+  {
+    m_printDialogData.SetFromPage(minPage);
+  }
+  if ((m_printDialogData.GetToPage() > maxPage ) || ( m_printDialogData.GetToPage() < 1 ))
+  {
+    m_printDialogData.SetToPage(maxPage);
+  }
+
+  int numberofpages = m_printDialogData.GetToPage() - m_printDialogData.GetFromPage() +1;
+  int printedPages = 0;
+
+  // ---------------------------------------------------------------
+  // do the actual printing
+  // ---------------------------------------------------------------
+  if (m_showProgressDialog)
+  {
+    progressDialog = 
+      new wxProgressDialog(printout->GetTitle(),
+                           _("Printing..."),
+                           numberofpages,
+                           parent,
+                           wxPD_AUTO_HIDE|wxPD_APP_MODAL);
+  }
+
+  printout->OnBeginPrinting();
+
+  sm_lastError = wxPRINTER_NO_ERROR;
+
+  if (printout->OnBeginDocument(m_printDialogData.GetFromPage(), m_printDialogData.GetToPage()))
+  {
+    // print our range of chosen pages or until HasPage returns false
+    int currentpage;
+    for (currentpage  = m_printDialogData.GetFromPage();
+         (currentpage <= m_printDialogData.GetToPage()) && printout->HasPage( currentpage );
+         currentpage++)
+    {
+      if (m_showProgressDialog)
+      {
+        wxString msg;
+        msg.Printf(_("Printing page %d..."), printedPages + 1);
+        progressDialog->Update(printedPages++, msg);
+      }
+      dc->StartPage();
+      printout->OnPrintPage(currentpage);
+      dc->EndPage();
+      wxYield();
+    }
+  }
+  else
+  {
+    // OnBeginDocument returned false
+    wxEndBusyCursor();
+    wxLogError(_("Could not start printing."));
+    sm_lastError = wxPRINTER_ERROR;
+  }
+
+  printout->OnEndDocument();
+  printout->OnEndPrinting();
+
+  // ---------------------------------------------------------------
+  // cleanup
+  // ---------------------------------------------------------------
+  if (m_showProgressDialog)
+  {
+    delete progressDialog;
+  }
+
+  wxEndBusyCursor();
+  delete dc;
+
+  // ---------------------------------------------------------------
+  // Launch Viewer
+  // ---------------------------------------------------------------
+
+  if (m_pdfPrintData.GetLaunchDocumentViewer() && !m_pdfPrintData.GetTemplateMode())
+  {
+    wxFileName fileName = wxFileName(m_pdfPrintData.GetFilename());  
+    wxFileType* fileType = wxTheMimeTypesManager->GetFileTypeFromExtension(wxT("pdf"));
+    if (fileType != NULL)
+    {
+      wxString cmd = fileType->GetOpenCommand(fileName.GetFullPath());
+      if (!cmd.IsEmpty())
+      {
+        wxExecute(cmd);
+      }
+      delete fileType;
+    }
+    else
+    {
+      // fallback
+      wxString fileURL;
+      if (wxIsAbsolutePath(m_pdfPrintData.GetFilename()))
+      {
+        fileURL = wxT("file://") + m_pdfPrintData.GetFilename();
+      }
+      else
+      {
+        fileURL = wxT("file://") + wxGetCwd() + wxFILE_SEP_PATH + m_pdfPrintData.GetFilename();
+      }
+      wxLaunchDefaultBrowser(fileURL);
+    }
+  }
+
+  return (sm_lastError == wxPRINTER_NO_ERROR);
+}
+
+wxDC*
+wxPdfPrinter::PrintDialog(wxWindow* parent)
+{
+  wxPdfDC* dc = NULL;
+
+  wxPdfPrintDialog dialog( parent, &m_pdfPrintData );
+  if (dialog.ShowModal() == wxID_OK)
+  {
+    dc = (wxPdfDC*) dialog.GetPrintDC();
+    m_pdfPrintData = dialog.GetPdfPrintData();
+
+    sm_lastError = (dc == NULL) ? wxPRINTER_ERROR : wxPRINTER_NO_ERROR;
+  }
+  else
+  {
+    sm_lastError = wxPRINTER_CANCELLED;
+  }
+
+  return dc;
+}
+
+bool
+wxPdfPrinter::Setup(wxWindow* WXUNUSED(parent))
+{
+  return false;
+}
+
+void
+wxPdfPrinter::GetPdfScreenPPI(int* x, int* y)
+{
+  wxScreenDC dc;
+
+  if (x)
+  {
+    *x = dc.GetPPI().GetWidth();
+  }
+
+  if (y)
+  {
+    *y = dc.GetPPI().GetHeight();
+  }
+}
+
+// ----------------------------------------------------------------------------
+// wxPdfPrintPreview
+// ----------------------------------------------------------------------------
+
+IMPLEMENT_CLASS(wxPdfPrintPreview, wxPrintPreview)
+
+wxPdfPrintPreview::wxPdfPrintPreview(wxPrintout* printout,
+                                     wxPrintout* printoutForPrinting)
+  : wxPrintPreviewBase(printout, printoutForPrinting)
+{
+  m_pimpl = new wxPdfPrintPreviewImpl(printout, printoutForPrinting);
+}
+
+wxPdfPrintPreview::wxPdfPrintPreview(wxPrintout* printout,
+                                     wxPrintout* printoutForPrinting,
+                                     wxPrintData* data)
+  : wxPrintPreviewBase(printout, printoutForPrinting, data)
+{
+  m_pimpl = new wxPdfPrintPreviewImpl(printout, printoutForPrinting, data);
+}
+
+wxPdfPrintPreview::wxPdfPrintPreview(wxPrintout* printout,
+                                     wxPrintout* printoutForPrinting,
+                                     wxPrintDialogData* data)
+  : wxPrintPreviewBase(printout, printoutForPrinting, data)
+{
+  m_pimpl = new wxPdfPrintPreviewImpl(printout, printoutForPrinting, data);
+}
+
+wxPdfPrintPreview::wxPdfPrintPreview(wxPrintout* printout,
+                                     wxPrintout* printoutForPrinting,
+                                     wxPdfPrintData* pdfPrintData)
+  : wxPrintPreviewBase(printout, printoutForPrinting)
+{
+  m_pimpl = new wxPdfPrintPreviewImpl(printout, printoutForPrinting, pdfPrintData);
+}
+
+wxPdfPrintPreview::~wxPdfPrintPreview()
+{
+  delete m_pimpl;
+
+  // don't delete twice
+  m_printPrintout = NULL;
+  m_previewPrintout = NULL;
+  m_previewBitmap = NULL;
+}
+
+bool
+wxPdfPrintPreview::SetCurrentPage(int pageNum)
+{
+  return m_pimpl->SetCurrentPage(pageNum);
+}
+
+int
+wxPdfPrintPreview::GetCurrentPage() const
+{
+  return m_pimpl->GetCurrentPage();
+}
+
+void
+wxPdfPrintPreview::SetPrintout(wxPrintout* printout)
+{
+  m_pimpl->SetPrintout(printout);
+}
+
+wxPrintout*
+wxPdfPrintPreview::GetPrintout() const
+{
+  return m_pimpl->GetPrintout();
+}
+
+wxPrintout*
+wxPdfPrintPreview::GetPrintoutForPrinting() const
+{
+  return m_pimpl->GetPrintoutForPrinting();
+}
+
+void
+wxPdfPrintPreview::SetFrame(wxFrame* frame)
+{
+  m_pimpl->SetFrame(frame);
+}
+
+void
+wxPdfPrintPreview::SetCanvas(wxPreviewCanvas* canvas)
+{
+  m_pimpl->SetCanvas(canvas);
+}
+
+wxFrame*
+wxPdfPrintPreview::GetFrame() const
+{
+  return m_pimpl->GetFrame();
+}
+
+wxPreviewCanvas*
+wxPdfPrintPreview::GetCanvas() const
+{
+  return m_pimpl->GetCanvas();
+}
+
+bool
+wxPdfPrintPreview::PaintPage(wxPreviewCanvas* canvas, wxDC& dc)
+{
+  return m_pimpl->PaintPage(canvas, dc);
+}
+
+#if wxCHECK_VERSION(2,9,0)
+bool
+wxPdfPrintPreview::UpdatePageRendering()
+{
+  return m_pimpl->UpdatePageRendering();
+}
+#endif
+
+bool
+wxPdfPrintPreview::DrawBlankPage(wxPreviewCanvas* canvas, wxDC& dc)
+{
+  return m_pimpl->DrawBlankPage(canvas, dc);
+}
+
+void
+wxPdfPrintPreview::AdjustScrollbars(wxPreviewCanvas* canvas)
+{
+  m_pimpl->AdjustScrollbars(canvas);
+}
+
+bool
+wxPdfPrintPreview::RenderPage(int pageNum)
+{
+  return m_pimpl->RenderPage(pageNum);
+}
+
+void
+wxPdfPrintPreview::SetZoom(int percent)
+{
+  m_pimpl->SetZoom(percent);
+}
+
+int
+wxPdfPrintPreview::GetZoom() const
+{
+  return m_pimpl->GetZoom();
+}
+
+wxPrintDialogData&
+wxPdfPrintPreview::GetPrintDialogData()
+{
+  return m_pimpl->GetPrintDialogData();
+}
+
+int
+wxPdfPrintPreview::GetMaxPage() const
+{
+  return m_pimpl->GetMaxPage();
+}
+
+int
+wxPdfPrintPreview::GetMinPage() const
+{
+  return m_pimpl->GetMinPage();
+}
+
+bool
+wxPdfPrintPreview::IsOk() const
+{
+  return m_pimpl->IsOk();
+}
+
+void
+wxPdfPrintPreview::SetOk(bool ok)
+{
+  m_pimpl->SetOk( ok );
+}
+
+bool
+wxPdfPrintPreview::Print(bool interactive)
+{
+  return m_pimpl->Print(interactive);
+}
+
+void
+wxPdfPrintPreview::DetermineScaling()
+{
+  m_pimpl->DetermineScaling();
+}
+
+
+// ----------------------------------------------------------------------------
+// wxPdfPrintPreview Implementation
+// ----------------------------------------------------------------------------
+
+
+IMPLEMENT_CLASS(wxPdfPrintPreviewImpl, wxPrintPreviewBase)
+
+wxPdfPrintPreviewImpl::wxPdfPrintPreviewImpl(wxPrintout* printout,
+                                             wxPrintout* printoutForPrinting)
+  : wxPrintPreviewBase(printout, printoutForPrinting)
+{
+    m_pdfPrintData  = new wxPdfPrintData();
+    m_pdfPreviewDC  = NULL;
+    m_pdfPreviewDoc = NULL;
+    DetermineScaling();
+}
+
+wxPdfPrintPreviewImpl::wxPdfPrintPreviewImpl(wxPrintout* printout,
+                                             wxPrintout* printoutForPrinting,
+                                             wxPrintData* data)
+  : wxPrintPreviewBase(printout, printoutForPrinting, data)
+{
+  m_pdfPrintData  = new wxPdfPrintData(data);
+  m_pdfPreviewDC  = NULL;
+  m_pdfPreviewDoc = NULL;
+  DetermineScaling();
+}
+
+wxPdfPrintPreviewImpl::wxPdfPrintPreviewImpl(wxPrintout* printout,
+                                             wxPrintout* printoutForPrinting,
+                                             wxPrintDialogData* data)
+  : wxPrintPreviewBase(printout, printoutForPrinting, data)
+{
+  m_pdfPrintData  = new wxPdfPrintData(data);
+  m_pdfPreviewDC  = NULL;
+  m_pdfPreviewDoc = NULL;
+  DetermineScaling();
+}
+
+wxPdfPrintPreviewImpl::wxPdfPrintPreviewImpl(wxPrintout* printout,
+                                             wxPrintout* printoutForPrinting,
+                                             wxPdfPrintData* pdfPrintData)
+  : wxPrintPreviewBase(printout, printoutForPrinting )
+{
+  m_pdfPrintData = new wxPdfPrintData( pdfPrintData );
+  m_pdfPreviewDC  = NULL;
+  m_pdfPreviewDoc = NULL;
+  DetermineScaling();
+}
+
+wxPdfPrintPreviewImpl::~wxPdfPrintPreviewImpl()
+{
+  if (m_pdfPreviewDC)
+  {
+    delete m_pdfPreviewDC;
+  }
+
+  if (m_pdfPreviewDoc)
+  {
+    delete m_pdfPreviewDoc;
+  }
+
+  if (m_pdfPrintData)
+  {
+    delete m_pdfPrintData;
+  }
+}
+
+bool
+wxPdfPrintPreviewImpl::Print(bool interactive)
+{
+  if (!m_printPrintout)
+  {
+    return false;
+  }
+
+  wxPdfPrinter printer(m_pdfPrintData);
+  return printer.Print(m_previewFrame, m_printPrintout, interactive);
+}
+
+void
+wxPdfPrintPreviewImpl::GetPdfScreenPPI(int* x, int* y)
+{
+  wxScreenDC dc;
+
+  if (x)
+  {
+    *x = dc.GetPPI().GetWidth();
+  }
+
+  if (y)
+  {
+    *y = dc.GetPPI().GetHeight();
+  }
+}
+
+void
+wxPdfPrintPreviewImpl::DetermineScaling()
+{
+  int screenppiX, screenppiY, deviceW, deviceH, devicemmX, devicemmY;
+  GetPdfScreenPPI(&screenppiX, &screenppiY);
+  int resolution = m_pdfPrintData->GetPrintResolution();
+  if (!m_pdfPreviewDC)
+  {
+    // In template mode get a document with the same metrics
+    // as the template for the preview dc
+    if (m_pdfPrintData->GetTemplateMode())
+    {
+      wxString scaleMode;
+      switch ((int) m_pdfPrintData->GetTemplateDocument()->GetScaleFactor())
+      {
+        case 1:
+          scaleMode = wxT("pt");
+          break;
+        case 72:
+          scaleMode = wxT("in");
+          break;
+        case 28:
+          scaleMode = wxT("cm");
+          break;
+        default:
+          scaleMode = wxT("mm");
+          break;
+      }
+
+      m_pdfPreviewDoc = new wxPdfDocument(wxPORTRAIT, m_pdfPrintData->GetTemplateWidth(),
+                                          m_pdfPrintData->GetTemplateHeight(), scaleMode);
+
+      m_pdfPreviewDC = new wxPdfDC(m_pdfPreviewDoc,
+                                   m_pdfPrintData->GetTemplateWidth(),
+                                   m_pdfPrintData->GetTemplateHeight());
+    }
+    else
+    {
+      wxPrintData* pdata = m_pdfPrintData->CreatePrintData();
+      m_pdfPreviewDC = new wxPdfDC(*pdata);
+      m_pdfPreviewDC->StartDoc(wxT("unused name"));
+      delete pdata;
+    }
+  }
+
+  m_pdfPreviewDC->SetResolution(resolution);
+  m_pdfPreviewDC->GetSize(&deviceW, &deviceH);
+  m_pdfPreviewDC->GetSizeMM(&devicemmX, &devicemmY);
+
+  m_previewPrintout->SetPPIScreen(screenppiX, screenppiY);
+  m_previewPrintout->SetPPIPrinter(resolution, resolution);
+  m_previewPrintout->SetPageSizePixels(deviceW, deviceH);
+  m_previewPrintout->SetPaperRectPixels(wxRect(0, 0, deviceW, deviceH));
+  m_previewPrintout->SetPageSizeMM(devicemmX, devicemmY);
+
+  m_pageWidth  = deviceW;
+  m_pageHeight = deviceH;
+
+  m_previewScaleX = (double) screenppiX / resolution;
+  m_previewScaleY = (double) screenppiY / resolution;
+
+  // override some base values
+  m_currentZoom = 100;
+}
+
+#if wxCHECK_VERSION(2,9,0)
+// Version 2.9.x
+
+bool
+wxPdfPrintPreviewImpl::RenderPageIntoBitmap(wxBitmap& bmp, int pageNum)
+{
+  wxMemoryDC memoryDC;
+  memoryDC.SelectObject(bmp);
+  memoryDC.Clear();
+  wxPdfPreviewDC previewDC(memoryDC, m_pdfPreviewDC);
+
+  return RenderPageIntoDC(previewDC, pageNum);
+}
+
+#else
+// Version 2.8.x
+
+bool
+wxPdfPrintPreviewImpl::RenderPageIntoDCImpl(wxDC& dc, int pageNum)
+{
+  m_previewPrintout->SetDC(&dc);
+  m_previewPrintout->SetPageSizePixels(m_pageWidth, m_pageHeight);
+
+  // Need to delay OnPreparePrinting() until here, so we have enough
+  // information.
+  if (!m_printingPrepared)
+  {
+    m_previewPrintout->OnPreparePrinting();
+    int selFrom, selTo;
+    m_previewPrintout->GetPageInfo(&m_minPage, &m_maxPage, &selFrom, &selTo);
+    m_printingPrepared = true;
+  }
+
+  m_previewPrintout->OnBeginPrinting();
+
+  if (!m_previewPrintout->OnBeginDocument(m_printDialogData.GetFromPage(), m_printDialogData.GetToPage()))
+  {
+    wxMessageBox(wxT("Could not start document preview."), wxT("Print Preview Failure"), wxOK);
+    return false;
+  }
+
+  m_previewPrintout->OnPrintPage(pageNum);
+  m_previewPrintout->OnEndDocument();
+  m_previewPrintout->OnEndPrinting();
+
+  m_previewPrintout->SetDC(NULL);
+
+  return true;
+}
+
+bool
+wxPdfPrintPreviewImpl::RenderPageIntoBitmapImpl(wxBitmap& bmp, int pageNum)
+{
+  wxMemoryDC memoryDC;
+  memoryDC.SelectObject(bmp);
+  memoryDC.Clear();
+  wxPdfPreviewDC previewDC(memoryDC, m_pdfPreviewDC);
+  return RenderPageIntoDCImpl(previewDC, pageNum);
+}
+
+bool
+wxPdfPrintPreviewImpl::RenderPage(int pageNum)
+{
+  wxBusyCursor busy;
+
+  if (!m_previewCanvas)
+  {
+    wxFAIL_MSG(wxT("wxPrintPreviewBase::RenderPage: must use wxPrintPreviewBase::SetCanvas to let me know about the canvas!"));
+    return false;
+  }
+
+  wxRect pageRect, paperRect;
+  CalcRects(m_previewCanvas, pageRect, paperRect);
+
+  if (!m_previewBitmap)
+  {
+    m_previewBitmap = new wxBitmap(pageRect.width, pageRect.height);
+
+    if (!m_previewBitmap || !m_previewBitmap->Ok())
+    {
+      if (m_previewBitmap)
+      {
+        delete m_previewBitmap;
+        m_previewBitmap = NULL;
+      }
+      wxMessageBox(wxT("Sorry, not enough memory to create a preview."), wxT("Print Preview Failure"), wxOK);
+      return false;
+    }
+  }
+
+  if (!RenderPageIntoBitmapImpl(*m_previewBitmap, pageNum))
+  {
+    wxMessageBox(wxT("Could not start document preview."), wxT("Print Preview Failure"), wxOK);
+
+    delete m_previewBitmap;
+    m_previewBitmap = NULL;
+    return false;
+  }
+
+#if wxUSE_STATUSBAR
+  wxString status;
+  if (m_maxPage != 0)
+  {
+    status = wxString::Format(wxT("Page %d of %d"), pageNum, m_maxPage);
+  }
+  else
+  {
+    status = wxString::Format(wxT("Page %d"), pageNum);
+  }
+
+  if (m_previewFrame)
+  {
+    m_previewFrame->SetStatusText(status);
+  }
+#endif
+
+  return true;
+}
+
+#endif
+
+
+//----------------------------------------------------------------------------
+// wxPdfPrintDialog
+//----------------------------------------------------------------------------
+
+IMPLEMENT_CLASS(wxPdfPrintDialog, wxPrintDialogBase)
+
+BEGIN_EVENT_TABLE(wxPdfPrintDialog, wxPrintDialogBase)
+    EVT_BUTTON(wxID_OK, wxPdfPrintDialog::OnOK)
+    EVT_CHECKBOX(wxPDF_PRINTDIALOG_CTRLID_PROTECT, wxPdfPrintDialog::OnProtectCheck)
+    EVT_FILEPICKER_CHANGED(wxPDF_PRINTDIALOG_CTRLID_FILEPICKER, wxPdfPrintDialog::OnFilepathChanged)
+END_EVENT_TABLE()
+
+wxPdfPrintDialog::wxPdfPrintDialog(wxWindow* parent, wxPdfPrintData* data)
+  : wxPrintDialogBase(parent,
+                      wxID_ANY, _("PDF Document Output"),
+                      wxPoint(0,0), wxSize(600, 600),
+                      wxDEFAULT_DIALOG_STYLE |
+                      wxTAB_TRAVERSAL)
+{
+  m_pdfPrintData = *data;
+  Init(parent);
+}
+
+
+void
+wxPdfPrintDialog::Init(wxWindow* WXUNUSED(parent))
+{
+  int dialogFlags = m_pdfPrintData.GetPrintDialogFlags();
+
+  wxBoxSizer* mainsizer = new wxBoxSizer(wxVERTICAL);
+  wxFlexGridSizer* flex = new wxFlexGridSizer(2);
+  flex->AddGrowableCol(1);
+
+  // File Path
+
+  flex->Add( new wxStaticText(this, wxID_ANY, _("Output File")), 0, wxALL, 5 );
+  wxBoxSizer* filesizer = new wxBoxSizer(wxHORIZONTAL);
+  m_filepath = new wxTextCtrl(this, wxID_ANY, wxEmptyString, wxDefaultPosition, wxSize(320, -1), wxTE_READONLY);
+  filesizer->Add(m_filepath, 1, wxEXPAND|wxALL, 0);
+
+  if (dialogFlags & wxPDF_PRINTDIALOG_FILEPATH)
+  {
+    m_filepicker = 
+      new wxFilePickerCtrl(this, wxPDF_PRINTDIALOG_CTRLID_FILEPICKER, m_pdfPrintData.GetFilename(), 
+                           _("Choose a file name for the PDF output"),
+                           _("PDF Files (*.pdf)|*.pdf"), wxDefaultPosition, wxDefaultSize,
+                           wxFLP_SAVE|wxFLP_OVERWRITE_PROMPT);
+
+    filesizer->Add(m_filepicker, 0, wxEXPAND|wxLEFT, 4);
+  }
+
+  flex->Add(filesizer,1, wxALL|wxEXPAND, 3);
+
+  if (dialogFlags & wxPDF_PRINTDIALOG_OPENDOC)
+  {
+    flex->AddSpacer(1);
+    m_launchViewer = new wxCheckBox(this, wxID_ANY, _("Open Document in Default Viewer"));
+    flex->Add(m_launchViewer, 1, wxALL|wxEXPAND, 5);
+  }
+
+  // Document Properties
+
+  if (dialogFlags & wxPDF_PRINTDIALOG_PROPERTIES)
+  {
+    flex->Add(new wxStaticText(this, wxID_ANY, _("Title")), 0, wxALL, 5);
+    m_title = new wxTextCtrl(this, wxID_ANY, wxEmptyString, wxDefaultPosition, wxDefaultSize);
+    flex->Add(m_title, 1, wxALL|wxEXPAND, 3);
+
+    flex->Add(new wxStaticText(this, wxID_ANY, _("Author")), 0, wxALL, 5);
+    m_author = new wxTextCtrl(this, wxID_ANY, wxEmptyString, wxDefaultPosition, wxDefaultSize);
+    flex->Add(m_author, 1, wxALL|wxEXPAND, 3);
+
+    flex->Add(new wxStaticText(this, wxID_ANY, _("Subject")), 0, wxALL, 5);
+    m_subject = new wxTextCtrl(this, wxID_ANY, wxEmptyString, wxDefaultPosition, wxDefaultSize);
+    flex->Add(m_subject, 1, wxALL|wxEXPAND, 3);
+
+    flex->Add(new wxStaticText(this, wxID_ANY, _("Keywords")), 0, wxALL, 5);
+    m_keywords = new wxTextCtrl(this, wxID_ANY, wxEmptyString, wxDefaultPosition, wxSize(400,50), wxTE_MULTILINE);
+    flex->Add(m_keywords, 1, wxALL|wxEXPAND, 3);
+  }
+
+  mainsizer->Add(flex, 0, wxLEFT|wxTOP|wxRIGHT|wxGROW, 10);
+
+  // Document Protection
+  wxString* compatchoices = new wxString[3];
+
+  if (dialogFlags & wxPDF_PRINTDIALOG_PROTECTION)
+  {
+    wxFlexGridSizer* flex2 = new wxFlexGridSizer(2);
+    flex2->AddGrowableCol(0);
+    flex2->AddGrowableCol(1);
+
+    m_protect = new wxCheckBox(this, wxPDF_PRINTDIALOG_CTRLID_PROTECT, _("Password Protect and Encrypt Document"));
+    flex2->Add( m_protect, 0, wxEXPAND|wxALL, 5);
+
+    compatchoices[0] = _("PDF Reader 7.0 Compatible");
+    compatchoices[1] = _("PDF Reader 5.0 Compatible");
+    compatchoices[2] = _("PDF Reader 3.0 Compatible");
+
+    m_compat = new wxChoice(this, wxID_ANY, wxDefaultPosition, wxDefaultSize, 3, compatchoices);
+
+    m_compat->SetSelection(0);
+    flex2->Add(m_compat, 1, wxEXPAND|wxALL, 5);
+
+    mainsizer->Add(flex2, 0, wxEXPAND|wxTOP|wxLEFT|wxRIGHT, 10);
+
+    wxFlexGridSizer* flex3 = new wxFlexGridSizer(4);
+    flex3->AddGrowableCol(1);
+    flex3->AddGrowableCol(3);
+
+    flex3->Add(new wxStaticText(this, wxID_ANY, _("User Password")), 0, wxALL, 5);
+    m_userpwd = new wxTextCtrl(this, wxID_ANY, wxEmptyString, wxDefaultPosition, wxDefaultSize, wxTE_PASSWORD);
+    flex3->Add(m_userpwd, 1, wxALL|wxEXPAND, 3);
+
+    flex3->Add(new wxStaticText(this, wxID_ANY, _("Confirm")), 0, wxALL, 5);
+    m_userpwdconfirm = new wxTextCtrl(this, wxID_ANY, wxEmptyString, wxDefaultPosition, wxDefaultSize, wxTE_PASSWORD);
+    flex3->Add(m_userpwdconfirm, 1, wxALL|wxEXPAND, 3);
+
+    flex3->Add(new wxStaticText(this, wxID_ANY, _("Owner Password")), 0, wxALL, 5);
+    m_ownerpwd = new wxTextCtrl(this, wxID_ANY, wxEmptyString, wxDefaultPosition, wxDefaultSize, wxTE_PASSWORD);
+    flex3->Add(m_ownerpwd, 1, wxALL|wxEXPAND, 3);
+
+    flex3->Add( new wxStaticText(this, wxID_ANY, _("Confirm")), 0, wxALL, 5);
+    m_ownerpwdconfirm = new wxTextCtrl(this, wxID_ANY, wxEmptyString, wxDefaultPosition, wxDefaultSize, wxTE_PASSWORD);
+    flex3->Add(m_ownerpwdconfirm, 1, wxALL|wxEXPAND, 3);
+
+    mainsizer->Add(flex3, 0, wxEXPAND|wxTOP|wxLEFT|wxRIGHT, 10);
+
+    wxFlexGridSizer* flex4 = new wxFlexGridSizer(3);
+    flex4->AddGrowableCol(0);
+    flex4->AddGrowableCol(1);
+    flex4->AddGrowableCol(2);
+
+    m_canprint = new wxCheckBox(this, wxID_ANY, _("Allow Printing"));
+    flex4->Add(m_canprint, 0, wxEXPAND|wxLEFT|wxRIGHT|wxTOP, 5);
+
+    m_canmodify = new wxCheckBox(this, wxID_ANY, _("Allow Modification"));
+    flex4->Add(m_canmodify, 0, wxEXPAND|wxLEFT|wxRIGHT|wxTOP, 5);
+
+    m_cancopy = new wxCheckBox(this, wxID_ANY, _("Allow Content Copying"));
+    flex4->Add(m_cancopy, 0, wxEXPAND|wxLEFT|wxRIGHT|wxTOP, 5);
+
+    m_canannot = new wxCheckBox(this, wxID_ANY, _("Allow Comments"));
+    flex4->Add(m_canannot, 0, wxEXPAND|wxLEFT|wxRIGHT|wxTOP, 5);
+
+    m_canform = new wxCheckBox(this, wxID_ANY, _("Allow Fill Form Fields"));
+    flex4->Add(m_canform, 0, wxEXPAND|wxLEFT|wxRIGHT|wxTOP, 5);
+
+    m_canextract = new wxCheckBox(this, wxID_ANY, _("Allow Content Extract"));
+    flex4->Add(m_canextract, 0, wxEXPAND|wxLEFT|wxRIGHT|wxTOP, 5);
+
+    m_canassemble = new wxCheckBox(this, wxID_ANY, _("Allow Assembly"));
+    flex4->Add(m_canassemble, 0, wxEXPAND|wxLEFT|wxRIGHT|wxTOP, 5);
+
+    mainsizer->Add(flex4, 0, wxEXPAND|wxTOP|wxLEFT|wxRIGHT, 10);
+  }
+
+  // Standard Dialog Buttons
+
+  //wxBoxSizer* bottomsizer = new wxBoxSizer(wxHORIZONTAL);
+
+  wxSizer* sizerBtn = CreateSeparatedButtonSizer(wxOK|wxCANCEL);
+  if (sizerBtn)
+  {
+    mainsizer->Add(sizerBtn, 0, wxEXPAND|wxALL, 10);
+  }
+
+  SetAutoLayout(true);
+  SetSizer(mainsizer);
+
+  mainsizer->Fit(this);
+  Centre(wxBOTH);
+
+  // Calls wxWindow::OnInitDialog and then wxPdfPrintDialog::TransferDataToWindow
+  InitDialog();
+  delete[] compatchoices;
+}
+
+int
+wxPdfPrintDialog::ShowModal()
+{
+  return wxDialog::ShowModal();
+}
+
+wxPdfPrintDialog::~wxPdfPrintDialog()
+{
+}
+
+void
+wxPdfPrintDialog::OnOK(wxCommandEvent& WXUNUSED(event))
+{
+  if (!TransferDataFromWindow())
+    return;
+
+  EndModal(wxID_OK);
+}
+
+void
+wxPdfPrintDialog::OnProtectCheck(wxCommandEvent& WXUNUSED(event))
+{
+  UpdateProtectionControls();
+}
+
+void
+wxPdfPrintDialog::OnFilepathChanged(wxFileDirPickerEvent& event)
+{
+  m_filepath->ChangeValue(event.GetPath());
+}
+
+void
+wxPdfPrintDialog::UpdateProtectionControls()
+{
+  int dialogFlags = m_pdfPrintData.GetPrintDialogFlags();
+
+  if (dialogFlags & wxPDF_PRINTDIALOG_PROTECTION)
+  {
+    bool protectionEnabled = m_protect->GetValue();
+
+    m_canprint->Enable(protectionEnabled);
+    m_canmodify->Enable(protectionEnabled);
+    m_cancopy->Enable(protectionEnabled);
+    m_canannot->Enable(protectionEnabled);
+    m_canform->Enable(protectionEnabled);
+    m_canextract->Enable(protectionEnabled);
+    m_canassemble->Enable(protectionEnabled);
+
+    m_ownerpwd->Enable(protectionEnabled);
+    m_userpwd->Enable(protectionEnabled);
+    m_ownerpwdconfirm->Enable(protectionEnabled);
+    m_userpwdconfirm->Enable(protectionEnabled);
+
+    m_compat->Enable(protectionEnabled);
+  }
+}
+
+bool
+wxPdfPrintDialog::TransferDataToWindow()
+{
+  int dialogFlags = m_pdfPrintData.GetPrintDialogFlags();
+
+  m_filepath->ChangeValue(m_pdfPrintData.GetFilename());
+
+  if (dialogFlags & wxPDF_PRINTDIALOG_OPENDOC)
+  {
+    m_launchViewer->SetValue(m_pdfPrintData.GetLaunchDocumentViewer());
+  }
+
+  if (dialogFlags & wxPDF_PRINTDIALOG_PROPERTIES)
+  {
+    m_title->ChangeValue(m_pdfPrintData.GetDocumentTitle()) ;
+    m_subject->ChangeValue(m_pdfPrintData.GetDocumentSubject()) ;
+    m_author->ChangeValue(m_pdfPrintData.GetDocumentAuthor()) ;
+    m_keywords->ChangeValue(m_pdfPrintData.GetDocumentKeywords()) ;
+  }
+
+  bool protectionEnabled = m_pdfPrintData.IsProtectionEnabled();
+
+  if (dialogFlags & wxPDF_PRINTDIALOG_PROTECTION)
+  {
+    m_protect->SetValue(protectionEnabled);
+
+    int permFlags = m_pdfPrintData.GetPermissions();
+    m_canprint->SetValue((permFlags & wxPDF_PERMISSION_PRINT) || (permFlags & wxPDF_PERMISSION_HLPRINT));
+    m_canmodify->SetValue((permFlags & wxPDF_PERMISSION_MODIFY) != 0);
+    m_cancopy->SetValue((permFlags & wxPDF_PERMISSION_COPY) != 0);
+    m_canannot->SetValue((permFlags & wxPDF_PERMISSION_ANNOT) != 0);
+    m_canform->SetValue((permFlags & wxPDF_PERMISSION_FILLFORM) != 0);
+    m_canextract->SetValue((permFlags & wxPDF_PERMISSION_EXTRACT) != 0);
+    m_canassemble->SetValue((permFlags & wxPDF_PERMISSION_ASSEMBLE) != 0);
+
+    m_ownerpwd->ChangeValue(m_pdfPrintData.GetOwnerPassword());
+    m_userpwd->ChangeValue(m_pdfPrintData.GetUserPassword());
+    m_ownerpwdconfirm->ChangeValue(m_pdfPrintData.GetOwnerPassword());
+    m_userpwdconfirm->ChangeValue(m_pdfPrintData.GetUserPassword());
+
+    switch (m_pdfPrintData.GetEncryptionMethod())
+    {
+      case wxPDF_ENCRYPTION_RC4V1:
+        m_compat->SetSelection(2);
+        break;
+      case wxPDF_ENCRYPTION_RC4V2:
+        m_compat->SetSelection(1);
+        break;
+      default:
+        m_compat->SetSelection(0);
+        break;
+    }
+
+    UpdateProtectionControls();
+  }
+
+  return true;
+}
+
+bool
+wxPdfPrintDialog::TransferDataFromWindow()
+{
+  int dialogFlags = m_pdfPrintData.GetPrintDialogFlags();
+
+  // Do protection first so that we may exit
+  // without having changed any values if
+  // passwords & confirms are not equal
+
+  if (dialogFlags & wxPDF_PRINTDIALOG_PROTECTION)
+  {
+    if (m_protect->GetValue())
+    {
+      if (m_userpwd->GetValue().Cmp(m_userpwdconfirm->GetValue()) != 0)
+      {
+        wxLogError(_("Your values for User Password and the confirmation are not the same."));
+        return false;
+      }
+
+      if (m_ownerpwd->GetValue().Cmp(m_ownerpwdconfirm->GetValue()) != 0)
+      {
+        wxLogError(_("Your values for Owner Password and the confirmation are not the same."));
+        return false;
+      }
+
+      int permissions = wxPDF_PERMISSION_NONE;
+
+      if (m_canprint->GetValue())
+      {
+        permissions |= wxPDF_PERMISSION_PRINT;
+      }
+
+      if (m_canmodify->GetValue())
+      {
+        permissions |= wxPDF_PERMISSION_MODIFY;
+      }
+
+      if (m_cancopy->GetValue())
+      {
+        permissions |= wxPDF_PERMISSION_COPY;
+      }
+
+      if (m_canannot->GetValue())
+      {
+        permissions |= wxPDF_PERMISSION_ANNOT;
+      }
+
+      if (m_canform->GetValue())
+      {
+        permissions |= wxPDF_PERMISSION_FILLFORM;
+      }
+
+      if (m_canextract->GetValue())
+      {
+        permissions |= wxPDF_PERMISSION_EXTRACT;
+      }
+
+      if (m_canassemble->GetValue())
+      {
+        permissions |= wxPDF_PERMISSION_ASSEMBLE;
+      }
+
+      int keylength;
+      wxPdfEncryptionMethod encryptMethod;
+
+      switch (m_compat->GetSelection())
+      {
+        case 0:
+          keylength = 128;
+          encryptMethod = wxPDF_ENCRYPTION_AESV2;
+          break;
+        case 1:
+          keylength = 128;
+          encryptMethod = wxPDF_ENCRYPTION_RC4V2;
+          break;
+        default:
+          keylength = 40;
+          encryptMethod = wxPDF_ENCRYPTION_RC4V1;
+          break;
+      }
+
+      m_pdfPrintData.SetDocumentProtection(permissions,
+                                           m_userpwd->GetValue(),
+                                           m_ownerpwd->GetValue(),
+                                           encryptMethod,
+                                           keylength);
+    }
+    else
+    {
+      m_pdfPrintData.ClearDocumentProtection();
+    }
+  }
+
+  // Filepath
+  if (dialogFlags & wxPDF_PRINTDIALOG_FILEPATH)
+  {
+    m_pdfPrintData.SetFilename(m_filepath->GetValue());
+  }
+
+  if (dialogFlags & wxPDF_PRINTDIALOG_OPENDOC)
+  {
+    m_pdfPrintData.SetLaunchDocumentViewer(m_launchViewer->GetValue());
+  }
+
+  // Properties
+
+  if (dialogFlags & wxPDF_PRINTDIALOG_PROPERTIES)
+  {
+    m_pdfPrintData.SetDocumentTitle(m_title->GetValue());
+    m_pdfPrintData.SetDocumentSubject(m_subject->GetValue());
+    m_pdfPrintData.SetDocumentAuthor(m_author->GetValue());
+    m_pdfPrintData.SetDocumentKeywords(m_keywords->GetValue());
+  }
+
+  return true;
+}
+
+wxPdfDC*
+wxPdfPrintDialog::GetPrintDC()
+{
+  return new wxPdfDC(*GetPdfPrintData().CreatePrintData());
+}
+
+// ---------------------------------------------------------------------------
+// wxPdfPageSetupDialogCanvas: paper drawing canvas
+// ---------------------------------------------------------------------------
+
+IMPLEMENT_CLASS(wxPdfPageSetupDialogCanvas, wxWindow)
+
+BEGIN_EVENT_TABLE(wxPdfPageSetupDialogCanvas, wxWindow)
+    EVT_PAINT(wxPdfPageSetupDialogCanvas::OnPaint)
+END_EVENT_TABLE()
+
+wxPdfPageSetupDialogCanvas::wxPdfPageSetupDialogCanvas(wxWindow* parent)
+  : wxWindow( parent, wxID_ANY, wxDefaultPosition, wxSize(300,200), wxBORDER_THEME)
+{
+  m_paperWidth = 210;
+  m_paperHeight = 297;
+  m_marginLeft = 25;
+  m_marginTop = 25;
+  m_marginRight = 25;
+  m_marginBottom = 25;
+}
+
+wxPdfPageSetupDialogCanvas::~wxPdfPageSetupDialogCanvas()
+{
+}
+
+void
+wxPdfPageSetupDialogCanvas::OnPaint(wxPaintEvent& WXUNUSED(event))
+{
+  wxPaintDC dc(this);
+
+  //------------------------------------------
+  // Get the sizes and bounds
+  //------------------------------------------
+
+  int px = m_paperWidth;
+  int py = m_paperHeight;
+  int ps = (px > py) ? px : py;
+
+  int w, h;
+  dc.GetSize(&w, &h);
+
+  double scale = ((double)h - 10.0 ) / (double)ps;
+
+  int rw = int( px * scale );
+  int rh = int( py * scale );
+  int rx = int( (w - rw) / 2 );
+  int ry = int( (h - rh) / 2 );
+
+  int ml = int( m_marginLeft * scale );
+  int mr = int( m_marginRight * scale );
+  int mt = int( m_marginTop * scale );
+  int mb = int( m_marginBottom * scale );
+
+  //------------------------------------------
+  // save current dc objects
+  //------------------------------------------
+
+  wxBrush restorebackground = dc.GetBackground();
+  wxBrush restorebrush = dc.GetBrush();
+  wxPen restorepen = dc.GetPen();
+
+  wxBrush* lightBrush = new wxBrush(wxColour(220,220,220), wxSOLID);
+
+  dc.SetBackground(*lightBrush);
+  dc.Clear();
+
+  int clipx, clipy, clipw, cliph;
+  dc.GetClippingBox(&clipx, &clipy, &clipw, &cliph);
+
+  //------------------------------------------
+  // Draw a 'shadow' paper
+  //------------------------------------------
+
+  wxBrush* shadowBrush = new wxBrush(wxColour(175,175,175), wxSOLID);
+
+  dc.SetBrush(*shadowBrush);
+  dc.SetPen(*wxTRANSPARENT_PEN);
+
+  dc.DrawRectangle(rx + 3, ry + 3, rw, rh);
+
+  //------------------------------------------
+  // Draw paper
+  //------------------------------------------
+
+  dc.SetBrush(*wxWHITE_BRUSH);
+  dc.SetPen(*wxBLACK_PEN);
+
+  dc.DrawRectangle(rx, ry, rw, rh);
+
+  //------------------------------------------
+  // Draw margins
+  //------------------------------------------
+
+  wxPen* dashpen = new wxPen(wxColour(255,0,125), 1 , wxUSER_DASH );
+  wxDash pDash[2] = { 3, 3 };
+  dashpen->SetDashes(2, pDash);
+  dc.SetPen(*dashpen);
+  dc.DrawLine(rx + ml, ry + 1, rx + ml, ( ry + rh ) - 2 ); // left margin
+  dc.DrawLine(rx + 1, ry + mt, ( rx + rw ) -1, ry + mt );  // top margin
+  dc.DrawLine((rx + rw) - mr, ry + 1, (rx + rw) - mr, ( ry + rh ) - 2 );// right margin
+  dc.DrawLine(rx + 1, (ry + rh) - mb, ( rx + rw ) -1, (ry + rh) - mb );  // bottom margin
+  dc.SetPen(*wxTRANSPARENT_PEN);
+
+  //------------------------------------------
+  // Draw fake content
+  //------------------------------------------
+
+  int linewidth = 4;
+
+  int sx = rx + ml + 2;
+  int sw = rw - ( ml + mr + 4 );
+  int sy = ry + mt + 2;
+  int sh = rh - ( mt + mb + 4 );
+  int smax = (ry + rh) - mb;
+
+  dc.SetBrush(*lightBrush);
+  dc.SetPen(*wxTRANSPARENT_PEN);
+  dc.SetClippingRegion( sx, sy, sw, sh );
+
+  while ( sy < smax )
+  {
+    dc.DrawRectangle(sx, sy, sw, linewidth);
+    sy += (linewidth + 3);
+  }
+
+  //------------------------------------------
+  // Restore DC objects
+  //------------------------------------------
+
+  dc.DestroyClippingRegion();
+  dc.SetClippingRegion(clipx, clipy, clipw, cliph);
+  dc.SetBrush(restorebrush);
+  dc.SetPen(restorepen);
+  dc.SetBackground(restorebackground);
+
+  delete lightBrush;
+  delete shadowBrush;
+  delete dashpen;
+}
+
+// ---------------------------------------------------------------------------
+// wxPdfPageSetupDialog: the page setup dialog
+// ---------------------------------------------------------------------------
+
+IMPLEMENT_CLASS(wxPdfPageSetupDialog, wxDialog)
+
+BEGIN_EVENT_TABLE(wxPdfPageSetupDialog, wxDialog)
+    EVT_BUTTON(wxID_OK, wxPdfPageSetupDialog::OnOK)
+    EVT_CHOICE(wxPDF_PAGEDIALOG_CTRLID_MARGINUNIT, wxPdfPageSetupDialog::OnMarginUnit)
+    EVT_CHOICE(wxPDF_PAGEDIALOG_CTRLID_PAPER, wxPdfPageSetupDialog::OnPaperType)
+    EVT_CHOICE(wxPDF_PAGEDIALOG_CTRLID_ORIENTATION, wxPdfPageSetupDialog::OnOrientation)
+    EVT_TEXT(wxPDF_PAGEDIALOG_CTRLID_MARGINLEFT, wxPdfPageSetupDialog::OnMarginText)
+    EVT_TEXT(wxPDF_PAGEDIALOG_CTRLID_MARGINRIGHT, wxPdfPageSetupDialog::OnMarginText)
+    EVT_TEXT(wxPDF_PAGEDIALOG_CTRLID_MARGINTOP, wxPdfPageSetupDialog::OnMarginText)
+    EVT_TEXT(wxPDF_PAGEDIALOG_CTRLID_MARGINBOTTOM, wxPdfPageSetupDialog::OnMarginText)
+END_EVENT_TABLE()
+
+wxPdfPageSetupDialog::wxPdfPageSetupDialog(wxWindow* parent, wxPageSetupDialogData* data, const wxString& title)
+  : wxDialog(parent, wxID_ANY, title) 
+{
+  if (title.IsEmpty())
+  {
+    SetTitle(_("PDF Document Page Setup"));
+  }
+
+  m_pageData = *data;
+  Init();
+}
+
+wxPdfPageSetupDialog::~wxPdfPageSetupDialog()
+{
+}
+
+void
+wxPdfPageSetupDialog::Init()
+{
+  if (wxLocale::GetSystemLanguage() == wxLANGUAGE_ENGLISH_US)
+  {
+    m_defaultUnitSelection = 2;
+    m_defaultPaperId = wxPAPER_LETTER;
+  }
+  else
+  {
+    m_defaultUnitSelection = 0;
+    m_defaultPaperId = wxPAPER_A4;
+  }
+
+  wxBoxSizer* mainsizer = new wxBoxSizer(wxVERTICAL);
+  wxBoxSizer* canvassizer = new wxBoxSizer(wxHORIZONTAL);
+
+  m_paperCanvas = new wxPdfPageSetupDialogCanvas(this);
+  canvassizer->Add(m_paperCanvas,1, wxEXPAND|wxALL, 0);
+
+  wxString* marginchoices = NULL;
+  wxString* orientchoices = NULL;
+  wxString* paperchoices  = NULL;
+
+  if (m_pageData.GetEnableMargins())
+  {
+    wxBoxSizer *marginsizer = new wxBoxSizer(wxVERTICAL);
+    marginsizer->Add(new wxStaticText(this, wxID_ANY, _("Margins")), 0, wxEXPAND|wxTOP, 15);
+    marginchoices = new wxString[3];
+    marginchoices[0] = _("Millimetres");
+    marginchoices[1] = _("Centimetres");
+    marginchoices[2] = _("Inches");
+
+    m_marginUnits = new wxChoice(this, wxPDF_PAGEDIALOG_CTRLID_MARGINUNIT, 
+                                 wxDefaultPosition, wxDefaultSize, 3, marginchoices);
+
+    marginsizer->Add(m_marginUnits, 0, wxEXPAND|wxALL, 0);
+
+    wxFlexGridSizer *marginflex = new wxFlexGridSizer(0, 2, 3, 3);
+    marginflex->AddGrowableCol(1);
+
+    marginflex->Add(new wxStaticText(this, wxID_ANY, _("Left")), 0, wxTOP|wxEXPAND, 3);
+    m_marginLeftText = new wxTextCtrl(this, wxPDF_PAGEDIALOG_CTRLID_MARGINLEFT, wxEmptyString, wxDefaultPosition, wxSize(50, -1));
+    m_marginLeftText->SetValidator(wxTextValidator(wxFILTER_NUMERIC));
+    marginflex->Add(m_marginLeftText, 0, wxALL|wxEXPAND, 0);
+
+    marginflex->Add(new wxStaticText( this, wxID_ANY, _("Top")), 0, wxTOP|wxEXPAND, 3);
+    m_marginTopText = new wxTextCtrl(this, wxPDF_PAGEDIALOG_CTRLID_MARGINTOP, wxEmptyString, wxDefaultPosition, wxSize(50, -1));
+    m_marginTopText->SetValidator(wxTextValidator(wxFILTER_NUMERIC));
+    marginflex->Add(m_marginTopText, 0, wxALL|wxEXPAND, 0);
+
+    marginflex->Add(new wxStaticText( this, wxID_ANY, _("Right") ), 0, wxTOP|wxEXPAND, 3);
+    m_marginRightText = new wxTextCtrl(this, wxPDF_PAGEDIALOG_CTRLID_MARGINRIGHT, wxEmptyString, wxDefaultPosition, wxSize(50, -1));
+    m_marginRightText->SetValidator(wxTextValidator(wxFILTER_NUMERIC));
+    marginflex->Add(m_marginRightText, 0, wxALL|wxEXPAND, 0);
+
+    marginflex->Add(new wxStaticText( this, wxID_ANY, _("Bottom") ), 0, wxTOP|wxEXPAND, 3);
+    m_marginBottomText = new wxTextCtrl(this, wxPDF_PAGEDIALOG_CTRLID_MARGINBOTTOM, wxEmptyString, wxDefaultPosition, wxSize(50, -1));
+    m_marginBottomText->SetValidator(wxTextValidator(wxFILTER_NUMERIC));
+    marginflex->Add(m_marginBottomText, 0, wxALL|wxEXPAND, 0);
+
+    marginsizer->Add(marginflex, 0, wxEXPAND|wxTOP, 5);
+    canvassizer->Add(marginsizer, 0, wxEXPAND|wxLEFT, 10);
+  }
+
+  mainsizer->Add(canvassizer, 0, wxEXPAND|wxALL, 10);
+
+  wxFlexGridSizer* papersizer = NULL;
+
+  if (m_pageData.GetEnableOrientation() || m_pageData.GetEnablePaper())
+  {
+    papersizer = new wxFlexGridSizer( 0,2,5,20 );
+    papersizer->AddGrowableCol(1);
+  }
+
+  if (m_pageData.GetEnablePaper())
+  {
+    papersizer->Add(new wxStaticText(this, wxID_ANY, _("Paper Size")), 0, wxTOP|wxEXPAND, 3);
+    size_t n = wxThePrintPaperDatabase->GetCount();
+    paperchoices  = new wxString [n];
+    for (size_t i = 0; i < n; ++i)
+    {
+      wxPrintPaperType *paper = wxThePrintPaperDatabase->Item(i);
+      paperchoices[i] = paper->GetName();
+    }
+
+    m_paperTypeChoice = new wxChoice(this, wxPDF_PAGEDIALOG_CTRLID_PAPER, 
+                                     wxDefaultPosition, wxDefaultSize, n, paperchoices);
+    papersizer->Add(m_paperTypeChoice,  1, wxEXPAND|wxALL, 0);
+  }
+
+  if (m_pageData.GetEnableOrientation())
+  {
+    papersizer->Add(new wxStaticText(this, wxID_ANY, _("Orientation")), 0, wxTOP|wxEXPAND, 3);
+    orientchoices = new wxString [2];
+    orientchoices[0] = _("Portrait");
+    orientchoices[1] = _("Landscape");
+
+    m_orientationChoice = new wxChoice(this, wxPDF_PAGEDIALOG_CTRLID_ORIENTATION, 
+                                       wxDefaultPosition, wxDefaultSize, 2, orientchoices);
+    papersizer->Add(m_orientationChoice,  1, wxEXPAND|wxALL, 0);
+  }
+
+  if (m_pageData.GetEnableOrientation() || m_pageData.GetEnablePaper())
+  {
+    mainsizer->Add(papersizer, 0, wxEXPAND|wxALL, 10);
+  }
+
+  // Standard Dialog Buttons
+  //wxBoxSizer* bottomsizer = new wxBoxSizer(wxHORIZONTAL);
+
+  wxSizer* sizerBtn = CreateSeparatedButtonSizer(wxOK|wxCANCEL);
+  if (sizerBtn)
+  {
+    mainsizer->Add(sizerBtn, 0, wxEXPAND|wxALL, 10 );
+  }
+
+  SetAutoLayout(true);
+  SetSizer(mainsizer);
+
+  mainsizer->Fit(this);
+  Centre(wxBOTH);
+
+  // Calls wxWindow::OnInitDialog and then wxPdfPrintDialog::TransferDataToWindow
+  InitDialog();
+
+  if (marginchoices)
+  {
+    delete[] marginchoices;
+  }
+
+  if (orientchoices)
+  {
+    delete[] orientchoices;
+  }
+    
+  if (paperchoices)
+  {
+    delete[] paperchoices;
+  }
+}
+
+wxPageSetupDialogData&
+wxPdfPageSetupDialog::GetPageSetupDialogData()
+{
+  return m_pageData;
+}
+
+// old name
+wxPageSetupDialogData&
+wxPdfPageSetupDialog::GetPageSetupData()
+{
+  return GetPageSetupDialogData();
+}
+
+void
+wxPdfPageSetupDialog::OnOK(wxCommandEvent& WXUNUSED(event))
+{
+  if (!TransferDataFromWindow())
+    return;
+
+  EndModal(wxID_OK);
+}
+
+void
+wxPdfPageSetupDialog::OnMarginUnit(wxCommandEvent& WXUNUSED(event))
+{
+  TransferMarginsToControls();
+}
+
+void
+wxPdfPageSetupDialog::OnPaperType(wxCommandEvent& WXUNUSED(event))
+{
+  wxPrintPaperType *paper = wxThePrintPaperDatabase->FindPaperType(m_paperTypeChoice->GetStringSelection());
+  if (!paper)
+  {
+    wxLogError(_("Unknown Paper Type Selected"));
+    return;
+  }
+  m_paperId = paper->GetId();
+  wxSize pSize = paper->GetSizeMM();
+  m_pageWidth = pSize.GetWidth();
+  m_pageHeight = pSize.GetHeight();
+  if (m_pageData.GetEnableMargins())
+  {
+    TransferControlsToMargins();
+    TransferMarginsToControls();
+  }
+  UpdatePaperCanvas();
+}
+
+void
+wxPdfPageSetupDialog::OnOrientation(wxCommandEvent& WXUNUSED(event))
+{
+  if (m_orientationChoice->GetSelection() == 1)
+  {
+    m_orientation = wxLANDSCAPE;
+  }
+  else
+  {
+    m_orientation = wxPORTRAIT;
+  }
+  if (m_pageData.GetEnableMargins())
+  {
+    TransferControlsToMargins();
+    TransferMarginsToControls();
+  }
+  UpdatePaperCanvas();
+}
+
+void
+wxPdfPageSetupDialog::OnMarginText(wxCommandEvent& WXUNUSED(event))
+{
+  TransferControlsToMargins();
+  UpdatePaperCanvas();
+}
+
+void
+wxPdfPageSetupDialog::UpdatePaperCanvas()
+{
+  if (m_orientation == wxPORTRAIT)
+  {
+    m_paperCanvas->UpdatePageMetrics(m_pageWidth, m_pageHeight, m_marginLeft,
+                                     m_marginRight, m_marginTop, m_marginBottom);
+  }
+  else
+  {
+    m_paperCanvas->UpdatePageMetrics(m_pageHeight, m_pageWidth, m_marginLeft,
+                                     m_marginRight, m_marginTop, m_marginBottom);        
+  }
+
+  m_paperCanvas->Refresh();
+}
+
+bool
+wxPdfPageSetupDialog::TransferDataFromWindow()
+{
+  if (m_pageData.GetEnableMargins())
+  {
+    TransferControlsToMargins();
+    m_pageData.SetMarginTopLeft(wxPoint(m_marginLeft, m_marginTop));
+    m_pageData.SetMarginBottomRight(wxPoint(m_marginRight, m_marginBottom));
+  }
+
+  if (m_pageData.GetEnablePaper())
+  {
+    m_pageData.GetPrintData().SetPaperId(m_paperId);
+    m_pageData.SetPaperId(m_paperId);
+  }
+    
+  if ( m_pageData.GetEnableOrientation() )
+  {
+    m_pageData.GetPrintData().SetOrientation(m_orientation);
+  }
+
+  return true;
+}
+
+bool
+wxPdfPageSetupDialog::TransferDataToWindow()
+{
+  // work out defaults
+  int useUnitSelection = false;
+
+  wxPrintData printData = m_pageData.GetPrintData();
+
+  m_paperId = printData.GetPaperId();
+  m_orientation = printData.GetOrientation();
+
+  wxPrintPaperType* paper = wxThePrintPaperDatabase->FindPaperType(m_paperId);
+  if (!paper)
+  {
+    paper = wxThePrintPaperDatabase->FindPaperType(m_defaultPaperId);
+    m_paperId = paper->GetId();
+  }
+
+  wxSize pSize = paper->GetSizeMM();
+  m_pageWidth = pSize.GetWidth();
+  m_pageHeight = pSize.GetHeight();
+
+  if ((m_orientation != wxPORTRAIT) && (m_orientation != wxLANDSCAPE))
+  {
+    m_orientation = wxPORTRAIT;
+  }
+
+  m_marginLeft    = m_pageData.GetMarginTopLeft().x;
+  m_marginTop     = m_pageData.GetMarginTopLeft().y;
+  m_marginRight   = m_pageData.GetMarginBottomRight().x;
+  m_marginBottom  = m_pageData.GetMarginBottomRight().y;
+
+  if (m_pageData.GetEnableMargins())
+  {
+    m_marginUnits->SetSelection(useUnitSelection);
+    TransferMarginsToControls();
+  }
+
+  if (m_pageData.GetEnableOrientation())
+  {
+    if (m_orientation == wxLANDSCAPE)
+    {
+      m_orientationChoice->SetSelection(1);
+    }
+    else
+    {
+      m_orientationChoice->SetSelection(0);
+    }
+  }
+
+  m_paperTypeChoice->SetStringSelection(paper->GetName());
+  UpdatePaperCanvas();
+  return true;
+}
+
+void
+wxPdfPageSetupDialog::TransferMarginsToControls()
+{
+  int unitSelection = m_marginUnits->GetSelection();
+  double marginScaleToUnit;
+  wxChar* formatS;
+    
+  switch (unitSelection)
+  {
+    case 0:
+      // mm
+      marginScaleToUnit = 1.0;
+      formatS = (wxChar*)wxT("%.0f");
+      break;
+    case 1:
+      // cm
+      marginScaleToUnit = 0.1;
+      formatS = (wxChar*)wxT("%#.1f");
+      break;
+    case 2:
+      // inch
+      marginScaleToUnit = 1.0 / 25.4;
+      formatS = (wxChar*)wxT("%#.2f");
+      break;
+    default:
+      wxLogError(_("Unknown margin unit format in margin to control transfer."));
+      return;
+  }
+
+  m_marginLeftText->ChangeValue(wxString::Format(formatS, (double) m_marginLeft * marginScaleToUnit));
+  m_marginTopText->ChangeValue(wxString::Format(formatS, (double) m_marginTop * marginScaleToUnit));
+  m_marginRightText->ChangeValue(wxString::Format(formatS, (double) m_marginRight * marginScaleToUnit));
+  m_marginBottomText->ChangeValue(wxString::Format(formatS, (double) m_marginBottom * marginScaleToUnit));
+}
+
+void
+wxPdfPageSetupDialog::TransferControlsToMargins()
+{   
+  int unitSelection = m_marginUnits->GetSelection();
+  double marginScaleToMM = 1.0;
+  //int defaultMargin = 10;
+  double strDbl;
+
+  int maxX, maxY;
+
+  if (m_orientation == wxPORTRAIT)
+  {
+    maxX = ( m_pageWidth / 2 ) -1;
+    maxY = ( m_pageHeight / 2 ) -1;
+  }
+  else
+  {
+    maxX = ( m_pageHeight / 2 ) -1;
+    maxY = ( m_pageWidth / 2 ) -1;
+  }
+
+  switch (unitSelection)
+  {
+    case 0:
+      marginScaleToMM = 1.0;
+      break;
+    case 1:
+      // cm
+      marginScaleToMM = 10.0;
+      break;
+    case 2:
+      // inch
+      marginScaleToMM = 25.4;
+      break;
+    default:
+      wxLogError(_("Unknown margin unit format in control to margin transfer."));
+      break;
+  }
+
+  if (m_marginLeftText->GetValue().ToDouble(&strDbl))
+  {
+    m_marginLeft = abs(wxRound( strDbl * marginScaleToMM ));
+    if (m_marginLeft > maxX)
+    {
+      m_marginLeft = maxX;
+    }
+  }
+
+  if (m_marginTopText->GetValue().ToDouble(&strDbl))
+  {
+    m_marginTop = abs(wxRound( strDbl * marginScaleToMM ));
+    if (m_marginTop > maxY)
+    {
+      m_marginTop = maxY;
+    }
+  }
+
+  if (m_marginRightText->GetValue().ToDouble(&strDbl))
+  {
+    m_marginRight = abs(wxRound( strDbl * marginScaleToMM ));
+    if (m_marginRight > maxX)
+    {
+      m_marginRight = maxX;
+    }
+  }
+
+  if (m_marginBottomText->GetValue().ToDouble(&strDbl))
+  {
+    m_marginBottom = abs(wxRound(strDbl * marginScaleToMM));
+    if (m_marginBottom > maxY)
+    {
+      m_marginBottom = maxY;
+    }
+  }
+}
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdftemplate.cpp wxPdfDoc-copy/src/pdftemplate.cpp
--- wxpdfdoc-0.9.2.1/src/pdftemplate.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdftemplate.cpp	2012-05-22 01:23:12.599400000 +0100
@@ -477,6 +477,12 @@
     case OBJTYPE_STRING:
       {
         // A string.
+        int nSave = m_n;
+        int actualId = obj->GetActualId();
+        if (actualId != -1)
+        {
+          m_n = actualId;
+        }
         if (((wxPdfString*) obj)->IsHexString())
         {
           OutHexTextstring(((wxPdfString*) obj)->GetValue(), newline);
@@ -485,6 +491,10 @@
         {
           OutRawTextstring(((wxPdfString*) obj)->GetValue(), newline);
         }
+        if (actualId != -1)
+        {
+          m_n = nSave;
+        }
       }
       break;
 
@@ -550,7 +560,17 @@
         WriteObjectValue(stream->GetDictionary());
 
         // Write the stream
+        int nSave = m_n;
+        int actualId = obj->GetActualId();
+        if (actualId != -1)
+        {
+          m_n = actualId;
+        }
         PutStream(*buffer);
+        if (actualId != -1)
+        {
+          m_n = nSave;
+        }
 
         // Restore the 'Length' entry of the stream dictionary
         dictionary->Put(&lengthKey, originalLength);
diff -ruNw -x.svn -x docs wxpdfdoc-0.9.2.1/src/pdfxml.cpp wxPdfDoc-copy/src/pdfxml.cpp
--- wxpdfdoc-0.9.2.1/src/pdfxml.cpp	2011-09-16 21:22:46.000000000 +0100
+++ wxPdfDoc-copy/src/pdfxml.cpp	2012-05-22 01:23:12.558400000 +0100
@@ -65,6 +65,7 @@
   m_currentLine = 0;
   m_currentContext = 0;
   m_aligned = false;
+  m_fillStyle = 0;
   m_lastChar = 0;
   m_spaceWidth = 0;
   m_lineDelta = 0;
@@ -955,6 +956,10 @@
         context.AddHeight(h);
       }
     }
+    else if (name == wxT("span"))
+    {
+      PrepareXmlCell(child, context);
+    }
     else if (name == wxT("font"))
     {
       // --- Font
@@ -1090,7 +1095,7 @@
         int nb = (int) s.Length();
         if (nb > 0 && s[nb-1] == wxT('\n'))
         {
-          nb--;
+          --nb;
         }
         int sep = -1;
         int i = 0;
@@ -1126,6 +1131,7 @@
             ls = len;
             ns++;
           }
+          double lastlen = len;
           len = GetStringWidth(s.SubString(j, i));
 
           if (len > wmax)
@@ -1133,6 +1139,7 @@
             // Automatic line break
             if (sep == -1)
             {
+              ls = lastlen;
               if (context.GetLastLineWidth() > 0)
               {
                 if (context.GetLastChar() == wxT(' '))
@@ -1618,6 +1625,23 @@
         SetXY(x, y+h);
       }
     }
+    else if (name == wxT("span"))
+    {
+      int saveFillStyle = context.GetFillStyle();
+      wxPdfColour saveColor  = GetFillColour();
+      wxString strColor = GetXmlAttribute(child, wxT("color"), wxT(""));
+      if (strColor.Length() > 0)
+      {
+        SetFillColour(wxPdfColour(strColor));
+        context.SetFillStyle(1);
+      }
+      WriteXmlCell(child, context);
+      if (strColor.Length() > 0)
+      {
+        context.SetFillStyle(saveFillStyle);
+        SetFillColour(saveColor);
+      }
+    }
     else if (name == wxT("font"))
     {
       // --- Font
@@ -1758,7 +1782,7 @@
         int nb = (int) s.Length();
         if (nb > 0 && s[nb-1] == wxT('\n'))
         {
-          nb--;
+          --nb;
         }
 
         int sep = -1;
@@ -1780,7 +1804,7 @@
               m_ws = 0;
               Out("0 Tw");
             }
-            WriteCell(h,s.SubString(j,i-1), wxPDF_BORDER_NONE, 0, link);
+            WriteCell(h,s.SubString(j,i-1), wxPDF_BORDER_NONE, context.GetFillStyle(), link);
             i++;
             sep = -1;
             j = i;
@@ -1805,13 +1829,17 @@
             // Automatic line break
             if (sep == -1)
             {
-              if (wmax == context.GetCurrentLineWidth())
+              // Case 1: current line length exactly matches the maximum with
+              // Case 2: current line contains no spaces and line length plus epsilon exactly matches the maximum width
+              //         (line break in the middle of a word if the word is too long to fit on the line)
+              if (  wmax == context.GetCurrentLineWidth() || 
+                  ((wmax == context.GetCurrentLineWidth() + wxPDF_EPSILON) && context.GetCurrentLineSpaces() == 0))
               {
                 if (i == j)
                 {
                   i++;
                 }
-                WriteCell(h,s.SubString(j,i-1), wxPDF_BORDER_NONE, 0, link);
+                WriteCell(h,s.SubString(j,i-1), wxPDF_BORDER_NONE, context.GetFillStyle(), link);
               }
               else
               {
@@ -1820,7 +1848,7 @@
             }
             else
             {
-              WriteCell(h,s.SubString(j,sep-1), wxPDF_BORDER_NONE, 0, link);
+              WriteCell(h,s.SubString(j,sep-1), wxPDF_BORDER_NONE, context.GetFillStyle(), link);
               i = sep + 1;
             }
             sep = -1;
@@ -1839,7 +1867,7 @@
           }
         }
         // Last chunk
-        WriteCell(h,s.SubString(j,i-1), wxPDF_BORDER_NONE, 0, link);
+        WriteCell(h,s.SubString(j,i-1), wxPDF_BORDER_NONE, context.GetFillStyle(), link);
         context.AddCurrentLineWidth(-len);
         if (context.GetHAlign() == wxPDF_ALIGN_JUSTIFY && m_ws > 0)
         {
@@ -1889,4 +1917,3 @@
   }
   context.SetAligned();
 }
-
